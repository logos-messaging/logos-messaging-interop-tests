2026-01-30 04:35:30.010 DEBUG [tests.conftest] Running fixture setup: test_id
2026-01-30 04:35:30.010 DEBUG [tests.conftest] Running test: test_message_relayed_while_store_node_is_stopped_without_removing with id: 2026-01-30_04-35-30__92bcf309-5b0b-460d-a1aa-060452cc8574
2026-01-30 04:35:30.011 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-01-30 04:35:30.012 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-01-30 04:35:30.024 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-30 04:35:30.025 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-01-30_04-35-30__92bcf309-5b0b-460d-a1aa-060452cc8574__wakuorg_nwaku:latest.log
2026-01-30 04:35:30.025 DEBUG [src.node.waku_node] Starting Node...
2026-01-30 04:35:30.026 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-30 04:35:30.030 DEBUG [src.node.docker_mananger] Network waku already exists
2026-01-30 04:35:30.030 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.103.50
2026-01-30 04:35:30.031 DEBUG [src.node.docker_mananger] Generated ports ['37223', '37224', '37225', '37226', '37227']
2026-01-30 04:35:30.031 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-30 04:35:30.032 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-30 04:35:30.032 DEBUG [src.node.waku_node] Using volumes []
2026-01-30 04:35:30.032 DEBUG [src.node.docker_mananger] docker run -i -t -p 37223:37223 -p 37224:37224 -p 37225:37225 -p 37226:37226 -p 37227:37227 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37225 --rest-port=37223 --tcp-port=37224 --discv5-udp-port=37226 --rest-address=0.0.0.0 --nat=extip:172.18.103.50 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d3fdb2c3829060affddf26998ec2cb37aa28acbd503d75af3bffdac36a8bed68 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37227 --metrics-logging=true --store=true --relay=true
2026-01-30 04:35:30.217 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.103.50 waku ad996db5fea37007fe653d246046e1898b61ce3b7c3e81a893cf44191755a5ba
2026-01-30 04:35:30.224 ERROR [src.node.docker_mananger] Max retries reached for container 662317d47b48. Exiting log stream.
2026-01-30 04:35:30.248 DEBUG [src.node.docker_mananger] Container started with ID ad996db5fea3. Setting up logs at ./log/docker/publishing_node1_2026-01-30_04-35-30__92bcf309-5b0b-460d-a1aa-060452cc8574__wakuorg_nwaku:latest.log
2026-01-30 04:35:30.250 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 37223
2026-01-30 04:35:30.250 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-30 04:35:30.844 ERROR [src.node.docker_mananger] Max retries reached for container 4941bd42dbee. Exiting log stream.
2026-01-30 04:35:31.250 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37223/health" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:35:31.254 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-01-30 04:35:31.254 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-30 04:35:31.254 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37223/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:35:31.256 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.103.50/tcp/37224/p2p/16Uiu2HAmMfMbKmrd1B2tnMsAjJFnMdyFm5qVa9jR2ycP2t92K6pi","/ip4/172.18.103.50/tcp/37225/ws/p2p/16Uiu2HAmMfMbKmrd1B2tnMsAjJFnMdyFm5qVa9jR2ycP2t92K6pi"],"enrUri":"enr:-L24QDxCQTkf3l-q8mMY_w-2zInbdJrlFNNgGTnmCFeZ8GT4C3TF02RnlRpZzfSQfmUTRv4WCnnsDiX0NS_UNuF2eYsCgmlkgnY0gmlwhKwSZzKKbXVsdGlhZGRyc5YACASsEmcyBpFoAAoErBJnMgaRad0DgnJzhQADAQAAiXNlY3AyNTZrMaEDhdEzYiNy3OLXrlrGNjgFySy4oVK8-reMG8LQl1QOUqODdGNwgpFog3VkcIKRaoV3YWt1MgM"}'
2026-01-30 04:35:31.257 INFO [src.node.waku_node] REST service is ready !!
2026-01-30 04:35:31.263 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-30 04:35:31.263 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-01-30_04-35-30__92bcf309-5b0b-460d-a1aa-060452cc8574__wakuorg_nwaku:latest.log
2026-01-30 04:35:31.264 DEBUG [src.node.waku_node] Starting Node...
2026-01-30 04:35:31.264 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-30 04:35:31.265 DEBUG [src.node.docker_mananger] Network waku already exists
2026-01-30 04:35:31.265 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.146.32
2026-01-30 04:35:31.265 DEBUG [src.node.docker_mananger] Generated ports ['42208', '42209', '42210', '42211', '42212']
2026-01-30 04:35:31.265 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-30 04:35:31.266 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-30 04:35:31.266 DEBUG [src.node.waku_node] Using volumes []
2026-01-30 04:35:31.266 DEBUG [src.node.docker_mananger] docker run -i -t -p 42208:42208 -p 42209:42209 -p 42210:42210 -p 42211:42211 -p 42212:42212 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42210 --rest-port=42208 --tcp-port=42209 --discv5-udp-port=42211 --rest-address=0.0.0.0 --nat=extip:172.18.146.32 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=96fb1742c80ff11fc1bf22dda34daef7a9da8d8571f21b4d2fbd8efbb2dcc9fa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42212 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QDxCQTkf3l-q8mMY_w-2zInbdJrlFNNgGTnmCFeZ8GT4C3TF02RnlRpZzfSQfmUTRv4WCnnsDiX0NS_UNuF2eYsCgmlkgnY0gmlwhKwSZzKKbXVsdGlhZGRyc5YACASsEmcyBpFoAAoErBJnMgaRad0DgnJzhQADAQAAiXNlY3AyNTZrMaEDhdEzYiNy3OLXrlrGNjgFySy4oVK8-reMG8LQl1QOUqODdGNwgpFog3VkcIKRaoV3YWt1MgM --storenode=/ip4/172.18.103.50/tcp/37224/p2p/16Uiu2HAmMfMbKmrd1B2tnMsAjJFnMdyFm5qVa9jR2ycP2t92K6pi --store=false --relay=false
2026-01-30 04:35:31.458 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.146.32 waku 06c3d3c9c27a3d5897596c303f6f75da4a81901a58b9f706ff10b3080b9c60f7
2026-01-30 04:35:31.489 DEBUG [src.node.docker_mananger] Container started with ID 06c3d3c9c27a. Setting up logs at ./log/docker/store_node1_2026-01-30_04-35-30__92bcf309-5b0b-460d-a1aa-060452cc8574__wakuorg_nwaku:latest.log
2026-01-30 04:35:31.490 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 42208
2026-01-30 04:35:31.490 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-30 04:35:32.490 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42208/health" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:35:32.494 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-01-30 04:35:32.494 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-30 04:35:32.494 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42208/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:35:32.496 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.146.32/tcp/42209/p2p/16Uiu2HAmRBk8dUwTjxu1UUq1rrUeTqrgSVwh3JTNxU6EqEwxGXJa","/ip4/172.18.146.32/tcp/42210/ws/p2p/16Uiu2HAmRBk8dUwTjxu1UUq1rrUeTqrgSVwh3JTNxU6EqEwxGXJa"],"enrUri":"enr:-L24QFlDa-bqDU2uxmU-FcHa4oNB7hJLOS9saipTfC6t9yi8RcNF_-YVi5IldrF2oTssUIxZpmSumFCnM33yPz6UR4oCgmlkgnY0gmlwhKwSkiCKbXVsdGlhZGRyc5YACASsEpIgBqThAAoErBKSIAak4t0DgnJzhQADAQAAiXNlY3AyNTZrMaEDui0r6hRoP_mHYHV0KDi1IGXcP1W7K6fhF2VgHlbS4PuDdGNwgqThg3VkcIKk44V3YWt1MgA"}'
2026-01-30 04:35:32.497 INFO [src.node.waku_node] REST service is ready !!
2026-01-30 04:35:32.497 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42208/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.103.50/tcp/37224/p2p/16Uiu2HAmMfMbKmrd1B2tnMsAjJFnMdyFm5qVa9jR2ycP2t92K6pi"]'
2026-01-30 04:35:32.525 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-30 04:35:32.525 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37223/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-01-30 04:35:32.537 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-30 04:35:32.538 DEBUG [src.steps.store] Relaying message
2026-01-30 04:35:32.540 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37223/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-01-30 04:35:32.547 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-30 04:35:32.547 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-01-30 04:35:32.748 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-01-30 04:35:32.748 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37223/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:35:32.751 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xe34952725c18a8343d4111548f00451241828d17cd156dada0ca0244633f724b"}]}'
2026-01-30 04:35:32.752 DEBUG [src.steps.store] messages length is 1
2026-01-30 04:35:32.752 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-01-30 04:35:32.752 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42208/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:35:32.761 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"e7cbbd0e5e9a210917ac","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xe34952725c18a8343d4111548f00451241828d17cd156dada0ca0244633f724b"}]}'
2026-01-30 04:35:32.761 DEBUG [src.steps.store] messages length is 1
2026-01-30 04:35:33.282 DEBUG [src.steps.store] Relaying message
2026-01-30 04:35:33.282 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37223/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-01-30 04:35:33.288 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-30 04:35:33.289 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-01-30 04:35:33.682 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42208/health" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:35:33.785 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42208/health" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:35:33.789 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-01-30 04:35:33.789 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-30 04:35:33.790 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42208/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:35:33.792 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.146.32/tcp/42209/p2p/16Uiu2HAmRBk8dUwTjxu1UUq1rrUeTqrgSVwh3JTNxU6EqEwxGXJa","/ip4/172.18.146.32/tcp/42210/ws/p2p/16Uiu2HAmRBk8dUwTjxu1UUq1rrUeTqrgSVwh3JTNxU6EqEwxGXJa"],"enrUri":"enr:-L24QFlDa-bqDU2uxmU-FcHa4oNB7hJLOS9saipTfC6t9yi8RcNF_-YVi5IldrF2oTssUIxZpmSumFCnM33yPz6UR4oCgmlkgnY0gmlwhKwSkiCKbXVsdGlhZGRyc5YACASsEpIgBqThAAoErBKSIAak4t0DgnJzhQADAQAAiXNlY3AyNTZrMaEDui0r6hRoP_mHYHV0KDi1IGXcP1W7K6fhF2VgHlbS4PuDdGNwgqThg3VkcIKk44V3YWt1MgA"}'
2026-01-30 04:35:33.792 INFO [src.node.waku_node] REST service is ready !!
2026-01-30 04:35:33.793 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37223/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:35:33.795 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xe34952725c18a8343d4111548f00451241828d17cd156dada0ca0244633f724b"},{"messageHash":"0xd286430527ba477359df61c6bbf26b26c6c3ca56670908d0980b23754b4c05a2"}]}'
2026-01-30 04:35:33.796 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42208/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:35:33.832 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"75796245ca4ab00f12c3","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xe34952725c18a8343d4111548f00451241828d17cd156dada0ca0244633f724b"},{"messageHash":"0xd286430527ba477359df61c6bbf26b26c6c3ca56670908d0980b23754b4c05a2"}]}'
2026-01-30 04:35:33.837 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-01-30 04:35:33.840 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-01-30 04:35:33.840 DEBUG [src.node.waku_node] Stopping container with id ad996db5fea3
2026-01-30 04:35:34.402 DEBUG [src.node.waku_node] Container stopped.
2026-01-30 04:35:34.402 DEBUG [src.node.waku_node] Stopping container with id 06c3d3c9c27a
2026-01-30 04:35:34.950 DEBUG [src.node.waku_node] Container stopped.
2026-01-30 04:35:34.952 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-01-30 04:35:34.969 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-01-30 04:35:35.045 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
