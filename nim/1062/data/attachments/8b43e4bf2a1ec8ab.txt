2026-01-30 04:39:57.253 DEBUG [tests.conftest] Running fixture setup: test_id
2026-01-30 04:39:57.253 DEBUG [tests.conftest] Running test: test_subscribe_and_publish_on_another_shard with id: 2026-01-30_04-39-57__3d512a27-76b8-4849-b984-e152666a2932
2026-01-30 04:39:57.253 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-01-30 04:39:57.253 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-01-30 04:39:57.254 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-01-30 04:39:57.260 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-30 04:39:57.260 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-01-30_04-39-57__3d512a27-76b8-4849-b984-e152666a2932__wakuorg_nwaku:latest.log
2026-01-30 04:39:57.261 DEBUG [src.node.waku_node] Starting Node...
2026-01-30 04:39:57.261 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-30 04:39:57.262 DEBUG [src.node.docker_mananger] Network waku already exists
2026-01-30 04:39:57.262 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.39.245
2026-01-30 04:39:57.262 DEBUG [src.node.docker_mananger] Generated ports ['43586', '43587', '43588', '43589', '43590']
2026-01-30 04:39:57.262 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-01-30 04:39:57.263 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-01-30 04:39:57.263 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-30 04:39:57.263 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-30 04:39:57.263 DEBUG [src.node.waku_node] Using volumes []
2026-01-30 04:39:57.263 DEBUG [src.node.docker_mananger] docker run -i -t -p 43586:43586 -p 43587:43587 -p 43588:43588 -p 43589:43589 -p 43590:43590 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=43588 --rest-port=43586 --tcp-port=43587 --discv5-udp-port=43589 --rest-address=0.0.0.0 --nat=extip:172.18.39.245 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=f4dfe5baa34d18cd7abdae1cc3a84936966acd4e33ce1cb8abccdfe22fc8adf7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=43590 --metrics-logging=true --relay=true --filter=true
2026-01-30 04:39:57.442 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.39.245 waku 58e324c66862210e9251649303c923c5b0f0945fbc62da8e279bd9f174bd88cd
2026-01-30 04:39:57.472 DEBUG [src.node.docker_mananger] Container started with ID 58e324c66862. Setting up logs at ./log/docker/node1_2026-01-30_04-39-57__3d512a27-76b8-4849-b984-e152666a2932__wakuorg_nwaku:latest.log
2026-01-30 04:39:57.472 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 43586
2026-01-30 04:39:57.472 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-30 04:39:57.526 ERROR [src.node.docker_mananger] Max retries reached for container 7af2a8d4eb91. Exiting log stream.
2026-01-30 04:39:58.036 ERROR [src.node.docker_mananger] Max retries reached for container 24b30f759a7e. Exiting log stream.
2026-01-30 04:39:58.473 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43586/health" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:39:58.476 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-01-30 04:39:58.476 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-30 04:39:58.476 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43586/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:39:58.478 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.39.245/tcp/43587/p2p/16Uiu2HAmDGzkHyvDBYJVncRKAwHfP8kK39BUNa6kt27zpJ6tdTeY","/ip4/172.18.39.245/tcp/43588/ws/p2p/16Uiu2HAmDGzkHyvDBYJVncRKAwHfP8kK39BUNa6kt27zpJ6tdTeY"],"enrUri":"enr:-L24QMOWl4zJQ2b0DUjU3u4OAK2SLZBkpoepERHIyPXnjLTfdign88_L-2eKYlZdDegMuouMQrm__kuJW9A3q6S_RUICgmlkgnY0gmlwhKwSJ_WKbXVsdGlhZGRyc5YACASsEif1BqpDAAoErBIn9QaqRN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDCTlbinnXkipZgqvtqVAzVh8hKYFOkPR9Brn45L5pytmDdGNwgqpDg3VkcIKqRYV3YWt1MgU"}'
2026-01-30 04:39:58.478 INFO [src.node.waku_node] REST service is ready !!
2026-01-30 04:39:58.485 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-30 04:39:58.485 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-01-30_04-39-57__3d512a27-76b8-4849-b984-e152666a2932__wakuorg_nwaku:latest.log
2026-01-30 04:39:58.485 DEBUG [src.node.waku_node] Starting Node...
2026-01-30 04:39:58.485 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-30 04:39:58.486 DEBUG [src.node.docker_mananger] Network waku already exists
2026-01-30 04:39:58.486 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.227.12
2026-01-30 04:39:58.487 DEBUG [src.node.docker_mananger] Generated ports ['40809', '40810', '40811', '40812', '40813']
2026-01-30 04:39:58.487 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-01-30 04:39:58.487 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-01-30 04:39:58.487 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-30 04:39:58.487 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-30 04:39:58.487 DEBUG [src.node.waku_node] Using volumes []
2026-01-30 04:39:58.487 DEBUG [src.node.docker_mananger] docker run -i -t -p 40809:40809 -p 40810:40810 -p 40811:40811 -p 40812:40812 -p 40813:40813 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=40811 --rest-port=40809 --tcp-port=40810 --discv5-udp-port=40812 --rest-address=0.0.0.0 --nat=extip:172.18.227.12 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=d9827afb65dbaa66f81dacbc1c8ddbbb0ad9d4afda91e80ca8ed47b04fe64af1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=40813 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QMOWl4zJQ2b0DUjU3u4OAK2SLZBkpoepERHIyPXnjLTfdign88_L-2eKYlZdDegMuouMQrm__kuJW9A3q6S_RUICgmlkgnY0gmlwhKwSJ_WKbXVsdGlhZGRyc5YACASsEif1BqpDAAoErBIn9QaqRN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDCTlbinnXkipZgqvtqVAzVh8hKYFOkPR9Brn45L5pytmDdGNwgqpDg3VkcIKqRYV3YWt1MgU
2026-01-30 04:39:58.671 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.227.12 waku e7a6357585e3a9fa52dd0b89a2cba85d6bc86aeb20591372a80a42708c36a887
2026-01-30 04:39:58.701 DEBUG [src.node.docker_mananger] Container started with ID e7a6357585e3. Setting up logs at ./log/docker/node2_2026-01-30_04-39-57__3d512a27-76b8-4849-b984-e152666a2932__wakuorg_nwaku:latest.log
2026-01-30 04:39:58.701 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 40809
2026-01-30 04:39:58.701 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-30 04:39:59.702 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40809/health" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:39:59.719 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-01-30 04:39:59.719 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-30 04:39:59.719 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40809/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:39:59.723 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.227.12/tcp/40810/p2p/16Uiu2HAkzJu9mYAxdaiSmcuthAcjynrqUUpKGuGqhCA2aXo9F77k","/ip4/172.18.227.12/tcp/40811/ws/p2p/16Uiu2HAkzJu9mYAxdaiSmcuthAcjynrqUUpKGuGqhCA2aXo9F77k"],"enrUri":"enr:-L24QPDAHQ2JK7Eo1d3yBLhOOYUxM87EgkXx66s3MCACvtwZGohBjgiFNXiK1J1YHwqtOsvBW0dr-Am_8o4KM1MDYgsCgmlkgnY0gmlwhKwS4wyKbXVsdGlhZGRyc5YACASsEuMMBp9qAAoErBLjDAafa90DgnJzhQACAQAAiXNlY3AyNTZrMaECSI5DOHWrCzQW4ntkzM1W3cR-p_7kNJb1AyIO_vlgls-DdGNwgp9qg3VkcIKfbIV3YWt1MgE"}'
2026-01-30 04:39:59.724 INFO [src.node.waku_node] REST service is ready !!
2026-01-30 04:39:59.724 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40809/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.39.245/tcp/43587/p2p/16Uiu2HAmDGzkHyvDBYJVncRKAwHfP8kK39BUNa6kt27zpJ6tdTeY"]'
2026-01-30 04:39:59.727 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-30 04:39:59.727 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43586/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
2026-01-30 04:39:59.730 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-30 04:39:59.731 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40809/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
2026-01-30 04:39:59.736 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-30 04:39:59.737 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43586/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-01-30 04:39:59.741 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-30 04:39:59.741 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-01-30 04:39:59.842 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-01-30 04:39:59.842 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43586/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:39:59.844 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1769747999737309728,"ephemeral":false,"proof":""}]'
2026-01-30 04:39:59.846 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-01-30 04:39:59.846 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40809/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:39:59.848 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1769747999737309728,"ephemeral":false,"proof":""}]'
2026-01-30 04:39:59.850 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43586/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-01-30 04:39:59.854 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-30 04:39:59.855 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-01-30 04:39:59.955 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-01-30 04:39:59.955 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43586/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:39:59.958 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1769747999850071893,"ephemeral":false,"proof":""}]'
2026-01-30 04:39:59.959 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-01-30 04:39:59.959 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40809/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:39:59.961 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1769747999850071893,"ephemeral":false,"proof":""}]'
2026-01-30 04:39:59.964 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-01-30 04:39:59.965 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-01-30 04:39:59.965 DEBUG [src.node.waku_node] Stopping container with id 58e324c66862
2026-01-30 04:40:00.497 DEBUG [src.node.waku_node] Container stopped.
2026-01-30 04:40:00.498 DEBUG [src.node.waku_node] Stopping container with id e7a6357585e3
2026-01-30 04:40:01.035 DEBUG [src.node.waku_node] Container stopped.
2026-01-30 04:40:01.037 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-01-30 04:40:01.042 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-01-30 04:40:01.048 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
