2026-01-30 04:38:42.300 DEBUG [tests.conftest] Running fixture setup: test_id
2026-01-30 04:38:42.301 DEBUG [tests.conftest] Running test: test_store_with_wrongPeerAddr with id: 2026-01-30_04-38-42__b5149f04-e214-4cd1-93fe-9a9f574d4e9b
2026-01-30 04:38:42.301 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-01-30 04:38:42.301 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-01-30 04:38:42.301 DEBUG [src.steps.store] Running fixture setup: node_setup
2026-01-30 04:38:42.308 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-30 04:38:42.308 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-01-30_04-38-42__b5149f04-e214-4cd1-93fe-9a9f574d4e9b__wakuorg_nwaku:latest.log
2026-01-30 04:38:42.308 DEBUG [src.node.waku_node] Starting Node...
2026-01-30 04:38:42.308 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-30 04:38:42.310 DEBUG [src.node.docker_mananger] Network waku already exists
2026-01-30 04:38:42.310 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.6.57
2026-01-30 04:38:42.310 DEBUG [src.node.docker_mananger] Generated ports ['55761', '55762', '55763', '55764', '55765']
2026-01-30 04:38:42.310 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-30 04:38:42.310 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-30 04:38:42.310 DEBUG [src.node.waku_node] Using volumes []
2026-01-30 04:38:42.310 DEBUG [src.node.docker_mananger] docker run -i -t -p 55761:55761 -p 55762:55762 -p 55763:55763 -p 55764:55764 -p 55765:55765 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55763 --rest-port=55761 --tcp-port=55762 --discv5-udp-port=55764 --rest-address=0.0.0.0 --nat=extip:172.18.6.57 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=03eef4a1accd40ecbf3956f7fe329e75fbfebbdc77cebfeced69b6dadd7dfefd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55765 --metrics-logging=true --store=true --relay=true
2026-01-30 04:38:42.499 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.6.57 waku 954e5b27b39078367d5877f6da67da65ab2eab67b3a9f8ab6c447af69cce42bf
2026-01-30 04:38:42.529 DEBUG [src.node.docker_mananger] Container started with ID 954e5b27b390. Setting up logs at ./log/docker/publishing_node1_2026-01-30_04-38-42__b5149f04-e214-4cd1-93fe-9a9f574d4e9b__wakuorg_nwaku:latest.log
2026-01-30 04:38:42.530 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 55761
2026-01-30 04:38:42.531 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-30 04:38:42.550 ERROR [src.node.docker_mananger] Max retries reached for container 68072f7ef60d. Exiting log stream.
2026-01-30 04:38:43.092 ERROR [src.node.docker_mananger] Max retries reached for container f664d2ed605a. Exiting log stream.
2026-01-30 04:38:43.531 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55761/health" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:38:43.534 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-01-30 04:38:43.534 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-30 04:38:43.535 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55761/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:38:43.537 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.6.57/tcp/55762/p2p/16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPAu","/ip4/172.18.6.57/tcp/55763/ws/p2p/16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPAu"],"enrUri":"enr:-L24QHXEfC6HOUS23UYno-IWmfryM5cF9ZO_PNPDWtOxTurJdaNJf_VE4Wr7EuS1aW-i6H-mGwfttiQ-QhQyLLQ0xmsCgmlkgnY0gmlwhKwSBjmKbXVsdGlhZGRyc5YACASsEgY5BtnSAAoErBIGOQbZ090DgnJzhQADAQAAiXNlY3AyNTZrMaEDVbRij7vYfqfNEVwq-nmLDAFpWm-Up5ooPgREnm3KOl6DdGNwgtnSg3VkcILZ1IV3YWt1MgM"}'
2026-01-30 04:38:43.537 INFO [src.node.waku_node] REST service is ready !!
2026-01-30 04:38:43.543 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-30 04:38:43.543 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-01-30_04-38-42__b5149f04-e214-4cd1-93fe-9a9f574d4e9b__wakuorg_nwaku:latest.log
2026-01-30 04:38:43.544 DEBUG [src.node.waku_node] Starting Node...
2026-01-30 04:38:43.544 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-30 04:38:43.545 DEBUG [src.node.docker_mananger] Network waku already exists
2026-01-30 04:38:43.545 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.23.9
2026-01-30 04:38:43.545 DEBUG [src.node.docker_mananger] Generated ports ['57883', '57884', '57885', '57886', '57887']
2026-01-30 04:38:43.545 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-30 04:38:43.545 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-30 04:38:43.546 DEBUG [src.node.waku_node] Using volumes []
2026-01-30 04:38:43.546 DEBUG [src.node.docker_mananger] docker run -i -t -p 57883:57883 -p 57884:57884 -p 57885:57885 -p 57886:57886 -p 57887:57887 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57885 --rest-port=57883 --tcp-port=57884 --discv5-udp-port=57886 --rest-address=0.0.0.0 --nat=extip:172.18.23.9 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=eaa854707acaedbcaa75ebe7af84bb765cd1d8d1f44b0c6e2bed1d8eb6fa9c0d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57887 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QHXEfC6HOUS23UYno-IWmfryM5cF9ZO_PNPDWtOxTurJdaNJf_VE4Wr7EuS1aW-i6H-mGwfttiQ-QhQyLLQ0xmsCgmlkgnY0gmlwhKwSBjmKbXVsdGlhZGRyc5YACASsEgY5BtnSAAoErBIGOQbZ090DgnJzhQADAQAAiXNlY3AyNTZrMaEDVbRij7vYfqfNEVwq-nmLDAFpWm-Up5ooPgREnm3KOl6DdGNwgtnSg3VkcILZ1IV3YWt1MgM --storenode=/ip4/172.18.6.57/tcp/55762/p2p/16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPAu --store=true --relay=true
2026-01-30 04:38:43.736 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.23.9 waku 81c0a600f5a6f22f65e5db25f1b9fa51559ce7da6570933d7aff66b4478bc1ec
2026-01-30 04:38:43.769 DEBUG [src.node.docker_mananger] Container started with ID 81c0a600f5a6. Setting up logs at ./log/docker/store_node1_2026-01-30_04-38-42__b5149f04-e214-4cd1-93fe-9a9f574d4e9b__wakuorg_nwaku:latest.log
2026-01-30 04:38:43.769 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 57883
2026-01-30 04:38:43.769 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-30 04:38:44.770 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57883/health" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:38:44.774 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-01-30 04:38:44.774 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-30 04:38:44.774 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57883/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:38:44.776 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.23.9/tcp/57884/p2p/16Uiu2HAmTyaLdTW5sjHqZxXrHxGLQ58duuZu6hYVzf1xkXwiirFx","/ip4/172.18.23.9/tcp/57885/ws/p2p/16Uiu2HAmTyaLdTW5sjHqZxXrHxGLQ58duuZu6hYVzf1xkXwiirFx"],"enrUri":"enr:-L24QHY49obIekxeyQ8aFwVqAzYFhdN7bod372AzRHWygWWxUvVxRfzxC7F7ytR_7vtbHWj6DOal-wg08_q01TKe5TUCgmlkgnY0gmlwhKwSFwmKbXVsdGlhZGRyc5YACASsEhcJBuIcAAoErBIXCQbiHd0DgnJzhQADAQAAiXNlY3AyNTZrMaED46Iwg2X0YARBVWXj1Ie8sSQPj89AgKohUE7QN_AQNP-DdGNwguIcg3VkcILiHoV3YWt1MgM"}'
2026-01-30 04:38:44.776 INFO [src.node.waku_node] REST service is ready !!
2026-01-30 04:38:44.777 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57883/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.6.57/tcp/55762/p2p/16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPAu"]'
2026-01-30 04:38:44.779 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-30 04:38:44.779 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55761/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-01-30 04:38:44.782 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-30 04:38:44.782 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57883/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-01-30 04:38:44.784 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-30 04:38:44.785 DEBUG [src.steps.store] Relaying message
2026-01-30 04:38:44.786 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55761/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-01-30 04:38:44.790 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-30 04:38:44.791 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-01-30 04:38:44.991 DEBUG [tests.store.test_api_flags] Running test with wrong_peer_addr: ip4/172.18.6.57/tcp/55762/p2p/16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPAu
2026-01-30 04:38:44.992 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-01-30 04:38:44.992 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57883/store/v3/messages?peerAddr=ip4%2F172.18.6.57%2Ftcp%2F55762%2Fp2p%2F16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPAu&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:38:44.995 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:57883/store/v3/messages?peerAddr=ip4%2F172.18.6.57%2Ftcp%2F55762%2Fp2p%2F16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPAu&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0. Response content: b'Failed parsing remote peer info: MultiAddress.init [multiaddress: Invalid MultiAddress, must start with `/`]'
2026-01-30 04:38:44.996 DEBUG [tests.store.test_api_flags]  Response with wrong peer address is Error: 400 Client Error: Bad Request for url: http://127.0.0.1:57883/store/v3/messages?peerAddr=ip4%2F172.18.6.57%2Ftcp%2F55762%2Fp2p%2F16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPAu&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0 with response: b'Failed parsing remote peer info: MultiAddress.init [multiaddress: Invalid MultiAddress, must start with `/`]'
2026-01-30 04:38:44.996 DEBUG [tests.store.test_api_flags] Running test with wrong_peer_addr /ip4/172.18.6.57/tcp/55762/p2p/16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPA
2026-01-30 04:38:44.997 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-01-30 04:38:44.997 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57883/store/v3/messages?peerAddr=%2Fip4%2F172.18.6.57%2Ftcp%2F55762%2Fp2p%2F16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPA&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:38:44.999 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:57883/store/v3/messages?peerAddr=%2Fip4%2F172.18.6.57%2Ftcp%2F55762%2Fp2p%2F16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPA&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0. Response content: b'Failed parsing remote peer info: MultiAddress.init [multiaddress: Error encoding `p2p/16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPA`]'
2026-01-30 04:38:45.000 DEBUG [tests.store.test_api_flags]  Response with wrong peer id is Error: 400 Client Error: Bad Request for url: http://127.0.0.1:57883/store/v3/messages?peerAddr=%2Fip4%2F172.18.6.57%2Ftcp%2F55762%2Fp2p%2F16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPA&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0 with response: b'Failed parsing remote peer info: MultiAddress.init [multiaddress: Error encoding `p2p/16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPA`]'
2026-01-30 04:38:45.000 DEBUG [tests.store.test_api_flags] logger is /ip4/172.18.6.57/55762/p2p/16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPAu
2026-01-30 04:38:45.001 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-01-30 04:38:45.001 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57883/store/v3/messages?peerAddr=%2Fip4%2F172.18.6.57%2F55762%2Fp2p%2F16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPAu&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2026-01-30 04:38:45.004 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:57883/store/v3/messages?peerAddr=%2Fip4%2F172.18.6.57%2F55762%2Fp2p%2F16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPAu&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0. Response content: b"Failed parsing remote peer info: MultiAddress.init [multiaddress: Unsupported protocol '55762']"
2026-01-30 04:38:45.005 DEBUG [tests.store.test_api_flags]  Response with wrong peer address is Error: 400 Client Error: Bad Request for url: http://127.0.0.1:57883/store/v3/messages?peerAddr=%2Fip4%2F172.18.6.57%2F55762%2Fp2p%2F16Uiu2HAmJRYYBGSjh7m2mkYD2WZirDSkkKeYsZGreCq8EVhrcPAu&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0 with response: b"Failed parsing remote peer info: MultiAddress.init [multiaddress: Unsupported protocol '55762']"
2026-01-30 04:38:45.006 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-01-30 04:38:45.008 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-01-30 04:38:45.008 DEBUG [src.node.waku_node] Stopping container with id 954e5b27b390
2026-01-30 04:38:45.555 DEBUG [src.node.waku_node] Container stopped.
2026-01-30 04:38:45.555 DEBUG [src.node.waku_node] Stopping container with id 81c0a600f5a6
2026-01-30 04:38:46.047 DEBUG [src.node.waku_node] Container stopped.
2026-01-30 04:38:46.049 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-01-30 04:38:46.059 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-01-30 04:38:46.064 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
