2026-02-13 04:44:45.865 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-13 04:44:45.867 DEBUG [tests.conftest] Running test: test_cant_publish_on_not_subscribed_shard with id: 2026-02-13_04-44-45__8bcc38c8-c7ba-44cd-bc4a-8540efc369dd
2026-02-13 04:44:45.868 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-13 04:44:45.868 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-13 04:44:45.869 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-13 04:44:45.880 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-13 04:44:45.881 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-13_04-44-45__8bcc38c8-c7ba-44cd-bc4a-8540efc369dd__wakuorg_nwaku:latest.log
2026-02-13 04:44:45.881 DEBUG [src.node.waku_node] Starting Node...
2026-02-13 04:44:45.881 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-13 04:44:45.882 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-13 04:44:45.882 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.69.198
2026-02-13 04:44:45.883 DEBUG [src.node.docker_mananger] Generated ports ['9194', '9195', '9196', '9197', '9198']
2026-02-13 04:44:45.883 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-13 04:44:45.883 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-13 04:44:45.883 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-13 04:44:45.883 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-13 04:44:45.883 DEBUG [src.node.waku_node] Using volumes []
2026-02-13 04:44:45.883 DEBUG [src.node.docker_mananger] docker run -i -t -p 9194:9194 -p 9195:9195 -p 9196:9196 -p 9197:9197 -p 9198:9198 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=9196 --rest-port=9194 --tcp-port=9195 --discv5-udp-port=9197 --rest-address=0.0.0.0 --nat=extip:172.18.69.198 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=e2dc0ebf9fd3da59bf54e16f4a1086dc746e83fd70d44edf0f4e8a02e5ee6b61 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=9198 --metrics-logging=true --relay=true --filter=true
2026-02-13 04:44:46.093 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.69.198 waku d21fae2d471b0f50cc97502f8d484d8baf7e0150efd97919f818671ebc896650
2026-02-13 04:44:46.109 ERROR [src.node.docker_mananger] Max retries reached for container c0f263756b47. Exiting log stream.
2026-02-13 04:44:46.142 DEBUG [src.node.docker_mananger] Container started with ID d21fae2d471b. Setting up logs at ./log/docker/node1_2026-02-13_04-44-45__8bcc38c8-c7ba-44cd-bc4a-8540efc369dd__wakuorg_nwaku:latest.log
2026-02-13 04:44:46.142 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 9194
2026-02-13 04:44:46.143 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-13 04:44:46.354 ERROR [src.node.docker_mananger] Max retries reached for container 34fc1e35882c. Exiting log stream.
2026-02-13 04:44:46.689 ERROR [src.node.docker_mananger] Max retries reached for container 76d45c694059. Exiting log stream.
2026-02-13 04:44:47.143 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9194/health" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:44:47.147 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-13 04:44:47.147 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-13 04:44:47.147 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9194/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:44:47.149 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.69.198/tcp/9195/p2p/16Uiu2HAmMknXGg6F6Qd8RKf3Zy1r65xWart8fp1pqJACk5r2Hru6","/ip4/172.18.69.198/tcp/9196/ws/p2p/16Uiu2HAmMknXGg6F6Qd8RKf3Zy1r65xWart8fp1pqJACk5r2Hru6"],"enrUri":"enr:-L24QKiAphVa5QG5gzaZyUrU9pnkR8qRy5F4zRoEUY9NfYhkKwhavnJhefzeT_QWaj1mxRJ20pPlRKg-5_Jdn11FFAoCgmlkgnY0gmlwhKwSRcaKbXVsdGlhZGRyc5YACASsEkXGBiPrAAoErBJFxgYj7N0DgnJzhQACAQAAiXNlY3AyNTZrMaEDhzVLF7NcO5azAfUuAm_G7o7GxRqhzZE9bg0lIYLdqGGDdGNwgiPrg3VkcIIj7YV3YWt1MgU"}'
2026-02-13 04:44:47.150 INFO [src.node.waku_node] REST service is ready !!
2026-02-13 04:44:47.157 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-13 04:44:47.157 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-13_04-44-45__8bcc38c8-c7ba-44cd-bc4a-8540efc369dd__wakuorg_nwaku:latest.log
2026-02-13 04:44:47.157 DEBUG [src.node.waku_node] Starting Node...
2026-02-13 04:44:47.157 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-13 04:44:47.159 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-13 04:44:47.159 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.74.78
2026-02-13 04:44:47.159 DEBUG [src.node.docker_mananger] Generated ports ['45414', '45415', '45416', '45417', '45418']
2026-02-13 04:44:47.159 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-13 04:44:47.159 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-13 04:44:47.159 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-13 04:44:47.160 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-13 04:44:47.160 DEBUG [src.node.waku_node] Using volumes []
2026-02-13 04:44:47.160 DEBUG [src.node.docker_mananger] docker run -i -t -p 45414:45414 -p 45415:45415 -p 45416:45416 -p 45417:45417 -p 45418:45418 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45416 --rest-port=45414 --tcp-port=45415 --discv5-udp-port=45417 --rest-address=0.0.0.0 --nat=extip:172.18.74.78 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=abbfbf544bc8c6bdaee45cac1d8f28fb421299c4effffbdd38b7db5d18aeeded --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45418 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QKiAphVa5QG5gzaZyUrU9pnkR8qRy5F4zRoEUY9NfYhkKwhavnJhefzeT_QWaj1mxRJ20pPlRKg-5_Jdn11FFAoCgmlkgnY0gmlwhKwSRcaKbXVsdGlhZGRyc5YACASsEkXGBiPrAAoErBJFxgYj7N0DgnJzhQACAQAAiXNlY3AyNTZrMaEDhzVLF7NcO5azAfUuAm_G7o7GxRqhzZE9bg0lIYLdqGGDdGNwgiPrg3VkcIIj7YV3YWt1MgU
2026-02-13 04:44:47.370 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.74.78 waku c8d7747e4dd26cccd89b59dcafb8efa4f0ab224655ba3d96e7e81e4416ddb931
2026-02-13 04:44:47.421 DEBUG [src.node.docker_mananger] Container started with ID c8d7747e4dd2. Setting up logs at ./log/docker/node2_2026-02-13_04-44-45__8bcc38c8-c7ba-44cd-bc4a-8540efc369dd__wakuorg_nwaku:latest.log
2026-02-13 04:44:47.421 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 45414
2026-02-13 04:44:47.421 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-13 04:44:48.422 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45414/health" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:44:48.426 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-13 04:44:48.426 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-13 04:44:48.426 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45414/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:44:48.428 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.74.78/tcp/45415/p2p/16Uiu2HAm2DUHiETMf2BiWQpg88KuAHDSUfdyeUJneQHEVt66iCuM","/ip4/172.18.74.78/tcp/45416/ws/p2p/16Uiu2HAm2DUHiETMf2BiWQpg88KuAHDSUfdyeUJneQHEVt66iCuM"],"enrUri":"enr:-L24QHcwCFj24cno7nbcBYbS2YH_hbURuxuDe1-QdOV4hLORMVbbaO6_ShCTPwYGCWJ-LBCf-luTTbbcdxetQIxBNewCgmlkgnY0gmlwhKwSSk6KbXVsdGlhZGRyc5YACASsEkpOBrFnAAoErBJKTgaxaN0DgnJzhQACAQAAiXNlY3AyNTZrMaECZOGeoRdNBlP0lhK0AXE9lKzQCI8cI14w1QHE5i3zYACDdGNwgrFng3VkcIKxaYV3YWt1MgE"}'
2026-02-13 04:44:48.429 INFO [src.node.waku_node] REST service is ready !!
2026-02-13 04:44:48.429 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45414/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.69.198/tcp/9195/p2p/16Uiu2HAmMknXGg6F6Qd8RKf3Zy1r65xWart8fp1pqJACk5r2Hru6"]'
2026-02-13 04:44:48.432 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:44:48.432 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9194/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2026-02-13 04:44:48.435 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:44:48.435 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45414/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2026-02-13 04:44:48.437 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:44:48.438 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9194/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-13 04:44:48.440 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:9194/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1. Response content: b'Failed to publish: Node not subscribed to topic: /waku/2/rs/2/1'
2026-02-13 04:44:48.443 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-13 04:44:48.444 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-13 04:44:48.444 DEBUG [src.node.waku_node] Stopping container with id d21fae2d471b
2026-02-13 04:44:48.720 DEBUG [src.node.waku_node] Container stopped.
2026-02-13 04:44:48.720 DEBUG [src.node.waku_node] Stopping container with id c8d7747e4dd2
2026-02-13 04:44:48.987 DEBUG [src.node.waku_node] Container stopped.
2026-02-13 04:44:48.990 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-13 04:44:48.999 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-13 04:44:49.006 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
