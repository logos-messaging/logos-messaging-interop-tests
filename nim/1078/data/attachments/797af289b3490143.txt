2026-02-13 04:45:10.626 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-13 04:45:10.627 DEBUG [tests.conftest] Running test: test_message_with_ephemeral_false with id: 2026-02-13_04-45-10__9539b6d7-f8f2-4e1e-a540-45d1859cd973
2026-02-13 04:45:10.628 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-13 04:45:10.628 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-02-13 04:45:10.629 DEBUG [src.steps.store] Running fixture setup: node_setup
2026-02-13 04:45:10.639 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-13 04:45:10.640 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-02-13_04-45-10__9539b6d7-f8f2-4e1e-a540-45d1859cd973__wakuorg_nwaku:latest.log
2026-02-13 04:45:10.640 DEBUG [src.node.waku_node] Starting Node...
2026-02-13 04:45:10.640 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-13 04:45:10.642 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-13 04:45:10.642 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.148.96
2026-02-13 04:45:10.643 DEBUG [src.node.docker_mananger] Generated ports ['30320', '30321', '30322', '30323', '30324']
2026-02-13 04:45:10.643 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-13 04:45:10.643 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-13 04:45:10.643 DEBUG [src.node.waku_node] Using volumes []
2026-02-13 04:45:10.643 DEBUG [src.node.docker_mananger] docker run -i -t -p 30320:30320 -p 30321:30321 -p 30322:30322 -p 30323:30323 -p 30324:30324 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30322 --rest-port=30320 --tcp-port=30321 --discv5-udp-port=30323 --rest-address=0.0.0.0 --nat=extip:172.18.148.96 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ffc8aff0a93acd78fceecde1a9cc3d944b5d09728f1d7a5e2b1acfe4f58ed6cf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30324 --metrics-logging=true --store=true --relay=true
2026-02-13 04:45:10.871 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.148.96 waku 6ef4b8a9fcfc7e4df931592758c76e3c69f315b2c90ab9e28986de986a70d5a3
2026-02-13 04:45:10.925 DEBUG [src.node.docker_mananger] Container started with ID 6ef4b8a9fcfc. Setting up logs at ./log/docker/publishing_node1_2026-02-13_04-45-10__9539b6d7-f8f2-4e1e-a540-45d1859cd973__wakuorg_nwaku:latest.log
2026-02-13 04:45:10.926 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 30320
2026-02-13 04:45:10.926 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-13 04:45:11.177 ERROR [src.node.docker_mananger] Max retries reached for container e9277c1052cc. Exiting log stream.
2026-02-13 04:45:11.465 ERROR [src.node.docker_mananger] Max retries reached for container 60eccab38b1d. Exiting log stream.
2026-02-13 04:45:11.927 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30320/health" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:45:11.930 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-13 04:45:11.930 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-13 04:45:11.930 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30320/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:45:11.933 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.148.96/tcp/30321/p2p/16Uiu2HAm75n9WtnyoHx3EfSibePhTMoZMTJFXWPUmGnGQqE81pGj","/ip4/172.18.148.96/tcp/30322/ws/p2p/16Uiu2HAm75n9WtnyoHx3EfSibePhTMoZMTJFXWPUmGnGQqE81pGj"],"enrUri":"enr:-L24QP7CzgkvlVXix10FdkVhAIvEsOU7dMOT0lwbxsiwIaXoZXlo1fGZbUoVzcVnYFIDMOrHgoEXHXDEfmD-7tS8-18CgmlkgnY0gmlwhKwSlGCKbXVsdGlhZGRyc5YACASsEpRgBnZxAAoErBKUYAZ2ct0DgnJzhQADAQAAiXNlY3AyNTZrMaECrTOZx2zMLOCQtibQYZ7GWC7ZMRo6J4udanQA-RcwbDyDdGNwgnZxg3VkcIJ2c4V3YWt1MgM"}'
2026-02-13 04:45:11.933 INFO [src.node.waku_node] REST service is ready !!
2026-02-13 04:45:11.941 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-13 04:45:11.941 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-02-13_04-45-10__9539b6d7-f8f2-4e1e-a540-45d1859cd973__wakuorg_nwaku:latest.log
2026-02-13 04:45:11.941 DEBUG [src.node.waku_node] Starting Node...
2026-02-13 04:45:11.941 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-13 04:45:11.943 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-13 04:45:11.943 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.90.243
2026-02-13 04:45:11.943 DEBUG [src.node.docker_mananger] Generated ports ['55834', '55835', '55836', '55837', '55838']
2026-02-13 04:45:11.943 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-13 04:45:11.943 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-13 04:45:11.943 DEBUG [src.node.waku_node] Using volumes []
2026-02-13 04:45:11.944 DEBUG [src.node.docker_mananger] docker run -i -t -p 55834:55834 -p 55835:55835 -p 55836:55836 -p 55837:55837 -p 55838:55838 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55836 --rest-port=55834 --tcp-port=55835 --discv5-udp-port=55837 --rest-address=0.0.0.0 --nat=extip:172.18.90.243 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ccbcfdb8dfabdcaf1a32851e6ef8ee51e001caeafb9f7e6ebb5fd6ccb0503e45 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55838 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QP7CzgkvlVXix10FdkVhAIvEsOU7dMOT0lwbxsiwIaXoZXlo1fGZbUoVzcVnYFIDMOrHgoEXHXDEfmD-7tS8-18CgmlkgnY0gmlwhKwSlGCKbXVsdGlhZGRyc5YACASsEpRgBnZxAAoErBKUYAZ2ct0DgnJzhQADAQAAiXNlY3AyNTZrMaECrTOZx2zMLOCQtibQYZ7GWC7ZMRo6J4udanQA-RcwbDyDdGNwgnZxg3VkcIJ2c4V3YWt1MgM --storenode=/ip4/172.18.148.96/tcp/30321/p2p/16Uiu2HAm75n9WtnyoHx3EfSibePhTMoZMTJFXWPUmGnGQqE81pGj --store=true --relay=true
2026-02-13 04:45:12.166 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.90.243 waku ce26afde29d1c2eb10cd1915a569e75aa37afc96968eb9da3544233c959348ac
2026-02-13 04:45:12.214 DEBUG [src.node.docker_mananger] Container started with ID ce26afde29d1. Setting up logs at ./log/docker/store_node1_2026-02-13_04-45-10__9539b6d7-f8f2-4e1e-a540-45d1859cd973__wakuorg_nwaku:latest.log
2026-02-13 04:45:12.214 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 55834
2026-02-13 04:45:12.214 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-13 04:45:13.215 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55834/health" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:45:13.219 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-13 04:45:13.219 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-13 04:45:13.219 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55834/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:45:13.222 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.90.243/tcp/55835/p2p/16Uiu2HAmAS3vrVqQrJS5nWzMNagcAfj7S9Wunbm3e9idA9LtySXU","/ip4/172.18.90.243/tcp/55836/ws/p2p/16Uiu2HAmAS3vrVqQrJS5nWzMNagcAfj7S9Wunbm3e9idA9LtySXU"],"enrUri":"enr:-L24QJZTAaho-2XLGXkgW2gFMWltkbpSgvdSu5u0A3GZX7uULVYO_iQ7_iL1EOMRjoAE_czfcLTr-hPwoWOh3p27ej8CgmlkgnY0gmlwhKwSWvOKbXVsdGlhZGRyc5YACASsElrzBtobAAoErBJa8wbaHN0DgnJzhQADAQAAiXNlY3AyNTZrMaEC3vgfQDD4ffLuSIjZPSdHrkKkr0M8V9VPaLWJOn3HY7uDdGNwgtobg3VkcILaHYV3YWt1MgM"}'
2026-02-13 04:45:13.222 INFO [src.node.waku_node] REST service is ready !!
2026-02-13 04:45:13.222 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55834/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.148.96/tcp/30321/p2p/16Uiu2HAm75n9WtnyoHx3EfSibePhTMoZMTJFXWPUmGnGQqE81pGj"]'
2026-02-13 04:45:13.225 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:45:13.225 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30320/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-13 04:45:13.228 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:45:13.228 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55834/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-13 04:45:13.230 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:45:13.231 DEBUG [src.steps.store] Relaying message
2026-02-13 04:45:13.232 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30320/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
2026-02-13 04:45:13.237 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:45:13.237 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-13 04:45:13.437 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-13 04:45:13.438 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30320/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:45:13.441 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xd7d24c143d090e02c00f911e70f32af8a5c9847f8eeddf942612f6ae59b9b733"}]}'
2026-02-13 04:45:13.441 DEBUG [src.steps.store] messages length is 1
2026-02-13 04:45:13.442 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-13 04:45:13.442 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55834/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:45:13.445 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xd7d24c143d090e02c00f911e70f32af8a5c9847f8eeddf942612f6ae59b9b733"}]}'
2026-02-13 04:45:13.445 DEBUG [src.steps.store] messages length is 1
2026-02-13 04:45:13.447 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-13 04:45:13.448 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-13 04:45:13.449 DEBUG [src.node.waku_node] Stopping container with id 6ef4b8a9fcfc
2026-02-13 04:45:13.719 DEBUG [src.node.waku_node] Container stopped.
2026-02-13 04:45:13.720 DEBUG [src.node.waku_node] Stopping container with id ce26afde29d1
2026-02-13 04:45:14.005 DEBUG [src.node.waku_node] Container stopped.
2026-02-13 04:45:14.006 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-13 04:45:14.017 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-13 04:45:14.023 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
