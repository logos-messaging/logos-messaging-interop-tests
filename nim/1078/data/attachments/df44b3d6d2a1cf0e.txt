2026-02-13 04:39:05.702 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-13 04:39:05.702 DEBUG [tests.conftest] Running test: test_publish_with_invalid_payloads with id: 2026-02-13_04-39-05__2b8f0ade-2712-437c-ac89-5ccfd987bf6a
2026-02-13 04:39:05.703 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-13 04:39:05.703 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-13 04:39:05.703 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2026-02-13 04:39:05.710 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-13 04:39:05.711 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-13_04-39-05__2b8f0ade-2712-437c-ac89-5ccfd987bf6a__wakuorg_nwaku:latest.log
2026-02-13 04:39:05.712 DEBUG [src.node.waku_node] Starting Node...
2026-02-13 04:39:05.712 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-13 04:39:05.714 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-13 04:39:05.714 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.62.15
2026-02-13 04:39:05.714 DEBUG [src.node.docker_mananger] Generated ports ['1295', '1296', '1297', '1298', '1299']
2026-02-13 04:39:05.715 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-13 04:39:05.715 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-13 04:39:05.715 DEBUG [src.node.waku_node] Using volumes []
2026-02-13 04:39:05.715 DEBUG [src.node.docker_mananger] docker run -i -t -p 1295:1295 -p 1296:1296 -p 1297:1297 -p 1298:1298 -p 1299:1299 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=1297 --rest-port=1295 --tcp-port=1296 --discv5-udp-port=1298 --rest-address=0.0.0.0 --nat=extip:172.18.62.15 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f602cb603ebfcb04de2fcdc1a58b800e4dfccab424d34b04fdb980d9e047773c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=1299 --metrics-logging=true --relay=true
2026-02-13 04:39:05.878 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.62.15 waku c9de77369a702ad680cae8542a02b46a67ef3eb8431ca476c6f59d9a9cc6ad4f
2026-02-13 04:39:05.911 DEBUG [src.node.docker_mananger] Container started with ID c9de77369a70. Setting up logs at ./log/docker/node1_2026-02-13_04-39-05__2b8f0ade-2712-437c-ac89-5ccfd987bf6a__wakuorg_nwaku:latest.log
2026-02-13 04:39:05.912 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 1295
2026-02-13 04:39:05.913 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-13 04:39:06.032 ERROR [src.node.docker_mananger] Max retries reached for container 824d04cab404. Exiting log stream.
2026-02-13 04:39:06.243 ERROR [src.node.docker_mananger] Max retries reached for container a52a08708355. Exiting log stream.
2026-02-13 04:39:06.547 ERROR [src.node.docker_mananger] Max retries reached for container c5d1e434e128. Exiting log stream.
2026-02-13 04:39:06.913 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:1295/health" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:39:06.916 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-13 04:39:06.916 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-13 04:39:06.917 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:1295/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:39:06.919 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.62.15/tcp/1296/p2p/16Uiu2HAm3GsshVMdxNtSvgif9fgn6dKwZ4aVyxr6Wrm1CmJv1pr6","/ip4/172.18.62.15/tcp/1297/ws/p2p/16Uiu2HAm3GsshVMdxNtSvgif9fgn6dKwZ4aVyxr6Wrm1CmJv1pr6"],"enrUri":"enr:-L24QOdVw9kHgo5J4CaW_pOE6DupPd0e6El8VSyXoDqUlB0wJikh8nhNIvO3ozBX-BigCc0jx5R7n-0KK3LBPlVvojsCgmlkgnY0gmlwhKwSPg-KbXVsdGlhZGRyc5YACASsEj4PBgUQAAoErBI-DwYFEd0DgnJzhQADAQAAiXNlY3AyNTZrMaECdJy3vwXenngFFK671GfN0aYlGU6aMQreOysWjyHiUyuDdGNwggUQg3VkcIIFEoV3YWt1MgE"}'
2026-02-13 04:39:06.919 INFO [src.node.waku_node] REST service is ready !!
2026-02-13 04:39:06.925 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-13 04:39:06.925 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-13_04-39-05__2b8f0ade-2712-437c-ac89-5ccfd987bf6a__wakuorg_nwaku:latest.log
2026-02-13 04:39:06.925 DEBUG [src.node.waku_node] Starting Node...
2026-02-13 04:39:06.925 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-13 04:39:06.926 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-13 04:39:06.926 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.126.11
2026-02-13 04:39:06.926 DEBUG [src.node.docker_mananger] Generated ports ['50051', '50052', '50053', '50054', '50055']
2026-02-13 04:39:06.927 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-13 04:39:06.927 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-13 04:39:06.927 DEBUG [src.node.waku_node] Using volumes []
2026-02-13 04:39:06.927 DEBUG [src.node.docker_mananger] docker run -i -t -p 50051:50051 -p 50052:50052 -p 50053:50053 -p 50054:50054 -p 50055:50055 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=50053 --rest-port=50051 --tcp-port=50052 --discv5-udp-port=50054 --rest-address=0.0.0.0 --nat=extip:172.18.126.11 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2e3bdadabeb9063c0ccf589863fcd212afaac5cfcc1cc5de5d6fa15840e5bfec --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=50055 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QOdVw9kHgo5J4CaW_pOE6DupPd0e6El8VSyXoDqUlB0wJikh8nhNIvO3ozBX-BigCc0jx5R7n-0KK3LBPlVvojsCgmlkgnY0gmlwhKwSPg-KbXVsdGlhZGRyc5YACASsEj4PBgUQAAoErBI-DwYFEd0DgnJzhQADAQAAiXNlY3AyNTZrMaECdJy3vwXenngFFK671GfN0aYlGU6aMQreOysWjyHiUyuDdGNwggUQg3VkcIIFEoV3YWt1MgE
2026-02-13 04:39:07.085 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.126.11 waku 96295b37623adf7007b361cbc4de0cc3b0a2d7c6d18f7820077d64be659492b2
2026-02-13 04:39:07.121 DEBUG [src.node.docker_mananger] Container started with ID 96295b37623a. Setting up logs at ./log/docker/node2_2026-02-13_04-39-05__2b8f0ade-2712-437c-ac89-5ccfd987bf6a__wakuorg_nwaku:latest.log
2026-02-13 04:39:07.121 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 50051
2026-02-13 04:39:07.121 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-13 04:39:08.122 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50051/health" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:39:08.128 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-13 04:39:08.128 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-13 04:39:08.130 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50051/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:39:08.136 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.126.11/tcp/50052/p2p/16Uiu2HAm5vDjRBrexjZxRE2g8PB4hua6u4hwkLdfjFpqK94wcm2P","/ip4/172.18.126.11/tcp/50053/ws/p2p/16Uiu2HAm5vDjRBrexjZxRE2g8PB4hua6u4hwkLdfjFpqK94wcm2P"],"enrUri":"enr:-L24QLR2KU1kAIIhcj7I67VUjz37Lb3xF6wPVQTbIGfSDUsPS4eXFjo4gWHyp6iRLPtvvYlBMZ9mzQ_8q_NrUm5bpTUCgmlkgnY0gmlwhKwSfguKbXVsdGlhZGRyc5YACASsEn4LBsOEAAoErBJ-CwbDhd0DgnJzhQADAQAAiXNlY3AyNTZrMaECm-UIwBCHmE9S-V0mVWtfVxaCVzi1Fuqlifvp0RMhBTiDdGNwgsOEg3VkcILDhoV3YWt1MgE"}'
2026-02-13 04:39:08.136 INFO [src.node.waku_node] REST service is ready !!
2026-02-13 04:39:08.137 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50051/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.62.15/tcp/1296/p2p/16Uiu2HAm3GsshVMdxNtSvgif9fgn6dKwZ4aVyxr6Wrm1CmJv1pr6"]'
2026-02-13 04:39:08.139 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:39:08.140 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2026-02-13 04:39:08.140 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:1295/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-13 04:39:08.143 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:39:08.144 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50051/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-13 04:39:08.148 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:39:08.149 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:1295/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-13 04:39:08.154 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:39:08.154 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-13 04:39:08.255 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-13 04:39:08.255 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:1295/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:39:08.258 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770957548149602816,"ephemeral":false,"proof":""}]'
2026-02-13 04:39:08.259 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-13 04:39:08.260 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50051/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:39:08.262 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770957548149602816,"ephemeral":false,"proof":""}]'
2026-02-13 04:39:08.263 INFO [src.steps.relay] WARM UP successful!!
2026-02-13 04:39:08.264 DEBUG [tests.relay.test_publish] Running test with payload Empty string
2026-02-13 04:39:08.264 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:1295/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-13 04:39:08.266 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:1295/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-13 04:39:08.266 DEBUG [tests.relay.test_publish] Running test with payload Unecoded text
2026-02-13 04:39:08.267 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:1295/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "Hello World!", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-13 04:39:08.269 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:1295/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Incorrect base64 string'
2026-02-13 04:39:08.269 DEBUG [tests.relay.test_publish] Running test with payload A dictionary
2026-02-13 04:39:08.269 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:1295/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": {"key": "YWFh"}, "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-13 04:39:08.271 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:1295/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-13 04:39:08.271 DEBUG [tests.relay.test_publish] Running test with payload An integer
2026-02-13 04:39:08.272 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:1295/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": 1234567890, "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-13 04:39:08.274 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:1295/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-13 04:39:08.274 DEBUG [tests.relay.test_publish] Running test with payload A list
2026-02-13 04:39:08.274 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:1295/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": ["YWFh"], "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-13 04:39:08.276 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:1295/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-13 04:39:08.276 DEBUG [tests.relay.test_publish] Running test with payload A bool
2026-02-13 04:39:08.277 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:1295/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": true, "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-13 04:39:08.279 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:1295/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-13 04:39:08.281 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-13 04:39:08.282 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-13 04:39:08.282 DEBUG [src.node.waku_node] Stopping container with id c9de77369a70
2026-02-13 04:39:08.544 DEBUG [src.node.waku_node] Container stopped.
2026-02-13 04:39:08.544 DEBUG [src.node.waku_node] Stopping container with id 96295b37623a
2026-02-13 04:39:08.750 DEBUG [src.node.waku_node] Container stopped.
2026-02-13 04:39:08.752 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-13 04:39:08.757 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-13 04:39:08.761 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
