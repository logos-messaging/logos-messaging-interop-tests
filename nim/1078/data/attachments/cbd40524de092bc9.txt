2026-02-13 04:42:46.841 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-13 04:42:46.842 DEBUG [tests.conftest] Running test: test_filter_get_message_after_node1_restarts with id: 2026-02-13_04-42-46__8877992b-386f-42dc-8e42-525b5b3722f5
2026-02-13 04:42:46.843 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-13 04:42:46.843 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2026-02-13 04:42:46.843 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2026-02-13 04:42:46.851 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-13 04:42:46.852 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-13_04-42-46__8877992b-386f-42dc-8e42-525b5b3722f5__wakuorg_nwaku:latest.log
2026-02-13 04:42:46.852 DEBUG [src.node.waku_node] Starting Node...
2026-02-13 04:42:46.852 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-13 04:42:46.853 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-13 04:42:46.854 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.53.208
2026-02-13 04:42:46.854 DEBUG [src.node.docker_mananger] Generated ports ['8204', '8205', '8206', '8207', '8208']
2026-02-13 04:42:46.854 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-13 04:42:46.854 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-13 04:42:46.854 DEBUG [src.node.waku_node] Using volumes []
2026-02-13 04:42:46.854 DEBUG [src.node.docker_mananger] docker run -i -t -p 8204:8204 -p 8205:8205 -p 8206:8206 -p 8207:8207 -p 8208:8208 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=8206 --rest-port=8204 --tcp-port=8205 --discv5-udp-port=8207 --rest-address=0.0.0.0 --nat=extip:172.18.53.208 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a5d0d8a1ace6b6f06d8ec5efbcf7eecc7a7eadd4dabf0597e3d41dcab6d9af32 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=8208 --metrics-logging=true --relay=true --filter=true
2026-02-13 04:42:47.065 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.53.208 waku c86cd1aff56c4ae92280140f95b8d188c7f716fb2cc66d84481f6785c4b8f3dd
2026-02-13 04:42:47.121 DEBUG [src.node.docker_mananger] Container started with ID c86cd1aff56c. Setting up logs at ./log/docker/node1_2026-02-13_04-42-46__8877992b-386f-42dc-8e42-525b5b3722f5__wakuorg_nwaku:latest.log
2026-02-13 04:42:47.121 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 8204
2026-02-13 04:42:47.121 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-13 04:42:47.343 ERROR [src.node.docker_mananger] Max retries reached for container 7d4b9bb3cd23. Exiting log stream.
2026-02-13 04:42:47.658 ERROR [src.node.docker_mananger] Max retries reached for container aa656eb286a8. Exiting log stream.
2026-02-13 04:42:48.122 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8204/health" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:42:48.125 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-13 04:42:48.125 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-13 04:42:48.125 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8204/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:42:48.128 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.53.208/tcp/8205/p2p/16Uiu2HAm5Mw8jhvvgRRVbjM8XzWMAiVHPhDLwrrVgBYTz6aN5VrR","/ip4/172.18.53.208/tcp/8206/ws/p2p/16Uiu2HAm5Mw8jhvvgRRVbjM8XzWMAiVHPhDLwrrVgBYTz6aN5VrR"],"enrUri":"enr:-L24QLKpbPxPUflkBqY_JhW_WRCiL3-k8NkxevZ39FtcBv-AdHObAg6zPcMrjEXDbW3kc8fDvXpAAvpMkGiD8CLbX5UCgmlkgnY0gmlwhKwSNdCKbXVsdGlhZGRyc5YACASsEjXQBiANAAoErBI10AYgDt0DgnJzhQADAQAAiXNlY3AyNTZrMaECk5-uUdA-llHbflcLT1gCDneifwzbTuT1IQEuVsg-dXKDdGNwgiANg3VkcIIgD4V3YWt1MgU"}'
2026-02-13 04:42:48.128 INFO [src.node.waku_node] REST service is ready !!
2026-02-13 04:42:48.128 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2026-02-13 04:42:48.135 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-13 04:42:48.136 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-13_04-42-46__8877992b-386f-42dc-8e42-525b5b3722f5__wakuorg_nwaku:latest.log
2026-02-13 04:42:48.136 DEBUG [src.node.waku_node] Starting Node...
2026-02-13 04:42:48.136 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-13 04:42:48.137 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-13 04:42:48.137 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.236.161
2026-02-13 04:42:48.138 DEBUG [src.node.docker_mananger] Generated ports ['44619', '44620', '44621', '44622', '44623']
2026-02-13 04:42:48.138 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-13 04:42:48.138 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-13 04:42:48.138 DEBUG [src.node.waku_node] Using volumes []
2026-02-13 04:42:48.138 DEBUG [src.node.docker_mananger] docker run -i -t -p 44619:44619 -p 44620:44620 -p 44621:44621 -p 44622:44622 -p 44623:44623 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44621 --rest-port=44619 --tcp-port=44620 --discv5-udp-port=44622 --rest-address=0.0.0.0 --nat=extip:172.18.236.161 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=af9caecbfe03272ffc5f5e0f5fe1eec2dd5e74ad6d6371919dbdff55347b6d6c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44623 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QLKpbPxPUflkBqY_JhW_WRCiL3-k8NkxevZ39FtcBv-AdHObAg6zPcMrjEXDbW3kc8fDvXpAAvpMkGiD8CLbX5UCgmlkgnY0gmlwhKwSNdCKbXVsdGlhZGRyc5YACASsEjXQBiANAAoErBI10AYgDt0DgnJzhQADAQAAiXNlY3AyNTZrMaECk5-uUdA-llHbflcLT1gCDneifwzbTuT1IQEuVsg-dXKDdGNwgiANg3VkcIIgD4V3YWt1MgU --filternode=/ip4/172.18.53.208/tcp/8205/p2p/16Uiu2HAm5Mw8jhvvgRRVbjM8XzWMAiVHPhDLwrrVgBYTz6aN5VrR
2026-02-13 04:42:48.350 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.236.161 waku 86f91ba82a526d3b5f4a01c45f4d24652eb5dfa4c367e8655fec47cad1b54a54
2026-02-13 04:42:48.401 DEBUG [src.node.docker_mananger] Container started with ID 86f91ba82a52. Setting up logs at ./log/docker/node2_2026-02-13_04-42-46__8877992b-386f-42dc-8e42-525b5b3722f5__wakuorg_nwaku:latest.log
2026-02-13 04:42:48.402 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 44619
2026-02-13 04:42:48.402 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-13 04:42:49.403 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44619/health" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:42:49.407 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-13 04:42:49.408 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-13 04:42:49.408 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44619/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:42:49.410 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.236.161/tcp/44620/p2p/16Uiu2HAm6vRk2KKSgoFhA5GFPkhDmNPdSWmthw9FpXfzLVTV7Zu3","/ip4/172.18.236.161/tcp/44621/ws/p2p/16Uiu2HAm6vRk2KKSgoFhA5GFPkhDmNPdSWmthw9FpXfzLVTV7Zu3"],"enrUri":"enr:-L24QH--UMhHpsSuChitSdoPKD-axhyngTdDWyVt6BeXGQg_exPISxzXWoxhLni6-1bK6apv8JlKfB_5sD87syUOYDkCgmlkgnY0gmlwhKwS7KGKbXVsdGlhZGRyc5YACASsEuyhBq5MAAoErBLsoQauTd0DgnJzhQADAQAAiXNlY3AyNTZrMaECqs5NJcbtzp3CmweTpHcSHdojc8X1IlNI4JxukcfQqLqDdGNwgq5Mg3VkcIKuToV3YWt1MgA"}'
2026-02-13 04:42:49.411 INFO [src.node.waku_node] REST service is ready !!
2026-02-13 04:42:49.411 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44619/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.53.208/tcp/8205/p2p/16Uiu2HAm5Mw8jhvvgRRVbjM8XzWMAiVHPhDLwrrVgBYTz6aN5VrR"]'
2026-02-13 04:42:49.442 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:42:49.443 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2026-02-13 04:42:49.444 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8204/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-13 04:42:49.459 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:42:49.460 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44619/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "0a7cc4cf-af16-4d5c-b702-bac1507273b3", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-13 04:42:49.473 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"0a7cc4cf-af16-4d5c-b702-bac1507273b3","statusDesc":"OK"}'
2026-02-13 04:42:49.476 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8204/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-02-13 04:42:49.484 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:42:49.484 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-13 04:42:49.584 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-13 04:42:49.585 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44619/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:42:49.588 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1770957769476371753,"ephemeral":false}]'
2026-02-13 04:42:49.590 DEBUG [src.node.waku_node] Restarting container with id c86cd1aff56c
2026-02-13 04:42:50.057 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8204/health" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:42:50.161 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8204/health" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:42:50.165 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-13 04:42:50.165 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-13 04:42:50.165 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8204/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:42:50.168 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.53.208/tcp/8205/p2p/16Uiu2HAm5Mw8jhvvgRRVbjM8XzWMAiVHPhDLwrrVgBYTz6aN5VrR","/ip4/172.18.53.208/tcp/8206/ws/p2p/16Uiu2HAm5Mw8jhvvgRRVbjM8XzWMAiVHPhDLwrrVgBYTz6aN5VrR"],"enrUri":"enr:-L24QLKpbPxPUflkBqY_JhW_WRCiL3-k8NkxevZ39FtcBv-AdHObAg6zPcMrjEXDbW3kc8fDvXpAAvpMkGiD8CLbX5UCgmlkgnY0gmlwhKwSNdCKbXVsdGlhZGRyc5YACASsEjXQBiANAAoErBI10AYgDt0DgnJzhQADAQAAiXNlY3AyNTZrMaECk5-uUdA-llHbflcLT1gCDneifwzbTuT1IQEuVsg-dXKDdGNwgiANg3VkcIIgD4V3YWt1MgU"}'
2026-02-13 04:42:50.168 INFO [src.node.waku_node] REST service is ready !!
2026-02-13 04:42:50.168 DEBUG [src.libs.common] Sleeping for 2 seconds
2026-02-13 04:42:52.169 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8204/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-13 04:42:52.181 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:42:52.182 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44619/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "98cc8705-9707-45b7-83ff-9a77ed8692f6", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-13 04:42:52.212 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"98cc8705-9707-45b7-83ff-9a77ed8692f6","statusDesc":"OK"}'
2026-02-13 04:42:52.216 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8204/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-02-13 04:42:52.227 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-13 04:42:52.228 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-13 04:42:52.328 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-13 04:42:52.329 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44619/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-13 04:42:52.331 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1770957772215895728,"ephemeral":false}]'
2026-02-13 04:42:52.335 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-13 04:42:52.336 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-13 04:42:52.336 DEBUG [src.node.waku_node] Stopping container with id c86cd1aff56c
2026-02-13 04:42:52.599 DEBUG [src.node.waku_node] Container stopped.
2026-02-13 04:42:52.602 DEBUG [src.node.waku_node] Stopping container with id 86f91ba82a52
2026-02-13 04:42:52.909 DEBUG [src.node.waku_node] Container stopped.
2026-02-13 04:42:52.913 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-13 04:42:52.941 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-13 04:42:52.949 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
