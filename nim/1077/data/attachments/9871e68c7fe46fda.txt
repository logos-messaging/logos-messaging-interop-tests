2026-02-12 04:40:37.345 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-12 04:40:37.345 DEBUG [tests.conftest] Running test: test_relay_resubscribe_to_unsubscribed_pubsub_topic with id: 2026-02-12_04-40-37__26a9b18f-c03a-4305-97e9-b4610da3fa64
2026-02-12 04:40:37.346 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-12 04:40:37.346 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-12 04:40:37.346 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2026-02-12 04:40:37.354 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-12 04:40:37.354 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-12_04-40-37__26a9b18f-c03a-4305-97e9-b4610da3fa64__wakuorg_nwaku:latest.log
2026-02-12 04:40:37.354 DEBUG [src.node.waku_node] Starting Node...
2026-02-12 04:40:37.354 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-12 04:40:37.356 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-12 04:40:37.356 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.237.154
2026-02-12 04:40:37.356 DEBUG [src.node.docker_mananger] Generated ports ['17063', '17064', '17065', '17066', '17067']
2026-02-12 04:40:37.357 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-12 04:40:37.357 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-12 04:40:37.357 DEBUG [src.node.waku_node] Using volumes []
2026-02-12 04:40:37.357 DEBUG [src.node.docker_mananger] docker run -i -t -p 17063:17063 -p 17064:17064 -p 17065:17065 -p 17066:17066 -p 17067:17067 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17065 --rest-port=17063 --tcp-port=17064 --discv5-udp-port=17066 --rest-address=0.0.0.0 --nat=extip:172.18.237.154 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3f65b75bddd47f20c4223aa950ae6dbfe06e8ca8c4f8cb3521cbbc5c1adc4586 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17067 --metrics-logging=true --relay=true
2026-02-12 04:40:37.545 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.237.154 waku fd37a9d0950dc5491ed98f3e5244d9c2563efb0a88ec93ce99cd9cddabadfcb3
2026-02-12 04:40:37.588 DEBUG [src.node.docker_mananger] Container started with ID fd37a9d0950d. Setting up logs at ./log/docker/node1_2026-02-12_04-40-37__26a9b18f-c03a-4305-97e9-b4610da3fa64__wakuorg_nwaku:latest.log
2026-02-12 04:40:37.588 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 17063
2026-02-12 04:40:37.589 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-12 04:40:37.594 ERROR [src.node.docker_mananger] Max retries reached for container 82799b98f4d7. Exiting log stream.
2026-02-12 04:40:38.154 ERROR [src.node.docker_mananger] Max retries reached for container 314d46921f10. Exiting log stream.
2026-02-12 04:40:38.589 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17063/health" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:40:38.593 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-12 04:40:38.593 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-12 04:40:38.593 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17063/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:40:38.596 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.237.154/tcp/17064/p2p/16Uiu2HAmCZwRxC36gAMNRfDyMayXoSJVCzhK73Nvn6npcW4NdSay","/ip4/172.18.237.154/tcp/17065/ws/p2p/16Uiu2HAmCZwRxC36gAMNRfDyMayXoSJVCzhK73Nvn6npcW4NdSay"],"enrUri":"enr:-L24QFhLPoMZeTmZLDDciFMgDWKiVmdXEqpwnGLJ1R3YBoyZfA27KskmfMa4KuKDljvljSGbQtc2XuJr2SG2-8saNxACgmlkgnY0gmlwhKwS7ZqKbXVsdGlhZGRyc5YACASsEu2aBkKoAAoErBLtmgZCqd0DgnJzhQADAQAAiXNlY3AyNTZrMaEC_rTLc_5izeUCMeEERdFTLY7tTsrJku8Z_Vo9p6YFIsaDdGNwgkKog3VkcIJCqoV3YWt1MgE"}'
2026-02-12 04:40:38.596 INFO [src.node.waku_node] REST service is ready !!
2026-02-12 04:40:38.602 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-12 04:40:38.603 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-12_04-40-37__26a9b18f-c03a-4305-97e9-b4610da3fa64__wakuorg_nwaku:latest.log
2026-02-12 04:40:38.603 DEBUG [src.node.waku_node] Starting Node...
2026-02-12 04:40:38.603 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-12 04:40:38.604 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-12 04:40:38.604 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.219.136
2026-02-12 04:40:38.604 DEBUG [src.node.docker_mananger] Generated ports ['40437', '40438', '40439', '40440', '40441']
2026-02-12 04:40:38.605 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-12 04:40:38.605 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-12 04:40:38.605 DEBUG [src.node.waku_node] Using volumes []
2026-02-12 04:40:38.605 DEBUG [src.node.docker_mananger] docker run -i -t -p 40437:40437 -p 40438:40438 -p 40439:40439 -p 40440:40440 -p 40441:40441 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=40439 --rest-port=40437 --tcp-port=40438 --discv5-udp-port=40440 --rest-address=0.0.0.0 --nat=extip:172.18.219.136 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c9eacfa76de155cbd90818cb1beae5c841ed496b89fb6ebabcb9cf07b4d544d0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=40441 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QFhLPoMZeTmZLDDciFMgDWKiVmdXEqpwnGLJ1R3YBoyZfA27KskmfMa4KuKDljvljSGbQtc2XuJr2SG2-8saNxACgmlkgnY0gmlwhKwS7ZqKbXVsdGlhZGRyc5YACASsEu2aBkKoAAoErBLtmgZCqd0DgnJzhQADAQAAiXNlY3AyNTZrMaEC_rTLc_5izeUCMeEERdFTLY7tTsrJku8Z_Vo9p6YFIsaDdGNwgkKog3VkcIJCqoV3YWt1MgE
2026-02-12 04:40:38.806 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.219.136 waku 7d63fed25c62cac9ba1afecea8d5fd76a75c8f70098a297de69624996e06dd1f
2026-02-12 04:40:38.840 DEBUG [src.node.docker_mananger] Container started with ID 7d63fed25c62. Setting up logs at ./log/docker/node2_2026-02-12_04-40-37__26a9b18f-c03a-4305-97e9-b4610da3fa64__wakuorg_nwaku:latest.log
2026-02-12 04:40:38.840 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 40437
2026-02-12 04:40:38.841 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-12 04:40:39.841 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40437/health" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:40:39.849 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-12 04:40:39.850 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-12 04:40:39.850 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40437/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:40:39.854 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.219.136/tcp/40438/p2p/16Uiu2HAmEgGVTYyqkuJLgS2ksbNvVu3nyDYbLkhm8cgK59Y478B4","/ip4/172.18.219.136/tcp/40439/ws/p2p/16Uiu2HAmEgGVTYyqkuJLgS2ksbNvVu3nyDYbLkhm8cgK59Y478B4"],"enrUri":"enr:-L24QGJuf0NAkBpVIZtYynOf6ajJz8ZfhB6fgAlK1lITWwtuCTMOu8_zE8l3ZD1ivhRaCf0hENktjxG0UNua1FLZ4eYCgmlkgnY0gmlwhKwS24iKbXVsdGlhZGRyc5YACASsEtuIBp32AAoErBLbiAad990DgnJzhQADAQAAiXNlY3AyNTZrMaEDHgs0heCVrqy9HCVYi2edmjAbu52LsAo-1tGfAvyHCMODdGNwgp32g3VkcIKd-IV3YWt1MgE"}'
2026-02-12 04:40:39.855 INFO [src.node.waku_node] REST service is ready !!
2026-02-12 04:40:39.855 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40437/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.237.154/tcp/17064/p2p/16Uiu2HAmCZwRxC36gAMNRfDyMayXoSJVCzhK73Nvn6npcW4NdSay"]'
2026-02-12 04:40:39.859 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-12 04:40:39.860 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17063/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-12 04:40:39.863 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-12 04:40:39.863 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40437/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-12 04:40:39.868 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-12 04:40:39.869 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17063/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-12 04:40:39.875 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-12 04:40:39.875 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-12 04:40:39.976 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-12 04:40:39.976 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17063/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:40:39.979 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770871239869302016,"ephemeral":false,"proof":""}]'
2026-02-12 04:40:39.981 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-12 04:40:39.981 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40437/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:40:39.983 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770871239869302016,"ephemeral":false,"proof":""}]'
2026-02-12 04:40:39.984 INFO [src.node.api_clients.base_client] curl -v -X DELETE "http://127.0.0.1:17063/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-12 04:40:39.987 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-12 04:40:39.988 INFO [src.node.api_clients.base_client] curl -v -X DELETE "http://127.0.0.1:40437/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-12 04:40:39.993 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-12 04:40:39.993 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17063/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-12 04:40:39.995 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:17063/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Failed to publish: Node not subscribed to topic: /waku/2/rs/3/1'
2026-02-12 04:40:39.996 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17063/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-12 04:40:39.999 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-12 04:40:40.000 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40437/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-12 04:40:40.004 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-12 04:40:40.005 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17063/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-12 04:40:40.010 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-12 04:40:40.010 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-12 04:40:40.110 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-12 04:40:40.111 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17063/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:40:40.113 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770871240005110038,"ephemeral":false,"proof":""}]'
2026-02-12 04:40:40.116 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-12 04:40:40.116 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40437/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:40:40.119 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770871240005110038,"ephemeral":false,"proof":""}]'
2026-02-12 04:40:40.121 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-12 04:40:40.122 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-12 04:40:40.122 DEBUG [src.node.waku_node] Stopping container with id fd37a9d0950d
2026-02-12 04:40:40.671 DEBUG [src.node.waku_node] Container stopped.
2026-02-12 04:40:40.671 DEBUG [src.node.waku_node] Stopping container with id 7d63fed25c62
2026-02-12 04:40:41.248 DEBUG [src.node.waku_node] Container stopped.
2026-02-12 04:40:41.249 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-12 04:40:41.257 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-12 04:40:41.263 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
