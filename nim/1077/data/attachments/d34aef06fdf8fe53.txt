2026-02-12 04:41:32.692 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-12 04:41:32.693 DEBUG [tests.conftest] Running test: test_relay_different_latency_between_two_nodes[500] with id: 2026-02-12_04-41-32__b51fce55-3856-431e-86fb-ebe2e23147a0
2026-02-12 04:41:32.693 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-12 04:41:32.693 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-12 04:41:32.700 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-12 04:41:32.700 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-12_04-41-32__b51fce55-3856-431e-86fb-ebe2e23147a0__wakuorg_nwaku:latest.log
2026-02-12 04:41:32.706 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-12 04:41:32.706 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-12_04-41-32__b51fce55-3856-431e-86fb-ebe2e23147a0__wakuorg_nwaku:latest.log
2026-02-12 04:41:32.707 INFO [tests.e2e.test_network_conditions] Starting node1 and node2 with relay enabled
2026-02-12 04:41:32.707 DEBUG [src.node.waku_node] Starting Node...
2026-02-12 04:41:32.707 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-12 04:41:32.708 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-12 04:41:32.709 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.182.10
2026-02-12 04:41:32.709 DEBUG [src.node.docker_mananger] Generated ports ['10897', '10898', '10899', '10900', '10901']
2026-02-12 04:41:32.709 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-12 04:41:32.709 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-12 04:41:32.709 DEBUG [src.node.waku_node] Using volumes []
2026-02-12 04:41:32.709 DEBUG [src.node.docker_mananger] docker run -i -t -p 10897:10897 -p 10898:10898 -p 10899:10899 -p 10900:10900 -p 10901:10901 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10899 --rest-port=10897 --tcp-port=10898 --discv5-udp-port=10900 --rest-address=0.0.0.0 --nat=extip:172.18.182.10 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b33d4b3facdf35c401e97b6d82f2608ab3fe1bac1b729a2cb92bb2ec98dbb64e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10901 --metrics-logging=true --relay=true
2026-02-12 04:41:32.888 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.182.10 waku ee50be6324ebfb94c5af4603a42efa98df9fc8fc8ab44eb9faaf16a50d01043c
2026-02-12 04:41:32.920 DEBUG [src.node.docker_mananger] Container started with ID ee50be6324eb. Setting up logs at ./log/docker/node1_2026-02-12_04-41-32__b51fce55-3856-431e-86fb-ebe2e23147a0__wakuorg_nwaku:latest.log
2026-02-12 04:41:32.920 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 10897
2026-02-12 04:41:32.921 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-12 04:41:33.007 ERROR [src.node.docker_mananger] Max retries reached for container 4db922e5eb0c. Exiting log stream.
2026-02-12 04:41:33.921 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10897/health" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:41:33.924 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-12 04:41:33.924 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-12 04:41:33.925 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10897/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:41:33.927 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.182.10/tcp/10898/p2p/16Uiu2HAm4TyA5JM6SQGJZ3whFUjZXaxBfim7eBMyZKErSBjgeZC7","/ip4/172.18.182.10/tcp/10899/ws/p2p/16Uiu2HAm4TyA5JM6SQGJZ3whFUjZXaxBfim7eBMyZKErSBjgeZC7"],"enrUri":"enr:-L24QCoHb1R1FpcXr1XufGsFeQSGgRChsb5Vrx9CsExKd7GjNEcc5c3X8xyNSCg1S3V7d21vU7sj-1L6oxTcMIK5JwcCgmlkgnY0gmlwhKwStgqKbXVsdGlhZGRyc5YACASsErYKBiqSAAoErBK2CgYqk90DgnJzhQADAQAAiXNlY3AyNTZrMaEChk_EL6FQ9D6oTddkbEpAyhxkzltNnUncXJeVzeqpqHyDdGNwgiqSg3VkcIIqlIV3YWt1MgE"}'
2026-02-12 04:41:33.927 INFO [src.node.waku_node] REST service is ready !!
2026-02-12 04:41:33.927 DEBUG [src.node.waku_node] Starting Node...
2026-02-12 04:41:33.928 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-12 04:41:33.929 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-12 04:41:33.929 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.162.177
2026-02-12 04:41:33.929 DEBUG [src.node.docker_mananger] Generated ports ['7864', '7865', '7866', '7867', '7868']
2026-02-12 04:41:33.930 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-12 04:41:33.930 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-12 04:41:33.930 DEBUG [src.node.waku_node] Using volumes []
2026-02-12 04:41:33.930 DEBUG [src.node.docker_mananger] docker run -i -t -p 7864:7864 -p 7865:7865 -p 7866:7866 -p 7867:7867 -p 7868:7868 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=7866 --rest-port=7864 --tcp-port=7865 --discv5-udp-port=7867 --rest-address=0.0.0.0 --nat=extip:172.18.162.177 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b8a9829f0e2bf3aad9cdc8d55cb019ce631214bc139d40a7fe9eb6e2113d6bad --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=7868 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QCoHb1R1FpcXr1XufGsFeQSGgRChsb5Vrx9CsExKd7GjNEcc5c3X8xyNSCg1S3V7d21vU7sj-1L6oxTcMIK5JwcCgmlkgnY0gmlwhKwStgqKbXVsdGlhZGRyc5YACASsErYKBiqSAAoErBK2CgYqk90DgnJzhQADAQAAiXNlY3AyNTZrMaEChk_EL6FQ9D6oTddkbEpAyhxkzltNnUncXJeVzeqpqHyDdGNwgiqSg3VkcIIqlIV3YWt1MgE
2026-02-12 04:41:34.118 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.162.177 waku 6f6b69ac44aeffa3cb38ac7a8e4dbcb312ec3d2c04e5ad6100b6ebc19f4f5eec
2026-02-12 04:41:34.152 DEBUG [src.node.docker_mananger] Container started with ID 6f6b69ac44ae. Setting up logs at ./log/docker/node2_2026-02-12_04-41-32__b51fce55-3856-431e-86fb-ebe2e23147a0__wakuorg_nwaku:latest.log
2026-02-12 04:41:34.153 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 7864
2026-02-12 04:41:34.153 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-12 04:41:35.153 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7864/health" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:41:35.166 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-12 04:41:35.169 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-12 04:41:35.169 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7864/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:41:35.173 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.162.177/tcp/7865/p2p/16Uiu2HAmEYNMrgZypsXnv5raJiaoBDPt7KBV89yxdik3U1FRzHj1","/ip4/172.18.162.177/tcp/7866/ws/p2p/16Uiu2HAmEYNMrgZypsXnv5raJiaoBDPt7KBV89yxdik3U1FRzHj1"],"enrUri":"enr:-L24QLs7igdFqaXikuKZgiZYxZ98Ynnce9F88AyMO2-w09bKctIhKG9NLKQI4SoOUApj0o9OEdQq91dl4JdPyN7UYWECgmlkgnY0gmlwhKwSorGKbXVsdGlhZGRyc5YACASsEqKxBh65AAoErBKisQYeut0DgnJzhQADAQAAiXNlY3AyNTZrMaEDHAUx2fvzpXQldVGXxa-9vhn-y4TiGvnou4toWqO5RmyDdGNwgh65g3VkcIIeu4V3YWt1MgE"}'
2026-02-12 04:41:35.174 INFO [src.node.waku_node] REST service is ready !!
2026-02-12 04:41:35.175 INFO [tests.e2e.test_network_conditions] Subscribing both nodes to relay topic
2026-02-12 04:41:35.175 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10897/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-12 04:41:35.179 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-12 04:41:35.179 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:7864/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-12 04:41:35.184 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-12 04:41:35.185 INFO [tests.e2e.test_network_conditions] Waiting for autoconnection
2026-02-12 04:41:35.185 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10897/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:41:35.188 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.162.177/tcp/60106/p2p/16Uiu2HAmEYNMrgZypsXnv5raJiaoBDPt7KBV89yxdik3U1FRzHj1","protocols":["/ipfs/id/1.0.0","/libp2p/autonat/1.0.0","/libp2p/circuit/relay/0.2.0/hop","/vac/waku/metadata/1.0.0","/vac/waku/relay/2.0.0","/vac/waku/rendezvous/1.0.0","/ipfs/ping/1.0.0","/vac/waku/filter-push/2.0.0-beta1","/vac/waku/peer-exchange/2.0.0-alpha1"],"shards":[0],"connected":"Connected","agent":"nwaku-v0.36.0-127-ga4e44d","origin":"UnknownOrigin"}]'
2026-02-12 04:41:35.188 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7864/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:41:35.190 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.182.10/tcp/10898/p2p/16Uiu2HAm4TyA5JM6SQGJZ3whFUjZXaxBfim7eBMyZKErSBjgeZC7","protocols":["/ipfs/id/1.0.0","/libp2p/autonat/1.0.0","/libp2p/circuit/relay/0.2.0/hop","/vac/waku/metadata/1.0.0","/vac/waku/relay/2.0.0","/vac/waku/rendezvous/1.0.0","/ipfs/ping/1.0.0","/vac/waku/filter-push/2.0.0-beta1","/vac/waku/peer-exchange/2.0.0-alpha1"],"shards":[0],"connected":"Connected","agent":"nwaku-v0.36.0-127-ga4e44d","origin":"Discv5"}]'
2026-02-12 04:41:35.190 DEBUG [src.libs.common] Sleeping for 10 seconds
2026-02-12 04:41:45.191 INFO [tests.e2e.test_network_conditions] Applying 500ms latency to node2
2026-02-12 04:41:45.193 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '8366', '-n', 'tc', 'qdisc', 'del', 'dev', 'eth0', 'root']
2026-02-12 04:41:45.203 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '8366', '-n', 'tc', 'qdisc', 'del', 'dev', 'eth0', 'root']
2026-02-12 04:41:45.213 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '8366', '-n', 'tc', 'qdisc', 'add', 'dev', 'eth0', 'root', 'netem', 'delay', '500ms']
2026-02-12 04:41:45.222 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10897/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-12 04:41:45.227 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-12 04:41:45.227 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7864/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:41:46.230 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770871305222459927,"ephemeral":false,"proof":""}]'
2026-02-12 04:41:46.232 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '8366', '-n', 'tc', 'qdisc', 'del', 'dev', 'eth0', 'root']
2026-02-12 04:41:46.243 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-12 04:41:46.243 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-12 04:41:46.244 DEBUG [src.node.waku_node] Stopping container with id ee50be6324eb
2026-02-12 04:41:46.770 DEBUG [src.node.waku_node] Container stopped.
2026-02-12 04:41:46.771 DEBUG [src.node.waku_node] Stopping container with id 6f6b69ac44ae
2026-02-12 04:41:47.269 DEBUG [src.node.waku_node] Container stopped.
2026-02-12 04:41:47.270 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-12 04:41:47.280 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-12 04:41:47.289 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
