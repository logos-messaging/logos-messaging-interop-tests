2026-02-12 04:43:37.472 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-12 04:43:37.472 DEBUG [tests.conftest] Running test: test_filter_update_subscription_with_invalid_content_topic_format with id: 2026-02-12_04-43-37__0544023f-e3b4-4b9e-9fe1-096e1aa9373b
2026-02-12 04:43:37.472 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-12 04:43:37.472 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2026-02-12 04:43:37.473 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2026-02-12 04:43:37.479 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-12 04:43:37.479 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-12_04-43-37__0544023f-e3b4-4b9e-9fe1-096e1aa9373b__wakuorg_nwaku:latest.log
2026-02-12 04:43:37.480 DEBUG [src.node.waku_node] Starting Node...
2026-02-12 04:43:37.480 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-12 04:43:37.481 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-12 04:43:37.481 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.4.207
2026-02-12 04:43:37.481 DEBUG [src.node.docker_mananger] Generated ports ['58640', '58641', '58642', '58643', '58644']
2026-02-12 04:43:37.481 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-12 04:43:37.482 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-12 04:43:37.482 DEBUG [src.node.waku_node] Using volumes []
2026-02-12 04:43:37.482 DEBUG [src.node.docker_mananger] docker run -i -t -p 58640:58640 -p 58641:58641 -p 58642:58642 -p 58643:58643 -p 58644:58644 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58642 --rest-port=58640 --tcp-port=58641 --discv5-udp-port=58643 --rest-address=0.0.0.0 --nat=extip:172.18.4.207 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=01a4fe6659cea04ccaae7bdffa3a9ccfab3e8d0a52ee59ccf3f0cacd8e5d331d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58644 --metrics-logging=true --relay=true --filter=true
2026-02-12 04:43:37.662 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.4.207 waku 2131006494f7d327850d3e4c2d649e9e4b22f3677a18135ce88e0f5bffded58e
2026-02-12 04:43:37.693 DEBUG [src.node.docker_mananger] Container started with ID 2131006494f7. Setting up logs at ./log/docker/node1_2026-02-12_04-43-37__0544023f-e3b4-4b9e-9fe1-096e1aa9373b__wakuorg_nwaku:latest.log
2026-02-12 04:43:37.693 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 58640
2026-02-12 04:43:37.694 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-12 04:43:37.719 ERROR [src.node.docker_mananger] Max retries reached for container 60d723104e17. Exiting log stream.
2026-02-12 04:43:38.275 ERROR [src.node.docker_mananger] Max retries reached for container 5af6b3412c1c. Exiting log stream.
2026-02-12 04:43:38.695 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58640/health" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:43:38.698 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-12 04:43:38.698 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-12 04:43:38.698 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58640/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:43:38.701 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.4.207/tcp/58641/p2p/16Uiu2HAmMsGiwoQr3ZJBcwY6gEPMBogcsFP811RzsXBTzmgqiU5f","/ip4/172.18.4.207/tcp/58642/ws/p2p/16Uiu2HAmMsGiwoQr3ZJBcwY6gEPMBogcsFP811RzsXBTzmgqiU5f"],"enrUri":"enr:-L24QIkZlbtn5IJKtLS-y6ovsToikKvtxTntaCtshjxcevZURSNfVdQdS-oZULWX7Le3rYpL5USJBji87fIJoDeyMjwCgmlkgnY0gmlwhKwSBM-KbXVsdGlhZGRyc5YACASsEgTPBuURAAoErBIEzwblEt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDiN6qXPAdMJLT21oyWgqD8c1WhD19e2RAeAEZOL2-UiKDdGNwguURg3VkcILlE4V3YWt1MgU"}'
2026-02-12 04:43:38.701 INFO [src.node.waku_node] REST service is ready !!
2026-02-12 04:43:38.701 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2026-02-12 04:43:38.708 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-12 04:43:38.708 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-12_04-43-37__0544023f-e3b4-4b9e-9fe1-096e1aa9373b__wakuorg_nwaku:latest.log
2026-02-12 04:43:38.708 DEBUG [src.node.waku_node] Starting Node...
2026-02-12 04:43:38.708 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-12 04:43:38.709 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-12 04:43:38.709 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.210.112
2026-02-12 04:43:38.710 DEBUG [src.node.docker_mananger] Generated ports ['24965', '24966', '24967', '24968', '24969']
2026-02-12 04:43:38.710 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-12 04:43:38.710 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-12 04:43:38.710 DEBUG [src.node.waku_node] Using volumes []
2026-02-12 04:43:38.710 DEBUG [src.node.docker_mananger] docker run -i -t -p 24965:24965 -p 24966:24966 -p 24967:24967 -p 24968:24968 -p 24969:24969 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24967 --rest-port=24965 --tcp-port=24966 --discv5-udp-port=24968 --rest-address=0.0.0.0 --nat=extip:172.18.210.112 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a8922bb4bc8f74ed974fd736b72b007fd8c2f30eeb8c79e2bca4bb04e18753ab --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24969 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QIkZlbtn5IJKtLS-y6ovsToikKvtxTntaCtshjxcevZURSNfVdQdS-oZULWX7Le3rYpL5USJBji87fIJoDeyMjwCgmlkgnY0gmlwhKwSBM-KbXVsdGlhZGRyc5YACASsEgTPBuURAAoErBIEzwblEt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDiN6qXPAdMJLT21oyWgqD8c1WhD19e2RAeAEZOL2-UiKDdGNwguURg3VkcILlE4V3YWt1MgU --filternode=/ip4/172.18.4.207/tcp/58641/p2p/16Uiu2HAmMsGiwoQr3ZJBcwY6gEPMBogcsFP811RzsXBTzmgqiU5f
2026-02-12 04:43:38.896 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.210.112 waku 4bc114dc18e6737e230219387d3524ee7aaee285f2c9a9175a5a0b283a8e9b81
2026-02-12 04:43:38.927 DEBUG [src.node.docker_mananger] Container started with ID 4bc114dc18e6. Setting up logs at ./log/docker/node2_2026-02-12_04-43-37__0544023f-e3b4-4b9e-9fe1-096e1aa9373b__wakuorg_nwaku:latest.log
2026-02-12 04:43:38.927 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 24965
2026-02-12 04:43:38.927 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-12 04:43:39.928 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24965/health" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:43:39.932 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-12 04:43:39.932 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-12 04:43:39.932 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24965/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-12 04:43:39.934 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.210.112/tcp/24966/p2p/16Uiu2HAkzKVHzH7ajZ19cFomwVgiZzT8rtY6JHZm6aKAhSpFRbzL","/ip4/172.18.210.112/tcp/24967/ws/p2p/16Uiu2HAkzKVHzH7ajZ19cFomwVgiZzT8rtY6JHZm6aKAhSpFRbzL"],"enrUri":"enr:-L24QKgPV8PzbkyMLSYPwIUJ2EqQ3enCIjmnVBcDLjFXqDXZJNccuurthJ0HPwIPlG0ulnhT56sPSi057sRy_y6KU9oCgmlkgnY0gmlwhKwS0nCKbXVsdGlhZGRyc5YACASsEtJwBmGGAAoErBLScAZhh90DgnJzhQADAQAAiXNlY3AyNTZrMaECSLTd4vLmzBCbCgMif6WV8gmgpP12hWnZIgiI9MkSWAWDdGNwgmGGg3VkcIJhiIV3YWt1MgA"}'
2026-02-12 04:43:39.935 INFO [src.node.waku_node] REST service is ready !!
2026-02-12 04:43:39.935 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24965/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.4.207/tcp/58641/p2p/16Uiu2HAmMsGiwoQr3ZJBcwY6gEPMBogcsFP811RzsXBTzmgqiU5f"]'
2026-02-12 04:43:39.967 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-12 04:43:39.968 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2026-02-12 04:43:39.968 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58640/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-12 04:43:39.979 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-12 04:43:39.980 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24965/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "c30b5b6d-fc47-4dcf-bd2f-2d787d9e429f", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-12 04:43:39.991 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"c30b5b6d-fc47-4dcf-bd2f-2d787d9e429f","statusDesc":"OK"}'
2026-02-12 04:43:39.993 DEBUG [tests.filter.test_subscribe_update] Running test with contetn topic Empty string
2026-02-12 04:43:39.993 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:24965/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": [{"description": "Empty string", "value": ""}], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-12 04:43:39.996 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:24965/filter/v2/subscriptions. Response content: b'{"requestId":"unknown","statusDesc":"BAD_REQUEST: Failed to decode request: (status: 400 Bad Request, headers: , kind: Error, errobj: (status: 400 Bad Request, message: \\"Invalid content body, could not decode. Unable to deserialize data: \\", contentType: \\"text/plain\\"))"}'
2026-02-12 04:43:39.996 DEBUG [tests.filter.test_subscribe_update] Running test with contetn topic A dictionary
2026-02-12 04:43:39.996 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:24965/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": [{"description": "A dictionary", "value": {"key": "YWFh"}}], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-12 04:43:39.999 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:24965/filter/v2/subscriptions. Response content: b'{"requestId":"unknown","statusDesc":"BAD_REQUEST: Failed to decode request: (status: 400 Bad Request, headers: , kind: Error, errobj: (status: 400 Bad Request, message: \\"Invalid content body, could not decode. Unable to deserialize data: \\", contentType: \\"text/plain\\"))"}'
2026-02-12 04:43:40.000 DEBUG [tests.filter.test_subscribe_update] Running test with contetn topic An integer
2026-02-12 04:43:40.000 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:24965/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": [{"description": "An integer", "value": 1234567890}], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-12 04:43:40.002 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:24965/filter/v2/subscriptions. Response content: b'{"requestId":"unknown","statusDesc":"BAD_REQUEST: Failed to decode request: (status: 400 Bad Request, headers: , kind: Error, errobj: (status: 400 Bad Request, message: \\"Invalid content body, could not decode. Unable to deserialize data: \\", contentType: \\"text/plain\\"))"}'
2026-02-12 04:43:40.003 DEBUG [tests.filter.test_subscribe_update] Running test with contetn topic A list
2026-02-12 04:43:40.003 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:24965/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": [{"description": "A list", "value": ["YWFh"]}], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-12 04:43:40.006 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:24965/filter/v2/subscriptions. Response content: b'{"requestId":"unknown","statusDesc":"BAD_REQUEST: Failed to decode request: (status: 400 Bad Request, headers: , kind: Error, errobj: (status: 400 Bad Request, message: \\"Invalid content body, could not decode. Unable to deserialize data: \\", contentType: \\"text/plain\\"))"}'
2026-02-12 04:43:40.006 DEBUG [tests.filter.test_subscribe_update] Running test with contetn topic A bool
2026-02-12 04:43:40.006 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:24965/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": [{"description": "A bool", "value": true}], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-12 04:43:40.009 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:24965/filter/v2/subscriptions. Response content: b'{"requestId":"unknown","statusDesc":"BAD_REQUEST: Failed to decode request: (status: 400 Bad Request, headers: , kind: Error, errobj: (status: 400 Bad Request, message: \\"Invalid content body, could not decode. Unable to deserialize data: \\", contentType: \\"text/plain\\"))"}'
2026-02-12 04:43:40.011 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-12 04:43:40.012 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-12 04:43:40.012 DEBUG [src.node.waku_node] Stopping container with id 2131006494f7
2026-02-12 04:43:40.561 DEBUG [src.node.waku_node] Container stopped.
2026-02-12 04:43:40.561 DEBUG [src.node.waku_node] Stopping container with id 4bc114dc18e6
2026-02-12 04:43:41.103 DEBUG [src.node.waku_node] Container stopped.
2026-02-12 04:43:41.103 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-12 04:43:41.109 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-12 04:43:41.114 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
