2026-02-02 04:46:10.008 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-02 04:46:10.009 DEBUG [tests.conftest] Running test: test_publish_with_invalid_timestamps with id: 2026-02-02_04-46-10__b2aef11b-254b-4c70-b4b8-0cda9e90d90e
2026-02-02 04:46:10.009 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-02 04:46:10.009 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-02 04:46:10.009 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2026-02-02 04:46:10.016 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-02 04:46:10.016 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-02_04-46-10__b2aef11b-254b-4c70-b4b8-0cda9e90d90e__wakuorg_nwaku:latest.log
2026-02-02 04:46:10.017 DEBUG [src.node.waku_node] Starting Node...
2026-02-02 04:46:10.017 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-02 04:46:10.018 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-02 04:46:10.018 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.72.122
2026-02-02 04:46:10.018 DEBUG [src.node.docker_mananger] Generated ports ['18083', '18084', '18085', '18086', '18087']
2026-02-02 04:46:10.019 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-02 04:46:10.019 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-02 04:46:10.019 DEBUG [src.node.waku_node] Using volumes []
2026-02-02 04:46:10.019 DEBUG [src.node.docker_mananger] docker run -i -t -p 18083:18083 -p 18084:18084 -p 18085:18085 -p 18086:18086 -p 18087:18087 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18085 --rest-port=18083 --tcp-port=18084 --discv5-udp-port=18086 --rest-address=0.0.0.0 --nat=extip:172.18.72.122 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=71edd0bbcae742448d7ffaecdcdf35ad99bdf0e9eca2c265581afffdc2dc7944 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18087 --metrics-logging=true --relay=true
2026-02-02 04:46:10.200 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.72.122 waku b4561ea40eca08848ced158fe5f08fa6be4b4ddfe8c84d6b46c99f8e75a81869
2026-02-02 04:46:10.212 ERROR [src.node.docker_mananger] Max retries reached for container 867e61040204. Exiting log stream.
2026-02-02 04:46:10.233 DEBUG [src.node.docker_mananger] Container started with ID b4561ea40eca. Setting up logs at ./log/docker/node1_2026-02-02_04-46-10__b2aef11b-254b-4c70-b4b8-0cda9e90d90e__wakuorg_nwaku:latest.log
2026-02-02 04:46:10.234 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 18083
2026-02-02 04:46:10.235 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-02 04:46:10.797 ERROR [src.node.docker_mananger] Max retries reached for container 395cc0051b1a. Exiting log stream.
2026-02-02 04:46:11.235 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18083/health" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:46:11.239 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-02 04:46:11.239 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-02 04:46:11.239 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18083/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:46:11.241 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.72.122/tcp/18084/p2p/16Uiu2HAmD6adRCbaurNEWbq3NBHo5bWBRjpmaf7xCuTfFbWVs7Vk","/ip4/172.18.72.122/tcp/18085/ws/p2p/16Uiu2HAmD6adRCbaurNEWbq3NBHo5bWBRjpmaf7xCuTfFbWVs7Vk"],"enrUri":"enr:-L24QJhiCiGirbTtG8Wq5B2vFX4zPgRgIGcQ7-ALx49FThctBxnZ3bBqLm6aX-72LQ3wcq_YrIOdEklVy3ztnc8ArW8CgmlkgnY0gmlwhKwSSHqKbXVsdGlhZGRyc5YACASsEkh6BkakAAoErBJIegZGpd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDBo5HUCMErkvQUNAVqWm0OHp8ja3HLAES01qHgvkEG4uDdGNwgkakg3VkcIJGpoV3YWt1MgE"}'
2026-02-02 04:46:11.242 INFO [src.node.waku_node] REST service is ready !!
2026-02-02 04:46:11.248 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-02 04:46:11.248 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-02_04-46-10__b2aef11b-254b-4c70-b4b8-0cda9e90d90e__wakuorg_nwaku:latest.log
2026-02-02 04:46:11.249 DEBUG [src.node.waku_node] Starting Node...
2026-02-02 04:46:11.249 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-02 04:46:11.250 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-02 04:46:11.250 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.221.97
2026-02-02 04:46:11.250 DEBUG [src.node.docker_mananger] Generated ports ['3614', '3615', '3616', '3617', '3618']
2026-02-02 04:46:11.251 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-02 04:46:11.251 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-02 04:46:11.251 DEBUG [src.node.waku_node] Using volumes []
2026-02-02 04:46:11.251 DEBUG [src.node.docker_mananger] docker run -i -t -p 3614:3614 -p 3615:3615 -p 3616:3616 -p 3617:3617 -p 3618:3618 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3616 --rest-port=3614 --tcp-port=3615 --discv5-udp-port=3617 --rest-address=0.0.0.0 --nat=extip:172.18.221.97 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c08da1de5f5edbb792e976a86e85fd74c6b6fb2ad8cc50ab0a4e0dfb2414d6ee --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3618 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QJhiCiGirbTtG8Wq5B2vFX4zPgRgIGcQ7-ALx49FThctBxnZ3bBqLm6aX-72LQ3wcq_YrIOdEklVy3ztnc8ArW8CgmlkgnY0gmlwhKwSSHqKbXVsdGlhZGRyc5YACASsEkh6BkakAAoErBJIegZGpd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDBo5HUCMErkvQUNAVqWm0OHp8ja3HLAES01qHgvkEG4uDdGNwgkakg3VkcIJGpoV3YWt1MgE
2026-02-02 04:46:11.442 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.221.97 waku 5858e3f573e2c0716fc7fe6b7852f4bdc3b99e7df8ac24b6ec9ac8cf74d70460
2026-02-02 04:46:11.473 DEBUG [src.node.docker_mananger] Container started with ID 5858e3f573e2. Setting up logs at ./log/docker/node2_2026-02-02_04-46-10__b2aef11b-254b-4c70-b4b8-0cda9e90d90e__wakuorg_nwaku:latest.log
2026-02-02 04:46:11.474 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 3614
2026-02-02 04:46:11.475 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-02 04:46:12.475 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3614/health" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:46:12.488 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-02 04:46:12.489 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-02 04:46:12.490 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3614/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:46:12.496 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.221.97/tcp/3615/p2p/16Uiu2HAkuuu2Jj5e5gPUXK9sVca6vhyzMcZy5gkiTfUs83NKy4AV","/ip4/172.18.221.97/tcp/3616/ws/p2p/16Uiu2HAkuuu2Jj5e5gPUXK9sVca6vhyzMcZy5gkiTfUs83NKy4AV"],"enrUri":"enr:-L24QME-XVIvdYAHP9RTEmcHMxzFOBbL8vhcV5tX96QNZD0dQJqUaYv8a1VLCJM8HNt4rh4tjB_kjHdE_Zyaa8XkEDYCgmlkgnY0gmlwhKwS3WGKbXVsdGlhZGRyc5YACASsEt1hBg4fAAoErBLdYQYOIN0DgnJzhQADAQAAiXNlY3AyNTZrMaECBzsCwyB7k2q80rhZuDk7BAQydeRuv5A0iwbPsoE1UZKDdGNwgg4fg3VkcIIOIYV3YWt1MgE"}'
2026-02-02 04:46:12.496 INFO [src.node.waku_node] REST service is ready !!
2026-02-02 04:46:12.497 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3614/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.72.122/tcp/18084/p2p/16Uiu2HAmD6adRCbaurNEWbq3NBHo5bWBRjpmaf7xCuTfFbWVs7Vk"]'
2026-02-02 04:46:12.500 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:46:12.501 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2026-02-02 04:46:12.501 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18083/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-02 04:46:12.505 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:46:12.505 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3614/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-02 04:46:12.510 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:46:12.511 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-02 04:46:12.516 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:46:12.517 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-02 04:46:12.618 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-02 04:46:12.618 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:46:12.620 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770007572511276288,"ephemeral":false,"proof":""}]'
2026-02-02 04:46:12.622 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-02 04:46:12.622 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3614/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:46:12.624 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770007572511276288,"ephemeral":false,"proof":""}]'
2026-02-02 04:46:12.626 INFO [src.steps.relay] WARM UP successful!!
2026-02-02 04:46:12.627 DEBUG [tests.relay.test_publish] Running test with timestamp Timestamp as string number
2026-02-02 04:46:12.627 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-02 04:46:12.630 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-02 04:46:12.630 DEBUG [tests.relay.test_publish] Running test with timestamp Invalid large number
2026-02-02 04:46:12.631 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-02 04:46:12.633 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-02 04:46:12.634 DEBUG [tests.relay.test_publish] Running test with timestamp Float number
2026-02-02 04:46:12.634 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-02 04:46:12.637 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-02 04:46:12.637 DEBUG [tests.relay.test_publish] Running test with timestamp Array instead of timestamp
2026-02-02 04:46:12.638 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-02 04:46:12.640 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-02 04:46:12.641 DEBUG [tests.relay.test_publish] Running test with timestamp Object instead of timestamp
2026-02-02 04:46:12.641 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-02 04:46:12.644 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-02 04:46:12.644 DEBUG [tests.relay.test_publish] Running test with timestamp ISO 8601 timestamp
2026-02-02 04:46:12.645 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-02 04:46:12.647 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-02 04:46:12.648 DEBUG [tests.relay.test_publish] Running test with timestamp Missing
2026-02-02 04:46:12.648 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-02 04:46:12.650 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:18083/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-02 04:46:12.653 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-02 04:46:12.654 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-02 04:46:12.654 DEBUG [src.node.waku_node] Stopping container with id b4561ea40eca
2026-02-02 04:46:13.235 DEBUG [src.node.waku_node] Container stopped.
2026-02-02 04:46:13.237 DEBUG [src.node.waku_node] Stopping container with id 5858e3f573e2
2026-02-02 04:46:13.779 DEBUG [src.node.waku_node] Container stopped.
2026-02-02 04:46:13.782 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-02 04:46:13.788 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-02 04:46:13.792 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
