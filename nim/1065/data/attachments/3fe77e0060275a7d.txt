2026-02-02 04:41:21.914 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-02 04:41:21.915 DEBUG [tests.conftest] Running test: test_subscribe_and_publish_on_another_content_topic_from_another_shard with id: 2026-02-02_04-41-21__9c5a67e8-35ca-417e-bb20-040c7c301522
2026-02-02 04:41:21.915 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-02 04:41:21.915 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-02 04:41:21.916 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-02 04:41:21.924 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-02 04:41:21.924 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-02_04-41-21__9c5a67e8-35ca-417e-bb20-040c7c301522__wakuorg_nwaku:latest.log
2026-02-02 04:41:21.925 DEBUG [src.node.waku_node] Starting Node...
2026-02-02 04:41:21.925 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-02 04:41:21.926 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-02 04:41:21.927 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.81.231
2026-02-02 04:41:21.927 DEBUG [src.node.docker_mananger] Generated ports ['50408', '50409', '50410', '50411', '50412']
2026-02-02 04:41:21.927 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-02 04:41:21.927 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-02 04:41:21.927 DEBUG [src.node.waku_node] Using volumes []
2026-02-02 04:41:21.927 DEBUG [src.node.docker_mananger] docker run -i -t -p 50408:50408 -p 50409:50409 -p 50410:50410 -p 50411:50411 -p 50412:50412 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=50410 --rest-port=50408 --tcp-port=50409 --discv5-udp-port=50411 --rest-address=0.0.0.0 --nat=extip:172.18.81.231 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=06f4bdadcfeda0c08ca09a4d88ca7c828aba848f06eb7feaccc0fece3c738989 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=50412 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto --num-shards-in-network=8
2026-02-02 04:41:22.121 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.81.231 waku e3c337eb059c9409b4c3be5c0d0e499f5ba8d0e00414f69ffeeda64f9312748e
2026-02-02 04:41:22.151 DEBUG [src.node.docker_mananger] Container started with ID e3c337eb059c. Setting up logs at ./log/docker/node1_2026-02-02_04-41-21__9c5a67e8-35ca-417e-bb20-040c7c301522__wakuorg_nwaku:latest.log
2026-02-02 04:41:22.153 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 50408
2026-02-02 04:41:22.153 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-02 04:41:22.721 ERROR [src.node.docker_mananger] Max retries reached for container a06790ef6ad0. Exiting log stream.
2026-02-02 04:41:23.153 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50408/health" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:23.157 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-02 04:41:23.157 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-02 04:41:23.157 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50408/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:23.159 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.81.231/tcp/50409/p2p/16Uiu2HAmAmGVJrJTyZ7GVRXeLb6GnQQu66VJEUk68GZdW4XK9xzR","/ip4/172.18.81.231/tcp/50410/ws/p2p/16Uiu2HAmAmGVJrJTyZ7GVRXeLb6GnQQu66VJEUk68GZdW4XK9xzR"],"enrUri":"enr:-L24QMSOX0uDMeMQ-SOvhJiXTHXckx1S-PAO5p_iOu5zfNRBLcFq5pwhkLzXFRl4s-6LCiTNzyc1ygs0eWfBhw0LQGICgmlkgnY0gmlwhKwSUeeKbXVsdGlhZGRyc5YACASsElHnBsTpAAoErBJR5wbE6t0DgnJzhQACAQAAiXNlY3AyNTZrMaEC4-RbzBnKzn32U6Bdi15WDEN__4I7XDgsLgYvPgYO8B6DdGNwgsTpg3VkcILE64V3YWt1MgU"}'
2026-02-02 04:41:23.160 INFO [src.node.waku_node] REST service is ready !!
2026-02-02 04:41:23.167 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-02 04:41:23.167 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-02_04-41-21__9c5a67e8-35ca-417e-bb20-040c7c301522__wakuorg_nwaku:latest.log
2026-02-02 04:41:23.167 DEBUG [src.node.waku_node] Starting Node...
2026-02-02 04:41:23.167 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-02 04:41:23.168 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-02 04:41:23.169 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.118.129
2026-02-02 04:41:23.169 DEBUG [src.node.docker_mananger] Generated ports ['62464', '62465', '62466', '62467', '62468']
2026-02-02 04:41:23.169 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-02 04:41:23.169 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-02 04:41:23.169 DEBUG [src.node.waku_node] Using volumes []
2026-02-02 04:41:23.169 DEBUG [src.node.docker_mananger] docker run -i -t -p 62464:62464 -p 62465:62465 -p 62466:62466 -p 62467:62467 -p 62468:62468 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=62466 --rest-port=62464 --tcp-port=62465 --discv5-udp-port=62467 --rest-address=0.0.0.0 --nat=extip:172.18.118.129 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=bbb62e7ff7c23ffb30ed91dbcffdd851fcbefdacab586feefdead032b49aa4bf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=62468 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QMSOX0uDMeMQ-SOvhJiXTHXckx1S-PAO5p_iOu5zfNRBLcFq5pwhkLzXFRl4s-6LCiTNzyc1ygs0eWfBhw0LQGICgmlkgnY0gmlwhKwSUeeKbXVsdGlhZGRyc5YACASsElHnBsTpAAoErBJR5wbE6t0DgnJzhQACAQAAiXNlY3AyNTZrMaEC4-RbzBnKzn32U6Bdi15WDEN__4I7XDgsLgYvPgYO8B6DdGNwgsTpg3VkcILE64V3YWt1MgU --content-topic=/myapp/1/latest/proto --num-shards-in-network=8
2026-02-02 04:41:23.363 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.118.129 waku e05d37319cd5738f1cb4b5545db9339cd9569abae2b322b8d48ad7a920377f22
2026-02-02 04:41:23.392 DEBUG [src.node.docker_mananger] Container started with ID e05d37319cd5. Setting up logs at ./log/docker/node2_2026-02-02_04-41-21__9c5a67e8-35ca-417e-bb20-040c7c301522__wakuorg_nwaku:latest.log
2026-02-02 04:41:23.393 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 62464
2026-02-02 04:41:23.394 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-02 04:41:24.394 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62464/health" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:24.410 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-02 04:41:24.412 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-02 04:41:24.413 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62464/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:24.420 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.118.129/tcp/62465/p2p/16Uiu2HAmQqcJ81X4fXfjULAV4EkYkhCeGL4mFyyWapQBncmRQ8Su","/ip4/172.18.118.129/tcp/62466/ws/p2p/16Uiu2HAmQqcJ81X4fXfjULAV4EkYkhCeGL4mFyyWapQBncmRQ8Su"],"enrUri":"enr:-L24QC8J6jcRYiOxhbJ0ZzsPTfBu2LfLaoiwoxIfh_SdGYGeNajiJ1YrMoIdHhly6nelmWX37BuknC9aHc3YLbzAjvcCgmlkgnY0gmlwhKwSdoGKbXVsdGlhZGRyc5YACASsEnaBBvQBAAoErBJ2gQb0At0DgnJzhQACAQAAiXNlY3AyNTZrMaEDtQSx3KApIDU88VwMKhygk_rLmpbpDXR0mDOHcF1207KDdGNwgvQBg3VkcIL0A4V3YWt1MgE"}'
2026-02-02 04:41:24.420 INFO [src.node.waku_node] REST service is ready !!
2026-02-02 04:41:24.421 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62464/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.81.231/tcp/50409/p2p/16Uiu2HAmAmGVJrJTyZ7GVRXeLb6GnQQu66VJEUk68GZdW4XK9xzR"]'
2026-02-02 04:41:24.423 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:41:24.424 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50408/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/toychat/2/huilong/proto"]'
2026-02-02 04:41:24.428 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:41:24.428 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62464/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/toychat/2/huilong/proto"]'
2026-02-02 04:41:24.433 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:41:24.434 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50408/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/toychat/2/huilong/proto", "timestamp": '$(date +%s%N)'}'
2026-02-02 04:41:24.439 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:41:24.440 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-02 04:41:24.540 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-02 04:41:24.541 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50408/relay/v1/auto/messages/%2Ftoychat%2F2%2Fhuilong%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:24.544 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/toychat/2/huilong/proto","version":0,"timestamp":1770007284434390544,"ephemeral":false,"proof":""}]'
2026-02-02 04:41:24.546 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-02 04:41:24.546 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62464/relay/v1/auto/messages/%2Ftoychat%2F2%2Fhuilong%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:24.548 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/toychat/2/huilong/proto","version":0,"timestamp":1770007284434390544,"ephemeral":false,"proof":""}]'
2026-02-02 04:41:24.550 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50408/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-02 04:41:24.554 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:41:24.555 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-02 04:41:24.655 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-02 04:41:24.656 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50408/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:24.659 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770007284550356366,"ephemeral":false,"proof":""}]'
2026-02-02 04:41:24.660 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-02 04:41:24.660 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62464/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:24.663 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770007284550356366,"ephemeral":false,"proof":""}]'
2026-02-02 04:41:24.666 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-02 04:41:24.667 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-02 04:41:24.667 DEBUG [src.node.waku_node] Stopping container with id e3c337eb059c
2026-02-02 04:41:25.249 DEBUG [src.node.waku_node] Container stopped.
2026-02-02 04:41:25.249 DEBUG [src.node.waku_node] Stopping container with id e05d37319cd5
2026-02-02 04:41:25.796 DEBUG [src.node.waku_node] Container stopped.
2026-02-02 04:41:25.797 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-02 04:41:25.803 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-02 04:41:25.809 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
