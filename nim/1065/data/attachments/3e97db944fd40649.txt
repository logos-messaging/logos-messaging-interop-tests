2026-02-02 04:41:46.539 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-02 04:41:46.540 DEBUG [tests.conftest] Running test: test_message_with_both_ephemeral_true_and_false with id: 2026-02-02_04-41-46__3db93e41-60a7-488e-9979-432732f2005e
2026-02-02 04:41:46.540 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-02 04:41:46.540 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-02-02 04:41:46.540 DEBUG [src.steps.store] Running fixture setup: node_setup
2026-02-02 04:41:46.547 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-02 04:41:46.547 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-02-02_04-41-46__3db93e41-60a7-488e-9979-432732f2005e__wakuorg_nwaku:latest.log
2026-02-02 04:41:46.547 DEBUG [src.node.waku_node] Starting Node...
2026-02-02 04:41:46.547 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-02 04:41:46.548 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-02 04:41:46.549 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.69.5
2026-02-02 04:41:46.549 DEBUG [src.node.docker_mananger] Generated ports ['35610', '35611', '35612', '35613', '35614']
2026-02-02 04:41:46.549 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-02 04:41:46.549 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-02 04:41:46.549 DEBUG [src.node.waku_node] Using volumes []
2026-02-02 04:41:46.549 DEBUG [src.node.docker_mananger] docker run -i -t -p 35610:35610 -p 35611:35611 -p 35612:35612 -p 35613:35613 -p 35614:35614 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=35612 --rest-port=35610 --tcp-port=35611 --discv5-udp-port=35613 --rest-address=0.0.0.0 --nat=extip:172.18.69.5 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c2a8aaa313866bf121ea0dabcbd3f3196c888f6fd630ad3c2b581531ab3b98e6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=35614 --metrics-logging=true --store=true --relay=true
2026-02-02 04:41:46.734 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.69.5 waku a4badf448d3880592695e67f82fb9eef4eaac0e4f18a2b64d90e27eacf8bced9
2026-02-02 04:41:46.767 DEBUG [src.node.docker_mananger] Container started with ID a4badf448d38. Setting up logs at ./log/docker/publishing_node1_2026-02-02_04-41-46__3db93e41-60a7-488e-9979-432732f2005e__wakuorg_nwaku:latest.log
2026-02-02 04:41:46.768 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 35610
2026-02-02 04:41:46.769 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-02 04:41:46.776 ERROR [src.node.docker_mananger] Max retries reached for container b440d754ad22. Exiting log stream.
2026-02-02 04:41:47.341 ERROR [src.node.docker_mananger] Max retries reached for container fb14cedf7e22. Exiting log stream.
2026-02-02 04:41:47.770 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35610/health" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:47.774 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-02 04:41:47.774 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-02 04:41:47.774 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35610/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:47.777 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.69.5/tcp/35611/p2p/16Uiu2HAmLsthfLq68frndVH5WztAUqbjrKa4grqWwJzfXKxFqomZ","/ip4/172.18.69.5/tcp/35612/ws/p2p/16Uiu2HAmLsthfLq68frndVH5WztAUqbjrKa4grqWwJzfXKxFqomZ"],"enrUri":"enr:-L24QBYUsLEIZKPv0fkcTPM2mJI3IbOV5fx1duEpzogtiAA3EnzfTHgNfLqcYBo2E42VoC9GXFx0W7ghlhslpUjjrVMCgmlkgnY0gmlwhKwSRQWKbXVsdGlhZGRyc5YACASsEkUFBosbAAoErBJFBQaLHN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDeiuoqt2V31hGxfzWTP5wtx1xyDxYzsR8E_SWZqnM6dCDdGNwgosbg3VkcIKLHYV3YWt1MgM"}'
2026-02-02 04:41:47.777 INFO [src.node.waku_node] REST service is ready !!
2026-02-02 04:41:47.783 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-02 04:41:47.783 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-02-02_04-41-46__3db93e41-60a7-488e-9979-432732f2005e__wakuorg_nwaku:latest.log
2026-02-02 04:41:47.784 DEBUG [src.node.waku_node] Starting Node...
2026-02-02 04:41:47.784 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-02 04:41:47.785 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-02 04:41:47.785 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.195.219
2026-02-02 04:41:47.785 DEBUG [src.node.docker_mananger] Generated ports ['19360', '19361', '19362', '19363', '19364']
2026-02-02 04:41:47.786 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-02 04:41:47.786 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-02 04:41:47.786 DEBUG [src.node.waku_node] Using volumes []
2026-02-02 04:41:47.786 DEBUG [src.node.docker_mananger] docker run -i -t -p 19360:19360 -p 19361:19361 -p 19362:19362 -p 19363:19363 -p 19364:19364 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=19362 --rest-port=19360 --tcp-port=19361 --discv5-udp-port=19363 --rest-address=0.0.0.0 --nat=extip:172.18.195.219 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f73fdde2f9fec7deec1d2ed2aadaeac176375bc0f5a13a6ff623673b0cffd2a1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=19364 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QBYUsLEIZKPv0fkcTPM2mJI3IbOV5fx1duEpzogtiAA3EnzfTHgNfLqcYBo2E42VoC9GXFx0W7ghlhslpUjjrVMCgmlkgnY0gmlwhKwSRQWKbXVsdGlhZGRyc5YACASsEkUFBosbAAoErBJFBQaLHN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDeiuoqt2V31hGxfzWTP5wtx1xyDxYzsR8E_SWZqnM6dCDdGNwgosbg3VkcIKLHYV3YWt1MgM --storenode=/ip4/172.18.69.5/tcp/35611/p2p/16Uiu2HAmLsthfLq68frndVH5WztAUqbjrKa4grqWwJzfXKxFqomZ --store=true --relay=true
2026-02-02 04:41:47.978 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.195.219 waku d5371ce6691e0c403585bc1a65d42270777c6242d47bba82266eb3cd31a9aa0e
2026-02-02 04:41:48.009 DEBUG [src.node.docker_mananger] Container started with ID d5371ce6691e. Setting up logs at ./log/docker/store_node1_2026-02-02_04-41-46__3db93e41-60a7-488e-9979-432732f2005e__wakuorg_nwaku:latest.log
2026-02-02 04:41:48.010 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 19360
2026-02-02 04:41:48.011 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-02 04:41:49.011 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19360/health" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:49.015 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-02 04:41:49.016 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-02 04:41:49.016 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19360/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:49.018 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.195.219/tcp/19361/p2p/16Uiu2HAmDuVcU3S2JBf6frNLGd7K4twL1SFLMQqa5BYay2LV3Qq6","/ip4/172.18.195.219/tcp/19362/ws/p2p/16Uiu2HAmDuVcU3S2JBf6frNLGd7K4twL1SFLMQqa5BYay2LV3Qq6"],"enrUri":"enr:-L24QCV47tTFKUU3rWqzEZvLfIPzXOde8YOPN0FgMHI-v1ZXFrvqtMNorqE-GQEvI0tEDhXaPpiLz6Izff8y7_WI1RQCgmlkgnY0gmlwhKwSw9uKbXVsdGlhZGRyc5YACASsEsPbBkuhAAoErBLD2wZLot0DgnJzhQADAQAAiXNlY3AyNTZrMaEDEpLnj6HCTjM3B8cVmXe4XebcY--IFRQvkTlqrBGY51GDdGNwgkuhg3VkcIJLo4V3YWt1MgM"}'
2026-02-02 04:41:49.019 INFO [src.node.waku_node] REST service is ready !!
2026-02-02 04:41:49.019 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19360/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.69.5/tcp/35611/p2p/16Uiu2HAmLsthfLq68frndVH5WztAUqbjrKa4grqWwJzfXKxFqomZ"]'
2026-02-02 04:41:49.022 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:41:49.022 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35610/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-02 04:41:49.025 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:41:49.025 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19360/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-02 04:41:49.027 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:41:49.028 DEBUG [src.steps.store] Relaying message
2026-02-02 04:41:49.028 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35610/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
2026-02-02 04:41:49.032 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:41:49.032 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-02 04:41:49.233 DEBUG [src.steps.store] Relaying message
2026-02-02 04:41:49.233 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35610/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
2026-02-02 04:41:49.239 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:41:49.239 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-02 04:41:49.440 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-02 04:41:49.440 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35610/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:49.443 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3f2cb626b45bcaba4ba5647027297de83d78cc2345c3f0eb7b70d80caef58e3d"}]}'
2026-02-02 04:41:49.444 DEBUG [src.steps.store] messages length is 1
2026-02-02 04:41:49.444 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-02 04:41:49.444 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19360/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:49.447 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3f2cb626b45bcaba4ba5647027297de83d78cc2345c3f0eb7b70d80caef58e3d"}]}'
2026-02-02 04:41:49.447 DEBUG [src.steps.store] messages length is 1
2026-02-02 04:41:49.448 DEBUG [src.steps.store] Relaying message
2026-02-02 04:41:49.448 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35610/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
2026-02-02 04:41:49.452 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:41:49.453 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-02 04:41:49.653 DEBUG [src.steps.store] Relaying message
2026-02-02 04:41:49.653 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35610/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
2026-02-02 04:41:49.658 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-02 04:41:49.658 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-02 04:41:49.859 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-02 04:41:49.859 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35610/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:49.862 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3f2cb626b45bcaba4ba5647027297de83d78cc2345c3f0eb7b70d80caef58e3d"},{"messageHash":"0xbfa44bd56d0c1f724ef3c27afcb3fb366547228151790ddba30e860e1eb03400"}]}'
2026-02-02 04:41:49.862 DEBUG [src.steps.store] messages length is 2
2026-02-02 04:41:49.863 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-02 04:41:49.863 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19360/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-02 04:41:49.865 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3f2cb626b45bcaba4ba5647027297de83d78cc2345c3f0eb7b70d80caef58e3d"},{"messageHash":"0xbfa44bd56d0c1f724ef3c27afcb3fb366547228151790ddba30e860e1eb03400"}]}'
2026-02-02 04:41:49.866 DEBUG [src.steps.store] messages length is 2
2026-02-02 04:41:49.867 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-02 04:41:49.868 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-02 04:41:49.869 DEBUG [src.node.waku_node] Stopping container with id a4badf448d38
2026-02-02 04:41:50.442 DEBUG [src.node.waku_node] Container stopped.
2026-02-02 04:41:50.443 DEBUG [src.node.waku_node] Stopping container with id d5371ce6691e
2026-02-02 04:41:50.970 DEBUG [src.node.waku_node] Container stopped.
2026-02-02 04:41:50.973 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-02 04:41:50.981 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-02 04:41:50.989 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
