2026-02-11 04:46:29.442 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-11 04:46:29.442 DEBUG [tests.conftest] Running test: test_filter_get_message_duplicate_message with id: 2026-02-11_04-46-29__2b497a5c-ef0f-409c-9e03-f31e15fe8c1d
2026-02-11 04:46:29.442 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-11 04:46:29.442 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2026-02-11 04:46:29.443 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2026-02-11 04:46:29.448 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-11 04:46:29.448 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-11_04-46-29__2b497a5c-ef0f-409c-9e03-f31e15fe8c1d__wakuorg_nwaku:latest.log
2026-02-11 04:46:29.448 DEBUG [src.node.waku_node] Starting Node...
2026-02-11 04:46:29.448 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-11 04:46:29.449 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-11 04:46:29.449 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.190.132
2026-02-11 04:46:29.449 DEBUG [src.node.docker_mananger] Generated ports ['46403', '46404', '46405', '46406', '46407']
2026-02-11 04:46:29.450 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-11 04:46:29.450 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-11 04:46:29.450 DEBUG [src.node.waku_node] Using volumes []
2026-02-11 04:46:29.450 DEBUG [src.node.docker_mananger] docker run -i -t -p 46403:46403 -p 46404:46404 -p 46405:46405 -p 46406:46406 -p 46407:46407 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=46405 --rest-port=46403 --tcp-port=46404 --discv5-udp-port=46406 --rest-address=0.0.0.0 --nat=extip:172.18.190.132 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a402ecfeaddf0c9a61d67c3c8eaccaf79cb9ffc763429c2b03eaef2f9d2aecf1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=46407 --metrics-logging=true --relay=true --filter=true
2026-02-11 04:46:29.597 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.190.132 waku f2073cf49cd3a7bea0900167cb62f68b17bdb03e008199fbe0030b7e8273b2d5
2026-02-11 04:46:29.624 DEBUG [src.node.docker_mananger] Container started with ID f2073cf49cd3. Setting up logs at ./log/docker/node1_2026-02-11_04-46-29__2b497a5c-ef0f-409c-9e03-f31e15fe8c1d__wakuorg_nwaku:latest.log
2026-02-11 04:46:29.624 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 46403
2026-02-11 04:46:29.625 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-11 04:46:29.779 ERROR [src.node.docker_mananger] Max retries reached for container 203b8f9c3f04. Exiting log stream.
2026-02-11 04:46:30.248 ERROR [src.node.docker_mananger] Max retries reached for container ed75d0d8e82b. Exiting log stream.
2026-02-11 04:46:30.626 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46403/health" -H "Content-Type: application/json" -d 'None'
2026-02-11 04:46:30.629 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-11 04:46:30.629 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-11 04:46:30.629 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46403/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-11 04:46:30.631 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.190.132/tcp/46404/p2p/16Uiu2HAm3E8MksLbWRgozB9XuMaaHRwCJ7c63415SWdiYUY6bH9w","/ip4/172.18.190.132/tcp/46405/ws/p2p/16Uiu2HAm3E8MksLbWRgozB9XuMaaHRwCJ7c63415SWdiYUY6bH9w"],"enrUri":"enr:-L24QKQOeQMbHp3XbABlpHRztE2SbTN3CL4JtyOYcIpxnEYmQPFZeCpGJocTp_gdMeegtjNB5L5buXhiGpFUBPqPekgCgmlkgnY0gmlwhKwSvoSKbXVsdGlhZGRyc5YACASsEr6EBrVEAAoErBK-hAa1Rd0DgnJzhQADAQAAiXNlY3AyNTZrMaECc-haKBpy5IUybIEHt42D1cQWPGEvietnp84ZlUx4CIaDdGNwgrVEg3VkcIK1RoV3YWt1MgU"}'
2026-02-11 04:46:30.631 INFO [src.node.waku_node] REST service is ready !!
2026-02-11 04:46:30.632 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2026-02-11 04:46:30.637 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-11 04:46:30.637 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-11_04-46-29__2b497a5c-ef0f-409c-9e03-f31e15fe8c1d__wakuorg_nwaku:latest.log
2026-02-11 04:46:30.637 DEBUG [src.node.waku_node] Starting Node...
2026-02-11 04:46:30.637 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-11 04:46:30.638 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-11 04:46:30.639 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.14.25
2026-02-11 04:46:30.639 DEBUG [src.node.docker_mananger] Generated ports ['36768', '36769', '36770', '36771', '36772']
2026-02-11 04:46:30.639 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-11 04:46:30.639 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-11 04:46:30.639 DEBUG [src.node.waku_node] Using volumes []
2026-02-11 04:46:30.639 DEBUG [src.node.docker_mananger] docker run -i -t -p 36768:36768 -p 36769:36769 -p 36770:36770 -p 36771:36771 -p 36772:36772 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36770 --rest-port=36768 --tcp-port=36769 --discv5-udp-port=36771 --rest-address=0.0.0.0 --nat=extip:172.18.14.25 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=31ebfa7ad995b4b2f1cf05a32af6cc3dc8ad5e6aa9f669eb0a1069b865883ac3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36772 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QKQOeQMbHp3XbABlpHRztE2SbTN3CL4JtyOYcIpxnEYmQPFZeCpGJocTp_gdMeegtjNB5L5buXhiGpFUBPqPekgCgmlkgnY0gmlwhKwSvoSKbXVsdGlhZGRyc5YACASsEr6EBrVEAAoErBK-hAa1Rd0DgnJzhQADAQAAiXNlY3AyNTZrMaECc-haKBpy5IUybIEHt42D1cQWPGEvietnp84ZlUx4CIaDdGNwgrVEg3VkcIK1RoV3YWt1MgU --filternode=/ip4/172.18.190.132/tcp/46404/p2p/16Uiu2HAm3E8MksLbWRgozB9XuMaaHRwCJ7c63415SWdiYUY6bH9w
2026-02-11 04:46:30.785 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.14.25 waku ebd0cc7dc14547283c6bddb7a34dc72ec63962c1d146d324c46f003fc3e17edb
2026-02-11 04:46:30.811 DEBUG [src.node.docker_mananger] Container started with ID ebd0cc7dc145. Setting up logs at ./log/docker/node2_2026-02-11_04-46-29__2b497a5c-ef0f-409c-9e03-f31e15fe8c1d__wakuorg_nwaku:latest.log
2026-02-11 04:46:30.811 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 36768
2026-02-11 04:46:30.811 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-11 04:46:31.811 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36768/health" -H "Content-Type: application/json" -d 'None'
2026-02-11 04:46:31.815 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-11 04:46:31.815 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-11 04:46:31.815 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36768/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-11 04:46:31.818 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.14.25/tcp/36769/p2p/16Uiu2HAmLK9zNVRHPsxQtyXXwEQBtZipSd3Hs8nED2WZPQuMzsas","/ip4/172.18.14.25/tcp/36770/ws/p2p/16Uiu2HAmLK9zNVRHPsxQtyXXwEQBtZipSd3Hs8nED2WZPQuMzsas"],"enrUri":"enr:-L24QLHl1h2lQ5EnGOAa0-XZtpFM_19dj_3LnxKUup-TG-uyInuvT7bNgjfNcoS68bmf3DJLPFhkc8fndrq7d0DZOWsCgmlkgnY0gmlwhKwSDhmKbXVsdGlhZGRyc5YACASsEg4ZBo-hAAoErBIOGQaPot0DgnJzhQADAQAAiXNlY3AyNTZrMaEDccjHSTL7QtIySz5ybUt7uy7emetklfCSfAVPf9YV8hyDdGNwgo-hg3VkcIKPo4V3YWt1MgA"}'
2026-02-11 04:46:31.818 INFO [src.node.waku_node] REST service is ready !!
2026-02-11 04:46:31.818 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36768/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.190.132/tcp/46404/p2p/16Uiu2HAm3E8MksLbWRgozB9XuMaaHRwCJ7c63415SWdiYUY6bH9w"]'
2026-02-11 04:46:31.847 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-11 04:46:31.847 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2026-02-11 04:46:31.847 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46403/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-11 04:46:31.855 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-11 04:46:31.856 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36768/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "e9106fa4-cae2-4442-97b8-27c7145718f6", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-11 04:46:31.866 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"e9106fa4-cae2-4442-97b8-27c7145718f6","statusDesc":"OK"}'
2026-02-11 04:46:31.867 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46403/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-02-11 04:46:31.873 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-11 04:46:31.873 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-11 04:46:31.973 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-11 04:46:31.974 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36768/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-11 04:46:31.976 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1770785191867508790,"ephemeral":false}]'
2026-02-11 04:46:31.978 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46403/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-02-11 04:46:31.981 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-11 04:46:31.981 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-11 04:46:32.081 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-11 04:46:32.082 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36768/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-11 04:46:32.084 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[]'
2026-02-11 04:46:32.086 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-11 04:46:32.086 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-11 04:46:32.087 DEBUG [src.node.waku_node] Stopping container with id f2073cf49cd3
2026-02-11 04:46:32.575 DEBUG [src.node.waku_node] Container stopped.
2026-02-11 04:46:32.576 DEBUG [src.node.waku_node] Stopping container with id ebd0cc7dc145
2026-02-11 04:46:33.012 DEBUG [src.node.waku_node] Container stopped.
2026-02-11 04:46:33.014 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-11 04:46:33.019 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-11 04:46:33.023 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
