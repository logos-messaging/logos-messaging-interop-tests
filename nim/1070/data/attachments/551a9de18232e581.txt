2026-02-05 04:41:41.855 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-05 04:41:41.856 DEBUG [tests.conftest] Running test: test_subscribe_and_publish_on_another_shard with id: 2026-02-05_04-41-41__240bb2a7-5eb7-447c-b686-b275bbc45d99
2026-02-05 04:41:41.856 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-05 04:41:41.856 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-05 04:41:41.856 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-05 04:41:41.863 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-05 04:41:41.863 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-05_04-41-41__240bb2a7-5eb7-447c-b686-b275bbc45d99__wakuorg_nwaku:latest.log
2026-02-05 04:41:41.863 DEBUG [src.node.waku_node] Starting Node...
2026-02-05 04:41:41.864 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-05 04:41:41.865 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-05 04:41:41.865 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.66.195
2026-02-05 04:41:41.865 DEBUG [src.node.docker_mananger] Generated ports ['15957', '15958', '15959', '15960', '15961']
2026-02-05 04:41:41.865 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-05 04:41:41.866 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-05 04:41:41.866 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-05 04:41:41.866 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-05 04:41:41.866 DEBUG [src.node.waku_node] Using volumes []
2026-02-05 04:41:41.866 DEBUG [src.node.docker_mananger] docker run -i -t -p 15957:15957 -p 15958:15958 -p 15959:15959 -p 15960:15960 -p 15961:15961 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15959 --rest-port=15957 --tcp-port=15958 --discv5-udp-port=15960 --rest-address=0.0.0.0 --nat=extip:172.18.66.195 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=e5b99fdc5ecf98752fd0b1ebfde7efa57fe0d8dfc1fafe1fefdd879e4f6b3dbd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15961 --metrics-logging=true --relay=true --filter=true
2026-02-05 04:41:42.041 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.66.195 waku 5821716b4f4cb11c91b62298b911ba086225bb5989a1695d9d565fe3eb8c8cfb
2026-02-05 04:41:42.070 DEBUG [src.node.docker_mananger] Container started with ID 5821716b4f4c. Setting up logs at ./log/docker/node1_2026-02-05_04-41-41__240bb2a7-5eb7-447c-b686-b275bbc45d99__wakuorg_nwaku:latest.log
2026-02-05 04:41:42.071 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 15957
2026-02-05 04:41:42.071 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-05 04:41:42.113 ERROR [src.node.docker_mananger] Max retries reached for container 2d0a0fe07226. Exiting log stream.
2026-02-05 04:41:42.629 ERROR [src.node.docker_mananger] Max retries reached for container e0ecb73fcaef. Exiting log stream.
2026-02-05 04:41:43.071 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15957/health" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:41:43.074 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-05 04:41:43.074 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-05 04:41:43.074 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15957/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:41:43.077 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.66.195/tcp/15958/p2p/16Uiu2HAm7QniB4dyHhdqUKzoHWvedY86b1DNvGpedooURz1Eq6zx","/ip4/172.18.66.195/tcp/15959/ws/p2p/16Uiu2HAm7QniB4dyHhdqUKzoHWvedY86b1DNvGpedooURz1Eq6zx"],"enrUri":"enr:-L24QJXiQKs6wV0OTsskgRhUNUTTeDjkoQAH0fFiH0Y5B78jS1CME_C8RK6vmZexvT3Merulzv8bSwYs1cDKInwg2acCgmlkgnY0gmlwhKwSQsOKbXVsdGlhZGRyc5YACASsEkLDBj5WAAoErBJCwwY-V90DgnJzhQACAQAAiXNlY3AyNTZrMaECshJF0iM_MBydcI0s4uaTwAXi0RFUnL6ivtRu5prRb2WDdGNwgj5Wg3VkcII-WIV3YWt1MgU"}'
2026-02-05 04:41:43.077 INFO [src.node.waku_node] REST service is ready !!
2026-02-05 04:41:43.083 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-05 04:41:43.083 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-05_04-41-41__240bb2a7-5eb7-447c-b686-b275bbc45d99__wakuorg_nwaku:latest.log
2026-02-05 04:41:43.083 DEBUG [src.node.waku_node] Starting Node...
2026-02-05 04:41:43.084 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-05 04:41:43.085 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-05 04:41:43.085 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.81.106
2026-02-05 04:41:43.085 DEBUG [src.node.docker_mananger] Generated ports ['4871', '4872', '4873', '4874', '4875']
2026-02-05 04:41:43.085 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-05 04:41:43.085 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-05 04:41:43.085 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-05 04:41:43.086 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-05 04:41:43.086 DEBUG [src.node.waku_node] Using volumes []
2026-02-05 04:41:43.086 DEBUG [src.node.docker_mananger] docker run -i -t -p 4871:4871 -p 4872:4872 -p 4873:4873 -p 4874:4874 -p 4875:4875 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=4873 --rest-port=4871 --tcp-port=4872 --discv5-udp-port=4874 --rest-address=0.0.0.0 --nat=extip:172.18.81.106 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=fd43aee1b826dbaa30ca0dedcda0c0bbd78e168a63e70ade0f22269608448510 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=4875 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QJXiQKs6wV0OTsskgRhUNUTTeDjkoQAH0fFiH0Y5B78jS1CME_C8RK6vmZexvT3Merulzv8bSwYs1cDKInwg2acCgmlkgnY0gmlwhKwSQsOKbXVsdGlhZGRyc5YACASsEkLDBj5WAAoErBJCwwY-V90DgnJzhQACAQAAiXNlY3AyNTZrMaECshJF0iM_MBydcI0s4uaTwAXi0RFUnL6ivtRu5prRb2WDdGNwgj5Wg3VkcII-WIV3YWt1MgU
2026-02-05 04:41:43.259 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.81.106 waku 13c505f826f0ec6ee33ae62f7acaa97752695d9d8800d4850b4d3883665e1b20
2026-02-05 04:41:43.291 DEBUG [src.node.docker_mananger] Container started with ID 13c505f826f0. Setting up logs at ./log/docker/node2_2026-02-05_04-41-41__240bb2a7-5eb7-447c-b686-b275bbc45d99__wakuorg_nwaku:latest.log
2026-02-05 04:41:43.291 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 4871
2026-02-05 04:41:43.291 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-05 04:41:44.293 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:4871/health" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:41:44.306 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-05 04:41:44.306 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-05 04:41:44.306 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:4871/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:41:44.310 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.81.106/tcp/4872/p2p/16Uiu2HAmEqUhXqBMwHG52eC3zAhmtHpffAbHzDx7J94LtNFMRvcZ","/ip4/172.18.81.106/tcp/4873/ws/p2p/16Uiu2HAmEqUhXqBMwHG52eC3zAhmtHpffAbHzDx7J94LtNFMRvcZ"],"enrUri":"enr:-L24QB4JGBw76t4XEMK0g1uUz7f8s8aMj9XY8sK9L9iBN2FANTMOs560My3Z3n_MUx_mef0lIoR3GDuOjKmiI7C6IXgCgmlkgnY0gmlwhKwSUWqKbXVsdGlhZGRyc5YACASsElFqBhMIAAoErBJRagYTCd0DgnJzhQACAQAAiXNlY3AyNTZrMaEDIGc8fCzZICM_bAvBuvJzjhbk_RaqOYOSGW6HTzWPLAKDdGNwghMIg3VkcIITCoV3YWt1MgE"}'
2026-02-05 04:41:44.311 INFO [src.node.waku_node] REST service is ready !!
2026-02-05 04:41:44.312 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:4871/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.66.195/tcp/15958/p2p/16Uiu2HAm7QniB4dyHhdqUKzoHWvedY86b1DNvGpedooURz1Eq6zx"]'
2026-02-05 04:41:44.316 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:41:44.316 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15957/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
2026-02-05 04:41:44.319 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:41:44.320 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:4871/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
2026-02-05 04:41:44.325 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:41:44.326 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15957/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-05 04:41:44.331 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:41:44.331 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-05 04:41:44.431 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-05 04:41:44.432 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15957/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:41:44.434 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770266504326022981,"ephemeral":false,"proof":""}]'
2026-02-05 04:41:44.436 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-05 04:41:44.436 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:4871/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:41:44.438 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770266504326022981,"ephemeral":false,"proof":""}]'
2026-02-05 04:41:44.440 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15957/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-05 04:41:44.444 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:41:44.444 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-05 04:41:44.544 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-05 04:41:44.545 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15957/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:41:44.547 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770266504440085429,"ephemeral":false,"proof":""}]'
2026-02-05 04:41:44.548 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-05 04:41:44.548 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:4871/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:41:44.550 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770266504440085429,"ephemeral":false,"proof":""}]'
2026-02-05 04:41:44.553 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-05 04:41:44.554 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-05 04:41:44.554 DEBUG [src.node.waku_node] Stopping container with id 5821716b4f4c
2026-02-05 04:41:45.039 DEBUG [src.node.waku_node] Container stopped.
2026-02-05 04:41:45.039 DEBUG [src.node.waku_node] Stopping container with id 13c505f826f0
2026-02-05 04:41:45.508 DEBUG [src.node.waku_node] Container stopped.
2026-02-05 04:41:45.508 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-05 04:41:45.515 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-05 04:41:45.521 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
