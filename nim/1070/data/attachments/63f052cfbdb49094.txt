2026-02-05 04:34:02.134 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-05 04:34:02.135 DEBUG [tests.conftest] Running test: test_publish_with_invalid_payloads with id: 2026-02-05_04-34-02__f02db407-d469-4a58-a697-dabe34755bee
2026-02-05 04:34:02.135 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-05 04:34:02.135 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-05 04:34:02.135 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2026-02-05 04:34:02.144 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-05 04:34:02.144 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-05_04-34-02__f02db407-d469-4a58-a697-dabe34755bee__wakuorg_nwaku:latest.log
2026-02-05 04:34:02.144 DEBUG [src.node.waku_node] Starting Node...
2026-02-05 04:34:02.144 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-05 04:34:02.146 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-05 04:34:02.146 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.241.193
2026-02-05 04:34:02.146 DEBUG [src.node.docker_mananger] Generated ports ['61910', '61911', '61912', '61913', '61914']
2026-02-05 04:34:02.146 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-05 04:34:02.147 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-05 04:34:02.147 DEBUG [src.node.waku_node] Using volumes []
2026-02-05 04:34:02.147 DEBUG [src.node.docker_mananger] docker run -i -t -p 61910:61910 -p 61911:61911 -p 61912:61912 -p 61913:61913 -p 61914:61914 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61912 --rest-port=61910 --tcp-port=61911 --discv5-udp-port=61913 --rest-address=0.0.0.0 --nat=extip:172.18.241.193 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8474ccbdd6864efb4a18da09ce9e7bc27e1adfbd3dd7fbfbcca9221457931cee --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61914 --metrics-logging=true --relay=true
2026-02-05 04:34:02.335 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.241.193 waku 7d0dab07f5b3730a00f0c4209d094646e851bf852c8542cd56504aa15684999e
2026-02-05 04:34:02.349 ERROR [src.node.docker_mananger] Max retries reached for container f729191ab758. Exiting log stream.
2026-02-05 04:34:02.368 DEBUG [src.node.docker_mananger] Container started with ID 7d0dab07f5b3. Setting up logs at ./log/docker/node1_2026-02-05_04-34-02__f02db407-d469-4a58-a697-dabe34755bee__wakuorg_nwaku:latest.log
2026-02-05 04:34:02.369 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 61910
2026-02-05 04:34:02.369 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-05 04:34:02.942 ERROR [src.node.docker_mananger] Max retries reached for container b43dad43d3eb. Exiting log stream.
2026-02-05 04:34:03.370 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61910/health" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:34:03.374 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-05 04:34:03.374 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-05 04:34:03.374 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61910/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:34:03.377 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.241.193/tcp/61911/p2p/16Uiu2HAmBAFgS5Nem1x8EDjfBHtuvpX4qFLdHoMRhMhixCXePAD2","/ip4/172.18.241.193/tcp/61912/ws/p2p/16Uiu2HAmBAFgS5Nem1x8EDjfBHtuvpX4qFLdHoMRhMhixCXePAD2"],"enrUri":"enr:-L24QPqK0cD4UVWnJ3uXWruMJeunor13Sm7cEHH63-XXZhpkfOHuBomb8MwaqZx_kg-tHnS5wMYLG9zUDFs4SA7b5OsCgmlkgnY0gmlwhKwS8cGKbXVsdGlhZGRyc5YACASsEvHBBvHXAAoErBLxwQbx2N0DgnJzhQADAQAAiXNlY3AyNTZrMaEC6cfNqQnl_w2g70jHI__h9l2X8ZvuVjhhWM6-okNM872DdGNwgvHXg3VkcILx2YV3YWt1MgE"}'
2026-02-05 04:34:03.377 INFO [src.node.waku_node] REST service is ready !!
2026-02-05 04:34:03.384 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-05 04:34:03.384 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-05_04-34-02__f02db407-d469-4a58-a697-dabe34755bee__wakuorg_nwaku:latest.log
2026-02-05 04:34:03.384 DEBUG [src.node.waku_node] Starting Node...
2026-02-05 04:34:03.384 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-05 04:34:03.386 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-05 04:34:03.386 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.116.187
2026-02-05 04:34:03.386 DEBUG [src.node.docker_mananger] Generated ports ['53682', '53683', '53684', '53685', '53686']
2026-02-05 04:34:03.386 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-05 04:34:03.387 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-05 04:34:03.387 DEBUG [src.node.waku_node] Using volumes []
2026-02-05 04:34:03.387 DEBUG [src.node.docker_mananger] docker run -i -t -p 53682:53682 -p 53683:53683 -p 53684:53684 -p 53685:53685 -p 53686:53686 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=53684 --rest-port=53682 --tcp-port=53683 --discv5-udp-port=53685 --rest-address=0.0.0.0 --nat=extip:172.18.116.187 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d4ce2f299b6fe8a3b3e0aad2b0fadbb2fbac6cb77e70c61baaab0b4e383992f2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=53686 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QPqK0cD4UVWnJ3uXWruMJeunor13Sm7cEHH63-XXZhpkfOHuBomb8MwaqZx_kg-tHnS5wMYLG9zUDFs4SA7b5OsCgmlkgnY0gmlwhKwS8cGKbXVsdGlhZGRyc5YACASsEvHBBvHXAAoErBLxwQbx2N0DgnJzhQADAQAAiXNlY3AyNTZrMaEC6cfNqQnl_w2g70jHI__h9l2X8ZvuVjhhWM6-okNM872DdGNwgvHXg3VkcILx2YV3YWt1MgE
2026-02-05 04:34:03.588 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.116.187 waku 36956749da9459f48292b5904cb86f75a2478b7e252b3bce978237e0a6e68c37
2026-02-05 04:34:03.620 DEBUG [src.node.docker_mananger] Container started with ID 36956749da94. Setting up logs at ./log/docker/node2_2026-02-05_04-34-02__f02db407-d469-4a58-a697-dabe34755bee__wakuorg_nwaku:latest.log
2026-02-05 04:34:03.620 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 53682
2026-02-05 04:34:03.620 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-05 04:34:04.621 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53682/health" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:34:04.635 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-05 04:34:04.636 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-05 04:34:04.637 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53682/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:34:04.643 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.116.187/tcp/53683/p2p/16Uiu2HAm59aUxcSq4u4q4n8d1C7NPSRV9UqDQqQG1w6YnHHgWWyN","/ip4/172.18.116.187/tcp/53684/ws/p2p/16Uiu2HAm59aUxcSq4u4q4n8d1C7NPSRV9UqDQqQG1w6YnHHgWWyN"],"enrUri":"enr:-L24QIrrmXlrV9H8vHM3BlzyBMT9u1QcqSX5PQ8gcketNHi7EebyoOLSlzgRVftTAO9BNlphFYW8bQbnWyXE2FM578oCgmlkgnY0gmlwhKwSdLuKbXVsdGlhZGRyc5YACASsEnS7BtGzAAoErBJ0uwbRtN0DgnJzhQADAQAAiXNlY3AyNTZrMaECkHVcVfjbTD6hgAe_usgZ6nzoWuFyGhIqLcxLYqsvPVGDdGNwgtGzg3VkcILRtYV3YWt1MgE"}'
2026-02-05 04:34:04.644 INFO [src.node.waku_node] REST service is ready !!
2026-02-05 04:34:04.644 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53682/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.241.193/tcp/61911/p2p/16Uiu2HAmBAFgS5Nem1x8EDjfBHtuvpX4qFLdHoMRhMhixCXePAD2"]'
2026-02-05 04:34:04.647 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:34:04.648 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2026-02-05 04:34:04.648 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61910/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-05 04:34:04.652 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:34:04.652 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53682/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-05 04:34:04.657 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:34:04.658 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-05 04:34:04.664 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:34:04.665 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-05 04:34:04.765 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-05 04:34:04.765 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:34:04.768 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770266044658510080,"ephemeral":false,"proof":""}]'
2026-02-05 04:34:04.770 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-05 04:34:04.770 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53682/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:34:04.773 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770266044658510080,"ephemeral":false,"proof":""}]'
2026-02-05 04:34:04.774 INFO [src.steps.relay] WARM UP successful!!
2026-02-05 04:34:04.775 DEBUG [tests.relay.test_publish] Running test with payload Empty string
2026-02-05 04:34:04.776 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-05 04:34:04.778 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:61910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-05 04:34:04.778 DEBUG [tests.relay.test_publish] Running test with payload Unecoded text
2026-02-05 04:34:04.779 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "Hello World!", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-05 04:34:04.781 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:61910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Incorrect base64 string'
2026-02-05 04:34:04.781 DEBUG [tests.relay.test_publish] Running test with payload A dictionary
2026-02-05 04:34:04.782 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": {"key": "YWFh"}, "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-05 04:34:04.784 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:61910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-05 04:34:04.785 DEBUG [tests.relay.test_publish] Running test with payload An integer
2026-02-05 04:34:04.785 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": 1234567890, "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-05 04:34:04.787 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:61910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-05 04:34:04.788 DEBUG [tests.relay.test_publish] Running test with payload A list
2026-02-05 04:34:04.788 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": ["YWFh"], "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-05 04:34:04.790 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:61910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-05 04:34:04.791 DEBUG [tests.relay.test_publish] Running test with payload A bool
2026-02-05 04:34:04.791 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": true, "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-05 04:34:04.793 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:61910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-05 04:34:04.795 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-05 04:34:04.796 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-05 04:34:04.796 DEBUG [src.node.waku_node] Stopping container with id 7d0dab07f5b3
2026-02-05 04:34:05.364 DEBUG [src.node.waku_node] Container stopped.
2026-02-05 04:34:05.365 DEBUG [src.node.waku_node] Stopping container with id 36956749da94
2026-02-05 04:34:05.916 DEBUG [src.node.waku_node] Container stopped.
2026-02-05 04:34:05.917 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-05 04:34:05.924 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-05 04:34:05.930 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
