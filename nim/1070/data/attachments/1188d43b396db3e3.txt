2026-02-05 04:36:56.153 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-05 04:36:56.153 DEBUG [tests.conftest] Running test: test_subscribe_and_publish_on_another_content_topic_from_same_shard with id: 2026-02-05_04-36-56__43fef765-48c2-4605-98ce-f1c76562691f
2026-02-05 04:36:56.154 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-05 04:36:56.154 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-05 04:36:56.154 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-05 04:36:56.161 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-05 04:36:56.161 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-05_04-36-56__43fef765-48c2-4605-98ce-f1c76562691f__wakuorg_nwaku:latest.log
2026-02-05 04:36:56.162 DEBUG [src.node.waku_node] Starting Node...
2026-02-05 04:36:56.162 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-05 04:36:56.163 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-05 04:36:56.163 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.85.91
2026-02-05 04:36:56.163 DEBUG [src.node.docker_mananger] Generated ports ['13599', '13600', '13601', '13602', '13603']
2026-02-05 04:36:56.163 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-05 04:36:56.164 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-05 04:36:56.164 DEBUG [src.node.waku_node] Using volumes []
2026-02-05 04:36:56.164 DEBUG [src.node.docker_mananger] docker run -i -t -p 13599:13599 -p 13600:13600 -p 13601:13601 -p 13602:13602 -p 13603:13603 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=13601 --rest-port=13599 --tcp-port=13600 --discv5-udp-port=13602 --rest-address=0.0.0.0 --nat=extip:172.18.85.91 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=dea9aec5bbd5aee646e5c9ffd17c53be70ae8c40cfbdf7f8d107ba0b1cca45c0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=13603 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto --num-shards-in-network=8
2026-02-05 04:36:56.348 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.85.91 waku 41e364b76bbd084cb39992df8f7e6d3fc6d5ea5f4268e8ff06bfa2842b713f36
2026-02-05 04:36:56.380 DEBUG [src.node.docker_mananger] Container started with ID 41e364b76bbd. Setting up logs at ./log/docker/node1_2026-02-05_04-36-56__43fef765-48c2-4605-98ce-f1c76562691f__wakuorg_nwaku:latest.log
2026-02-05 04:36:56.382 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 13599
2026-02-05 04:36:56.382 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-05 04:36:56.405 ERROR [src.node.docker_mananger] Max retries reached for container 4d269e26dd46. Exiting log stream.
2026-02-05 04:36:56.952 ERROR [src.node.docker_mananger] Max retries reached for container f27db1135f4d. Exiting log stream.
2026-02-05 04:36:57.382 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13599/health" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:36:57.385 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-05 04:36:57.386 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-05 04:36:57.386 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13599/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:36:57.388 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.85.91/tcp/13600/p2p/16Uiu2HAkwdFbaRCRyyuECYRmtvv9ApE2TM9xXmmpLDBoex1g62LE","/ip4/172.18.85.91/tcp/13601/ws/p2p/16Uiu2HAkwdFbaRCRyyuECYRmtvv9ApE2TM9xXmmpLDBoex1g62LE"],"enrUri":"enr:-L24QItpM_F_u0U52ekp1SpQbnTpyjsEG65TkOpYEQHfNAjVQEcSon5jJ2nBZucez8Jd_5czuh7-EmcytkTTLR-sUAcCgmlkgnY0gmlwhKwSVVuKbXVsdGlhZGRyc5YACASsElVbBjUgAAoErBJVWwY1Id0DgnJzhQACAQAAiXNlY3AyNTZrMaECIK7GCGy9NHxcB7ZrUanor9Zksrv0QsdYML9Gg0P99_eDdGNwgjUgg3VkcII1IoV3YWt1MgU"}'
2026-02-05 04:36:57.388 INFO [src.node.waku_node] REST service is ready !!
2026-02-05 04:36:57.395 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-05 04:36:57.395 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-05_04-36-56__43fef765-48c2-4605-98ce-f1c76562691f__wakuorg_nwaku:latest.log
2026-02-05 04:36:57.395 DEBUG [src.node.waku_node] Starting Node...
2026-02-05 04:36:57.395 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-05 04:36:57.396 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-05 04:36:57.397 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.106.48
2026-02-05 04:36:57.397 DEBUG [src.node.docker_mananger] Generated ports ['42090', '42091', '42092', '42093', '42094']
2026-02-05 04:36:57.397 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-05 04:36:57.397 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-05 04:36:57.397 DEBUG [src.node.waku_node] Using volumes []
2026-02-05 04:36:57.397 DEBUG [src.node.docker_mananger] docker run -i -t -p 42090:42090 -p 42091:42091 -p 42092:42092 -p 42093:42093 -p 42094:42094 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42092 --rest-port=42090 --tcp-port=42091 --discv5-udp-port=42093 --rest-address=0.0.0.0 --nat=extip:172.18.106.48 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=7d4bf47f7de4f4eb793bedb6a85afcfbca4d58b9988c5cecfc29d07c0b3c14c3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42094 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QItpM_F_u0U52ekp1SpQbnTpyjsEG65TkOpYEQHfNAjVQEcSon5jJ2nBZucez8Jd_5czuh7-EmcytkTTLR-sUAcCgmlkgnY0gmlwhKwSVVuKbXVsdGlhZGRyc5YACASsElVbBjUgAAoErBJVWwY1Id0DgnJzhQACAQAAiXNlY3AyNTZrMaECIK7GCGy9NHxcB7ZrUanor9Zksrv0QsdYML9Gg0P99_eDdGNwgjUgg3VkcII1IoV3YWt1MgU --content-topic=/myapp/1/latest/proto --num-shards-in-network=8
2026-02-05 04:36:57.592 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.106.48 waku 150fe89bfe2846820add9a93836cf902dd46b37323071ad6afd46b11449cdeab
2026-02-05 04:36:57.624 DEBUG [src.node.docker_mananger] Container started with ID 150fe89bfe28. Setting up logs at ./log/docker/node2_2026-02-05_04-36-56__43fef765-48c2-4605-98ce-f1c76562691f__wakuorg_nwaku:latest.log
2026-02-05 04:36:57.625 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 42090
2026-02-05 04:36:57.625 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-05 04:36:58.625 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42090/health" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:36:58.633 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-05 04:36:58.635 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-05 04:36:58.636 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42090/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:36:58.639 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.106.48/tcp/42091/p2p/16Uiu2HAmQtUEUpR57jHPLQGjzF7zchFNgWaLmA885vamPLXh17Vq","/ip4/172.18.106.48/tcp/42092/ws/p2p/16Uiu2HAmQtUEUpR57jHPLQGjzF7zchFNgWaLmA885vamPLXh17Vq"],"enrUri":"enr:-L24QA8AzV5gDiP4rNmJx4EAQnh5s_IxivGJK2QD5W59-Aoec9Knzd-DD2PIUf9bIwAfP4ODIShb_Sg8AvU53QxbIwICgmlkgnY0gmlwhKwSajCKbXVsdGlhZGRyc5YACASsEmowBqRrAAoErBJqMAakbN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDtcBSEeeohR685TuJzN1GlVP4yRKNZoLjG2RYQ1QIMGCDdGNwgqRrg3VkcIKkbYV3YWt1MgE"}'
2026-02-05 04:36:58.640 INFO [src.node.waku_node] REST service is ready !!
2026-02-05 04:36:58.640 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42090/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.85.91/tcp/13600/p2p/16Uiu2HAkwdFbaRCRyyuECYRmtvv9ApE2TM9xXmmpLDBoex1g62LE"]'
2026-02-05 04:36:58.643 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:36:58.644 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13599/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/newsService/1.0/weekly/protobuf"]'
2026-02-05 04:36:58.647 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:36:58.648 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42090/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/newsService/1.0/weekly/protobuf"]'
2026-02-05 04:36:58.654 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:36:58.655 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13599/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/newsService/1.0/weekly/protobuf", "timestamp": '$(date +%s%N)'}'
2026-02-05 04:36:58.660 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:36:58.660 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-05 04:36:58.761 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-05 04:36:58.761 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13599/relay/v1/auto/messages/%2FnewsService%2F1.0%2Fweekly%2Fprotobuf" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:36:58.764 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/newsService/1.0/weekly/protobuf","version":0,"timestamp":1770266218655334912,"ephemeral":false,"proof":""}]'
2026-02-05 04:36:58.765 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-05 04:36:58.765 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42090/relay/v1/auto/messages/%2FnewsService%2F1.0%2Fweekly%2Fprotobuf" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:36:58.767 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/newsService/1.0/weekly/protobuf","version":0,"timestamp":1770266218655334912,"ephemeral":false,"proof":""}]'
2026-02-05 04:36:58.769 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13599/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-05 04:36:58.773 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:36:58.774 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-05 04:36:58.874 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-05 04:36:58.875 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13599/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:36:58.877 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770266218769336352,"ephemeral":false,"proof":""}]'
2026-02-05 04:36:58.879 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-05 04:36:58.879 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42090/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:36:58.881 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770266218769336352,"ephemeral":false,"proof":""}]'
2026-02-05 04:36:58.884 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-05 04:36:58.885 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-05 04:36:58.885 DEBUG [src.node.waku_node] Stopping container with id 41e364b76bbd
2026-02-05 04:36:59.425 DEBUG [src.node.waku_node] Container stopped.
2026-02-05 04:36:59.427 DEBUG [src.node.waku_node] Stopping container with id 150fe89bfe28
2026-02-05 04:36:59.966 DEBUG [src.node.waku_node] Container stopped.
2026-02-05 04:36:59.967 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-05 04:36:59.978 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-05 04:36:59.984 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
