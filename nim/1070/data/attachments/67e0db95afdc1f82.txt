2026-02-05 04:35:13.047 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-05 04:35:13.047 DEBUG [tests.conftest] Running test: test_single_pubsub_topic[/waku/2/rs/2/1] with id: 2026-02-05_04-35-13__a57b3c79-d96d-474c-a80c-0d8fa1139694
2026-02-05 04:35:13.047 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-05 04:35:13.048 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-05 04:35:13.048 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-05 04:35:13.057 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-05 04:35:13.057 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-05_04-35-13__a57b3c79-d96d-474c-a80c-0d8fa1139694__wakuorg_nwaku:latest.log
2026-02-05 04:35:13.057 DEBUG [src.node.waku_node] Starting Node...
2026-02-05 04:35:13.058 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-05 04:35:13.059 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-05 04:35:13.059 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.191.111
2026-02-05 04:35:13.060 DEBUG [src.node.docker_mananger] Generated ports ['34700', '34701', '34702', '34703', '34704']
2026-02-05 04:35:13.060 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-05 04:35:13.060 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-05 04:35:13.060 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-05 04:35:13.060 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-05 04:35:13.060 DEBUG [src.node.waku_node] Using volumes []
2026-02-05 04:35:13.060 DEBUG [src.node.docker_mananger] docker run -i -t -p 34700:34700 -p 34701:34701 -p 34702:34702 -p 34703:34703 -p 34704:34704 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=34702 --rest-port=34700 --tcp-port=34701 --discv5-udp-port=34703 --rest-address=0.0.0.0 --nat=extip:172.18.191.111 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=19640d14f7dcc5fce530f0605bc1fde9b22ac6e88bfbe92997ea0dee9dc94e4a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=34704 --metrics-logging=true --relay=true --filter=true
2026-02-05 04:35:13.253 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.191.111 waku 1aa9f9ae12e032890c739d5873616d8a406e25780a82ceb138b533addfbe3d37
2026-02-05 04:35:13.274 ERROR [src.node.docker_mananger] Max retries reached for container 2b30d3974959. Exiting log stream.
2026-02-05 04:35:13.286 DEBUG [src.node.docker_mananger] Container started with ID 1aa9f9ae12e0. Setting up logs at ./log/docker/node1_2026-02-05_04-35-13__a57b3c79-d96d-474c-a80c-0d8fa1139694__wakuorg_nwaku:latest.log
2026-02-05 04:35:13.288 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 34700
2026-02-05 04:35:13.288 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-05 04:35:13.849 ERROR [src.node.docker_mananger] Max retries reached for container 076e92ed5829. Exiting log stream.
2026-02-05 04:35:14.288 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34700/health" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:35:14.292 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-05 04:35:14.292 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-05 04:35:14.292 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34700/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:35:14.295 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.191.111/tcp/34701/p2p/16Uiu2HAmM4fBB7ToWQAc4RyCZXgtYeSxuhmadiuDxagc876qnCDc","/ip4/172.18.191.111/tcp/34702/ws/p2p/16Uiu2HAmM4fBB7ToWQAc4RyCZXgtYeSxuhmadiuDxagc876qnCDc"],"enrUri":"enr:-L24QFRCfzy84Hn6fxncO6IFgMdfymAvCx8q_xh3JCbUyeKrff2GvpYuuiXw9PQlbfI5DvHnd3jjYT8fLyHXIRLEUMACgmlkgnY0gmlwhKwSv2-KbXVsdGlhZGRyc5YACASsEr9vBoeNAAoErBK_bwaHjt0DgnJzhQACAQAAiXNlY3AyNTZrMaEDfO3BGCVJgHWh6dPWy5vwm69O-9gMlUk06ol3pW49b4-DdGNwgoeNg3VkcIKHj4V3YWt1MgU"}'
2026-02-05 04:35:14.295 INFO [src.node.waku_node] REST service is ready !!
2026-02-05 04:35:14.303 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-05 04:35:14.303 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-05_04-35-13__a57b3c79-d96d-474c-a80c-0d8fa1139694__wakuorg_nwaku:latest.log
2026-02-05 04:35:14.303 DEBUG [src.node.waku_node] Starting Node...
2026-02-05 04:35:14.303 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-05 04:35:14.304 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-05 04:35:14.305 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.138.89
2026-02-05 04:35:14.305 DEBUG [src.node.docker_mananger] Generated ports ['34217', '34218', '34219', '34220', '34221']
2026-02-05 04:35:14.305 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-05 04:35:14.305 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-05 04:35:14.305 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-05 04:35:14.305 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-05 04:35:14.305 DEBUG [src.node.waku_node] Using volumes []
2026-02-05 04:35:14.306 DEBUG [src.node.docker_mananger] docker run -i -t -p 34217:34217 -p 34218:34218 -p 34219:34219 -p 34220:34220 -p 34221:34221 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=34219 --rest-port=34217 --tcp-port=34218 --discv5-udp-port=34220 --rest-address=0.0.0.0 --nat=extip:172.18.138.89 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=7f5bca6cafccc96a71d3b802afefcfba39cf6d0f3f74f01bebbcbbe2aaffd5e8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=34221 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QFRCfzy84Hn6fxncO6IFgMdfymAvCx8q_xh3JCbUyeKrff2GvpYuuiXw9PQlbfI5DvHnd3jjYT8fLyHXIRLEUMACgmlkgnY0gmlwhKwSv2-KbXVsdGlhZGRyc5YACASsEr9vBoeNAAoErBK_bwaHjt0DgnJzhQACAQAAiXNlY3AyNTZrMaEDfO3BGCVJgHWh6dPWy5vwm69O-9gMlUk06ol3pW49b4-DdGNwgoeNg3VkcIKHj4V3YWt1MgU
2026-02-05 04:35:14.497 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.138.89 waku 8a8fdcd8b174b6701ee4049a68de73704d95e957c8f6c4f85fbbb8468aea1224
2026-02-05 04:35:14.527 DEBUG [src.node.docker_mananger] Container started with ID 8a8fdcd8b174. Setting up logs at ./log/docker/node2_2026-02-05_04-35-13__a57b3c79-d96d-474c-a80c-0d8fa1139694__wakuorg_nwaku:latest.log
2026-02-05 04:35:14.528 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 34217
2026-02-05 04:35:14.528 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-05 04:35:15.528 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34217/health" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:35:15.544 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-05 04:35:15.544 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-05 04:35:15.544 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34217/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:35:15.550 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.138.89/tcp/34218/p2p/16Uiu2HAkyzDvEguDQmd6jgS2gVAt94WqcJjkU4GpgcQzSsqEvuPK","/ip4/172.18.138.89/tcp/34219/ws/p2p/16Uiu2HAkyzDvEguDQmd6jgS2gVAt94WqcJjkU4GpgcQzSsqEvuPK"],"enrUri":"enr:-L24QK1XIcLDeKtBohOz8PTMqH4xzRjfBumxBxmkuUmhKdP6Pc55UOTqJ9Gr_Opm8bUY7aI8Q72Jz4U3YlCAyP3PGAoCgmlkgnY0gmlwhKwSilmKbXVsdGlhZGRyc5YACASsEopZBoWqAAoErBKKWQaFq90DgnJzhQACAQAAiXNlY3AyNTZrMaECQ8VyX8IZjfjsCntlwcDbY_nfUafO-pQjQscNdLtEVHaDdGNwgoWqg3VkcIKFrIV3YWt1MgE"}'
2026-02-05 04:35:15.550 INFO [src.node.waku_node] REST service is ready !!
2026-02-05 04:35:15.551 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34217/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.191.111/tcp/34701/p2p/16Uiu2HAmM4fBB7ToWQAc4RyCZXgtYeSxuhmadiuDxagc876qnCDc"]'
2026-02-05 04:35:15.555 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:35:15.556 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34700/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
2026-02-05 04:35:15.559 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:35:15.560 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34217/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
2026-02-05 04:35:15.565 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:35:15.566 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34700/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-05 04:35:15.571 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-05 04:35:15.572 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-05 04:35:15.673 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-05 04:35:15.673 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34700/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:35:15.676 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770266115566339413,"ephemeral":false,"proof":""}]'
2026-02-05 04:35:15.678 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-05 04:35:15.678 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34217/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-05 04:35:15.681 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770266115566339413,"ephemeral":false,"proof":""}]'
2026-02-05 04:35:15.684 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-05 04:35:15.685 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-05 04:35:15.686 DEBUG [src.node.waku_node] Stopping container with id 1aa9f9ae12e0
2026-02-05 04:35:16.309 DEBUG [src.node.waku_node] Container stopped.
2026-02-05 04:35:16.309 DEBUG [src.node.waku_node] Stopping container with id 8a8fdcd8b174
2026-02-05 04:35:16.858 DEBUG [src.node.waku_node] Container stopped.
2026-02-05 04:35:16.859 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-05 04:35:16.866 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-05 04:35:16.872 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
