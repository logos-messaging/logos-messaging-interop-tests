2026-02-06 04:35:17.907 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-06 04:35:17.908 DEBUG [tests.conftest] Running test: test_filter_works_with_static_sharding with id: 2026-02-06_04-35-17__d98a62e4-2921-4e7a-a017-ac9bfd6246af
2026-02-06 04:35:17.908 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-06 04:35:17.908 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-06 04:35:17.908 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-06 04:35:17.915 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-06 04:35:17.915 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-06_04-35-17__d98a62e4-2921-4e7a-a017-ac9bfd6246af__wakuorg_nwaku:latest.log
2026-02-06 04:35:17.915 DEBUG [src.node.waku_node] Starting Node...
2026-02-06 04:35:17.915 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-06 04:35:17.917 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-06 04:35:17.917 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.146.241
2026-02-06 04:35:17.917 DEBUG [src.node.docker_mananger] Generated ports ['46628', '46629', '46630', '46631', '46632']
2026-02-06 04:35:17.917 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-06 04:35:17.917 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-06 04:35:17.917 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-06 04:35:17.918 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-06 04:35:17.918 DEBUG [src.node.waku_node] Using volumes []
2026-02-06 04:35:17.918 DEBUG [src.node.docker_mananger] docker run -i -t -p 46628:46628 -p 46629:46629 -p 46630:46630 -p 46631:46631 -p 46632:46632 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=46630 --rest-port=46628 --tcp-port=46629 --discv5-udp-port=46631 --rest-address=0.0.0.0 --nat=extip:172.18.146.241 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=ddfccac7bf0be0fe5dbac59a9e4cf5cf4a212ae1fb0ace1b0bac3ca95282cd31 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=46632 --metrics-logging=true --relay=true --filter=true
2026-02-06 04:35:18.103 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.146.241 waku eb26cb40c5e04b3b9f16d1f92e891dd48c9ecde3641d0268567b094105f90ff3
2026-02-06 04:35:18.134 DEBUG [src.node.docker_mananger] Container started with ID eb26cb40c5e0. Setting up logs at ./log/docker/node1_2026-02-06_04-35-17__d98a62e4-2921-4e7a-a017-ac9bfd6246af__wakuorg_nwaku:latest.log
2026-02-06 04:35:18.135 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 46628
2026-02-06 04:35:18.135 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-06 04:35:18.153 ERROR [src.node.docker_mananger] Max retries reached for container 1e3894402c20. Exiting log stream.
2026-02-06 04:35:18.708 ERROR [src.node.docker_mananger] Max retries reached for container 832475f9a5ab. Exiting log stream.
2026-02-06 04:35:19.136 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46628/health" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:35:19.139 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-06 04:35:19.139 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-06 04:35:19.139 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46628/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:35:19.141 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.146.241/tcp/46629/p2p/16Uiu2HAmQ4mGn1fuqFYqkYWCRg7MeqPvAhF2DmrnWBKuW5MUn126","/ip4/172.18.146.241/tcp/46630/ws/p2p/16Uiu2HAmQ4mGn1fuqFYqkYWCRg7MeqPvAhF2DmrnWBKuW5MUn126"],"enrUri":"enr:-L24QPMoj3Z5JYkf2MdbUlcPcoVZRfIrV62VxvKL_gLXk6PjSGPausSLOmGOE4-2wsegPjC4pt4-4Sb78E7uSEA07hUCgmlkgnY0gmlwhKwSkvGKbXVsdGlhZGRyc5YACASsEpLxBrYlAAoErBKS8Qa2Jt0DgnJzhQACAQAAiXNlY3AyNTZrMaEDqYe1XvjxJw9smcInR2NDebursUcnmiRapUqzCACw-_eDdGNwgrYlg3VkcIK2J4V3YWt1MgU"}'
2026-02-06 04:35:19.141 INFO [src.node.waku_node] REST service is ready !!
2026-02-06 04:35:19.148 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-06 04:35:19.148 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-06_04-35-17__d98a62e4-2921-4e7a-a017-ac9bfd6246af__wakuorg_nwaku:latest.log
2026-02-06 04:35:19.148 DEBUG [src.node.waku_node] Starting Node...
2026-02-06 04:35:19.148 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-06 04:35:19.149 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-06 04:35:19.150 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.254.210
2026-02-06 04:35:19.150 DEBUG [src.node.docker_mananger] Generated ports ['27053', '27054', '27055', '27056', '27057']
2026-02-06 04:35:19.150 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-06 04:35:19.150 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-06 04:35:19.150 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-06 04:35:19.150 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-06 04:35:19.150 DEBUG [src.node.waku_node] Using volumes []
2026-02-06 04:35:19.150 DEBUG [src.node.docker_mananger] docker run -i -t -p 27053:27053 -p 27054:27054 -p 27055:27055 -p 27056:27056 -p 27057:27057 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=27055 --rest-port=27053 --tcp-port=27054 --discv5-udp-port=27056 --rest-address=0.0.0.0 --nat=extip:172.18.254.210 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=d1cd3eddcb8efcbbb2846cc8d4c1db7d2132143d847cffe0ae18fc3acade2aa0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=27057 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QPMoj3Z5JYkf2MdbUlcPcoVZRfIrV62VxvKL_gLXk6PjSGPausSLOmGOE4-2wsegPjC4pt4-4Sb78E7uSEA07hUCgmlkgnY0gmlwhKwSkvGKbXVsdGlhZGRyc5YACASsEpLxBrYlAAoErBKS8Qa2Jt0DgnJzhQACAQAAiXNlY3AyNTZrMaEDqYe1XvjxJw9smcInR2NDebursUcnmiRapUqzCACw-_eDdGNwgrYlg3VkcIK2J4V3YWt1MgU --filternode=/ip4/172.18.146.241/tcp/46629/p2p/16Uiu2HAmQ4mGn1fuqFYqkYWCRg7MeqPvAhF2DmrnWBKuW5MUn126
2026-02-06 04:35:19.329 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.254.210 waku 53eae5d678f8911502ba172be4bbc2741a10ca9eb3f289ed2cc84603183ac99a
2026-02-06 04:35:19.359 DEBUG [src.node.docker_mananger] Container started with ID 53eae5d678f8. Setting up logs at ./log/docker/node2_2026-02-06_04-35-17__d98a62e4-2921-4e7a-a017-ac9bfd6246af__wakuorg_nwaku:latest.log
2026-02-06 04:35:19.359 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 27053
2026-02-06 04:35:19.359 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-06 04:35:20.360 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27053/health" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:35:20.363 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-06 04:35:20.364 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-06 04:35:20.364 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27053/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:35:20.366 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.254.210/tcp/27054/p2p/16Uiu2HAm6MUFi9wkUKhqUZsYW4UNvouVkTpHAFwjbhnTbFHvbUgZ","/ip4/172.18.254.210/tcp/27055/ws/p2p/16Uiu2HAm6MUFi9wkUKhqUZsYW4UNvouVkTpHAFwjbhnTbFHvbUgZ"],"enrUri":"enr:-L24QNs1CwdJHwqvbxwLppsX35KvUlQNNB8EYGcUOuCl8qZEVYufHSv51AbM3Hg5dT5U5HbUvmfqlA_UoQ_VzfkyNMUCgmlkgnY0gmlwhKwS_tKKbXVsdGlhZGRyc5YACASsEv7SBmmuAAoErBL-0gZpr90DgnJzhQACAQAAiXNlY3AyNTZrMaEColz5jP5tEb6XgLDGe_DaYi4xbYevCNirjFRhTjPhq-KDdGNwgmmug3VkcIJpsIV3YWt1MgA"}'
2026-02-06 04:35:20.366 INFO [src.node.waku_node] REST service is ready !!
2026-02-06 04:35:20.367 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:27053/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.146.241/tcp/46629/p2p/16Uiu2HAmQ4mGn1fuqFYqkYWCRg7MeqPvAhF2DmrnWBKuW5MUn126"]'
2026-02-06 04:35:20.395 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-06 04:35:20.396 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46628/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2026-02-06 04:35:20.410 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-06 04:35:20.411 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:27053/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "d1405c1f-8290-421a-9ed4-7bd445bf9717", "contentFilters": ["/myapp/1/latest/proto"], "pubsubTopic": "/waku/2/rs/2/0"}'
2026-02-06 04:35:20.421 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"d1405c1f-8290-421a-9ed4-7bd445bf9717","statusDesc":"OK"}'
2026-02-06 04:35:20.422 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46628/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-06 04:35:20.428 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-06 04:35:20.428 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-06 04:35:20.529 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-06 04:35:20.529 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27053/filter/v2/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:35:20.532 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770352520421878736,"ephemeral":false}]'
2026-02-06 04:35:20.535 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-06 04:35:20.536 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-06 04:35:20.536 DEBUG [src.node.waku_node] Stopping container with id eb26cb40c5e0
2026-02-06 04:35:21.072 DEBUG [src.node.waku_node] Container stopped.
2026-02-06 04:35:21.073 DEBUG [src.node.waku_node] Stopping container with id 53eae5d678f8
2026-02-06 04:35:21.662 DEBUG [src.node.waku_node] Container stopped.
2026-02-06 04:35:21.663 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-06 04:35:21.675 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-06 04:35:21.679 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
