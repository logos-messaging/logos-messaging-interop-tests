2026-02-06 04:39:54.026 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-06 04:39:54.027 DEBUG [tests.conftest] Running test: test_retrieve_messages_without_subscribing_via_api with id: 2026-02-06_04-39-54__74a6dd4c-d727-4d03-8cd2-55550648b8b7
2026-02-06 04:39:54.027 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-06 04:39:54.027 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-06 04:39:54.027 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-06 04:39:54.034 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-06 04:39:54.035 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-06_04-39-54__74a6dd4c-d727-4d03-8cd2-55550648b8b7__wakuorg_nwaku:latest.log
2026-02-06 04:39:54.035 DEBUG [src.node.waku_node] Starting Node...
2026-02-06 04:39:54.035 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-06 04:39:54.036 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-06 04:39:54.036 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.126.207
2026-02-06 04:39:54.037 DEBUG [src.node.docker_mananger] Generated ports ['21299', '21300', '21301', '21302', '21303']
2026-02-06 04:39:54.037 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-06 04:39:54.037 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-06 04:39:54.037 DEBUG [src.node.waku_node] Using volumes []
2026-02-06 04:39:54.037 DEBUG [src.node.docker_mananger] docker run -i -t -p 21299:21299 -p 21300:21300 -p 21301:21301 -p 21302:21302 -p 21303:21303 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=21301 --rest-port=21299 --tcp-port=21300 --discv5-udp-port=21302 --rest-address=0.0.0.0 --nat=extip:172.18.126.207 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=ad6c2ecbdcd21ec74e2f1b8ccbeb5a9be6c671f29aefcedd3aeb3ffd801be7b4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=21303 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto --num-shards-in-network=8
2026-02-06 04:39:54.200 ERROR [src.node.docker_mananger] Max retries reached for container ee44425a52a7. Exiting log stream.
2026-02-06 04:39:54.222 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.126.207 waku 14466d67d66750291bf17c1599f72cc0d5f463f828501253094c9bc6939a5e25
2026-02-06 04:39:54.254 DEBUG [src.node.docker_mananger] Container started with ID 14466d67d667. Setting up logs at ./log/docker/node1_2026-02-06_04-39-54__74a6dd4c-d727-4d03-8cd2-55550648b8b7__wakuorg_nwaku:latest.log
2026-02-06 04:39:54.255 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 21299
2026-02-06 04:39:54.255 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-06 04:39:54.763 ERROR [src.node.docker_mananger] Max retries reached for container 5f68a8ff7bfe. Exiting log stream.
2026-02-06 04:39:55.255 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21299/health" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:39:55.259 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-06 04:39:55.259 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-06 04:39:55.259 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21299/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:39:55.261 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.126.207/tcp/21300/p2p/16Uiu2HAmFP7aoVds4L2GfBRKeyo39tdigUmMMAsBQDZL2FVNhRPD","/ip4/172.18.126.207/tcp/21301/ws/p2p/16Uiu2HAmFP7aoVds4L2GfBRKeyo39tdigUmMMAsBQDZL2FVNhRPD"],"enrUri":"enr:-L24QL8uOy8lHP1M-na4JxuTBk0xWVKm383WGiBK6e3ndW3EdH2lNegnl2apike3X6_4vyr2Y34p_LXMTXHemPLfQo4CgmlkgnY0gmlwhKwSfs-KbXVsdGlhZGRyc5YACASsEn7PBlM0AAoErBJ-zwZTNd0DgnJzhQACAQAAiXNlY3AyNTZrMaEDKIHyOSwkzp6MRY42e297Hd_I_pnYWUA0PpfmkVDqw3iDdGNwglM0g3VkcIJTNoV3YWt1MgU"}'
2026-02-06 04:39:55.261 INFO [src.node.waku_node] REST service is ready !!
2026-02-06 04:39:55.268 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-06 04:39:55.268 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-06_04-39-54__74a6dd4c-d727-4d03-8cd2-55550648b8b7__wakuorg_nwaku:latest.log
2026-02-06 04:39:55.268 DEBUG [src.node.waku_node] Starting Node...
2026-02-06 04:39:55.268 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-06 04:39:55.270 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-06 04:39:55.270 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.121.117
2026-02-06 04:39:55.270 DEBUG [src.node.docker_mananger] Generated ports ['57474', '57475', '57476', '57477', '57478']
2026-02-06 04:39:55.270 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-06 04:39:55.270 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-06 04:39:55.270 DEBUG [src.node.waku_node] Using volumes []
2026-02-06 04:39:55.270 DEBUG [src.node.docker_mananger] docker run -i -t -p 57474:57474 -p 57475:57475 -p 57476:57476 -p 57477:57477 -p 57478:57478 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57476 --rest-port=57474 --tcp-port=57475 --discv5-udp-port=57477 --rest-address=0.0.0.0 --nat=extip:172.18.121.117 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=caa479bed70bfd5458e2b6707fe6ac3fbabac91bcd55e3bedecbbd2cbace0d81 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57478 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QL8uOy8lHP1M-na4JxuTBk0xWVKm383WGiBK6e3ndW3EdH2lNegnl2apike3X6_4vyr2Y34p_LXMTXHemPLfQo4CgmlkgnY0gmlwhKwSfs-KbXVsdGlhZGRyc5YACASsEn7PBlM0AAoErBJ-zwZTNd0DgnJzhQACAQAAiXNlY3AyNTZrMaEDKIHyOSwkzp6MRY42e297Hd_I_pnYWUA0PpfmkVDqw3iDdGNwglM0g3VkcIJTNoV3YWt1MgU --content-topic=/myapp/1/latest/proto --num-shards-in-network=8
2026-02-06 04:39:55.451 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.121.117 waku 4a4d568ab598ff2905dbdf5b7eb5e554dba13bd5bb4796e44c56f6f49245286d
2026-02-06 04:39:55.483 DEBUG [src.node.docker_mananger] Container started with ID 4a4d568ab598. Setting up logs at ./log/docker/node2_2026-02-06_04-39-54__74a6dd4c-d727-4d03-8cd2-55550648b8b7__wakuorg_nwaku:latest.log
2026-02-06 04:39:55.483 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 57474
2026-02-06 04:39:55.484 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-06 04:39:56.484 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57474/health" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:39:56.501 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-06 04:39:56.502 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-06 04:39:56.504 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57474/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:39:56.508 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.121.117/tcp/57475/p2p/16Uiu2HAm68cmB6RWPpJ3Hyt26DV6z5y2at7GUchHPXJKxdYH6L1i","/ip4/172.18.121.117/tcp/57476/ws/p2p/16Uiu2HAm68cmB6RWPpJ3Hyt26DV6z5y2at7GUchHPXJKxdYH6L1i"],"enrUri":"enr:-L24QHwSKfsfIKUqLqr5_EFWIr8SO7hVlIKk3Kfm5n7VA9sXMKUmsU8euHNG5aEo2kkWirC-4YvnEFz6CRsWhpcGFjICgmlkgnY0gmlwhKwSeXWKbXVsdGlhZGRyc5YACASsEnl1BuCDAAoErBJ5dQbghN0DgnJzhQACAQAAiXNlY3AyNTZrMaECnxILWOPzLcjoHEi6RYPc0erJMYSgz6HgVTzxGVvZgn2DdGNwguCDg3VkcILghYV3YWt1MgE"}'
2026-02-06 04:39:56.509 INFO [src.node.waku_node] REST service is ready !!
2026-02-06 04:39:56.510 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57474/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.126.207/tcp/21300/p2p/16Uiu2HAmFP7aoVds4L2GfBRKeyo39tdigUmMMAsBQDZL2FVNhRPD"]'
2026-02-06 04:39:56.512 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-06 04:39:56.513 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:21299/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-06 04:39:56.517 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-06 04:39:56.517 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-06 04:39:56.617 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-06 04:39:56.618 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21299/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:39:56.621 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770352796513078444,"ephemeral":false,"proof":""}]'
2026-02-06 04:39:56.622 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-06 04:39:56.622 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57474/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:39:56.625 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770352796513078444,"ephemeral":false,"proof":""}]'
2026-02-06 04:39:56.627 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-06 04:39:56.628 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-06 04:39:56.629 DEBUG [src.node.waku_node] Stopping container with id 14466d67d667
2026-02-06 04:39:57.208 DEBUG [src.node.waku_node] Container stopped.
2026-02-06 04:39:57.208 DEBUG [src.node.waku_node] Stopping container with id 4a4d568ab598
2026-02-06 04:39:57.721 DEBUG [src.node.waku_node] Container stopped.
2026-02-06 04:39:57.722 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-06 04:39:57.727 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-06 04:39:57.732 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
