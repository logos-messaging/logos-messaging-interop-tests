2026-02-06 04:35:07.456 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-06 04:35:07.457 DEBUG [tests.conftest] Running test: test_relay_different_latency_between_two_nodes[500] with id: 2026-02-06_04-35-07__7e17887e-1d74-4c64-8dac-a7c428cd2116
2026-02-06 04:35:07.457 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-06 04:35:07.457 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-06 04:35:07.466 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-06 04:35:07.466 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-06_04-35-07__7e17887e-1d74-4c64-8dac-a7c428cd2116__wakuorg_nwaku:latest.log
2026-02-06 04:35:07.474 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-06 04:35:07.474 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-06_04-35-07__7e17887e-1d74-4c64-8dac-a7c428cd2116__wakuorg_nwaku:latest.log
2026-02-06 04:35:07.476 INFO [tests.e2e.test_network_conditions] Starting node1 and node2 with relay enabled
2026-02-06 04:35:07.477 DEBUG [src.node.waku_node] Starting Node...
2026-02-06 04:35:07.477 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-06 04:35:07.478 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-06 04:35:07.479 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.44.127
2026-02-06 04:35:07.479 DEBUG [src.node.docker_mananger] Generated ports ['35814', '35815', '35816', '35817', '35818']
2026-02-06 04:35:07.479 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-06 04:35:07.479 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-06 04:35:07.479 DEBUG [src.node.waku_node] Using volumes []
2026-02-06 04:35:07.480 DEBUG [src.node.docker_mananger] docker run -i -t -p 35814:35814 -p 35815:35815 -p 35816:35816 -p 35817:35817 -p 35818:35818 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=35816 --rest-port=35814 --tcp-port=35815 --discv5-udp-port=35817 --rest-address=0.0.0.0 --nat=extip:172.18.44.127 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=caf74de3a472e8d4c2d75802da7fd2efee54deb968fbd67480eddc990c3aca97 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=35818 --metrics-logging=true --relay=true
2026-02-06 04:35:07.698 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.44.127 waku c99ad6705b69ec707fcb9176eefc49e4acaa96a0919e4bbd52ca3cdbb1454a06
2026-02-06 04:35:07.734 DEBUG [src.node.docker_mananger] Container started with ID c99ad6705b69. Setting up logs at ./log/docker/node1_2026-02-06_04-35-07__7e17887e-1d74-4c64-8dac-a7c428cd2116__wakuorg_nwaku:latest.log
2026-02-06 04:35:07.735 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 35814
2026-02-06 04:35:07.735 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-06 04:35:08.535 ERROR [src.node.docker_mananger] Max retries reached for container 609401ab7338. Exiting log stream.
2026-02-06 04:35:08.735 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35814/health" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:35:08.739 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-06 04:35:08.739 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-06 04:35:08.739 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35814/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:35:08.741 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.44.127/tcp/35815/p2p/16Uiu2HAmJPPjBKqJ4AqK6iiGYycWyU7PZSSRoRLTqXSfvpPyRk7P","/ip4/172.18.44.127/tcp/35816/ws/p2p/16Uiu2HAmJPPjBKqJ4AqK6iiGYycWyU7PZSSRoRLTqXSfvpPyRk7P"],"enrUri":"enr:-L24QILzVD1Lx0f5n_M9FshuveB98KULE654mPjuZMd8it-GfraI_MxDhmpiNDUeQ1lVJSOclucBTViZsGDjkkPiNQcCgmlkgnY0gmlwhKwSLH-KbXVsdGlhZGRyc5YACASsEix_BovnAAoErBIsfwaL6N0DgnJzhQADAQAAiXNlY3AyNTZrMaEDVSdC8uD70J9ly3mqrXrrpLsgDv5jeGMCLZCD7bs8e76DdGNwgovng3VkcIKL6YV3YWt1MgE"}'
2026-02-06 04:35:08.742 INFO [src.node.waku_node] REST service is ready !!
2026-02-06 04:35:08.742 DEBUG [src.node.waku_node] Starting Node...
2026-02-06 04:35:08.742 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-06 04:35:08.743 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-06 04:35:08.744 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.232.132
2026-02-06 04:35:08.744 DEBUG [src.node.docker_mananger] Generated ports ['42328', '42329', '42330', '42331', '42332']
2026-02-06 04:35:08.744 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-06 04:35:08.744 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-06 04:35:08.744 DEBUG [src.node.waku_node] Using volumes []
2026-02-06 04:35:08.744 DEBUG [src.node.docker_mananger] docker run -i -t -p 42328:42328 -p 42329:42329 -p 42330:42330 -p 42331:42331 -p 42332:42332 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42330 --rest-port=42328 --tcp-port=42329 --discv5-udp-port=42331 --rest-address=0.0.0.0 --nat=extip:172.18.232.132 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ac82b643423fbaafab7e5bc303cfe5ac4f8eb90ad302916e52c1635ec50fdc3f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42332 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QILzVD1Lx0f5n_M9FshuveB98KULE654mPjuZMd8it-GfraI_MxDhmpiNDUeQ1lVJSOclucBTViZsGDjkkPiNQcCgmlkgnY0gmlwhKwSLH-KbXVsdGlhZGRyc5YACASsEix_BovnAAoErBIsfwaL6N0DgnJzhQADAQAAiXNlY3AyNTZrMaEDVSdC8uD70J9ly3mqrXrrpLsgDv5jeGMCLZCD7bs8e76DdGNwgovng3VkcIKL6YV3YWt1MgE
2026-02-06 04:35:08.923 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.232.132 waku 27c15e0c7a19c2d750488a29bbf0c82c7c557ef1132a8b6d12f81b5ce50e99d2
2026-02-06 04:35:08.952 DEBUG [src.node.docker_mananger] Container started with ID 27c15e0c7a19. Setting up logs at ./log/docker/node2_2026-02-06_04-35-07__7e17887e-1d74-4c64-8dac-a7c428cd2116__wakuorg_nwaku:latest.log
2026-02-06 04:35:08.952 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 42328
2026-02-06 04:35:08.952 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-06 04:35:09.954 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42328/health" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:35:09.971 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-06 04:35:09.973 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-06 04:35:09.974 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42328/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:35:09.980 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.232.132/tcp/42329/p2p/16Uiu2HAkzmJ7cyTm6acD91khrgs6fRHYPL2MGjJiwweeDF6gxtdU","/ip4/172.18.232.132/tcp/42330/ws/p2p/16Uiu2HAkzmJ7cyTm6acD91khrgs6fRHYPL2MGjJiwweeDF6gxtdU"],"enrUri":"enr:-L24QONxcFoe_gwomtXMW155fRrMrtyNaC_xUt12j4IPBBbTB9qpg3wOFbWz05byW8InfnL8qU5VE1tHqPnKGAx1HxACgmlkgnY0gmlwhKwS6ISKbXVsdGlhZGRyc5YACASsEuiEBqVZAAoErBLohAalWt0DgnJzhQADAQAAiXNlY3AyNTZrMaECT1FT80ZH7P1e9Pg8IxAuyPio73wu_Wi0gL02XFR4AxeDdGNwgqVZg3VkcIKlW4V3YWt1MgE"}'
2026-02-06 04:35:09.980 INFO [src.node.waku_node] REST service is ready !!
2026-02-06 04:35:09.980 INFO [tests.e2e.test_network_conditions] Subscribing both nodes to relay topic
2026-02-06 04:35:09.981 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35814/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-06 04:35:09.985 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-06 04:35:09.985 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42328/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-06 04:35:09.988 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-06 04:35:09.989 INFO [tests.e2e.test_network_conditions] Waiting for autoconnection
2026-02-06 04:35:09.989 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35814/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:35:09.992 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.232.132/tcp/41412/p2p/16Uiu2HAkzmJ7cyTm6acD91khrgs6fRHYPL2MGjJiwweeDF6gxtdU","protocols":["/ipfs/id/1.0.0","/libp2p/autonat/1.0.0","/libp2p/circuit/relay/0.2.0/hop","/vac/waku/metadata/1.0.0","/vac/waku/relay/2.0.0","/vac/waku/rendezvous/1.0.0","/ipfs/ping/1.0.0","/vac/waku/filter-push/2.0.0-beta1","/vac/waku/peer-exchange/2.0.0-alpha1"],"shards":[0],"connected":"Connected","agent":"nwaku-v0.36.0-127-ga4e44d","origin":"UnknownOrigin"}]'
2026-02-06 04:35:09.992 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42328/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:35:09.995 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.44.127/tcp/35815/p2p/16Uiu2HAmJPPjBKqJ4AqK6iiGYycWyU7PZSSRoRLTqXSfvpPyRk7P","protocols":["/ipfs/id/1.0.0","/libp2p/autonat/1.0.0","/libp2p/circuit/relay/0.2.0/hop","/vac/waku/metadata/1.0.0","/vac/waku/relay/2.0.0","/vac/waku/rendezvous/1.0.0","/ipfs/ping/1.0.0","/vac/waku/filter-push/2.0.0-beta1","/vac/waku/peer-exchange/2.0.0-alpha1"],"shards":[0],"connected":"Connected","agent":"nwaku-v0.36.0-127-ga4e44d","origin":"Discv5"}]'
2026-02-06 04:35:09.996 DEBUG [src.libs.common] Sleeping for 10 seconds
2026-02-06 04:35:19.996 INFO [tests.e2e.test_network_conditions] Applying 500ms latency to node2
2026-02-06 04:35:19.998 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '8288', '-n', 'tc', 'qdisc', 'del', 'dev', 'eth0', 'root']
2026-02-06 04:35:20.008 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '8288', '-n', 'tc', 'qdisc', 'del', 'dev', 'eth0', 'root']
2026-02-06 04:35:20.017 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '8288', '-n', 'tc', 'qdisc', 'add', 'dev', 'eth0', 'root', 'netem', 'delay', '500ms']
2026-02-06 04:35:20.026 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35814/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-06 04:35:20.031 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-06 04:35:20.032 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42328/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:35:21.035 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770352520026543932,"ephemeral":false,"proof":""}]'
2026-02-06 04:35:21.036 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '8288', '-n', 'tc', 'qdisc', 'del', 'dev', 'eth0', 'root']
2026-02-06 04:35:21.047 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-06 04:35:21.048 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-06 04:35:21.048 DEBUG [src.node.waku_node] Stopping container with id c99ad6705b69
2026-02-06 04:35:21.550 DEBUG [src.node.waku_node] Container stopped.
2026-02-06 04:35:21.550 DEBUG [src.node.waku_node] Stopping container with id 27c15e0c7a19
2026-02-06 04:35:22.108 DEBUG [src.node.waku_node] Container stopped.
2026-02-06 04:35:22.110 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-06 04:35:22.120 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-06 04:35:22.128 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
