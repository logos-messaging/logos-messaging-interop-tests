2026-02-06 04:42:57.718 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-06 04:42:57.719 DEBUG [tests.conftest] Running test: test_message_with_ephemeral_true with id: 2026-02-06_04-42-57__d33acc84-f5a7-4d9c-b5b2-050d0f15f1c4
2026-02-06 04:42:57.719 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-06 04:42:57.719 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-02-06 04:42:57.720 DEBUG [src.steps.store] Running fixture setup: node_setup
2026-02-06 04:42:57.727 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-06 04:42:57.728 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-02-06_04-42-57__d33acc84-f5a7-4d9c-b5b2-050d0f15f1c4__wakuorg_nwaku:latest.log
2026-02-06 04:42:57.728 DEBUG [src.node.waku_node] Starting Node...
2026-02-06 04:42:57.728 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-06 04:42:57.729 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-06 04:42:57.729 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.16.147
2026-02-06 04:42:57.729 DEBUG [src.node.docker_mananger] Generated ports ['40378', '40379', '40380', '40381', '40382']
2026-02-06 04:42:57.730 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-06 04:42:57.730 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-06 04:42:57.730 DEBUG [src.node.waku_node] Using volumes []
2026-02-06 04:42:57.730 DEBUG [src.node.docker_mananger] docker run -i -t -p 40378:40378 -p 40379:40379 -p 40380:40380 -p 40381:40381 -p 40382:40382 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=40380 --rest-port=40378 --tcp-port=40379 --discv5-udp-port=40381 --rest-address=0.0.0.0 --nat=extip:172.18.16.147 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2fd4bb2a9cfb316f343d26ebb266cecde956c5ddf0848fc31fbd36babc4cdf35 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=40382 --metrics-logging=true --store=true --relay=true
2026-02-06 04:42:57.911 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.16.147 waku 971cfd20013d3b68e302c8e30f5ee116ec4780feb6cdef64e109bba4382ee570
2026-02-06 04:42:57.940 DEBUG [src.node.docker_mananger] Container started with ID 971cfd20013d. Setting up logs at ./log/docker/publishing_node1_2026-02-06_04-42-57__d33acc84-f5a7-4d9c-b5b2-050d0f15f1c4__wakuorg_nwaku:latest.log
2026-02-06 04:42:57.940 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 40378
2026-02-06 04:42:57.941 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-06 04:42:57.976 ERROR [src.node.docker_mananger] Max retries reached for container d3e2c447bc87. Exiting log stream.
2026-02-06 04:42:58.512 ERROR [src.node.docker_mananger] Max retries reached for container 0496d29b3538. Exiting log stream.
2026-02-06 04:42:58.942 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40378/health" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:42:58.945 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-06 04:42:58.945 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-06 04:42:58.946 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40378/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:42:58.948 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.16.147/tcp/40379/p2p/16Uiu2HAm6QcjDYDzVLBhD4Hq3jnnCzYmU6Z8WhqLPWryAesGzx5h","/ip4/172.18.16.147/tcp/40380/ws/p2p/16Uiu2HAm6QcjDYDzVLBhD4Hq3jnnCzYmU6Z8WhqLPWryAesGzx5h"],"enrUri":"enr:-L24QKQtuPmWjaR1SkiKyBTFBskAI2qqEpDRH6lUuFhZvZG0TPFt8-mzYNmtekQ5vhFXc0sapiFLST3w2jupvcAt0qsCgmlkgnY0gmlwhKwSEJOKbXVsdGlhZGRyc5YACASsEhCTBp27AAoErBIQkwadvN0DgnJzhQADAQAAiXNlY3AyNTZrMaECoytMkffEEa5ty0tg4lbRJejsay0p0WVSkI1KaDzX76SDdGNwgp27g3VkcIKdvYV3YWt1MgM"}'
2026-02-06 04:42:58.948 INFO [src.node.waku_node] REST service is ready !!
2026-02-06 04:42:58.955 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-06 04:42:58.955 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-02-06_04-42-57__d33acc84-f5a7-4d9c-b5b2-050d0f15f1c4__wakuorg_nwaku:latest.log
2026-02-06 04:42:58.955 DEBUG [src.node.waku_node] Starting Node...
2026-02-06 04:42:58.955 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-06 04:42:58.957 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-06 04:42:58.957 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.54.197
2026-02-06 04:42:58.957 DEBUG [src.node.docker_mananger] Generated ports ['20093', '20094', '20095', '20096', '20097']
2026-02-06 04:42:58.957 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-06 04:42:58.957 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-06 04:42:58.957 DEBUG [src.node.waku_node] Using volumes []
2026-02-06 04:42:58.957 DEBUG [src.node.docker_mananger] docker run -i -t -p 20093:20093 -p 20094:20094 -p 20095:20095 -p 20096:20096 -p 20097:20097 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20095 --rest-port=20093 --tcp-port=20094 --discv5-udp-port=20096 --rest-address=0.0.0.0 --nat=extip:172.18.54.197 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a0e6eaea7aeb21eb8d86e5e8fba672c830dccb3dbebbdec575c10cb1697ec1dd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20097 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QKQtuPmWjaR1SkiKyBTFBskAI2qqEpDRH6lUuFhZvZG0TPFt8-mzYNmtekQ5vhFXc0sapiFLST3w2jupvcAt0qsCgmlkgnY0gmlwhKwSEJOKbXVsdGlhZGRyc5YACASsEhCTBp27AAoErBIQkwadvN0DgnJzhQADAQAAiXNlY3AyNTZrMaECoytMkffEEa5ty0tg4lbRJejsay0p0WVSkI1KaDzX76SDdGNwgp27g3VkcIKdvYV3YWt1MgM --storenode=/ip4/172.18.16.147/tcp/40379/p2p/16Uiu2HAm6QcjDYDzVLBhD4Hq3jnnCzYmU6Z8WhqLPWryAesGzx5h --store=true --relay=true
2026-02-06 04:42:59.151 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.54.197 waku e991947ab34564a5589ee3b9d414a1028771826d71d58622e09a0f7ab3c501ed
2026-02-06 04:42:59.182 DEBUG [src.node.docker_mananger] Container started with ID e991947ab345. Setting up logs at ./log/docker/store_node1_2026-02-06_04-42-57__d33acc84-f5a7-4d9c-b5b2-050d0f15f1c4__wakuorg_nwaku:latest.log
2026-02-06 04:42:59.183 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 20093
2026-02-06 04:42:59.183 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-06 04:43:00.183 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20093/health" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:43:00.188 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-06 04:43:00.188 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-06 04:43:00.188 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20093/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:43:00.190 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.54.197/tcp/20094/p2p/16Uiu2HAkxYvY55maKXq4nMogjWQKka3HUeJukPFocor5qJRUvPHU","/ip4/172.18.54.197/tcp/20095/ws/p2p/16Uiu2HAkxYvY55maKXq4nMogjWQKka3HUeJukPFocor5qJRUvPHU"],"enrUri":"enr:-L24QAaT4hWMKPssKFIO933xTkaxJ9PDJzEXotl9dlbpcONUdvK3PGw_I3pxo-vVyf_ofWTv00hxwHPmR5iNFoiMwWQCgmlkgnY0gmlwhKwSNsWKbXVsdGlhZGRyc5YACASsEjbFBk5-AAoErBI2xQZOf90DgnJzhQADAQAAiXNlY3AyNTZrMaECLm6V5iPZcBtLAAgXulJzwOlA74n6zOFR4swmuVRRJwuDdGNwgk5-g3VkcIJOgIV3YWt1MgM"}'
2026-02-06 04:43:00.190 INFO [src.node.waku_node] REST service is ready !!
2026-02-06 04:43:00.191 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20093/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.16.147/tcp/40379/p2p/16Uiu2HAm6QcjDYDzVLBhD4Hq3jnnCzYmU6Z8WhqLPWryAesGzx5h"]'
2026-02-06 04:43:00.194 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-06 04:43:00.194 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40378/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-06 04:43:00.196 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-06 04:43:00.197 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20093/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-06 04:43:00.199 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-06 04:43:00.200 DEBUG [src.steps.store] Relaying message
2026-02-06 04:43:00.200 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40378/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
2026-02-06 04:43:00.204 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-06 04:43:00.205 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-06 04:43:00.405 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-06 04:43:00.406 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40378/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-06 04:43:00.409 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2026-02-06 04:43:00.409 DEBUG [src.steps.store] messages length is 0
2026-02-06 04:43:00.411 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-06 04:43:00.412 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-06 04:43:00.412 DEBUG [src.node.waku_node] Stopping container with id 971cfd20013d
2026-02-06 04:43:01.032 DEBUG [src.node.waku_node] Container stopped.
2026-02-06 04:43:01.032 DEBUG [src.node.waku_node] Stopping container with id e991947ab345
2026-02-06 04:43:01.572 DEBUG [src.node.waku_node] Container stopped.
2026-02-06 04:43:01.573 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-06 04:43:01.580 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-06 04:43:01.586 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
