2026-02-04 04:33:36.645 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 04:33:36.645 DEBUG [tests.conftest] Running test: test_main_node_only_relay__peer_relay_and_store with id: 2026-02-04_04-33-36__a06195ef-8611-4e55-974b-7dae652ca51a
2026-02-04 04:33:36.645 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 04:33:36.646 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-02-04 04:33:36.653 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 04:33:36.653 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-02-04_04-33-36__a06195ef-8611-4e55-974b-7dae652ca51a__wakuorg_nwaku:latest.log
2026-02-04 04:33:36.654 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 04:33:36.654 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 04:33:36.655 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 04:33:36.655 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.228.110
2026-02-04 04:33:36.655 DEBUG [src.node.docker_mananger] Generated ports ['31150', '31151', '31152', '31153', '31154']
2026-02-04 04:33:36.655 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 04:33:36.656 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 04:33:36.656 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 04:33:36.656 DEBUG [src.node.docker_mananger] docker run -i -t -p 31150:31150 -p 31151:31151 -p 31152:31152 -p 31153:31153 -p 31154:31154 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31152 --rest-port=31150 --tcp-port=31151 --discv5-udp-port=31153 --rest-address=0.0.0.0 --nat=extip:172.18.228.110 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=53a2001ddc89dabb2ceb7836d3f772d229cef0f301595d2b02e5c3cdcfce363d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31154 --metrics-logging=true --store=false --relay=true
2026-02-04 04:33:36.856 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.228.110 waku b304df75e918f9f678ee2a089d663e76b35cf7b07bd0f54448410ab982059d39
2026-02-04 04:33:36.888 DEBUG [src.node.docker_mananger] Container started with ID b304df75e918. Setting up logs at ./log/docker/publishing_node1_2026-02-04_04-33-36__a06195ef-8611-4e55-974b-7dae652ca51a__wakuorg_nwaku:latest.log
2026-02-04 04:33:36.892 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 31150
2026-02-04 04:33:36.892 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 04:33:36.898 ERROR [src.node.docker_mananger] Max retries reached for container e778d87a66dd. Exiting log stream.
2026-02-04 04:33:37.446 ERROR [src.node.docker_mananger] Max retries reached for container ac0f85294384. Exiting log stream.
2026-02-04 04:33:37.893 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31150/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:33:37.896 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 04:33:37.897 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 04:33:37.897 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31150/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:33:37.900 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.228.110/tcp/31151/p2p/16Uiu2HAmEvgxtsxkrYtd694rQ6YZqUswPqVSrFLgJdogQ24xHtCW","/ip4/172.18.228.110/tcp/31152/ws/p2p/16Uiu2HAmEvgxtsxkrYtd694rQ6YZqUswPqVSrFLgJdogQ24xHtCW"],"enrUri":"enr:-L24QPjuHpyq1WjXdQPlCTqN_txfYkZng7D5G5iGLcbndyrgaw1A9tBjQyFVTqLwGduivDXEbXz8M_SgH8Fyjv9DS_0CgmlkgnY0gmlwhKwS5G6KbXVsdGlhZGRyc5YACASsEuRuBnmvAAoErBLkbgZ5sN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDIb0CHRbDsUFyE6kCzKEF6lkcI_uz4Edj58DrJrgNBVeDdGNwgnmvg3VkcIJ5sYV3YWt1MgE"}'
2026-02-04 04:33:37.900 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 04:33:37.907 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 04:33:37.907 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-02-04_04-33-36__a06195ef-8611-4e55-974b-7dae652ca51a__wakuorg_nwaku:latest.log
2026-02-04 04:33:37.908 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 04:33:37.908 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 04:33:37.909 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 04:33:37.909 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.130.193
2026-02-04 04:33:37.910 DEBUG [src.node.docker_mananger] Generated ports ['3474', '3475', '3476', '3477', '3478']
2026-02-04 04:33:37.910 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 04:33:37.910 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 04:33:37.910 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 04:33:37.910 DEBUG [src.node.docker_mananger] docker run -i -t -p 3474:3474 -p 3475:3475 -p 3476:3476 -p 3477:3477 -p 3478:3478 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3476 --rest-port=3474 --tcp-port=3475 --discv5-udp-port=3477 --rest-address=0.0.0.0 --nat=extip:172.18.130.193 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c827e8b462b0a22c7dbd7d5ac3ebeb0b72994bf5cbf7ece76c1d5f14b91cfbae --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3478 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QPjuHpyq1WjXdQPlCTqN_txfYkZng7D5G5iGLcbndyrgaw1A9tBjQyFVTqLwGduivDXEbXz8M_SgH8Fyjv9DS_0CgmlkgnY0gmlwhKwS5G6KbXVsdGlhZGRyc5YACASsEuRuBnmvAAoErBLkbgZ5sN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDIb0CHRbDsUFyE6kCzKEF6lkcI_uz4Edj58DrJrgNBVeDdGNwgnmvg3VkcIJ5sYV3YWt1MgE --storenode=/ip4/172.18.228.110/tcp/31151/p2p/16Uiu2HAmEvgxtsxkrYtd694rQ6YZqUswPqVSrFLgJdogQ24xHtCW --store=true --relay=true
2026-02-04 04:33:38.097 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.130.193 waku 2cfe57e14484c2161329a0f8e001cef416dc0e90aba07c8c7f29a9c76f0e46ca
2026-02-04 04:33:38.134 DEBUG [src.node.docker_mananger] Container started with ID 2cfe57e14484. Setting up logs at ./log/docker/store_node1_2026-02-04_04-33-36__a06195ef-8611-4e55-974b-7dae652ca51a__wakuorg_nwaku:latest.log
2026-02-04 04:33:38.135 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 3474
2026-02-04 04:33:38.135 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 04:33:39.136 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3474/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:33:39.140 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 04:33:39.140 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 04:33:39.141 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3474/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:33:39.143 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.130.193/tcp/3475/p2p/16Uiu2HAm9YLWab3MaHg4K8ARLXyN21UuvooTD8VPeVba5Ggr2Roi","/ip4/172.18.130.193/tcp/3476/ws/p2p/16Uiu2HAm9YLWab3MaHg4K8ARLXyN21UuvooTD8VPeVba5Ggr2Roi"],"enrUri":"enr:-L24QOWBf4WwttCO8ITPml_ECnitWvuqmK2o-Q6MWN7yMoMVVPknQu3-WrTddVC1TLd1cNK7hL6tQ2X5hk2SxLqNsTACgmlkgnY0gmlwhKwSgsGKbXVsdGlhZGRyc5YACASsEoLBBg2TAAoErBKCwQYNlN0DgnJzhQADAQAAiXNlY3AyNTZrMaEC0birMmHmEydZ91a4cmhjYz7G0NC7Dtf9al3Nwe4jwE2DdGNwgg2Tg3VkcIINlYV3YWt1MgM"}'
2026-02-04 04:33:39.143 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 04:33:39.144 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3474/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.228.110/tcp/31151/p2p/16Uiu2HAmEvgxtsxkrYtd694rQ6YZqUswPqVSrFLgJdogQ24xHtCW"]'
2026-02-04 04:33:39.146 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 04:33:39.147 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31150/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 04:33:39.149 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 04:33:39.149 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3474/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 04:33:39.152 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 04:33:39.152 DEBUG [src.steps.store] Relaying message
2026-02-04 04:33:39.152 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31150/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 04:33:39.157 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 04:33:39.157 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 04:33:39.358 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-04 04:33:39.359 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3474/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:33:39.362 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xbc64249ece6c5ea60f8f28b7c209fb943182ce7fa22d56177cf0b6a7c9db6cc5"}]}'
2026-02-04 04:33:39.362 DEBUG [src.steps.store] messages length is 1
2026-02-04 04:33:39.363 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 04:33:39.365 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 04:33:39.365 DEBUG [src.node.waku_node] Stopping container with id b304df75e918
2026-02-04 04:33:39.895 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 04:33:39.895 DEBUG [src.node.waku_node] Stopping container with id 2cfe57e14484
2026-02-04 04:33:40.459 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 04:33:40.462 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 04:33:40.467 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 04:33:40.472 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
