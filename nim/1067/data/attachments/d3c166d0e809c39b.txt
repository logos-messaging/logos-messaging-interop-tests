2026-02-04 04:39:48.075 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 04:39:48.077 DEBUG [tests.conftest] Running test: test_message_with_ephemeral_false with id: 2026-02-04_04-39-48__111c7e57-aaa1-4296-bd6c-aab34ea93efc
2026-02-04 04:39:48.078 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 04:39:48.079 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-02-04 04:39:48.079 DEBUG [src.steps.store] Running fixture setup: node_setup
2026-02-04 04:39:48.088 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 04:39:48.088 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-02-04_04-39-48__111c7e57-aaa1-4296-bd6c-aab34ea93efc__wakuorg_nwaku:latest.log
2026-02-04 04:39:48.088 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 04:39:48.089 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 04:39:48.091 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 04:39:48.091 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.218.61
2026-02-04 04:39:48.092 DEBUG [src.node.docker_mananger] Generated ports ['63274', '63275', '63276', '63277', '63278']
2026-02-04 04:39:48.092 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 04:39:48.092 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 04:39:48.093 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 04:39:48.093 DEBUG [src.node.docker_mananger] docker run -i -t -p 63274:63274 -p 63275:63275 -p 63276:63276 -p 63277:63277 -p 63278:63278 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=63276 --rest-port=63274 --tcp-port=63275 --discv5-udp-port=63277 --rest-address=0.0.0.0 --nat=extip:172.18.218.61 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b34ae1c530b41e4aaec032a339d3d30bcd4bde8c5b76cff1b0ceac45b95449cf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=63278 --metrics-logging=true --store=true --relay=true
2026-02-04 04:39:48.287 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.218.61 waku 2dfe6162442b80869036cbb704efe7ed55327c1826266ec0c8bd0ac182916a01
2026-02-04 04:39:48.321 DEBUG [src.node.docker_mananger] Container started with ID 2dfe6162442b. Setting up logs at ./log/docker/publishing_node1_2026-02-04_04-39-48__111c7e57-aaa1-4296-bd6c-aab34ea93efc__wakuorg_nwaku:latest.log
2026-02-04 04:39:48.322 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 63274
2026-02-04 04:39:48.322 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 04:39:48.330 ERROR [src.node.docker_mananger] Max retries reached for container 27e54fa3d6b0. Exiting log stream.
2026-02-04 04:39:48.916 ERROR [src.node.docker_mananger] Max retries reached for container b7ea0ddc6bb1. Exiting log stream.
2026-02-04 04:39:49.323 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63274/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:39:49.327 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 04:39:49.327 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 04:39:49.327 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63274/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:39:49.329 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.218.61/tcp/63275/p2p/16Uiu2HAkuzxJRY9Ji5gm5zQfRujh6qWCKphpHEpwJTt1c1WCKKmo","/ip4/172.18.218.61/tcp/63276/ws/p2p/16Uiu2HAkuzxJRY9Ji5gm5zQfRujh6qWCKphpHEpwJTt1c1WCKKmo"],"enrUri":"enr:-L24QO_pYP43cz6Y8tY6ak3A8QS-bLE9CfjwY-7jeS6nYZToQqddVLgugdBMcRCgOVtc7-bKZd4rSE6DyhpqwlU36sICgmlkgnY0gmlwhKwS2j2KbXVsdGlhZGRyc5YACASsEto9BvcrAAoErBLaPQb3LN0DgnJzhQADAQAAiXNlY3AyNTZrMaECCIafA-8TPIc6HvEvCRp7sNhdtmFrpinrBAYyyDCQ_c6DdGNwgvcrg3VkcIL3LYV3YWt1MgM"}'
2026-02-04 04:39:49.330 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 04:39:49.337 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 04:39:49.337 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-02-04_04-39-48__111c7e57-aaa1-4296-bd6c-aab34ea93efc__wakuorg_nwaku:latest.log
2026-02-04 04:39:49.337 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 04:39:49.337 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 04:39:49.339 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 04:39:49.339 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.53.183
2026-02-04 04:39:49.339 DEBUG [src.node.docker_mananger] Generated ports ['29477', '29478', '29479', '29480', '29481']
2026-02-04 04:39:49.339 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 04:39:49.339 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 04:39:49.339 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 04:39:49.340 DEBUG [src.node.docker_mananger] docker run -i -t -p 29477:29477 -p 29478:29478 -p 29479:29479 -p 29480:29480 -p 29481:29481 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29479 --rest-port=29477 --tcp-port=29478 --discv5-udp-port=29480 --rest-address=0.0.0.0 --nat=extip:172.18.53.183 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a85c8e0e73626a80e70e6f14dba40a20be83c9cb20164cebcaeb8aeb1e09b4c9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29481 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QO_pYP43cz6Y8tY6ak3A8QS-bLE9CfjwY-7jeS6nYZToQqddVLgugdBMcRCgOVtc7-bKZd4rSE6DyhpqwlU36sICgmlkgnY0gmlwhKwS2j2KbXVsdGlhZGRyc5YACASsEto9BvcrAAoErBLaPQb3LN0DgnJzhQADAQAAiXNlY3AyNTZrMaECCIafA-8TPIc6HvEvCRp7sNhdtmFrpinrBAYyyDCQ_c6DdGNwgvcrg3VkcIL3LYV3YWt1MgM --storenode=/ip4/172.18.218.61/tcp/63275/p2p/16Uiu2HAkuzxJRY9Ji5gm5zQfRujh6qWCKphpHEpwJTt1c1WCKKmo --store=true --relay=true
2026-02-04 04:39:49.526 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.53.183 waku 9348800cc6bcf0c06c368f10872b446c6c10dbdb37188b01301cefb36c9efdd3
2026-02-04 04:39:49.561 DEBUG [src.node.docker_mananger] Container started with ID 9348800cc6bc. Setting up logs at ./log/docker/store_node1_2026-02-04_04-39-48__111c7e57-aaa1-4296-bd6c-aab34ea93efc__wakuorg_nwaku:latest.log
2026-02-04 04:39:49.561 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 29477
2026-02-04 04:39:49.561 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 04:39:50.562 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29477/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:39:50.566 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 04:39:50.566 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 04:39:50.566 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29477/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:39:50.569 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.53.183/tcp/29478/p2p/16Uiu2HAmHdrAbJJnA7ZtVBw1K2ZcaYbp4T9f8mjwXsWQGF1nsYws","/ip4/172.18.53.183/tcp/29479/ws/p2p/16Uiu2HAmHdrAbJJnA7ZtVBw1K2ZcaYbp4T9f8mjwXsWQGF1nsYws"],"enrUri":"enr:-L24QAxfRNXp2yjFaOSFeKTNF70l2crlYP-Z3EFUVSUfIsjWRSnl2m5EBu2ZCMIvYR-WLDmEqnnNTHslTtHR4qcq4rcCgmlkgnY0gmlwhKwSNbeKbXVsdGlhZGRyc5YACASsEjW3BnMmAAoErBI1twZzJ90DgnJzhQADAQAAiXNlY3AyNTZrMaEDSf-ZgjeitKix3tUFR2Db7sxXpv8gxp1gl0ZmgtskIWqDdGNwgnMmg3VkcIJzKIV3YWt1MgM"}'
2026-02-04 04:39:50.569 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 04:39:50.570 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29477/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.218.61/tcp/63275/p2p/16Uiu2HAkuzxJRY9Ji5gm5zQfRujh6qWCKphpHEpwJTt1c1WCKKmo"]'
2026-02-04 04:39:50.572 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 04:39:50.573 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63274/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 04:39:50.575 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 04:39:50.575 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29477/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 04:39:50.577 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 04:39:50.578 DEBUG [src.steps.store] Relaying message
2026-02-04 04:39:50.578 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63274/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
2026-02-04 04:39:50.583 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 04:39:50.584 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 04:39:50.785 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-04 04:39:50.785 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63274/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:39:50.788 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xdbca82ae55f93ac5fb165a8b8082d04250585133dd4f4037a24e1044b1b932b3"}]}'
2026-02-04 04:39:50.789 DEBUG [src.steps.store] messages length is 1
2026-02-04 04:39:50.789 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-04 04:39:50.789 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29477/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:39:50.792 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xdbca82ae55f93ac5fb165a8b8082d04250585133dd4f4037a24e1044b1b932b3"}]}'
2026-02-04 04:39:50.793 DEBUG [src.steps.store] messages length is 1
2026-02-04 04:39:50.794 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 04:39:50.795 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 04:39:50.796 DEBUG [src.node.waku_node] Stopping container with id 2dfe6162442b
2026-02-04 04:39:51.375 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 04:39:51.377 DEBUG [src.node.waku_node] Stopping container with id 9348800cc6bc
2026-02-04 04:39:51.930 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 04:39:51.931 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 04:39:51.938 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 04:39:51.943 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
