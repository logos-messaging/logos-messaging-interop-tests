2026-02-04 04:32:09.093 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 04:32:09.094 DEBUG [tests.conftest] Running test: test_filter_resubscribe_to_unsubscribed_topics with id: 2026-02-04_04-32-09__36fddf73-62f2-458d-a20c-d10d656ab3d4
2026-02-04 04:32:09.094 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 04:32:09.094 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2026-02-04 04:32:09.094 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2026-02-04 04:32:09.101 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 04:32:09.101 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-04_04-32-09__36fddf73-62f2-458d-a20c-d10d656ab3d4__wakuorg_nwaku:latest.log
2026-02-04 04:32:09.101 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 04:32:09.101 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 04:32:09.102 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 04:32:09.103 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.248.40
2026-02-04 04:32:09.103 DEBUG [src.node.docker_mananger] Generated ports ['2616', '2617', '2618', '2619', '2620']
2026-02-04 04:32:09.103 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 04:32:09.103 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 04:32:09.103 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 04:32:09.103 DEBUG [src.node.docker_mananger] docker run -i -t -p 2616:2616 -p 2617:2617 -p 2618:2618 -p 2619:2619 -p 2620:2620 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=2618 --rest-port=2616 --tcp-port=2617 --discv5-udp-port=2619 --rest-address=0.0.0.0 --nat=extip:172.18.248.40 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=46dd5cccedefeda834af4cb2d31aaddb89fd9cee044adbf7bbdaf8a1f6343adb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=2620 --metrics-logging=true --relay=true --filter=true
2026-02-04 04:32:09.279 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.248.40 waku 6cb4b133ac6aee33288f9dee8e8850864a578993b981e93c8ca290361307f34a
2026-02-04 04:32:09.316 DEBUG [src.node.docker_mananger] Container started with ID 6cb4b133ac6a. Setting up logs at ./log/docker/node1_2026-02-04_04-32-09__36fddf73-62f2-458d-a20c-d10d656ab3d4__wakuorg_nwaku:latest.log
2026-02-04 04:32:09.317 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 2616
2026-02-04 04:32:09.318 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 04:32:09.356 ERROR [src.node.docker_mananger] Max retries reached for container 187a7c6d1e68. Exiting log stream.
2026-02-04 04:32:09.898 ERROR [src.node.docker_mananger] Max retries reached for container df1e10d05190. Exiting log stream.
2026-02-04 04:32:10.318 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2616/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:32:10.322 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 04:32:10.322 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 04:32:10.322 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2616/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:32:10.324 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.248.40/tcp/2617/p2p/16Uiu2HAm6UUnTFnGfxuY1e3vRZzPSc4c8B671uPGC9XB69yPg7fC","/ip4/172.18.248.40/tcp/2618/ws/p2p/16Uiu2HAm6UUnTFnGfxuY1e3vRZzPSc4c8B671uPGC9XB69yPg7fC"],"enrUri":"enr:-L24QMCajIcr60ECK95lnw4axB8tQgksozsmO2ckRvIEDymkD3AAjpOSzf7ATYiDLdH0kK_dAGU9VkPPZZ5WH5gzJj4CgmlkgnY0gmlwhKwS-CiKbXVsdGlhZGRyc5YACASsEvgoBgo5AAoErBL4KAYKOt0DgnJzhQADAQAAiXNlY3AyNTZrMaECpCijyj88R4FGHw9ChQ4jHU4JxmkUxMMWZulYNfLqsneDdGNwggo5g3VkcIIKO4V3YWt1MgU"}'
2026-02-04 04:32:10.324 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 04:32:10.325 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2026-02-04 04:32:10.331 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 04:32:10.331 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-04_04-32-09__36fddf73-62f2-458d-a20c-d10d656ab3d4__wakuorg_nwaku:latest.log
2026-02-04 04:32:10.332 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 04:32:10.332 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 04:32:10.333 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 04:32:10.333 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.0.51
2026-02-04 04:32:10.333 DEBUG [src.node.docker_mananger] Generated ports ['33221', '33222', '33223', '33224', '33225']
2026-02-04 04:32:10.333 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 04:32:10.333 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 04:32:10.334 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 04:32:10.334 DEBUG [src.node.docker_mananger] docker run -i -t -p 33221:33221 -p 33222:33222 -p 33223:33223 -p 33224:33224 -p 33225:33225 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33223 --rest-port=33221 --tcp-port=33222 --discv5-udp-port=33224 --rest-address=0.0.0.0 --nat=extip:172.18.0.51 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7eec3ba40bacfecfdba5a6a5ee72f0c94c6a1dc2c636320f8a76b3ce711b3eab --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33225 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QMCajIcr60ECK95lnw4axB8tQgksozsmO2ckRvIEDymkD3AAjpOSzf7ATYiDLdH0kK_dAGU9VkPPZZ5WH5gzJj4CgmlkgnY0gmlwhKwS-CiKbXVsdGlhZGRyc5YACASsEvgoBgo5AAoErBL4KAYKOt0DgnJzhQADAQAAiXNlY3AyNTZrMaECpCijyj88R4FGHw9ChQ4jHU4JxmkUxMMWZulYNfLqsneDdGNwggo5g3VkcIIKO4V3YWt1MgU --filternode=/ip4/172.18.248.40/tcp/2617/p2p/16Uiu2HAm6UUnTFnGfxuY1e3vRZzPSc4c8B671uPGC9XB69yPg7fC
2026-02-04 04:32:10.519 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.0.51 waku 1a32d71a4ee7da9fe14cd3d10ea7c7d164a8c9219d32f84a8d5cc5f4c05be3fb
2026-02-04 04:32:10.553 DEBUG [src.node.docker_mananger] Container started with ID 1a32d71a4ee7. Setting up logs at ./log/docker/node2_2026-02-04_04-32-09__36fddf73-62f2-458d-a20c-d10d656ab3d4__wakuorg_nwaku:latest.log
2026-02-04 04:32:10.553 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 33221
2026-02-04 04:32:10.553 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 04:32:11.554 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33221/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:32:11.558 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-04 04:32:11.558 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 04:32:11.558 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33221/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:32:11.560 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.0.51/tcp/33222/p2p/16Uiu2HAmEyJv2pEQfJ5ZoQXfTDQbTdsMQABqtvWe52sJa13Qr8Ci","/ip4/172.18.0.51/tcp/33223/ws/p2p/16Uiu2HAmEyJv2pEQfJ5ZoQXfTDQbTdsMQABqtvWe52sJa13Qr8Ci"],"enrUri":"enr:-L24QKA_X-YO_SAeaoBUi3XvOI9t--ZVP16QhCqmWnkmkpKLZUf-bJwqMDMLA-xcCOLBj6qNk09bAZhN2V4JB4JbVTQCgmlkgnY0gmlwhKwSADOKbXVsdGlhZGRyc5YACASsEgAzBoHGAAoErBIAMwaBx90DgnJzhQADAQAAiXNlY3AyNTZrMaEDImjRw1fLwJ3I6c8wt_DGVU7iv77BDEtmgQooUH8WK3uDdGNwgoHGg3VkcIKByIV3YWt1MgA"}'
2026-02-04 04:32:11.561 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 04:32:11.561 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33221/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.248.40/tcp/2617/p2p/16Uiu2HAm6UUnTFnGfxuY1e3vRZzPSc4c8B671uPGC9XB69yPg7fC"]'
2026-02-04 04:32:11.590 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 04:32:11.590 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2026-02-04 04:32:11.591 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2616/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-04 04:32:11.604 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 04:32:11.605 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33221/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "e6e4e02f-66dc-4dad-8e3e-50a871c6d233", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-04 04:32:11.617 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"e6e4e02f-66dc-4dad-8e3e-50a871c6d233","statusDesc":"OK"}'
2026-02-04 04:32:11.619 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2616/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 04:32:11.627 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 04:32:11.627 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-04 04:32:11.727 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-04 04:32:11.728 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33221/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:32:11.732 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1770179531619287335,"ephemeral":false}]'
2026-02-04 04:32:11.734 INFO [src.node.api_clients.base_client] curl -v -X DELETE "http://127.0.0.1:33221/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-04 04:32:11.743 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
2026-02-04 04:32:11.743 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2616/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 04:32:11.747 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 04:32:11.747 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-04 04:32:11.847 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-04 04:32:11.848 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33221/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:32:11.851 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:33221/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto. Response content: b'Not subscribed to topic: /test/1/waku-filter/proto'
2026-02-04 04:32:11.853 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2616/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-04 04:32:11.855 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 04:32:11.856 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33221/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "5de72cf6-54fa-4f52-bbf6-4ccb0de1955a", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-04 04:32:11.865 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"5de72cf6-54fa-4f52-bbf6-4ccb0de1955a","statusDesc":"OK"}'
2026-02-04 04:32:11.865 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2616/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 04:32:11.870 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 04:32:11.870 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-04 04:32:11.970 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-04 04:32:11.971 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33221/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-04 04:32:11.974 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1770179531865800956,"ephemeral":false}]'
2026-02-04 04:32:11.977 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 04:32:11.978 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 04:32:11.978 DEBUG [src.node.waku_node] Stopping container with id 6cb4b133ac6a
2026-02-04 04:32:12.508 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 04:32:12.509 DEBUG [src.node.waku_node] Stopping container with id 1a32d71a4ee7
2026-02-04 04:32:13.001 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 04:32:13.002 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 04:32:13.008 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 04:32:13.015 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
