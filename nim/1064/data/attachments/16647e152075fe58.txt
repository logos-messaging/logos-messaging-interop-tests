2026-02-01 04:45:04.097 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-01 04:45:04.097 DEBUG [tests.conftest] Running test: test_filter_works_with_static_sharding with id: 2026-02-01_04-45-04__afc50834-1533-469c-8af0-8d0329b34ba5
2026-02-01 04:45:04.097 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-01 04:45:04.098 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-01 04:45:04.098 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-01 04:45:04.105 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-01 04:45:04.105 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-01_04-45-04__afc50834-1533-469c-8af0-8d0329b34ba5__wakuorg_nwaku:latest.log
2026-02-01 04:45:04.105 DEBUG [src.node.waku_node] Starting Node...
2026-02-01 04:45:04.105 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-01 04:45:04.107 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-01 04:45:04.107 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.226.245
2026-02-01 04:45:04.107 DEBUG [src.node.docker_mananger] Generated ports ['23181', '23182', '23183', '23184', '23185']
2026-02-01 04:45:04.107 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-01 04:45:04.107 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-01 04:45:04.107 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-01 04:45:04.107 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-01 04:45:04.108 DEBUG [src.node.waku_node] Using volumes []
2026-02-01 04:45:04.108 DEBUG [src.node.docker_mananger] docker run -i -t -p 23181:23181 -p 23182:23182 -p 23183:23183 -p 23184:23184 -p 23185:23185 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23183 --rest-port=23181 --tcp-port=23182 --discv5-udp-port=23184 --rest-address=0.0.0.0 --nat=extip:172.18.226.245 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=4b80d5b5da63da150cd8b06aa96cac1cdbdbebb9bffd47d3c6d4624b294feb70 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23185 --metrics-logging=true --relay=true --filter=true
2026-02-01 04:45:04.297 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.226.245 waku 45eb174397ec90240b9a8eec7119e8a7265f7d3241aee1430955e29eb9bce4cb
2026-02-01 04:45:04.329 DEBUG [src.node.docker_mananger] Container started with ID 45eb174397ec. Setting up logs at ./log/docker/node1_2026-02-01_04-45-04__afc50834-1533-469c-8af0-8d0329b34ba5__wakuorg_nwaku:latest.log
2026-02-01 04:45:04.330 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 23181
2026-02-01 04:45:04.330 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-01 04:45:04.356 ERROR [src.node.docker_mananger] Max retries reached for container 6a2c32f98fc4. Exiting log stream.
2026-02-01 04:45:04.904 ERROR [src.node.docker_mananger] Max retries reached for container 665405c71c57. Exiting log stream.
2026-02-01 04:45:05.331 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23181/health" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:05.334 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-01 04:45:05.334 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-01 04:45:05.334 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23181/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:05.337 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.226.245/tcp/23182/p2p/16Uiu2HAm2zUgbThckZw5L1yD7CTmxJrV5De7KF2zqyFZLT38Afr9","/ip4/172.18.226.245/tcp/23183/ws/p2p/16Uiu2HAm2zUgbThckZw5L1yD7CTmxJrV5De7KF2zqyFZLT38Afr9"],"enrUri":"enr:-L24QHUzrMsgDZAiP0wmbKpvK1uwUKXzEySDRnj29qvX4J2kc7ykar6PSynI3fx3LwgpjWJIfnrsE59a84Ee8i1W8SgCgmlkgnY0gmlwhKwS4vWKbXVsdGlhZGRyc5YACASsEuL1BlqOAAoErBLi9QZaj90DgnJzhQACAQAAiXNlY3AyNTZrMaECcGkzwMdwPXGp72T0OAHhlk3bZyYr3-tRMjEt7kQjVpKDdGNwglqOg3VkcIJakIV3YWt1MgU"}'
2026-02-01 04:45:05.337 INFO [src.node.waku_node] REST service is ready !!
2026-02-01 04:45:05.343 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-01 04:45:05.343 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-01_04-45-04__afc50834-1533-469c-8af0-8d0329b34ba5__wakuorg_nwaku:latest.log
2026-02-01 04:45:05.343 DEBUG [src.node.waku_node] Starting Node...
2026-02-01 04:45:05.344 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-01 04:45:05.345 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-01 04:45:05.345 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.195.160
2026-02-01 04:45:05.345 DEBUG [src.node.docker_mananger] Generated ports ['3492', '3493', '3494', '3495', '3496']
2026-02-01 04:45:05.345 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-01 04:45:05.345 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-01 04:45:05.346 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-01 04:45:05.346 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-01 04:45:05.346 DEBUG [src.node.waku_node] Using volumes []
2026-02-01 04:45:05.346 DEBUG [src.node.docker_mananger] docker run -i -t -p 3492:3492 -p 3493:3493 -p 3494:3494 -p 3495:3495 -p 3496:3496 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3494 --rest-port=3492 --tcp-port=3493 --discv5-udp-port=3495 --rest-address=0.0.0.0 --nat=extip:172.18.195.160 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=aeb7e052bd2c3c8ce3fdafe9e4dee8ffc7f0aecf1a488a2cca18fedcf61a28ac --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3496 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QHUzrMsgDZAiP0wmbKpvK1uwUKXzEySDRnj29qvX4J2kc7ykar6PSynI3fx3LwgpjWJIfnrsE59a84Ee8i1W8SgCgmlkgnY0gmlwhKwS4vWKbXVsdGlhZGRyc5YACASsEuL1BlqOAAoErBLi9QZaj90DgnJzhQACAQAAiXNlY3AyNTZrMaECcGkzwMdwPXGp72T0OAHhlk3bZyYr3-tRMjEt7kQjVpKDdGNwglqOg3VkcIJakIV3YWt1MgU --filternode=/ip4/172.18.226.245/tcp/23182/p2p/16Uiu2HAm2zUgbThckZw5L1yD7CTmxJrV5De7KF2zqyFZLT38Afr9
2026-02-01 04:45:05.532 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.195.160 waku 64bf2371706a45fe197136284d5b24a5936bcf7f63d7133e064c2701295d8403
2026-02-01 04:45:05.562 DEBUG [src.node.docker_mananger] Container started with ID 64bf2371706a. Setting up logs at ./log/docker/node2_2026-02-01_04-45-04__afc50834-1533-469c-8af0-8d0329b34ba5__wakuorg_nwaku:latest.log
2026-02-01 04:45:05.563 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 3492
2026-02-01 04:45:05.563 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-01 04:45:06.563 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3492/health" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:06.567 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-01 04:45:06.568 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-01 04:45:06.568 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3492/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:06.570 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.195.160/tcp/3493/p2p/16Uiu2HAmEQPyhbggCXrLQong4t4MT5jvLPt9NJQkP4e6nxfyGzKR","/ip4/172.18.195.160/tcp/3494/ws/p2p/16Uiu2HAmEQPyhbggCXrLQong4t4MT5jvLPt9NJQkP4e6nxfyGzKR"],"enrUri":"enr:-L24QJZkY-J9sWuVviFErFtJnCG3vjX9dY9_VTbpj1f3kaCTatIuVMHvM5LQxwK1fmDuhEzfhaDGLy37RpUCLoH9PFkCgmlkgnY0gmlwhKwSw6CKbXVsdGlhZGRyc5YACASsEsOgBg2lAAoErBLDoAYNpt0DgnJzhQACAQAAiXNlY3AyNTZrMaEDGfpgsqgZBeak4yWar0eupi7R_9DwJf6f6ItwyORcjgiDdGNwgg2lg3VkcIINp4V3YWt1MgA"}'
2026-02-01 04:45:06.570 INFO [src.node.waku_node] REST service is ready !!
2026-02-01 04:45:06.571 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3492/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.226.245/tcp/23182/p2p/16Uiu2HAm2zUgbThckZw5L1yD7CTmxJrV5De7KF2zqyFZLT38Afr9"]'
2026-02-01 04:45:06.601 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-01 04:45:06.602 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23181/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2026-02-01 04:45:06.612 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-01 04:45:06.612 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3492/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "fdb407cd-b97f-4a6b-bb34-6bc1be8935b6", "contentFilters": ["/myapp/1/latest/proto"], "pubsubTopic": "/waku/2/rs/2/0"}'
2026-02-01 04:45:06.625 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"fdb407cd-b97f-4a6b-bb34-6bc1be8935b6","statusDesc":"OK"}'
2026-02-01 04:45:06.625 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23181/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-01 04:45:06.632 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-01 04:45:06.632 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-01 04:45:06.732 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-01 04:45:06.733 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3492/filter/v2/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:06.735 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1769921106625763692,"ephemeral":false}]'
2026-02-01 04:45:06.738 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-01 04:45:06.739 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-01 04:45:06.739 DEBUG [src.node.waku_node] Stopping container with id 45eb174397ec
2026-02-01 04:45:07.275 DEBUG [src.node.waku_node] Container stopped.
2026-02-01 04:45:07.276 DEBUG [src.node.waku_node] Stopping container with id 64bf2371706a
2026-02-01 04:45:07.798 DEBUG [src.node.waku_node] Container stopped.
2026-02-01 04:45:07.800 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-01 04:45:07.805 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-01 04:45:07.810 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
