2026-02-01 04:45:28.945 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-01 04:45:28.946 DEBUG [tests.conftest] Running test: test_subscribe_and_publish_on_another_content_topic_from_another_shard with id: 2026-02-01_04-45-28__0213ab90-a507-4cd9-979b-cc53ea282591
2026-02-01 04:45:28.946 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-01 04:45:28.947 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-01 04:45:28.947 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-01 04:45:28.954 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-01 04:45:28.955 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-01_04-45-28__0213ab90-a507-4cd9-979b-cc53ea282591__wakuorg_nwaku:latest.log
2026-02-01 04:45:28.955 DEBUG [src.node.waku_node] Starting Node...
2026-02-01 04:45:28.955 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-01 04:45:28.957 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-01 04:45:28.957 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.177.136
2026-02-01 04:45:28.957 DEBUG [src.node.docker_mananger] Generated ports ['18779', '18780', '18781', '18782', '18783']
2026-02-01 04:45:28.957 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-01 04:45:28.957 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-01 04:45:28.958 DEBUG [src.node.waku_node] Using volumes []
2026-02-01 04:45:28.958 DEBUG [src.node.docker_mananger] docker run -i -t -p 18779:18779 -p 18780:18780 -p 18781:18781 -p 18782:18782 -p 18783:18783 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18781 --rest-port=18779 --tcp-port=18780 --discv5-udp-port=18782 --rest-address=0.0.0.0 --nat=extip:172.18.177.136 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=b8bbc15ab274c67ef62c581149fd2601e1bbee8cdd8caafd4a956f4df9f7d5ae --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18783 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto --num-shards-in-network=8
2026-02-01 04:45:29.143 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.177.136 waku ff3f689bf8f72c68b5c86f61b18eeccf6e970b40ad62da7bdf3667a9a1835b74
2026-02-01 04:45:29.177 DEBUG [src.node.docker_mananger] Container started with ID ff3f689bf8f7. Setting up logs at ./log/docker/node1_2026-02-01_04-45-28__0213ab90-a507-4cd9-979b-cc53ea282591__wakuorg_nwaku:latest.log
2026-02-01 04:45:29.177 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 18779
2026-02-01 04:45:29.178 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-01 04:45:29.757 ERROR [src.node.docker_mananger] Max retries reached for container 7bd313266dd9. Exiting log stream.
2026-02-01 04:45:30.179 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18779/health" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:30.182 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-01 04:45:30.182 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-01 04:45:30.183 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18779/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:30.185 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.177.136/tcp/18780/p2p/16Uiu2HAmHoec4qapWrgRkGk83NvVBr8HdeTvY5wZJd2HD4ytBrjB","/ip4/172.18.177.136/tcp/18781/ws/p2p/16Uiu2HAmHoec4qapWrgRkGk83NvVBr8HdeTvY5wZJd2HD4ytBrjB"],"enrUri":"enr:-L24QOkxvw79GVyz5gLY7UaQha4CpQlDut4Z-09yR_ULtutyds9F4rUDECkWR8sBgaIsVGCrLmz2ZTvYDbleCuXHxIgCgmlkgnY0gmlwhKwSsYiKbXVsdGlhZGRyc5YACASsErGIBklcAAoErBKxiAZJXd0DgnJzhQACAQAAiXNlY3AyNTZrMaEDTIJV_tBsGa4MQvwElQRa9hEIWmdBY7ZYx8KDUJLBevKDdGNwgklcg3VkcIJJXoV3YWt1MgU"}'
2026-02-01 04:45:30.185 INFO [src.node.waku_node] REST service is ready !!
2026-02-01 04:45:30.191 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-01 04:45:30.192 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-01_04-45-28__0213ab90-a507-4cd9-979b-cc53ea282591__wakuorg_nwaku:latest.log
2026-02-01 04:45:30.192 DEBUG [src.node.waku_node] Starting Node...
2026-02-01 04:45:30.192 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-01 04:45:30.193 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-01 04:45:30.193 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.50.29
2026-02-01 04:45:30.193 DEBUG [src.node.docker_mananger] Generated ports ['22483', '22484', '22485', '22486', '22487']
2026-02-01 04:45:30.193 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-01 04:45:30.194 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-01 04:45:30.194 DEBUG [src.node.waku_node] Using volumes []
2026-02-01 04:45:30.194 DEBUG [src.node.docker_mananger] docker run -i -t -p 22483:22483 -p 22484:22484 -p 22485:22485 -p 22486:22486 -p 22487:22487 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22485 --rest-port=22483 --tcp-port=22484 --discv5-udp-port=22486 --rest-address=0.0.0.0 --nat=extip:172.18.50.29 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=2ceadef289cd0a43d30add579e448bf1937ff093c9e0e2c5cb7c5ccfa05d9e9e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22487 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QOkxvw79GVyz5gLY7UaQha4CpQlDut4Z-09yR_ULtutyds9F4rUDECkWR8sBgaIsVGCrLmz2ZTvYDbleCuXHxIgCgmlkgnY0gmlwhKwSsYiKbXVsdGlhZGRyc5YACASsErGIBklcAAoErBKxiAZJXd0DgnJzhQACAQAAiXNlY3AyNTZrMaEDTIJV_tBsGa4MQvwElQRa9hEIWmdBY7ZYx8KDUJLBevKDdGNwgklcg3VkcIJJXoV3YWt1MgU --content-topic=/myapp/1/latest/proto --num-shards-in-network=8
2026-02-01 04:45:30.376 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.50.29 waku f9d910d5270c1ac68863adeb789ffe556a88149dab7d19c5dcc964ccd653c27b
2026-02-01 04:45:30.406 DEBUG [src.node.docker_mananger] Container started with ID f9d910d5270c. Setting up logs at ./log/docker/node2_2026-02-01_04-45-28__0213ab90-a507-4cd9-979b-cc53ea282591__wakuorg_nwaku:latest.log
2026-02-01 04:45:30.406 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 22483
2026-02-01 04:45:30.407 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-01 04:45:31.410 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22483/health" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:31.425 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-01 04:45:31.426 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-01 04:45:31.428 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22483/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:31.431 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.50.29/tcp/22484/p2p/16Uiu2HAmJk3CoknLTiaC44cwtjGVSqUwBDsio3azNrV9vpD5pFtt","/ip4/172.18.50.29/tcp/22485/ws/p2p/16Uiu2HAmJk3CoknLTiaC44cwtjGVSqUwBDsio3azNrV9vpD5pFtt"],"enrUri":"enr:-L24QBjNc8dE6Rs29_QgqmggjYZTuYB0zdIgcDNK-Akrh-IwKNnffAsWpIYe3-LqcwRO4g_jgmbLCCuf-1yRZxvkR9sCgmlkgnY0gmlwhKwSMh2KbXVsdGlhZGRyc5YACASsEjIdBlfUAAoErBIyHQZX1d0DgnJzhQACAQAAiXNlY3AyNTZrMaEDWnFAmV-lyx3C3MNs8oNA9XxF5XC0dNBRHGB5V4p19xGDdGNwglfUg3VkcIJX1oV3YWt1MgE"}'
2026-02-01 04:45:31.432 INFO [src.node.waku_node] REST service is ready !!
2026-02-01 04:45:31.433 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22483/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.177.136/tcp/18780/p2p/16Uiu2HAmHoec4qapWrgRkGk83NvVBr8HdeTvY5wZJd2HD4ytBrjB"]'
2026-02-01 04:45:31.436 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-01 04:45:31.436 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18779/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/toychat/2/huilong/proto"]'
2026-02-01 04:45:31.440 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-01 04:45:31.440 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22483/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/toychat/2/huilong/proto"]'
2026-02-01 04:45:31.445 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-01 04:45:31.447 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18779/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/toychat/2/huilong/proto", "timestamp": '$(date +%s%N)'}'
2026-02-01 04:45:31.452 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-01 04:45:31.452 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-01 04:45:31.552 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-01 04:45:31.553 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18779/relay/v1/auto/messages/%2Ftoychat%2F2%2Fhuilong%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:31.556 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/toychat/2/huilong/proto","version":0,"timestamp":1769921131447441922,"ephemeral":false,"proof":""}]'
2026-02-01 04:45:31.557 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-01 04:45:31.557 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22483/relay/v1/auto/messages/%2Ftoychat%2F2%2Fhuilong%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:31.560 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/toychat/2/huilong/proto","version":0,"timestamp":1769921131447441922,"ephemeral":false,"proof":""}]'
2026-02-01 04:45:31.561 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18779/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-01 04:45:31.567 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-01 04:45:31.568 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-01 04:45:31.668 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-01 04:45:31.669 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18779/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:31.672 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1769921131561657971,"ephemeral":false,"proof":""}]'
2026-02-01 04:45:31.673 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-01 04:45:31.673 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22483/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:31.675 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1769921131561657971,"ephemeral":false,"proof":""}]'
2026-02-01 04:45:31.678 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-01 04:45:31.679 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-01 04:45:31.679 DEBUG [src.node.waku_node] Stopping container with id ff3f689bf8f7
2026-02-01 04:45:32.244 DEBUG [src.node.waku_node] Container stopped.
2026-02-01 04:45:32.245 DEBUG [src.node.waku_node] Stopping container with id f9d910d5270c
2026-02-01 04:45:32.805 DEBUG [src.node.waku_node] Container stopped.
2026-02-01 04:45:32.806 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-01 04:45:32.813 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-01 04:45:32.819 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
