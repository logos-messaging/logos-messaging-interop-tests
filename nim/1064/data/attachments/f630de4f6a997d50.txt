2026-02-01 04:45:52.225 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-01 04:45:52.225 DEBUG [tests.conftest] Running test: test_filter_update_subscription_refresh_existing with id: 2026-02-01_04-45-52__ca393c95-8b50-429c-a6f7-0eadabbba145
2026-02-01 04:45:52.225 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-01 04:45:52.226 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2026-02-01 04:45:52.226 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2026-02-01 04:45:52.235 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-01 04:45:52.235 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-01_04-45-52__ca393c95-8b50-429c-a6f7-0eadabbba145__wakuorg_nwaku:latest.log
2026-02-01 04:45:52.236 DEBUG [src.node.waku_node] Starting Node...
2026-02-01 04:45:52.236 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-01 04:45:52.238 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-01 04:45:52.239 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.101.215
2026-02-01 04:45:52.239 DEBUG [src.node.docker_mananger] Generated ports ['52240', '52241', '52242', '52243', '52244']
2026-02-01 04:45:52.239 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-01 04:45:52.240 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-01 04:45:52.240 DEBUG [src.node.waku_node] Using volumes []
2026-02-01 04:45:52.240 DEBUG [src.node.docker_mananger] docker run -i -t -p 52240:52240 -p 52241:52241 -p 52242:52242 -p 52243:52243 -p 52244:52244 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=52242 --rest-port=52240 --tcp-port=52241 --discv5-udp-port=52243 --rest-address=0.0.0.0 --nat=extip:172.18.101.215 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0a59b8c49f1539c1c55f5cff0f947a85ca78def0d5f1dcb758dca91d8fb45a69 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=52244 --metrics-logging=true --relay=true --filter=true
2026-02-01 04:45:52.425 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.101.215 waku 5e7b365e290262ce94ed1a3e83f6d95425b5b72d328a593a9e89d09c80f2f4be
2026-02-01 04:45:52.456 DEBUG [src.node.docker_mananger] Container started with ID 5e7b365e2902. Setting up logs at ./log/docker/node1_2026-02-01_04-45-52__ca393c95-8b50-429c-a6f7-0eadabbba145__wakuorg_nwaku:latest.log
2026-02-01 04:45:52.456 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 52240
2026-02-01 04:45:52.456 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-01 04:45:52.504 ERROR [src.node.docker_mananger] Max retries reached for container cf4be722617d. Exiting log stream.
2026-02-01 04:45:53.052 ERROR [src.node.docker_mananger] Max retries reached for container d216ed54b57b. Exiting log stream.
2026-02-01 04:45:53.457 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:52240/health" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:53.460 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-01 04:45:53.460 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-01 04:45:53.461 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:52240/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:53.463 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.101.215/tcp/52241/p2p/16Uiu2HAmKrJUS2p4zfhryn2AkUCjgGjASYq4BJ9RvbJQoynTMm17","/ip4/172.18.101.215/tcp/52242/ws/p2p/16Uiu2HAmKrJUS2p4zfhryn2AkUCjgGjASYq4BJ9RvbJQoynTMm17"],"enrUri":"enr:-L24QCokWgCZ0Sciu88SrcYMLrm4ihzADnJSZhVzNxAV_fCjJCjGATbWEcmLMobZvT_oxKsxawcCfOwXIq11Sucy_ooCgmlkgnY0gmlwhKwSZdeKbXVsdGlhZGRyc5YACASsEmXXBswRAAoErBJl1wbMEt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDauewdWuHjdDlTe4vjxwCbrQ30Jm9hQfWWjH3L8s3MBaDdGNwgswRg3VkcILME4V3YWt1MgU"}'
2026-02-01 04:45:53.463 INFO [src.node.waku_node] REST service is ready !!
2026-02-01 04:45:53.463 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2026-02-01 04:45:53.470 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-01 04:45:53.470 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-01_04-45-52__ca393c95-8b50-429c-a6f7-0eadabbba145__wakuorg_nwaku:latest.log
2026-02-01 04:45:53.470 DEBUG [src.node.waku_node] Starting Node...
2026-02-01 04:45:53.470 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-01 04:45:53.472 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-01 04:45:53.472 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.170.147
2026-02-01 04:45:53.472 DEBUG [src.node.docker_mananger] Generated ports ['35487', '35488', '35489', '35490', '35491']
2026-02-01 04:45:53.472 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-01 04:45:53.472 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-01 04:45:53.473 DEBUG [src.node.waku_node] Using volumes []
2026-02-01 04:45:53.473 DEBUG [src.node.docker_mananger] docker run -i -t -p 35487:35487 -p 35488:35488 -p 35489:35489 -p 35490:35490 -p 35491:35491 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=35489 --rest-port=35487 --tcp-port=35488 --discv5-udp-port=35490 --rest-address=0.0.0.0 --nat=extip:172.18.170.147 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4c0630569cfcc23bd6bebdccbaca51cd9ff67fff5ab57fe7e6f2ac25eeaaf4fc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=35491 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QCokWgCZ0Sciu88SrcYMLrm4ihzADnJSZhVzNxAV_fCjJCjGATbWEcmLMobZvT_oxKsxawcCfOwXIq11Sucy_ooCgmlkgnY0gmlwhKwSZdeKbXVsdGlhZGRyc5YACASsEmXXBswRAAoErBJl1wbMEt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDauewdWuHjdDlTe4vjxwCbrQ30Jm9hQfWWjH3L8s3MBaDdGNwgswRg3VkcILME4V3YWt1MgU --filternode=/ip4/172.18.101.215/tcp/52241/p2p/16Uiu2HAmKrJUS2p4zfhryn2AkUCjgGjASYq4BJ9RvbJQoynTMm17
2026-02-01 04:45:53.666 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.170.147 waku bfced9a0ddae863da4d63270360784ace3aeaba51d1f90274c7159d1a04ece72
2026-02-01 04:45:53.696 DEBUG [src.node.docker_mananger] Container started with ID bfced9a0ddae. Setting up logs at ./log/docker/node2_2026-02-01_04-45-52__ca393c95-8b50-429c-a6f7-0eadabbba145__wakuorg_nwaku:latest.log
2026-02-01 04:45:53.696 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 35487
2026-02-01 04:45:53.696 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-01 04:45:54.697 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35487/health" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:54.701 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-01 04:45:54.701 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-01 04:45:54.701 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35487/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:54.703 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.170.147/tcp/35488/p2p/16Uiu2HAmEusAeFAunfczxpJMAajJJrrfW1CcLhKXfrdjFUdoVfpx","/ip4/172.18.170.147/tcp/35489/ws/p2p/16Uiu2HAmEusAeFAunfczxpJMAajJJrrfW1CcLhKXfrdjFUdoVfpx"],"enrUri":"enr:-L24QPU70cTydMIqkNVd5fmFurWycj0xnnsRO04LtzrJ_KN4Jd1mNojUyk-BGcI6c3r1Ii3J-VuWdaeOXhehGDt0ZksCgmlkgnY0gmlwhKwSqpOKbXVsdGlhZGRyc5YACASsEqqTBoqgAAoErBKqkwaKod0DgnJzhQADAQAAiXNlY3AyNTZrMaEDIYb2qCRTPYHkmOsS6b92OXccJArqXCtVPaFcxkQw37WDdGNwgoqgg3VkcIKKooV3YWt1MgA"}'
2026-02-01 04:45:54.704 INFO [src.node.waku_node] REST service is ready !!
2026-02-01 04:45:54.704 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35487/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.101.215/tcp/52241/p2p/16Uiu2HAmKrJUS2p4zfhryn2AkUCjgGjASYq4BJ9RvbJQoynTMm17"]'
2026-02-01 04:45:54.734 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-01 04:45:54.740 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:52240/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-01 04:45:54.748 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-01 04:45:54.749 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35487/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "572b2439-c0ca-49d1-8771-13d93ede16ac", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-01 04:45:54.761 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"572b2439-c0ca-49d1-8771-13d93ede16ac","statusDesc":"OK"}'
2026-02-01 04:45:54.762 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:35487/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-01 04:45:54.770 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
2026-02-01 04:45:54.771 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:52240/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-02-01 04:45:54.778 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-01 04:45:54.778 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-01 04:45:54.878 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-01 04:45:54.879 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35487/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:45:54.882 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1769921154771053547,"ephemeral":false}]'
2026-02-01 04:45:54.885 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-01 04:45:54.885 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-01 04:45:54.886 DEBUG [src.node.waku_node] Stopping container with id 5e7b365e2902
2026-02-01 04:45:55.437 DEBUG [src.node.waku_node] Container stopped.
2026-02-01 04:45:55.437 DEBUG [src.node.waku_node] Stopping container with id bfced9a0ddae
2026-02-01 04:45:55.981 DEBUG [src.node.waku_node] Container stopped.
2026-02-01 04:45:55.982 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-01 04:45:55.987 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-01 04:45:55.993 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
