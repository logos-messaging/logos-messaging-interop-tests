2026-02-01 04:43:56.462 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-01 04:43:56.462 DEBUG [tests.conftest] Running test: test_publish_with_invalid_payloads with id: 2026-02-01_04-43-56__b8adec2e-e643-400a-808f-9381f4ded36d
2026-02-01 04:43:56.462 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-01 04:43:56.463 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-01 04:43:56.463 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2026-02-01 04:43:56.469 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-01 04:43:56.469 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-01_04-43-56__b8adec2e-e643-400a-808f-9381f4ded36d__wakuorg_nwaku:latest.log
2026-02-01 04:43:56.469 DEBUG [src.node.waku_node] Starting Node...
2026-02-01 04:43:56.469 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-01 04:43:56.470 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-01 04:43:56.470 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.120.39
2026-02-01 04:43:56.471 DEBUG [src.node.docker_mananger] Generated ports ['23191', '23192', '23193', '23194', '23195']
2026-02-01 04:43:56.471 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-01 04:43:56.471 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-01 04:43:56.471 DEBUG [src.node.waku_node] Using volumes []
2026-02-01 04:43:56.471 DEBUG [src.node.docker_mananger] docker run -i -t -p 23191:23191 -p 23192:23192 -p 23193:23193 -p 23194:23194 -p 23195:23195 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23193 --rest-port=23191 --tcp-port=23192 --discv5-udp-port=23194 --rest-address=0.0.0.0 --nat=extip:172.18.120.39 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c1136d1f3dd9b844e20c2dbbb0666984d1ca7ae2ca3d40e89c9f59dca1d377f9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23195 --metrics-logging=true --relay=true
2026-02-01 04:43:56.630 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.120.39 waku 8c89e78d6695e874f40c32900d7a7bdbc4449f5c40a72089c91a78a2657c555b
2026-02-01 04:43:56.658 DEBUG [src.node.docker_mananger] Container started with ID 8c89e78d6695. Setting up logs at ./log/docker/node1_2026-02-01_04-43-56__b8adec2e-e643-400a-808f-9381f4ded36d__wakuorg_nwaku:latest.log
2026-02-01 04:43:56.659 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 23191
2026-02-01 04:43:56.659 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-01 04:43:56.807 ERROR [src.node.docker_mananger] Max retries reached for container 91d6694f7706. Exiting log stream.
2026-02-01 04:43:57.248 ERROR [src.node.docker_mananger] Max retries reached for container a3e642f77161. Exiting log stream.
2026-02-01 04:43:57.659 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23191/health" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:43:57.663 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-01 04:43:57.663 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-01 04:43:57.663 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23191/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:43:57.665 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.120.39/tcp/23192/p2p/16Uiu2HAkz3wt7sTu6xUw1tKz55qYtirj6T2e6YrBrdvJdt4J7HFW","/ip4/172.18.120.39/tcp/23193/ws/p2p/16Uiu2HAkz3wt7sTu6xUw1tKz55qYtirj6T2e6YrBrdvJdt4J7HFW"],"enrUri":"enr:-L24QGQkdxwVd2OM_-6DG-XvFu8EBVWB7OXevRYzPl95xufDHfuIv1DPSoVrxJP5WblRCzgN8bKahJTmRE_hCUWvzy0CgmlkgnY0gmlwhKwSeCeKbXVsdGlhZGRyc5YACASsEngnBlqYAAoErBJ4JwZamd0DgnJzhQADAQAAiXNlY3AyNTZrMaECRLmjMUq6DqkcxYrof-RWYgG3TmrmUJG0BIE9nv7YlSmDdGNwglqYg3VkcIJamoV3YWt1MgE"}'
2026-02-01 04:43:57.666 INFO [src.node.waku_node] REST service is ready !!
2026-02-01 04:43:57.671 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-01 04:43:57.672 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-01_04-43-56__b8adec2e-e643-400a-808f-9381f4ded36d__wakuorg_nwaku:latest.log
2026-02-01 04:43:57.672 DEBUG [src.node.waku_node] Starting Node...
2026-02-01 04:43:57.672 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-01 04:43:57.673 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-01 04:43:57.673 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.160.160
2026-02-01 04:43:57.673 DEBUG [src.node.docker_mananger] Generated ports ['51028', '51029', '51030', '51031', '51032']
2026-02-01 04:43:57.674 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-01 04:43:57.674 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-01 04:43:57.674 DEBUG [src.node.waku_node] Using volumes []
2026-02-01 04:43:57.674 DEBUG [src.node.docker_mananger] docker run -i -t -p 51028:51028 -p 51029:51029 -p 51030:51030 -p 51031:51031 -p 51032:51032 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=51030 --rest-port=51028 --tcp-port=51029 --discv5-udp-port=51031 --rest-address=0.0.0.0 --nat=extip:172.18.160.160 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3dfcbb62a9616aff330ab480c84aa77cbf158ff2a77e0efcefc110e55c9de158 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=51032 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QGQkdxwVd2OM_-6DG-XvFu8EBVWB7OXevRYzPl95xufDHfuIv1DPSoVrxJP5WblRCzgN8bKahJTmRE_hCUWvzy0CgmlkgnY0gmlwhKwSeCeKbXVsdGlhZGRyc5YACASsEngnBlqYAAoErBJ4JwZamd0DgnJzhQADAQAAiXNlY3AyNTZrMaECRLmjMUq6DqkcxYrof-RWYgG3TmrmUJG0BIE9nv7YlSmDdGNwglqYg3VkcIJamoV3YWt1MgE
2026-02-01 04:43:57.833 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.160.160 waku 30b3e29c4517af4fb4f4e9db6afeb72165f4d1251ec227552cff157fcf433f61
2026-02-01 04:43:57.859 DEBUG [src.node.docker_mananger] Container started with ID 30b3e29c4517. Setting up logs at ./log/docker/node2_2026-02-01_04-43-56__b8adec2e-e643-400a-808f-9381f4ded36d__wakuorg_nwaku:latest.log
2026-02-01 04:43:57.860 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 51028
2026-02-01 04:43:57.860 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-01 04:43:58.861 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:51028/health" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:43:58.879 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-01 04:43:58.880 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-01 04:43:58.883 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:51028/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:43:58.887 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.160.160/tcp/51029/p2p/16Uiu2HAmFHwCaxhQ12isPMGz7ZGHoDq1rvJbHyTZv5Zm5iMu3tXp","/ip4/172.18.160.160/tcp/51030/ws/p2p/16Uiu2HAmFHwCaxhQ12isPMGz7ZGHoDq1rvJbHyTZv5Zm5iMu3tXp"],"enrUri":"enr:-L24QMYC9PbN2SEvdUZvOZ1ujV1aU23G1DwB2yuQJcdM-RhyDwSgOB5B6zxdu3wcUHukCdgCilmpShYkPfVIOTyQJ40CgmlkgnY0gmlwhKwSoKCKbXVsdGlhZGRyc5YACASsEqCgBsdVAAoErBKgoAbHVt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDJy5NUBRNQ4OhsXqG3RF_u-wBKoYg2wCrmxdrej9pv3eDdGNwgsdVg3VkcILHV4V3YWt1MgE"}'
2026-02-01 04:43:58.887 INFO [src.node.waku_node] REST service is ready !!
2026-02-01 04:43:58.887 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:51028/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.120.39/tcp/23192/p2p/16Uiu2HAkz3wt7sTu6xUw1tKz55qYtirj6T2e6YrBrdvJdt4J7HFW"]'
2026-02-01 04:43:58.890 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-01 04:43:58.890 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2026-02-01 04:43:58.890 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23191/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-01 04:43:58.893 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-01 04:43:58.893 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:51028/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-01 04:43:58.899 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-01 04:43:58.900 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23191/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-01 04:43:58.904 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-01 04:43:58.904 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-01 04:43:59.004 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-01 04:43:59.005 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23191/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:43:59.008 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1769921038900082944,"ephemeral":false,"proof":""}]'
2026-02-01 04:43:59.009 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-01 04:43:59.009 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:51028/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-01 04:43:59.011 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1769921038900082944,"ephemeral":false,"proof":""}]'
2026-02-01 04:43:59.013 INFO [src.steps.relay] WARM UP successful!!
2026-02-01 04:43:59.014 DEBUG [tests.relay.test_publish] Running test with payload Empty string
2026-02-01 04:43:59.014 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23191/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-01 04:43:59.016 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:23191/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-01 04:43:59.016 DEBUG [tests.relay.test_publish] Running test with payload Unecoded text
2026-02-01 04:43:59.017 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23191/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "Hello World!", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-01 04:43:59.019 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:23191/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Incorrect base64 string'
2026-02-01 04:43:59.019 DEBUG [tests.relay.test_publish] Running test with payload A dictionary
2026-02-01 04:43:59.019 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23191/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": {"key": "YWFh"}, "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-01 04:43:59.021 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:23191/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-01 04:43:59.022 DEBUG [tests.relay.test_publish] Running test with payload An integer
2026-02-01 04:43:59.022 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23191/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": 1234567890, "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-01 04:43:59.024 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:23191/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-01 04:43:59.024 DEBUG [tests.relay.test_publish] Running test with payload A list
2026-02-01 04:43:59.025 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23191/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": ["YWFh"], "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-01 04:43:59.027 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:23191/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-01 04:43:59.027 DEBUG [tests.relay.test_publish] Running test with payload A bool
2026-02-01 04:43:59.027 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23191/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": true, "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-01 04:43:59.029 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:23191/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-01 04:43:59.031 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-01 04:43:59.032 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-01 04:43:59.032 DEBUG [src.node.waku_node] Stopping container with id 8c89e78d6695
2026-02-01 04:43:59.518 DEBUG [src.node.waku_node] Container stopped.
2026-02-01 04:43:59.518 DEBUG [src.node.waku_node] Stopping container with id 30b3e29c4517
2026-02-01 04:43:59.985 DEBUG [src.node.waku_node] Container stopped.
2026-02-01 04:43:59.988 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-01 04:43:59.993 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-01 04:43:59.997 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
