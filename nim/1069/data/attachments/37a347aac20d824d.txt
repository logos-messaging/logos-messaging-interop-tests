2026-02-04 17:12:51.281 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 17:12:51.282 DEBUG [tests.conftest] Running test: test_filter_update_subscription_refresh_existing with id: 2026-02-04_17-12-51__389c98ea-e14a-4ccb-a0d5-4f35fadbf98b
2026-02-04 17:12:51.283 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 17:12:51.284 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2026-02-04 17:12:51.284 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2026-02-04 17:12:51.293 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 17:12:51.293 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-04_17-12-51__389c98ea-e14a-4ccb-a0d5-4f35fadbf98b__wakuorg_nwaku:latest.log
2026-02-04 17:12:51.294 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 17:12:51.294 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 17:12:51.295 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 17:12:51.295 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.226.167
2026-02-04 17:12:51.295 DEBUG [src.node.docker_mananger] Generated ports ['45456', '45457', '45458', '45459', '45460']
2026-02-04 17:12:51.295 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 17:12:51.296 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 17:12:51.296 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 17:12:51.296 DEBUG [src.node.docker_mananger] docker run -i -t -p 45456:45456 -p 45457:45457 -p 45458:45458 -p 45459:45459 -p 45460:45460 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45458 --rest-port=45456 --tcp-port=45457 --discv5-udp-port=45459 --rest-address=0.0.0.0 --nat=extip:172.18.226.167 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=abe17f6e946ec6716f5dec4bc2cbde4cefd4d18cebf9337cf9d274bbae19d95e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45460 --metrics-logging=true --relay=true --filter=true
2026-02-04 17:12:51.477 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.226.167 waku 655c41ffd521eb1d805aae83d108137e077cf2771120875f490da82c34cbfa85
2026-02-04 17:12:51.510 DEBUG [src.node.docker_mananger] Container started with ID 655c41ffd521. Setting up logs at ./log/docker/node1_2026-02-04_17-12-51__389c98ea-e14a-4ccb-a0d5-4f35fadbf98b__wakuorg_nwaku:latest.log
2026-02-04 17:12:51.511 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 45456
2026-02-04 17:12:51.511 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 17:12:51.568 ERROR [src.node.docker_mananger] Max retries reached for container 91caccd731fa. Exiting log stream.
2026-02-04 17:12:52.104 ERROR [src.node.docker_mananger] Max retries reached for container d82e505c8c6b. Exiting log stream.
2026-02-04 17:12:52.512 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45456/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:12:52.515 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 17:12:52.515 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 17:12:52.515 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45456/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:12:52.517 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.226.167/tcp/45457/p2p/16Uiu2HAm7wRSWttsh2xLjyXBxmpkG1ByXuA4zJfuugCRZxGyePZS","/ip4/172.18.226.167/tcp/45458/ws/p2p/16Uiu2HAm7wRSWttsh2xLjyXBxmpkG1ByXuA4zJfuugCRZxGyePZS"],"enrUri":"enr:-L24QC14j-jfZisdKtNh1T_5RO4Lcklcyx4PagXqyulo8eFJQRzqdlLDjMMYlQeQo4jW926rJ1-LkrJWdE0tvlg48E8CgmlkgnY0gmlwhKwS4qeKbXVsdGlhZGRyc5YACASsEuKnBrGRAAoErBLipwaxkt0DgnJzhQADAQAAiXNlY3AyNTZrMaECues6UILS5X7_WEpGPBSJpIRo2k1Pxh6_iFNK_qY2CdmDdGNwgrGRg3VkcIKxk4V3YWt1MgU"}'
2026-02-04 17:12:52.517 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 17:12:52.518 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2026-02-04 17:12:52.524 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 17:12:52.524 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-04_17-12-51__389c98ea-e14a-4ccb-a0d5-4f35fadbf98b__wakuorg_nwaku:latest.log
2026-02-04 17:12:52.525 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 17:12:52.525 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 17:12:52.526 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 17:12:52.526 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.93.24
2026-02-04 17:12:52.526 DEBUG [src.node.docker_mananger] Generated ports ['12615', '12616', '12617', '12618', '12619']
2026-02-04 17:12:52.527 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 17:12:52.527 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 17:12:52.527 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 17:12:52.527 DEBUG [src.node.docker_mananger] docker run -i -t -p 12615:12615 -p 12616:12616 -p 12617:12617 -p 12618:12618 -p 12619:12619 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=12617 --rest-port=12615 --tcp-port=12616 --discv5-udp-port=12618 --rest-address=0.0.0.0 --nat=extip:172.18.93.24 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=61e89ddcc7ffe3fd3402bcdbc1f008bbcdd4adb83cea263cbccf5caffcccebe3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=12619 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QC14j-jfZisdKtNh1T_5RO4Lcklcyx4PagXqyulo8eFJQRzqdlLDjMMYlQeQo4jW926rJ1-LkrJWdE0tvlg48E8CgmlkgnY0gmlwhKwS4qeKbXVsdGlhZGRyc5YACASsEuKnBrGRAAoErBLipwaxkt0DgnJzhQADAQAAiXNlY3AyNTZrMaECues6UILS5X7_WEpGPBSJpIRo2k1Pxh6_iFNK_qY2CdmDdGNwgrGRg3VkcIKxk4V3YWt1MgU --filternode=/ip4/172.18.226.167/tcp/45457/p2p/16Uiu2HAm7wRSWttsh2xLjyXBxmpkG1ByXuA4zJfuugCRZxGyePZS
2026-02-04 17:12:52.704 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.93.24 waku 0b4efd050a03a0f5ca2b23488f104952f21a4ad2a8619bfa5f8c196f2bb93962
2026-02-04 17:12:52.733 DEBUG [src.node.docker_mananger] Container started with ID 0b4efd050a03. Setting up logs at ./log/docker/node2_2026-02-04_17-12-51__389c98ea-e14a-4ccb-a0d5-4f35fadbf98b__wakuorg_nwaku:latest.log
2026-02-04 17:12:52.734 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 12615
2026-02-04 17:12:52.734 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 17:12:53.734 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12615/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:12:53.738 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-04 17:12:53.738 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 17:12:53.739 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12615/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:12:53.741 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.93.24/tcp/12616/p2p/16Uiu2HAmQtRgXY3pcZbJ5MHZs8pE8Rp93vdaRPPR6gsXBkptTSKC","/ip4/172.18.93.24/tcp/12617/ws/p2p/16Uiu2HAmQtRgXY3pcZbJ5MHZs8pE8Rp93vdaRPPR6gsXBkptTSKC"],"enrUri":"enr:-L24QLKrz5x6t5zabfRgoReV2QjgWOtfM736aA8XZbtBQGRRQUdWbGGmVW0KMdVlqSVxNLEnA6cSAJI8MmZVX79YnpYCgmlkgnY0gmlwhKwSXRiKbXVsdGlhZGRyc5YACASsEl0YBjFIAAoErBJdGAYxSd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDtb1vrnFf_IKdxs4iRjLEuTShWtwiJRE3bYv5ZXZPUwODdGNwgjFIg3VkcIIxSoV3YWt1MgA"}'
2026-02-04 17:12:53.741 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 17:12:53.742 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:12615/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.226.167/tcp/45457/p2p/16Uiu2HAm7wRSWttsh2xLjyXBxmpkG1ByXuA4zJfuugCRZxGyePZS"]'
2026-02-04 17:12:53.772 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:12:53.775 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45456/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-04 17:12:53.786 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:12:53.787 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:12615/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "ece045e5-64fe-40e8-90b5-db17ef474811", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-04 17:12:53.800 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"ece045e5-64fe-40e8-90b5-db17ef474811","statusDesc":"OK"}'
2026-02-04 17:12:53.800 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:12615/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-04 17:12:53.809 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
2026-02-04 17:12:53.810 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45456/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 17:12:53.817 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:12:53.817 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-04 17:12:53.917 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-04 17:12:53.918 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12615/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:12:53.921 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1770225173809998657,"ephemeral":false}]'
2026-02-04 17:12:53.924 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 17:12:53.925 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 17:12:53.925 DEBUG [src.node.waku_node] Stopping container with id 655c41ffd521
2026-02-04 17:12:54.490 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 17:12:54.490 DEBUG [src.node.waku_node] Stopping container with id 0b4efd050a03
2026-02-04 17:12:55.023 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 17:12:55.024 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 17:12:55.032 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 17:12:55.037 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
