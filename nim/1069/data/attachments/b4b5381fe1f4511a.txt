2026-02-04 17:10:44.811 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 17:10:44.812 DEBUG [tests.conftest] Running test: test_relay_different_latency_between_two_nodes[200] with id: 2026-02-04_17-10-44__2d544618-118e-4dbb-b853-75b2c7c5ce59
2026-02-04 17:10:44.812 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 17:10:44.812 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-04 17:10:44.818 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 17:10:44.818 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-04_17-10-44__2d544618-118e-4dbb-b853-75b2c7c5ce59__wakuorg_nwaku:latest.log
2026-02-04 17:10:44.824 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 17:10:44.824 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-04_17-10-44__2d544618-118e-4dbb-b853-75b2c7c5ce59__wakuorg_nwaku:latest.log
2026-02-04 17:10:44.825 INFO [tests.e2e.test_network_conditions] Starting node1 and node2 with relay enabled
2026-02-04 17:10:44.825 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 17:10:44.826 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 17:10:44.827 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 17:10:44.827 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.198.10
2026-02-04 17:10:44.827 DEBUG [src.node.docker_mananger] Generated ports ['18890', '18891', '18892', '18893', '18894']
2026-02-04 17:10:44.827 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 17:10:44.828 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 17:10:44.828 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 17:10:44.828 DEBUG [src.node.docker_mananger] docker run -i -t -p 18890:18890 -p 18891:18891 -p 18892:18892 -p 18893:18893 -p 18894:18894 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18892 --rest-port=18890 --tcp-port=18891 --discv5-udp-port=18893 --rest-address=0.0.0.0 --nat=extip:172.18.198.10 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d1abfc4d77fe1a86bf96c71e665edd4d81abdbe0ebaefeece19d5234ffde87b1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18894 --metrics-logging=true --relay=true
2026-02-04 17:10:44.991 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.198.10 waku 7ae8fbc2ffc88c410ce9f70bdf40cebe88a446464b5952c4adb0586c66f46bf9
2026-02-04 17:10:45.018 DEBUG [src.node.docker_mananger] Container started with ID 7ae8fbc2ffc8. Setting up logs at ./log/docker/node1_2026-02-04_17-10-44__2d544618-118e-4dbb-b853-75b2c7c5ce59__wakuorg_nwaku:latest.log
2026-02-04 17:10:45.018 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 18890
2026-02-04 17:10:45.020 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 17:10:45.148 ERROR [src.node.docker_mananger] Max retries reached for container ddcf54425ad5. Exiting log stream.
2026-02-04 17:10:45.616 ERROR [src.node.docker_mananger] Max retries reached for container 619de4ebf2c1. Exiting log stream.
2026-02-04 17:10:46.021 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18890/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:10:46.025 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 17:10:46.025 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 17:10:46.025 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18890/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:10:46.028 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.198.10/tcp/18891/p2p/16Uiu2HAmTd5SRVBR9YFPjLH2cYDGcAJRedCkP1ncVVy7egzXyH7p","/ip4/172.18.198.10/tcp/18892/ws/p2p/16Uiu2HAmTd5SRVBR9YFPjLH2cYDGcAJRedCkP1ncVVy7egzXyH7p"],"enrUri":"enr:-L24QJkbZt0mdAF8GBuR7da95tq5DV4aZpdH-W_TaPS2QBCgKjhzk2rjsm8-yHVX-jVwnIA_HIwxDXL30dBIHM9kcfMCgmlkgnY0gmlwhKwSxgqKbXVsdGlhZGRyc5YACASsEsYKBknLAAoErBLGCgZJzN0DgnJzhQADAQAAiXNlY3AyNTZrMaED3mHlV2GIWaUHO-NWeHMQigUbpy3mTM4Clnd57k9AU0uDdGNwgknLg3VkcIJJzYV3YWt1MgE"}'
2026-02-04 17:10:46.028 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 17:10:46.028 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 17:10:46.028 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 17:10:46.030 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 17:10:46.030 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.212.27
2026-02-04 17:10:46.030 DEBUG [src.node.docker_mananger] Generated ports ['5321', '5322', '5323', '5324', '5325']
2026-02-04 17:10:46.030 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 17:10:46.030 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 17:10:46.030 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 17:10:46.030 DEBUG [src.node.docker_mananger] docker run -i -t -p 5321:5321 -p 5322:5322 -p 5323:5323 -p 5324:5324 -p 5325:5325 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=5323 --rest-port=5321 --tcp-port=5322 --discv5-udp-port=5324 --rest-address=0.0.0.0 --nat=extip:172.18.212.27 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=edc3808ffebfa9642a7e4d1b7326e2d8dc2dffadddb4e17adacdacd28be97b5e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=5325 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QJkbZt0mdAF8GBuR7da95tq5DV4aZpdH-W_TaPS2QBCgKjhzk2rjsm8-yHVX-jVwnIA_HIwxDXL30dBIHM9kcfMCgmlkgnY0gmlwhKwSxgqKbXVsdGlhZGRyc5YACASsEsYKBknLAAoErBLGCgZJzN0DgnJzhQADAQAAiXNlY3AyNTZrMaED3mHlV2GIWaUHO-NWeHMQigUbpy3mTM4Clnd57k9AU0uDdGNwgknLg3VkcIJJzYV3YWt1MgE
2026-02-04 17:10:46.188 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.212.27 waku ef351a85fb19f0ec034ccd88da2b50de4d36f045fdae938591b3a533d0e31f49
2026-02-04 17:10:46.215 DEBUG [src.node.docker_mananger] Container started with ID ef351a85fb19. Setting up logs at ./log/docker/node2_2026-02-04_17-10-44__2d544618-118e-4dbb-b853-75b2c7c5ce59__wakuorg_nwaku:latest.log
2026-02-04 17:10:46.216 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 5321
2026-02-04 17:10:46.217 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 17:10:47.218 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5321/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:10:47.235 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 17:10:47.237 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 17:10:47.237 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5321/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:10:47.243 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.212.27/tcp/5322/p2p/16Uiu2HAmL8qpGdE9RJL1SAF2oV3eor57H4gxbr6CtExmTUwUdFSr","/ip4/172.18.212.27/tcp/5323/ws/p2p/16Uiu2HAmL8qpGdE9RJL1SAF2oV3eor57H4gxbr6CtExmTUwUdFSr"],"enrUri":"enr:-L24QPqMQx-unEpF9t3KsND5opMwFqZWUzA7vyYxr4T3KXpnMRpwzyYS_9LMKEUNNzzA31ttuRv9C2t58YtJ6fgSW4gCgmlkgnY0gmlwhKwS1BuKbXVsdGlhZGRyc5YACASsEtQbBhTKAAoErBLUGwYUy90DgnJzhQADAQAAiXNlY3AyNTZrMaEDbyRruIuDihI95XFi8OF2-7Ch_ijOfkSY4ayadhq3E6ODdGNwghTKg3VkcIIUzIV3YWt1MgE"}'
2026-02-04 17:10:47.245 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 17:10:47.245 INFO [tests.e2e.test_network_conditions] Subscribing both nodes to relay topic
2026-02-04 17:10:47.245 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18890/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-04 17:10:47.250 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:10:47.250 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:5321/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-04 17:10:47.255 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:10:47.255 INFO [tests.e2e.test_network_conditions] Waiting for autoconnection
2026-02-04 17:10:47.255 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18890/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:10:47.259 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.212.27/tcp/33280/p2p/16Uiu2HAmL8qpGdE9RJL1SAF2oV3eor57H4gxbr6CtExmTUwUdFSr","protocols":["/ipfs/id/1.0.0","/libp2p/autonat/1.0.0","/libp2p/circuit/relay/0.2.0/hop","/vac/waku/metadata/1.0.0","/vac/waku/relay/2.0.0","/vac/waku/rendezvous/1.0.0","/ipfs/ping/1.0.0","/vac/waku/filter-push/2.0.0-beta1","/vac/waku/peer-exchange/2.0.0-alpha1"],"shards":[0],"connected":"Connected","agent":"nwaku-v0.36.0-127-ga4e44d","origin":"UnknownOrigin"}]'
2026-02-04 17:10:47.259 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5321/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:10:47.261 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.198.10/tcp/18891/p2p/16Uiu2HAmTd5SRVBR9YFPjLH2cYDGcAJRedCkP1ncVVy7egzXyH7p","protocols":["/ipfs/id/1.0.0","/libp2p/autonat/1.0.0","/libp2p/circuit/relay/0.2.0/hop","/vac/waku/metadata/1.0.0","/vac/waku/relay/2.0.0","/vac/waku/rendezvous/1.0.0","/ipfs/ping/1.0.0","/vac/waku/filter-push/2.0.0-beta1","/vac/waku/peer-exchange/2.0.0-alpha1"],"shards":[0],"connected":"Connected","agent":"nwaku-v0.36.0-127-ga4e44d","origin":"Discv5"}]'
2026-02-04 17:10:47.262 DEBUG [src.libs.common] Sleeping for 10 seconds
2026-02-04 17:10:57.262 INFO [tests.e2e.test_network_conditions] Applying 200ms latency to node2
2026-02-04 17:10:57.264 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '4698', '-n', 'tc', 'qdisc', 'del', 'dev', 'eth0', 'root']
2026-02-04 17:10:57.296 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '4698', '-n', 'tc', 'qdisc', 'del', 'dev', 'eth0', 'root']
2026-02-04 17:10:57.305 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '4698', '-n', 'tc', 'qdisc', 'add', 'dev', 'eth0', 'root', 'netem', 'delay', '200ms']
2026-02-04 17:10:57.376 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18890/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 17:10:57.381 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:10:57.382 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5321/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:10:57.785 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770225057376270269,"ephemeral":false,"proof":""}]'
2026-02-04 17:10:57.787 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '4698', '-n', 'tc', 'qdisc', 'del', 'dev', 'eth0', 'root']
2026-02-04 17:10:57.798 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 17:10:57.799 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 17:10:57.799 DEBUG [src.node.waku_node] Stopping container with id 7ae8fbc2ffc8
2026-02-04 17:10:58.311 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 17:10:58.311 DEBUG [src.node.waku_node] Stopping container with id ef351a85fb19
2026-02-04 17:10:58.800 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 17:10:58.802 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 17:10:58.810 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 17:10:58.818 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
