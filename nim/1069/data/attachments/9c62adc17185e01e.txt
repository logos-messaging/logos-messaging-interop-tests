2026-02-04 17:11:54.578 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 17:11:54.578 DEBUG [tests.conftest] Running test: test_single_pubsub_topic[/waku/2/rs/5/999] with id: 2026-02-04_17-11-54__52a2ed19-2b1c-4725-9aae-defa41c93794
2026-02-04 17:11:54.578 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 17:11:54.579 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-04 17:11:54.579 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-04 17:11:54.586 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 17:11:54.586 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-04_17-11-54__52a2ed19-2b1c-4725-9aae-defa41c93794__wakuorg_nwaku:latest.log
2026-02-04 17:11:54.586 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 17:11:54.586 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 17:11:54.588 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 17:11:54.588 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.229.26
2026-02-04 17:11:54.588 DEBUG [src.node.docker_mananger] Generated ports ['8067', '8068', '8069', '8070', '8071']
2026-02-04 17:11:54.588 DEBUG [src.node.waku_node] Cluster id was resolved to: 5
2026-02-04 17:11:54.588 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-04 17:11:54.588 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 17:11:54.588 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 17:11:54.589 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 17:11:54.589 DEBUG [src.node.docker_mananger] docker run -i -t -p 8067:8067 -p 8068:8068 -p 8069:8069 -p 8070:8070 -p 8071:8071 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=8069 --rest-port=8067 --tcp-port=8068 --discv5-udp-port=8070 --rest-address=0.0.0.0 --nat=extip:172.18.229.26 --peer-exchange=true --discv5-discovery=true --cluster-id=5 --nodekey=cafbdd6b20aeb4cd560f6414cadd5d8dfbed50759833f1a5194872374cbaa83a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=8071 --metrics-logging=true --relay=true --filter=true
2026-02-04 17:11:54.769 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.229.26 waku d8c47ce8d07ec28e935f815d9c663cebb9b3b94a6aa2b8ee7ddeb0b7e7646d88
2026-02-04 17:11:54.808 DEBUG [src.node.docker_mananger] Container started with ID d8c47ce8d07e. Setting up logs at ./log/docker/node1_2026-02-04_17-11-54__52a2ed19-2b1c-4725-9aae-defa41c93794__wakuorg_nwaku:latest.log
2026-02-04 17:11:54.808 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 8067
2026-02-04 17:11:54.808 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 17:11:54.826 ERROR [src.node.docker_mananger] Max retries reached for container 758fc42e2156. Exiting log stream.
2026-02-04 17:11:55.386 ERROR [src.node.docker_mananger] Max retries reached for container 297e3fe53327. Exiting log stream.
2026-02-04 17:11:55.809 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8067/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:11:55.812 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 17:11:55.812 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 17:11:55.812 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8067/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:11:55.815 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.229.26/tcp/8068/p2p/16Uiu2HAmJtWetrvumZrwRgENXQE7vjUWc49Dq2aQXc8ehC55NEzo","/ip4/172.18.229.26/tcp/8069/ws/p2p/16Uiu2HAmJtWetrvumZrwRgENXQE7vjUWc49Dq2aQXc8ehC55NEzo"],"enrUri":"enr:-L24QHOIlMG97GSvULGCfL076aH1yuszqyffhm-xNPdvWEu8ay8oEuyjVoaV2Xm_3xh8i3k8UqR-8jkC3Qg2Eu6WwkYCgmlkgnY0gmlwhKwS5RqKbXVsdGlhZGRyc5YACASsEuUaBh-EAAoErBLlGgYfhd0DgnJzhQAFAQAAiXNlY3AyNTZrMaEDXJzvt31VX0PDBzjjaTrCOSLd2o27DmKKN6Wx4SiuF7SDdGNwgh-Eg3VkcIIfhoV3YWt1MgU"}'
2026-02-04 17:11:55.815 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 17:11:55.821 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 17:11:55.821 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-04_17-11-54__52a2ed19-2b1c-4725-9aae-defa41c93794__wakuorg_nwaku:latest.log
2026-02-04 17:11:55.821 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 17:11:55.822 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 17:11:55.823 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 17:11:55.823 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.98.185
2026-02-04 17:11:55.823 DEBUG [src.node.docker_mananger] Generated ports ['33169', '33170', '33171', '33172', '33173']
2026-02-04 17:11:55.823 DEBUG [src.node.waku_node] Cluster id was resolved to: 5
2026-02-04 17:11:55.823 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-04 17:11:55.824 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 17:11:55.824 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 17:11:55.824 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 17:11:55.824 DEBUG [src.node.docker_mananger] docker run -i -t -p 33169:33169 -p 33170:33170 -p 33171:33171 -p 33172:33172 -p 33173:33173 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33171 --rest-port=33169 --tcp-port=33170 --discv5-udp-port=33172 --rest-address=0.0.0.0 --nat=extip:172.18.98.185 --peer-exchange=true --discv5-discovery=true --cluster-id=5 --nodekey=a75d19b0bc9ed7590ad46aae1d306ca6063b6afaad6d2c2da59eb5bf7d0fa54f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33173 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QHOIlMG97GSvULGCfL076aH1yuszqyffhm-xNPdvWEu8ay8oEuyjVoaV2Xm_3xh8i3k8UqR-8jkC3Qg2Eu6WwkYCgmlkgnY0gmlwhKwS5RqKbXVsdGlhZGRyc5YACASsEuUaBh-EAAoErBLlGgYfhd0DgnJzhQAFAQAAiXNlY3AyNTZrMaEDXJzvt31VX0PDBzjjaTrCOSLd2o27DmKKN6Wx4SiuF7SDdGNwgh-Eg3VkcIIfhoV3YWt1MgU
2026-02-04 17:11:56.000 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.98.185 waku 65da64732671ac29238fc5507569d2f59bbaf11152268f23179012d69f2dfe3b
2026-02-04 17:11:56.034 DEBUG [src.node.docker_mananger] Container started with ID 65da64732671. Setting up logs at ./log/docker/node2_2026-02-04_17-11-54__52a2ed19-2b1c-4725-9aae-defa41c93794__wakuorg_nwaku:latest.log
2026-02-04 17:11:56.035 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 33169
2026-02-04 17:11:56.035 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 17:11:57.035 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33169/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:11:57.043 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-04 17:11:57.044 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 17:11:57.044 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33169/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:11:57.048 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.98.185/tcp/33170/p2p/16Uiu2HAmBVmZKdeS2BcFpNXXTqoJB61jst7wntonHRjaQu9cazFH","/ip4/172.18.98.185/tcp/33171/ws/p2p/16Uiu2HAmBVmZKdeS2BcFpNXXTqoJB61jst7wntonHRjaQu9cazFH"],"enrUri":"enr:-L24QIjRIWxK8Dzg7w33aryBpMGy5benkMCEhxd-F4OACgPnJJ8w_43z5dve6VDi9WiU4KPFStnWGKBF7ev4C5kXJLsCgmlkgnY0gmlwhKwSYrmKbXVsdGlhZGRyc5YACASsEmK5BoGSAAoErBJiuQaBk90DgnJzhQAFAQAAiXNlY3AyNTZrMaEC7sefB7DlDu1MJlUJ2cKkF8CEhA7iJrlbTiHfcXTkERiDdGNwgoGSg3VkcIKBlIV3YWt1MgE"}'
2026-02-04 17:11:57.048 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 17:11:57.049 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33169/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.229.26/tcp/8068/p2p/16Uiu2HAmJtWetrvumZrwRgENXQE7vjUWc49Dq2aQXc8ehC55NEzo"]'
2026-02-04 17:11:57.052 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:11:57.053 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8067/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/5/999"]'
2026-02-04 17:11:57.057 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:11:57.057 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33169/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/5/999"]'
2026-02-04 17:11:57.061 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:11:57.062 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8067/relay/v1/messages/%2Fwaku%2F2%2Frs%2F5%2F999" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 17:11:57.068 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:11:57.069 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-04 17:11:57.169 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-04 17:11:57.170 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8067/relay/v1/messages/%2Fwaku%2F2%2Frs%2F5%2F999" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:11:57.172 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770225117062522467,"ephemeral":false,"proof":""}]'
2026-02-04 17:11:57.174 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-04 17:11:57.174 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33169/relay/v1/messages/%2Fwaku%2F2%2Frs%2F5%2F999" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:11:57.176 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770225117062522467,"ephemeral":false,"proof":""}]'
2026-02-04 17:11:57.178 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 17:11:57.179 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 17:11:57.180 DEBUG [src.node.waku_node] Stopping container with id d8c47ce8d07e
2026-02-04 17:11:57.726 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 17:11:57.727 DEBUG [src.node.waku_node] Stopping container with id 65da64732671
2026-02-04 17:11:58.229 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 17:11:58.233 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 17:11:58.239 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 17:11:58.246 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
