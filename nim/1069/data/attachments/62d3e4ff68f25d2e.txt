2026-02-04 17:15:12.250 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 17:15:12.250 DEBUG [tests.conftest] Running test: test_single_pubsub_topic[/waku/2/rs/999/999] with id: 2026-02-04_17-15-12__aeb680c0-4e14-4c15-8a73-e9d2b991e0cf
2026-02-04 17:15:12.250 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 17:15:12.251 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-04 17:15:12.251 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-04 17:15:12.258 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 17:15:12.258 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-04_17-15-12__aeb680c0-4e14-4c15-8a73-e9d2b991e0cf__wakuorg_nwaku:latest.log
2026-02-04 17:15:12.258 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 17:15:12.258 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 17:15:12.260 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 17:15:12.260 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.158.194
2026-02-04 17:15:12.260 DEBUG [src.node.docker_mananger] Generated ports ['20241', '20242', '20243', '20244', '20245']
2026-02-04 17:15:12.260 DEBUG [src.node.waku_node] Cluster id was resolved to: 999
2026-02-04 17:15:12.260 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-04 17:15:12.260 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 17:15:12.260 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 17:15:12.261 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 17:15:12.261 DEBUG [src.node.docker_mananger] docker run -i -t -p 20241:20241 -p 20242:20242 -p 20243:20243 -p 20244:20244 -p 20245:20245 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20243 --rest-port=20241 --tcp-port=20242 --discv5-udp-port=20244 --rest-address=0.0.0.0 --nat=extip:172.18.158.194 --peer-exchange=true --discv5-discovery=true --cluster-id=999 --nodekey=6309b210a9e2af1ca96b9da8c4bd18ccccc4e9a33cd9aabfddc2abed3d79bde9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20245 --metrics-logging=true --relay=true --filter=true
2026-02-04 17:15:12.444 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.158.194 waku b6f1999b67a203175235e3edaf801e77750cb324b5169421304f239a8238d063
2026-02-04 17:15:12.476 DEBUG [src.node.docker_mananger] Container started with ID b6f1999b67a2. Setting up logs at ./log/docker/node1_2026-02-04_17-15-12__aeb680c0-4e14-4c15-8a73-e9d2b991e0cf__wakuorg_nwaku:latest.log
2026-02-04 17:15:12.477 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 20241
2026-02-04 17:15:12.477 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 17:15:12.533 ERROR [src.node.docker_mananger] Max retries reached for container 1d1b1b2f4fea. Exiting log stream.
2026-02-04 17:15:13.059 ERROR [src.node.docker_mananger] Max retries reached for container 703b6d7b9d55. Exiting log stream.
2026-02-04 17:15:13.480 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20241/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:15:13.483 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 17:15:13.483 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 17:15:13.483 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20241/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:15:13.486 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.158.194/tcp/20242/p2p/16Uiu2HAmNBqUH4XAqqC8uvVRhEjhD95eBackQa6dQDXDvuejYi6p","/ip4/172.18.158.194/tcp/20243/ws/p2p/16Uiu2HAmNBqUH4XAqqC8uvVRhEjhD95eBackQa6dQDXDvuejYi6p"],"enrUri":"enr:-L24QD5PmIvzdD4xHnYd49Jmjc4lrVQhZNIIE3WaOEDizHvpVSZmo0R3P-zV_B9cknQo09AijiCxRfs_63Fgrf2Ih-ICgmlkgnY0gmlwhKwSnsKKbXVsdGlhZGRyc5YACASsEp7CBk8SAAoErBKewgZPE90DgnJzhQPnAQAAiXNlY3AyNTZrMaEDjaAltlSx37tCiD0_kRinUOt761wTr4B1MxjD8BiZ3S2DdGNwgk8Sg3VkcIJPFIV3YWt1MgU"}'
2026-02-04 17:15:13.486 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 17:15:13.493 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 17:15:13.493 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-04_17-15-12__aeb680c0-4e14-4c15-8a73-e9d2b991e0cf__wakuorg_nwaku:latest.log
2026-02-04 17:15:13.493 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 17:15:13.493 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 17:15:13.495 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 17:15:13.495 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.167.29
2026-02-04 17:15:13.495 DEBUG [src.node.docker_mananger] Generated ports ['55608', '55609', '55610', '55611', '55612']
2026-02-04 17:15:13.495 DEBUG [src.node.waku_node] Cluster id was resolved to: 999
2026-02-04 17:15:13.495 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-04 17:15:13.495 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 17:15:13.495 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 17:15:13.496 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 17:15:13.496 DEBUG [src.node.docker_mananger] docker run -i -t -p 55608:55608 -p 55609:55609 -p 55610:55610 -p 55611:55611 -p 55612:55612 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55610 --rest-port=55608 --tcp-port=55609 --discv5-udp-port=55611 --rest-address=0.0.0.0 --nat=extip:172.18.167.29 --peer-exchange=true --discv5-discovery=true --cluster-id=999 --nodekey=dfbd7bdc0d28ce576a0e2f5ed2d7b0b3baa727da06890ccba0700cebb54db0b4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55612 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QD5PmIvzdD4xHnYd49Jmjc4lrVQhZNIIE3WaOEDizHvpVSZmo0R3P-zV_B9cknQo09AijiCxRfs_63Fgrf2Ih-ICgmlkgnY0gmlwhKwSnsKKbXVsdGlhZGRyc5YACASsEp7CBk8SAAoErBKewgZPE90DgnJzhQPnAQAAiXNlY3AyNTZrMaEDjaAltlSx37tCiD0_kRinUOt761wTr4B1MxjD8BiZ3S2DdGNwgk8Sg3VkcIJPFIV3YWt1MgU
2026-02-04 17:15:13.677 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.167.29 waku 6dd0b71bdb1305f39bb4f9f8282835354834f0caa8379a40db3dcdd878f39335
2026-02-04 17:15:13.708 DEBUG [src.node.docker_mananger] Container started with ID 6dd0b71bdb13. Setting up logs at ./log/docker/node2_2026-02-04_17-15-12__aeb680c0-4e14-4c15-8a73-e9d2b991e0cf__wakuorg_nwaku:latest.log
2026-02-04 17:15:13.709 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 55608
2026-02-04 17:15:13.709 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 17:15:14.710 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55608/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:15:14.721 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-04 17:15:14.722 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 17:15:14.724 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55608/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:15:14.727 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.167.29/tcp/55609/p2p/16Uiu2HAmNwTz5HNR5rBRvGQrJtMmXW8c2rQJaaCW4QQYdYmah7D9","/ip4/172.18.167.29/tcp/55610/ws/p2p/16Uiu2HAmNwTz5HNR5rBRvGQrJtMmXW8c2rQJaaCW4QQYdYmah7D9"],"enrUri":"enr:-L24QG4AL7PCTrtWkcRE-bk9c7-FfFeTfrsqrnvZI4kX5T0MEu-fSFxmt8yG42T2SsnmBm1iHJIXomfdV1gsCIl3Xh4CgmlkgnY0gmlwhKwSpx2KbXVsdGlhZGRyc5YACASsEqcdBtk5AAoErBKnHQbZOt0DgnJzhQPnAQAAiXNlY3AyNTZrMaEDmM1oh7uyq7b1U1RqocnZprjCPs8JzQjEYCl-NaLhoyiDdGNwgtk5g3VkcILZO4V3YWt1MgE"}'
2026-02-04 17:15:14.729 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 17:15:14.729 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55608/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.158.194/tcp/20242/p2p/16Uiu2HAmNBqUH4XAqqC8uvVRhEjhD95eBackQa6dQDXDvuejYi6p"]'
2026-02-04 17:15:14.732 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:15:14.732 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20241/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/999/999"]'
2026-02-04 17:15:14.735 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:15:14.736 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55608/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/999/999"]'
2026-02-04 17:15:14.740 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:15:14.741 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20241/relay/v1/messages/%2Fwaku%2F2%2Frs%2F999%2F999" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 17:15:14.747 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:15:14.747 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-04 17:15:14.848 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-04 17:15:14.848 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20241/relay/v1/messages/%2Fwaku%2F2%2Frs%2F999%2F999" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:15:14.851 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770225314741003863,"ephemeral":false,"proof":""}]'
2026-02-04 17:15:14.853 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-04 17:15:14.853 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55608/relay/v1/messages/%2Fwaku%2F2%2Frs%2F999%2F999" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:15:14.855 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770225314741003863,"ephemeral":false,"proof":""}]'
2026-02-04 17:15:14.858 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 17:15:14.859 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 17:15:14.859 DEBUG [src.node.waku_node] Stopping container with id b6f1999b67a2
2026-02-04 17:15:15.423 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 17:15:15.423 DEBUG [src.node.waku_node] Stopping container with id 6dd0b71bdb13
2026-02-04 17:15:15.931 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 17:15:15.934 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 17:15:15.940 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 17:15:15.946 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
