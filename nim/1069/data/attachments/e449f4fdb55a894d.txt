2026-02-04 17:20:32.348 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 17:20:32.349 DEBUG [tests.conftest] Running test: test_message_with_ephemeral_true with id: 2026-02-04_17-20-32__683ff2a2-07f0-49f1-8d20-ab94edb29502
2026-02-04 17:20:32.349 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 17:20:32.350 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-02-04 17:20:32.350 DEBUG [src.steps.store] Running fixture setup: node_setup
2026-02-04 17:20:32.360 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 17:20:32.360 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-02-04_17-20-32__683ff2a2-07f0-49f1-8d20-ab94edb29502__wakuorg_nwaku:latest.log
2026-02-04 17:20:32.360 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 17:20:32.361 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 17:20:32.363 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 17:20:32.364 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.252.86
2026-02-04 17:20:32.364 DEBUG [src.node.docker_mananger] Generated ports ['63245', '63246', '63247', '63248', '63249']
2026-02-04 17:20:32.364 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 17:20:32.364 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 17:20:32.364 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 17:20:32.365 DEBUG [src.node.docker_mananger] docker run -i -t -p 63245:63245 -p 63246:63246 -p 63247:63247 -p 63248:63248 -p 63249:63249 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=63247 --rest-port=63245 --tcp-port=63246 --discv5-udp-port=63248 --rest-address=0.0.0.0 --nat=extip:172.18.252.86 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=adced415cac475f11ebff2ff7fddd25fb38cc4b4b7ffce70bd4664b9e5079ec6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=63249 --metrics-logging=true --store=true --relay=true
2026-02-04 17:20:32.556 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.252.86 waku d36544f707caee725ffb9ae63f48658a01cd12fe393b3092e9a9bbcc64c0fe97
2026-02-04 17:20:32.579 ERROR [src.node.docker_mananger] Max retries reached for container 46cb05497d36. Exiting log stream.
2026-02-04 17:20:32.595 DEBUG [src.node.docker_mananger] Container started with ID d36544f707ca. Setting up logs at ./log/docker/publishing_node1_2026-02-04_17-20-32__683ff2a2-07f0-49f1-8d20-ab94edb29502__wakuorg_nwaku:latest.log
2026-02-04 17:20:32.595 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 63245
2026-02-04 17:20:32.596 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 17:20:33.187 ERROR [src.node.docker_mananger] Max retries reached for container fea1eb1164fc. Exiting log stream.
2026-02-04 17:20:33.597 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63245/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:20:33.600 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 17:20:33.601 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 17:20:33.601 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63245/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:20:33.603 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.252.86/tcp/63246/p2p/16Uiu2HAkyMcimXcY3AbS7ksE4iyQhWfix4kLYET5y1ZfZYzaEv5V","/ip4/172.18.252.86/tcp/63247/ws/p2p/16Uiu2HAkyMcimXcY3AbS7ksE4iyQhWfix4kLYET5y1ZfZYzaEv5V"],"enrUri":"enr:-L24QGzPoj4YPg2s012ae8IiicSC9LXq3hQudVWf8ebd-xVyVGaEYEFFZydv_h8IMEnOok31NtW8F1IkydiZA1NknTwCgmlkgnY0gmlwhKwS_FaKbXVsdGlhZGRyc5YACASsEvxWBvcOAAoErBL8Vgb3D90DgnJzhQADAQAAiXNlY3AyNTZrMaECOmS9THZOJ3vetcuvfba_OF4DOlnhU0DpbKgz7RjcxPCDdGNwgvcOg3VkcIL3EIV3YWt1MgM"}'
2026-02-04 17:20:33.603 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 17:20:33.610 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 17:20:33.610 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-02-04_17-20-32__683ff2a2-07f0-49f1-8d20-ab94edb29502__wakuorg_nwaku:latest.log
2026-02-04 17:20:33.611 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 17:20:33.611 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 17:20:33.612 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 17:20:33.612 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.242.139
2026-02-04 17:20:33.612 DEBUG [src.node.docker_mananger] Generated ports ['54393', '54394', '54395', '54396', '54397']
2026-02-04 17:20:33.613 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 17:20:33.613 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 17:20:33.613 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 17:20:33.613 DEBUG [src.node.docker_mananger] docker run -i -t -p 54393:54393 -p 54394:54394 -p 54395:54395 -p 54396:54396 -p 54397:54397 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54395 --rest-port=54393 --tcp-port=54394 --discv5-udp-port=54396 --rest-address=0.0.0.0 --nat=extip:172.18.242.139 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=82cfc7bd4d748afdfafd7e74e604b5d76777a6fa8387fbe8bd710ee7bfdbdcc1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54397 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QGzPoj4YPg2s012ae8IiicSC9LXq3hQudVWf8ebd-xVyVGaEYEFFZydv_h8IMEnOok31NtW8F1IkydiZA1NknTwCgmlkgnY0gmlwhKwS_FaKbXVsdGlhZGRyc5YACASsEvxWBvcOAAoErBL8Vgb3D90DgnJzhQADAQAAiXNlY3AyNTZrMaECOmS9THZOJ3vetcuvfba_OF4DOlnhU0DpbKgz7RjcxPCDdGNwgvcOg3VkcIL3EIV3YWt1MgM --storenode=/ip4/172.18.252.86/tcp/63246/p2p/16Uiu2HAkyMcimXcY3AbS7ksE4iyQhWfix4kLYET5y1ZfZYzaEv5V --store=true --relay=true
2026-02-04 17:20:33.802 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.242.139 waku f2aeeced01baaf9b8a1eb53aa12601bc50bb226cb854c19c4280a47a4b6635a8
2026-02-04 17:20:33.834 DEBUG [src.node.docker_mananger] Container started with ID f2aeeced01ba. Setting up logs at ./log/docker/store_node1_2026-02-04_17-20-32__683ff2a2-07f0-49f1-8d20-ab94edb29502__wakuorg_nwaku:latest.log
2026-02-04 17:20:33.835 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 54393
2026-02-04 17:20:33.835 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 17:20:34.836 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54393/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:20:34.841 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 17:20:34.841 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 17:20:34.841 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54393/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:20:34.844 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.242.139/tcp/54394/p2p/16Uiu2HAmSB4MQwkb36xfw115ZVVPvMpQx4LwmVqby4JgbuSEgfgt","/ip4/172.18.242.139/tcp/54395/ws/p2p/16Uiu2HAmSB4MQwkb36xfw115ZVVPvMpQx4LwmVqby4JgbuSEgfgt"],"enrUri":"enr:-L24QLvQcEP4YGPf2b79512UsOyJ7FfvzL8Nhx3SyUSY1vI-fLFf1_1H6MYgUpoDTVsEDXaBYjlHpzxFaLM25eTQlQECgmlkgnY0gmlwhKwS8ouKbXVsdGlhZGRyc5YACASsEvKLBtR6AAoErBLyiwbUe90DgnJzhQADAQAAiXNlY3AyNTZrMaEDyNvhKauim8L4IxO5rmjrsM5Vwyx5Y4D9NV94od3-9emDdGNwgtR6g3VkcILUfIV3YWt1MgM"}'
2026-02-04 17:20:34.844 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 17:20:34.845 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54393/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.252.86/tcp/63246/p2p/16Uiu2HAkyMcimXcY3AbS7ksE4iyQhWfix4kLYET5y1ZfZYzaEv5V"]'
2026-02-04 17:20:34.847 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:20:34.848 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63245/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 17:20:34.850 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:20:34.851 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54393/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 17:20:34.853 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:20:34.854 DEBUG [src.steps.store] Relaying message
2026-02-04 17:20:34.854 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63245/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
2026-02-04 17:20:34.859 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:20:34.860 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 17:20:35.061 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-04 17:20:35.061 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63245/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:20:35.065 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2026-02-04 17:20:35.065 DEBUG [src.steps.store] messages length is 0
2026-02-04 17:20:35.067 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 17:20:35.068 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 17:20:35.068 DEBUG [src.node.waku_node] Stopping container with id d36544f707ca
2026-02-04 17:20:35.650 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 17:20:35.650 DEBUG [src.node.waku_node] Stopping container with id f2aeeced01ba
2026-02-04 17:20:36.179 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 17:20:36.180 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 17:20:36.185 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 17:20:36.191 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
