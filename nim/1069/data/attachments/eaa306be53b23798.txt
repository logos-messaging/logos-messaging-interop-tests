2026-02-04 17:15:17.922 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 17:15:17.923 DEBUG [tests.conftest] Running test: test_get_store_duplicate_messages with id: 2026-02-04_17-15-17__7f1ec9dd-457a-4303-82e4-5f041e43e8c4
2026-02-04 17:15:17.923 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 17:15:17.923 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-02-04 17:15:17.924 DEBUG [src.steps.store] Running fixture setup: node_setup
2026-02-04 17:15:17.931 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 17:15:17.931 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-02-04_17-15-17__7f1ec9dd-457a-4303-82e4-5f041e43e8c4__wakuorg_nwaku:latest.log
2026-02-04 17:15:17.931 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 17:15:17.931 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 17:15:17.933 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 17:15:17.933 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.148.156
2026-02-04 17:15:17.933 DEBUG [src.node.docker_mananger] Generated ports ['55713', '55714', '55715', '55716', '55717']
2026-02-04 17:15:17.933 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 17:15:17.933 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 17:15:17.933 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 17:15:17.933 DEBUG [src.node.docker_mananger] docker run -i -t -p 55713:55713 -p 55714:55714 -p 55715:55715 -p 55716:55716 -p 55717:55717 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55715 --rest-port=55713 --tcp-port=55714 --discv5-udp-port=55716 --rest-address=0.0.0.0 --nat=extip:172.18.148.156 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e827df2b6281f019dc1cca9ef56a4c2e8ec60d6eac9b7da1ff9d176d352bed19 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55717 --metrics-logging=true --store=true --relay=true
2026-02-04 17:15:18.117 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.148.156 waku 67ee86654dd8e227e8a25cf9446e65579f30d3cb58559b3e8ffdda1c9954442a
2026-02-04 17:15:18.135 ERROR [src.node.docker_mananger] Max retries reached for container 20b08352adea. Exiting log stream.
2026-02-04 17:15:18.153 DEBUG [src.node.docker_mananger] Container started with ID 67ee86654dd8. Setting up logs at ./log/docker/publishing_node1_2026-02-04_17-15-17__7f1ec9dd-457a-4303-82e4-5f041e43e8c4__wakuorg_nwaku:latest.log
2026-02-04 17:15:18.155 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 55713
2026-02-04 17:15:18.155 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 17:15:18.727 ERROR [src.node.docker_mananger] Max retries reached for container c94b3b73f8da. Exiting log stream.
2026-02-04 17:15:19.156 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55713/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:15:19.159 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 17:15:19.159 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 17:15:19.160 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55713/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:15:19.162 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.148.156/tcp/55714/p2p/16Uiu2HAmRKg5wkSSdb2u3JtLB5bQN8Qjws4GUs2jrFAGbA3CDGBh","/ip4/172.18.148.156/tcp/55715/ws/p2p/16Uiu2HAmRKg5wkSSdb2u3JtLB5bQN8Qjws4GUs2jrFAGbA3CDGBh"],"enrUri":"enr:-L24QL5H8J7RQ5HHJiXbsjSiL4-9aaFks-FLiXBIVY7CPzAFITPBocfLtM1PiLsNA00-uPfsw7nxT4s22MZHwTjZTM0CgmlkgnY0gmlwhKwSlJyKbXVsdGlhZGRyc5YACASsEpScBtmiAAoErBKUnAbZo90DgnJzhQADAQAAiXNlY3AyNTZrMaEDvDU-K63zv7nb2pbZbvsc0-VctP6CDTtkiM-2Imlo8piDdGNwgtmig3VkcILZpIV3YWt1MgM"}'
2026-02-04 17:15:19.162 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 17:15:19.170 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 17:15:19.170 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-02-04_17-15-17__7f1ec9dd-457a-4303-82e4-5f041e43e8c4__wakuorg_nwaku:latest.log
2026-02-04 17:15:19.170 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 17:15:19.170 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 17:15:19.172 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 17:15:19.172 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.92.47
2026-02-04 17:15:19.172 DEBUG [src.node.docker_mananger] Generated ports ['3195', '3196', '3197', '3198', '3199']
2026-02-04 17:15:19.172 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 17:15:19.172 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 17:15:19.172 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 17:15:19.172 DEBUG [src.node.docker_mananger] docker run -i -t -p 3195:3195 -p 3196:3196 -p 3197:3197 -p 3198:3198 -p 3199:3199 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3197 --rest-port=3195 --tcp-port=3196 --discv5-udp-port=3198 --rest-address=0.0.0.0 --nat=extip:172.18.92.47 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e1f7cff5716efdb6a5af1da039d62c35c31aa57340b56ca6db7c09fc0d0271ce --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3199 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QL5H8J7RQ5HHJiXbsjSiL4-9aaFks-FLiXBIVY7CPzAFITPBocfLtM1PiLsNA00-uPfsw7nxT4s22MZHwTjZTM0CgmlkgnY0gmlwhKwSlJyKbXVsdGlhZGRyc5YACASsEpScBtmiAAoErBKUnAbZo90DgnJzhQADAQAAiXNlY3AyNTZrMaEDvDU-K63zv7nb2pbZbvsc0-VctP6CDTtkiM-2Imlo8piDdGNwgtmig3VkcILZpIV3YWt1MgM --storenode=/ip4/172.18.148.156/tcp/55714/p2p/16Uiu2HAmRKg5wkSSdb2u3JtLB5bQN8Qjws4GUs2jrFAGbA3CDGBh --store=true --relay=true
2026-02-04 17:15:19.372 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.92.47 waku e37436d636e226745612a689c0d64d3b6cb35b473851dff9e1c0293aa635d905
2026-02-04 17:15:19.409 DEBUG [src.node.docker_mananger] Container started with ID e37436d636e2. Setting up logs at ./log/docker/store_node1_2026-02-04_17-15-17__7f1ec9dd-457a-4303-82e4-5f041e43e8c4__wakuorg_nwaku:latest.log
2026-02-04 17:15:19.410 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 3195
2026-02-04 17:15:19.411 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 17:15:20.412 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3195/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:15:20.416 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 17:15:20.416 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 17:15:20.417 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3195/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:15:20.419 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.92.47/tcp/3196/p2p/16Uiu2HAmKnP395YGa9mUZzCbiChRAr5Qm8oejnEyZMSd7GMpAf6Q","/ip4/172.18.92.47/tcp/3197/ws/p2p/16Uiu2HAmKnP395YGa9mUZzCbiChRAr5Qm8oejnEyZMSd7GMpAf6Q"],"enrUri":"enr:-L24QKdBw4UZzz5Rx3FWzahriSx4ev2I1FTX1JpuSFBhbFrgGsvtUZU6lUbfAHap5K7zcXny4pednJlxxcM1hJsjz0YCgmlkgnY0gmlwhKwSXC-KbXVsdGlhZGRyc5YACASsElwvBgx8AAoErBJcLwYMfd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDaeaGyOXNHHHXQccGVvmxr8QSuUcxu5YNujTgMGpFMSmDdGNwggx8g3VkcIIMfoV3YWt1MgM"}'
2026-02-04 17:15:20.419 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 17:15:20.420 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3195/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.148.156/tcp/55714/p2p/16Uiu2HAmRKg5wkSSdb2u3JtLB5bQN8Qjws4GUs2jrFAGbA3CDGBh"]'
2026-02-04 17:15:20.422 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:15:20.423 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55713/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 17:15:20.425 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:15:20.425 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3195/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 17:15:20.427 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:15:20.428 DEBUG [src.steps.store] Relaying message
2026-02-04 17:15:20.429 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55713/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 17:15:20.434 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:15:20.435 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 17:15:20.635 DEBUG [src.steps.store] Relaying message
2026-02-04 17:15:20.636 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55713/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 17:15:20.639 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:15:20.640 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 17:15:20.840 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-04 17:15:20.841 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55713/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:15:20.844 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xf6266f521e52612ca8e68b3bbac33a39673347bcaa3bf9fcf5f8a41a79e2f8e0"}]}'
2026-02-04 17:15:20.844 DEBUG [src.steps.store] messages length is 1
2026-02-04 17:15:20.844 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-04 17:15:20.845 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3195/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:15:20.847 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xf6266f521e52612ca8e68b3bbac33a39673347bcaa3bf9fcf5f8a41a79e2f8e0"}]}'
2026-02-04 17:15:20.847 DEBUG [src.steps.store] messages length is 1
2026-02-04 17:15:20.849 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 17:15:20.850 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 17:15:20.850 DEBUG [src.node.waku_node] Stopping container with id 67ee86654dd8
2026-02-04 17:15:21.451 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 17:15:21.451 DEBUG [src.node.waku_node] Stopping container with id e37436d636e2
2026-02-04 17:15:22.014 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 17:15:22.015 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 17:15:22.021 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 17:15:22.028 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
