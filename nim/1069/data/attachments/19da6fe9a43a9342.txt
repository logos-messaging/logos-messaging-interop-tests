2026-02-04 17:12:03.891 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 17:12:03.891 DEBUG [tests.conftest] Running test: test_relay_subscribe_to_already_existing_pubsub_topic with id: 2026-02-04_17-12-03__7e0d545b-cf11-4d18-afa1-4dc26385b5de
2026-02-04 17:12:03.891 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 17:12:03.892 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-04 17:12:03.892 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2026-02-04 17:12:03.898 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 17:12:03.898 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-04_17-12-03__7e0d545b-cf11-4d18-afa1-4dc26385b5de__wakuorg_nwaku:latest.log
2026-02-04 17:12:03.899 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 17:12:03.899 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 17:12:03.900 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 17:12:03.900 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.226.12
2026-02-04 17:12:03.900 DEBUG [src.node.docker_mananger] Generated ports ['38890', '38891', '38892', '38893', '38894']
2026-02-04 17:12:03.901 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 17:12:03.901 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 17:12:03.901 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 17:12:03.901 DEBUG [src.node.docker_mananger] docker run -i -t -p 38890:38890 -p 38891:38891 -p 38892:38892 -p 38893:38893 -p 38894:38894 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38892 --rest-port=38890 --tcp-port=38891 --discv5-udp-port=38893 --rest-address=0.0.0.0 --nat=extip:172.18.226.12 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2c547cb7eb42dbce422f95fb58514feb4a0491f38eeecfcaf5fca991ac9cdcad --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38894 --metrics-logging=true --relay=true
2026-02-04 17:12:04.095 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.226.12 waku 14bef45bec332da45400af4efbd0d390f8042c2da7e9086624636ee01ebc10d9
2026-02-04 17:12:04.116 ERROR [src.node.docker_mananger] Max retries reached for container 587f1afa5832. Exiting log stream.
2026-02-04 17:12:04.127 DEBUG [src.node.docker_mananger] Container started with ID 14bef45bec33. Setting up logs at ./log/docker/node1_2026-02-04_17-12-03__7e0d545b-cf11-4d18-afa1-4dc26385b5de__wakuorg_nwaku:latest.log
2026-02-04 17:12:04.129 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 38890
2026-02-04 17:12:04.129 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 17:12:04.669 ERROR [src.node.docker_mananger] Max retries reached for container 06d935729b9f. Exiting log stream.
2026-02-04 17:12:05.131 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38890/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:12:05.134 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 17:12:05.134 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 17:12:05.135 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38890/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:12:05.137 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.226.12/tcp/38891/p2p/16Uiu2HAm8MZ7LNHSWYPNSF917vmMSqg9DbTe5DUWERPwqqQP5vZq","/ip4/172.18.226.12/tcp/38892/ws/p2p/16Uiu2HAm8MZ7LNHSWYPNSF917vmMSqg9DbTe5DUWERPwqqQP5vZq"],"enrUri":"enr:-L24QNqBpqwmFeT3rG4E5VvjMhCs7KI_T8w3RE7EFU3Q-ktVUwbqvFD4A4RLBmc8aVIACYl-xVwnzA4AVE2ESQhzqV4CgmlkgnY0gmlwhKwS4gyKbXVsdGlhZGRyc5YACASsEuIMBpfrAAoErBLiDAaX7N0DgnJzhQADAQAAiXNlY3AyNTZrMaECwBnWweXxAH0SJUH51smJKnjrrp9eP6vkj7p5K5CSB0SDdGNwgpfrg3VkcIKX7YV3YWt1MgE"}'
2026-02-04 17:12:05.137 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 17:12:05.144 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 17:12:05.144 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-04_17-12-03__7e0d545b-cf11-4d18-afa1-4dc26385b5de__wakuorg_nwaku:latest.log
2026-02-04 17:12:05.144 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 17:12:05.144 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 17:12:05.146 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 17:12:05.146 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.229.242
2026-02-04 17:12:05.146 DEBUG [src.node.docker_mananger] Generated ports ['55468', '55469', '55470', '55471', '55472']
2026-02-04 17:12:05.146 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 17:12:05.146 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 17:12:05.146 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 17:12:05.146 DEBUG [src.node.docker_mananger] docker run -i -t -p 55468:55468 -p 55469:55469 -p 55470:55470 -p 55471:55471 -p 55472:55472 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55470 --rest-port=55468 --tcp-port=55469 --discv5-udp-port=55471 --rest-address=0.0.0.0 --nat=extip:172.18.229.242 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d96ab8fd2aa3371d7ad97fc5d07f9aeffacf2e8a154e239f6fbee1bccfbb1bde --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55472 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QNqBpqwmFeT3rG4E5VvjMhCs7KI_T8w3RE7EFU3Q-ktVUwbqvFD4A4RLBmc8aVIACYl-xVwnzA4AVE2ESQhzqV4CgmlkgnY0gmlwhKwS4gyKbXVsdGlhZGRyc5YACASsEuIMBpfrAAoErBLiDAaX7N0DgnJzhQADAQAAiXNlY3AyNTZrMaECwBnWweXxAH0SJUH51smJKnjrrp9eP6vkj7p5K5CSB0SDdGNwgpfrg3VkcIKX7YV3YWt1MgE
2026-02-04 17:12:05.342 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.229.242 waku b8c9075c1d1a88dedd637502b211e71b9ec76a107b87c314d0321d3cf5bca983
2026-02-04 17:12:05.374 DEBUG [src.node.docker_mananger] Container started with ID b8c9075c1d1a. Setting up logs at ./log/docker/node2_2026-02-04_17-12-03__7e0d545b-cf11-4d18-afa1-4dc26385b5de__wakuorg_nwaku:latest.log
2026-02-04 17:12:05.374 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 55468
2026-02-04 17:12:05.374 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 17:12:06.375 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55468/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:12:06.383 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 17:12:06.387 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 17:12:06.389 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55468/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:12:06.393 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.229.242/tcp/55469/p2p/16Uiu2HAm2j1WqYwHxbXExaPh5xD55NF2Ns8xir9HgogH9sJRu5BR","/ip4/172.18.229.242/tcp/55470/ws/p2p/16Uiu2HAm2j1WqYwHxbXExaPh5xD55NF2Ns8xir9HgogH9sJRu5BR"],"enrUri":"enr:-L24QHK8JPlppjcoUi_93GRm3mQnugtpYvrsMpFnixKFe2UMHYc4GySnAbE36Sy2-54MKBj1xYwbxb07-B1dIqZfomoCgmlkgnY0gmlwhKwS5fKKbXVsdGlhZGRyc5YACASsEuXyBtitAAoErBLl8gbYrt0DgnJzhQADAQAAiXNlY3AyNTZrMaECbHLFVBCf7B1V1XckJe-Mxp6hb11KNZZF2Uj9T9ARkqyDdGNwgtitg3VkcILYr4V3YWt1MgE"}'
2026-02-04 17:12:06.393 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 17:12:06.393 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55468/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.226.12/tcp/38891/p2p/16Uiu2HAm8MZ7LNHSWYPNSF917vmMSqg9DbTe5DUWERPwqqQP5vZq"]'
2026-02-04 17:12:06.396 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:12:06.397 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:38890/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-04 17:12:06.400 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:12:06.401 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55468/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-04 17:12:06.405 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:12:06.406 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:38890/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 17:12:06.411 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:12:06.412 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-04 17:12:06.512 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-04 17:12:06.512 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38890/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:12:06.515 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770225126406332416,"ephemeral":false,"proof":""}]'
2026-02-04 17:12:06.517 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-04 17:12:06.517 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55468/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:12:06.519 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770225126406332416,"ephemeral":false,"proof":""}]'
2026-02-04 17:12:06.521 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:38890/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-04 17:12:06.523 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:12:06.524 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55468/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-04 17:12:06.526 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:12:06.526 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:38890/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 17:12:06.530 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 17:12:06.531 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-04 17:12:06.632 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-04 17:12:06.632 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38890/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:12:06.635 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770225126526863591,"ephemeral":false,"proof":""}]'
2026-02-04 17:12:06.636 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-04 17:12:06.636 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55468/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-04 17:12:06.638 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770225126526863591,"ephemeral":false,"proof":""}]'
2026-02-04 17:12:06.641 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 17:12:06.642 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 17:12:06.642 DEBUG [src.node.waku_node] Stopping container with id 14bef45bec33
2026-02-04 17:12:07.184 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 17:12:07.184 DEBUG [src.node.waku_node] Stopping container with id b8c9075c1d1a
2026-02-04 17:12:07.684 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 17:12:07.687 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 17:12:07.692 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 17:12:07.699 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
