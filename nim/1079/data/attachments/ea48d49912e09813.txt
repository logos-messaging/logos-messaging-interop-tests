2026-02-14 04:33:45.877 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-14 04:33:45.877 DEBUG [tests.conftest] Running test: test_content_topic_also_in_docker_flags[/toychat/2/huilong/proto] with id: 2026-02-14_04-33-45__00b5d06d-7c0f-4f26-a490-4acd7750128a
2026-02-14 04:33:45.878 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-14 04:33:45.878 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-14 04:33:45.878 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-14 04:33:45.886 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-14 04:33:45.886 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-14_04-33-45__00b5d06d-7c0f-4f26-a490-4acd7750128a__wakuorg_nwaku:latest.log
2026-02-14 04:33:45.886 DEBUG [src.node.waku_node] Starting Node...
2026-02-14 04:33:45.886 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-14 04:33:45.888 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-14 04:33:45.888 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.201.97
2026-02-14 04:33:45.888 DEBUG [src.node.docker_mananger] Generated ports ['65465', '65466', '65467', '65468', '65469']
2026-02-14 04:33:45.888 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-14 04:33:45.888 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-14 04:33:45.889 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-14 04:33:45.889 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-14 04:33:45.889 DEBUG [src.node.waku_node] Using volumes []
2026-02-14 04:33:45.889 DEBUG [src.node.docker_mananger] docker run -i -t -p 65465:65465 -p 65466:65466 -p 65467:65467 -p 65468:65468 -p 65469:65469 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=65467 --rest-port=65465 --tcp-port=65466 --discv5-udp-port=65468 --rest-address=0.0.0.0 --nat=extip:172.18.201.97 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=0a48e5b0bc1f0ec6a8a4e5cfad03ffefc2f65e68b482ae846cd4b14fcb1d309c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=65469 --metrics-logging=true --relay=true --filter=true --content-topic=/toychat/2/huilong/proto
2026-02-14 04:33:46.087 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.201.97 waku 77d7f4b35eee861371876cdd6618eacb044633b502751aa8770c1737ba4124d2
2026-02-14 04:33:46.142 DEBUG [src.node.docker_mananger] Container started with ID 77d7f4b35eee. Setting up logs at ./log/docker/node1_2026-02-14_04-33-45__00b5d06d-7c0f-4f26-a490-4acd7750128a__wakuorg_nwaku:latest.log
2026-02-14 04:33:46.142 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 65465
2026-02-14 04:33:46.142 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-14 04:33:46.422 ERROR [src.node.docker_mananger] Max retries reached for container 4b1f4e8d4fdb. Exiting log stream.
2026-02-14 04:33:46.672 ERROR [src.node.docker_mananger] Max retries reached for container b5765f55716c. Exiting log stream.
2026-02-14 04:33:47.143 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:65465/health" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:33:47.146 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","connectionStatus":"Disconnected","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"},{"Rln Relay":"NOT_MOUNTED"}]}'
2026-02-14 04:33:47.146 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-14 04:33:47.146 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:65465/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:33:47.148 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.201.97/tcp/65466/p2p/16Uiu2HAmFj8wqMFZ9QBaNBuxkVDM6N5QdEUAmLXvQuFEzExr2axH","/ip4/172.18.201.97/tcp/65467/ws/p2p/16Uiu2HAmFj8wqMFZ9QBaNBuxkVDM6N5QdEUAmLXvQuFEzExr2axH"],"enrUri":"enr:-L24QN5LX7pPek6lEskiq8lYD6DD9f6LsQAPe0Gj689jn90gaRP7i5met53pbRqPUccOnril3VXqOknmgBhpPxAAEqkCgmlkgnY0gmlwhKwSyWGKbXVsdGlhZGRyc5YACASsEslhBv-6AAoErBLJYQb_u90DgnJzhQACAQAAiXNlY3AyNTZrMaEDLaMaY91zEA1V7K56oBzlayRTzK_agHRGfPd0f-hd1oKDdGNwgv-6g3VkcIL_vIV3YWt1MgU"}'
2026-02-14 04:33:47.149 INFO [src.node.waku_node] REST service is ready !!
2026-02-14 04:33:47.156 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-14 04:33:47.156 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-14_04-33-45__00b5d06d-7c0f-4f26-a490-4acd7750128a__wakuorg_nwaku:latest.log
2026-02-14 04:33:47.156 DEBUG [src.node.waku_node] Starting Node...
2026-02-14 04:33:47.156 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-14 04:33:47.157 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-14 04:33:47.157 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.201.210
2026-02-14 04:33:47.158 DEBUG [src.node.docker_mananger] Generated ports ['36301', '36302', '36303', '36304', '36305']
2026-02-14 04:33:47.158 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-14 04:33:47.158 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-14 04:33:47.158 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-14 04:33:47.158 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-14 04:33:47.158 DEBUG [src.node.waku_node] Using volumes []
2026-02-14 04:33:47.158 DEBUG [src.node.docker_mananger] docker run -i -t -p 36301:36301 -p 36302:36302 -p 36303:36303 -p 36304:36304 -p 36305:36305 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36303 --rest-port=36301 --tcp-port=36302 --discv5-udp-port=36304 --rest-address=0.0.0.0 --nat=extip:172.18.201.210 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=81776bc0b7b69817ac8d3e1c0b1bef19686dbadb9c6dce6cce310cdb3e0952aa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36305 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QN5LX7pPek6lEskiq8lYD6DD9f6LsQAPe0Gj689jn90gaRP7i5met53pbRqPUccOnril3VXqOknmgBhpPxAAEqkCgmlkgnY0gmlwhKwSyWGKbXVsdGlhZGRyc5YACASsEslhBv-6AAoErBLJYQb_u90DgnJzhQACAQAAiXNlY3AyNTZrMaEDLaMaY91zEA1V7K56oBzlayRTzK_agHRGfPd0f-hd1oKDdGNwgv-6g3VkcIL_vIV3YWt1MgU --content-topic=/toychat/2/huilong/proto
2026-02-14 04:33:47.357 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.201.210 waku caca9f21bd8a4eb6cf949c50429f37ba337d008a25464ed3d9ee2955869043ac
2026-02-14 04:33:47.413 DEBUG [src.node.docker_mananger] Container started with ID caca9f21bd8a. Setting up logs at ./log/docker/node2_2026-02-14_04-33-45__00b5d06d-7c0f-4f26-a490-4acd7750128a__wakuorg_nwaku:latest.log
2026-02-14 04:33:47.414 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 36301
2026-02-14 04:33:47.414 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-14 04:33:48.415 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36301/health" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:33:48.429 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","connectionStatus":"Disconnected","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"},{"Rln Relay":"NOT_MOUNTED"}]}'
2026-02-14 04:33:48.432 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-14 04:33:48.435 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36301/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:33:48.440 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.201.210/tcp/36302/p2p/16Uiu2HAmDw3NCUgPLxRsBPbsnRCj4rW4VQ7WCYzDQCRrCr1iNvN3","/ip4/172.18.201.210/tcp/36303/ws/p2p/16Uiu2HAmDw3NCUgPLxRsBPbsnRCj4rW4VQ7WCYzDQCRrCr1iNvN3"],"enrUri":"enr:-L24QDy1D2oNwCkvFbyFw7NudPPDo9B_uL3UdIxCBcCxu5JtagiVW9e2_whkkU09ZpQ7xHkBfmnHB8ARoSdRNwhSL7MCgmlkgnY0gmlwhKwSydKKbXVsdGlhZGRyc5YACASsEsnSBo3OAAoErBLJ0gaNz90DgnJzhQACAQAAiXNlY3AyNTZrMaEDEvhjw11rnIdSoHt8ilMiO_Rq-NqWdvRDNn8QGzdKJNCDdGNwgo3Og3VkcIKN0IV3YWt1MgE"}'
2026-02-14 04:33:48.440 INFO [src.node.waku_node] REST service is ready !!
2026-02-14 04:33:48.443 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36301/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.201.97/tcp/65466/p2p/16Uiu2HAmFj8wqMFZ9QBaNBuxkVDM6N5QdEUAmLXvQuFEzExr2axH"]'
2026-02-14 04:33:48.446 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:33:48.446 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:65465/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2026-02-14 04:33:48.448 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:33:48.449 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36301/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2026-02-14 04:33:48.451 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:33:48.452 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:65465/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-14 04:33:48.457 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:33:48.457 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-14 04:33:48.557 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-14 04:33:48.558 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:65465/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:33:48.561 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1771043628452096149,"ephemeral":false,"proof":""}]'
2026-02-14 04:33:48.563 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-14 04:33:48.563 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36301/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:33:48.565 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1771043628452096149,"ephemeral":false,"proof":""}]'
2026-02-14 04:33:48.568 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-14 04:33:48.569 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-14 04:33:48.569 DEBUG [src.node.waku_node] Stopping container with id 77d7f4b35eee
2026-02-14 04:33:48.858 DEBUG [src.node.waku_node] Container stopped.
2026-02-14 04:33:48.859 DEBUG [src.node.waku_node] Stopping container with id caca9f21bd8a
2026-02-14 04:33:49.122 DEBUG [src.node.waku_node] Container stopped.
2026-02-14 04:33:49.123 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-14 04:33:49.131 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-14 04:33:49.135 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
