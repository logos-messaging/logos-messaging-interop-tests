2026-02-14 04:41:36.017 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-14 04:41:36.018 DEBUG [tests.conftest] Running test: test_metrics_after_store_get with id: 2026-02-14_04-41-36__90aa6621-eb0f-4a68-87db-c38ba36d4fbd
2026-02-14 04:41:36.018 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-14 04:41:36.020 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2026-02-14 04:41:36.020 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2026-02-14 04:41:36.022 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-14 04:41:36.022 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-02-14 04:41:36.023 DEBUG [src.steps.store] Running fixture setup: node_setup
2026-02-14 04:41:36.034 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-14 04:41:36.035 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-02-14_04-41-36__90aa6621-eb0f-4a68-87db-c38ba36d4fbd__wakuorg_nwaku:latest.log
2026-02-14 04:41:36.035 DEBUG [src.node.waku_node] Starting Node...
2026-02-14 04:41:36.035 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-14 04:41:36.037 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-14 04:41:36.038 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.167.16
2026-02-14 04:41:36.038 DEBUG [src.node.docker_mananger] Generated ports ['23777', '23778', '23779', '23780', '23781']
2026-02-14 04:41:36.038 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-14 04:41:36.039 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-14 04:41:36.039 DEBUG [src.node.waku_node] Using volumes []
2026-02-14 04:41:36.039 DEBUG [src.node.docker_mananger] docker run -i -t -p 23777:23777 -p 23778:23778 -p 23779:23779 -p 23780:23780 -p 23781:23781 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23779 --rest-port=23777 --tcp-port=23778 --discv5-udp-port=23780 --rest-address=0.0.0.0 --nat=extip:172.18.167.16 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=59eb3a9e3be26bd866e776b2ed4b4ae9f1c80c8aece2accd64d47207caedaa42 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23781 --metrics-logging=true --store=true --relay=true
2026-02-14 04:41:36.250 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.167.16 waku b2c37d9171aed6293e61ac5828e37a4efe91052e29294ae7a4a6577db0aacee3
2026-02-14 04:41:36.267 ERROR [src.node.docker_mananger] Max retries reached for container 84956c5d981f. Exiting log stream.
2026-02-14 04:41:36.305 DEBUG [src.node.docker_mananger] Container started with ID b2c37d9171ae. Setting up logs at ./log/docker/publishing_node1_2026-02-14_04-41-36__90aa6621-eb0f-4a68-87db-c38ba36d4fbd__wakuorg_nwaku:latest.log
2026-02-14 04:41:36.306 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 23777
2026-02-14 04:41:36.306 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-14 04:41:36.518 ERROR [src.node.docker_mananger] Max retries reached for container 817400f2da26. Exiting log stream.
2026-02-14 04:41:36.861 ERROR [src.node.docker_mananger] Max retries reached for container 326a5c3acb71. Exiting log stream.
2026-02-14 04:41:37.307 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23777/health" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:41:37.310 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","connectionStatus":"Disconnected","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"},{"Rln Relay":"NOT_MOUNTED"}]}'
2026-02-14 04:41:37.310 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-14 04:41:37.310 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23777/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:41:37.313 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.167.16/tcp/23778/p2p/16Uiu2HAmBoaRg1v9Pj84LjaiztgkRmaSv49Zm8tjjqSEzecnE37f","/ip4/172.18.167.16/tcp/23779/ws/p2p/16Uiu2HAmBoaRg1v9Pj84LjaiztgkRmaSv49Zm8tjjqSEzecnE37f"],"enrUri":"enr:-L24QEkpBywpmZoI9A16P9u8mikNRYHbStIydwfYIxQlXUiBZpcqoCLQGUC-RQiTaAqP2Pq6fulzeHm2wLgSDNOjSPkCgmlkgnY0gmlwhKwSpxCKbXVsdGlhZGRyc5YACASsEqcQBlziAAoErBKnEAZc490DgnJzhQADAQAAiXNlY3AyNTZrMaEC81d9KlP8UQIrSq9tp_1zP8CX8hzF7x3M4v6BU5IttUKDdGNwglzig3VkcIJc5IV3YWt1MgM"}'
2026-02-14 04:41:37.313 INFO [src.node.waku_node] REST service is ready !!
2026-02-14 04:41:37.320 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-14 04:41:37.320 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-02-14_04-41-36__90aa6621-eb0f-4a68-87db-c38ba36d4fbd__wakuorg_nwaku:latest.log
2026-02-14 04:41:37.320 DEBUG [src.node.waku_node] Starting Node...
2026-02-14 04:41:37.320 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-14 04:41:37.322 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-14 04:41:37.322 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.136.111
2026-02-14 04:41:37.322 DEBUG [src.node.docker_mananger] Generated ports ['4193', '4194', '4195', '4196', '4197']
2026-02-14 04:41:37.322 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-14 04:41:37.322 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-14 04:41:37.322 DEBUG [src.node.waku_node] Using volumes []
2026-02-14 04:41:37.323 DEBUG [src.node.docker_mananger] docker run -i -t -p 4193:4193 -p 4194:4194 -p 4195:4195 -p 4196:4196 -p 4197:4197 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=4195 --rest-port=4193 --tcp-port=4194 --discv5-udp-port=4196 --rest-address=0.0.0.0 --nat=extip:172.18.136.111 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=abfac2bbab55fb9edb25fa4676fe3d3e4463421e93d8c00bc6cbb31dccbc32cf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=4197 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QEkpBywpmZoI9A16P9u8mikNRYHbStIydwfYIxQlXUiBZpcqoCLQGUC-RQiTaAqP2Pq6fulzeHm2wLgSDNOjSPkCgmlkgnY0gmlwhKwSpxCKbXVsdGlhZGRyc5YACASsEqcQBlziAAoErBKnEAZc490DgnJzhQADAQAAiXNlY3AyNTZrMaEC81d9KlP8UQIrSq9tp_1zP8CX8hzF7x3M4v6BU5IttUKDdGNwglzig3VkcIJc5IV3YWt1MgM --storenode=/ip4/172.18.167.16/tcp/23778/p2p/16Uiu2HAmBoaRg1v9Pj84LjaiztgkRmaSv49Zm8tjjqSEzecnE37f --store=true --relay=true
2026-02-14 04:41:37.524 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.136.111 waku e7bf558f980c6e95dfce4e5126294e53a205184b8ff58fe5a84149674d43f74e
2026-02-14 04:41:37.577 DEBUG [src.node.docker_mananger] Container started with ID e7bf558f980c. Setting up logs at ./log/docker/store_node1_2026-02-14_04-41-36__90aa6621-eb0f-4a68-87db-c38ba36d4fbd__wakuorg_nwaku:latest.log
2026-02-14 04:41:37.578 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 4193
2026-02-14 04:41:37.578 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-14 04:41:38.579 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:4193/health" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:41:38.582 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","connectionStatus":"PartiallyConnected","protocolsHealth":[{"Relay":"READY"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"},{"Rln Relay":"NOT_MOUNTED"}]}'
2026-02-14 04:41:38.583 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-14 04:41:38.583 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:4193/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:41:38.585 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.136.111/tcp/4194/p2p/16Uiu2HAmDZtDTi6APuyKpicLDcrZSSYUm1kdUGDKJG6ERYzECV7N","/ip4/172.18.136.111/tcp/4195/ws/p2p/16Uiu2HAmDZtDTi6APuyKpicLDcrZSSYUm1kdUGDKJG6ERYzECV7N"],"enrUri":"enr:-L24QD-3Asffo5erFZG6PEbmIPWvXF8EtsTPaWnb4y2GJbZUDqw7C6VaQAenHb0BRo8w-VcXzP6NEIaxcxFrkw9tFFUCgmlkgnY0gmlwhKwSiG-KbXVsdGlhZGRyc5YACASsEohvBhBiAAoErBKIbwYQY90DgnJzhQADAQAAiXNlY3AyNTZrMaEDDYzYljmUyzLUzoVXlmIT3v9VEHAg1uJqx_E2e9q3PEmDdGNwghBig3VkcIIQZIV3YWt1MgM"}'
2026-02-14 04:41:38.586 INFO [src.node.waku_node] REST service is ready !!
2026-02-14 04:41:38.586 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:4193/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.167.16/tcp/23778/p2p/16Uiu2HAmBoaRg1v9Pj84LjaiztgkRmaSv49Zm8tjjqSEzecnE37f"]'
2026-02-14 04:41:38.589 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:41:38.589 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23777/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-14 04:41:38.593 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:41:38.594 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:4193/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-14 04:41:38.600 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:41:38.604 DEBUG [src.steps.store] Relaying message
2026-02-14 04:41:38.604 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23777/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-14 04:41:38.611 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:41:38.612 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-14 04:41:38.813 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-14 04:41:38.813 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23777/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:41:38.816 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3084dfc8651af460e2c2d781cd810f227af3b6738532e6c588ed9af34ea1114d"}]}'
2026-02-14 04:41:38.816 DEBUG [src.steps.store] messages length is 1
2026-02-14 04:41:38.817 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-14 04:41:38.817 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:4193/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:41:38.820 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3084dfc8651af460e2c2d781cd810f227af3b6738532e6c588ed9af34ea1114d"}]}'
2026-02-14 04:41:38.820 DEBUG [src.steps.store] messages length is 1
2026-02-14 04:41:38.820 DEBUG [src.libs.common] Sleeping for 5 seconds
2026-02-14 04:41:43.821 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2026-02-14 04:41:43.825 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 1.0
2026-02-14 04:41:43.825 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_peers has 1
2026-02-14 04:41:43.828 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_peers with value 1.0
2026-02-14 04:41:43.829 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_topics has 1
2026-02-14 04:41:43.832 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_topics with value 2.0
2026-02-14 04:41:43.832 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_subscriptions_total has 1
2026-02-14 04:41:43.835 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_subscriptions_total with value 2.0
2026-02-14 04:41:43.835 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2026-02-14 04:41:43.838 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 1.0
2026-02-14 04:41:43.838 DEBUG [src.steps.metrics] Checking metric: waku_histogram_message_size_count has 1
2026-02-14 04:41:43.841 DEBUG [src.steps.metrics] Found metric: waku_histogram_message_size_count with value 1.0
2026-02-14 04:41:43.841 DEBUG [src.steps.metrics] Checking metric: waku_node_messages_total{type="relay"} has 1
2026-02-14 04:41:43.844 DEBUG [src.steps.metrics] Found metric: waku_node_messages_total{type="relay"} with value 1.0
2026-02-14 04:41:43.845 DEBUG [src.steps.metrics] Checking metric: waku_service_peers{protocol="/vac/waku/store/2.0.0-beta4",peerId="/ip4/172.18.167.16/tcp/23778"} has 1
2026-02-14 04:41:43.848 DEBUG [src.steps.metrics] Found metric: waku_service_peers{protocol="/vac/waku/store/2.0.0-beta4",peerId="/ip4/172.18.167.16/tcp/23778"} with value 1.0
2026-02-14 04:41:43.848 DEBUG [src.steps.metrics] Checking metric: waku_service_peers{protocol="/vac/waku/store-query/3.0.0",peerId="/ip4/172.18.167.16/tcp/23778"} has 1
2026-02-14 04:41:43.852 DEBUG [src.steps.metrics] Found metric: waku_service_peers{protocol="/vac/waku/store-query/3.0.0",peerId="/ip4/172.18.167.16/tcp/23778"} with value 1.0
2026-02-14 04:41:43.852 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2026-02-14 04:41:43.855 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 1.0
2026-02-14 04:41:43.855 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_peers has 1
2026-02-14 04:41:43.858 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_peers with value 1.0
2026-02-14 04:41:43.858 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_topics has 1
2026-02-14 04:41:43.861 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_topics with value 2.0
2026-02-14 04:41:43.862 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_subscriptions_total has 1
2026-02-14 04:41:43.865 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_subscriptions_total with value 2.0
2026-02-14 04:41:43.865 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2026-02-14 04:41:43.868 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 1.0
2026-02-14 04:41:43.868 DEBUG [src.steps.metrics] Checking metric: waku_histogram_message_size_count has 1
2026-02-14 04:41:43.871 DEBUG [src.steps.metrics] Found metric: waku_histogram_message_size_count with value 1.0
2026-02-14 04:41:43.872 DEBUG [src.steps.metrics] Checking metric: waku_node_messages_total{type="relay"} has 1
2026-02-14 04:41:43.875 DEBUG [src.steps.metrics] Found metric: waku_node_messages_total{type="relay"} with value 1.0
2026-02-14 04:41:43.877 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-14 04:41:43.878 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-14 04:41:43.878 DEBUG [src.node.waku_node] Stopping container with id b2c37d9171ae
2026-02-14 04:41:44.139 DEBUG [src.node.waku_node] Container stopped.
2026-02-14 04:41:44.140 DEBUG [src.node.waku_node] Stopping container with id e7bf558f980c
2026-02-14 04:41:44.409 DEBUG [src.node.waku_node] Container stopped.
2026-02-14 04:41:44.411 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-14 04:41:44.423 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-14 04:41:44.431 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
