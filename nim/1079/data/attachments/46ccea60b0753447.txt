2026-02-14 04:42:04.401 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-14 04:42:04.402 DEBUG [tests.conftest] Running test: test_subscribe_and_publish_on_another_shard with id: 2026-02-14_04-42-04__0284898c-16e6-4bb4-950e-95b9c32157ea
2026-02-14 04:42:04.403 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-14 04:42:04.404 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-14 04:42:04.404 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-14 04:42:04.413 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-14 04:42:04.413 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-14_04-42-04__0284898c-16e6-4bb4-950e-95b9c32157ea__wakuorg_nwaku:latest.log
2026-02-14 04:42:04.413 DEBUG [src.node.waku_node] Starting Node...
2026-02-14 04:42:04.413 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-14 04:42:04.415 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-14 04:42:04.415 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.44.207
2026-02-14 04:42:04.415 DEBUG [src.node.docker_mananger] Generated ports ['22868', '22869', '22870', '22871', '22872']
2026-02-14 04:42:04.416 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-14 04:42:04.416 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-14 04:42:04.416 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-14 04:42:04.416 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-14 04:42:04.416 DEBUG [src.node.waku_node] Using volumes []
2026-02-14 04:42:04.416 DEBUG [src.node.docker_mananger] docker run -i -t -p 22868:22868 -p 22869:22869 -p 22870:22870 -p 22871:22871 -p 22872:22872 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22870 --rest-port=22868 --tcp-port=22869 --discv5-udp-port=22871 --rest-address=0.0.0.0 --nat=extip:172.18.44.207 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=6b6eabcc183ef42b2dcdf9aa3c151cc5dbdbd48c0ccf226f12bde5aea24beab0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22872 --metrics-logging=true --relay=true --filter=true
2026-02-14 04:42:04.619 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.44.207 waku b5deb00b1207a132fdf80122235f1bbcb53797275006bce76a84b5b62db6a6ff
2026-02-14 04:42:04.636 ERROR [src.node.docker_mananger] Max retries reached for container 792134ee4a19. Exiting log stream.
2026-02-14 04:42:04.672 DEBUG [src.node.docker_mananger] Container started with ID b5deb00b1207. Setting up logs at ./log/docker/node1_2026-02-14_04-42-04__0284898c-16e6-4bb4-950e-95b9c32157ea__wakuorg_nwaku:latest.log
2026-02-14 04:42:04.672 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 22868
2026-02-14 04:42:04.673 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-14 04:42:04.908 ERROR [src.node.docker_mananger] Max retries reached for container 02c180ea9952. Exiting log stream.
2026-02-14 04:42:05.223 ERROR [src.node.docker_mananger] Max retries reached for container 5068381cf22c. Exiting log stream.
2026-02-14 04:42:05.673 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22868/health" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:42:05.676 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","connectionStatus":"Disconnected","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"},{"Rln Relay":"NOT_MOUNTED"}]}'
2026-02-14 04:42:05.676 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-14 04:42:05.677 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22868/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:42:05.679 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.44.207/tcp/22869/p2p/16Uiu2HAmVboapwKvkfYQjLuYWT5GLmCpUxwgoS9jThD2WX3amtah","/ip4/172.18.44.207/tcp/22870/ws/p2p/16Uiu2HAmVboapwKvkfYQjLuYWT5GLmCpUxwgoS9jThD2WX3amtah"],"enrUri":"enr:-L24QJ-SCSR3QzsqolNu66ovxYWQfZR-FKvHSVHxaboBbB4-JWAse4hkm93FDswp34G2uJYeg7FoULpcE-3eBtanlxoCgmlkgnY0gmlwhKwSLM-KbXVsdGlhZGRyc5YACASsEizPBllVAAoErBIszwZZVt0DgnJzhQACAQAAiXNlY3AyNTZrMaED-8XC8SIxPv8432RrfHYZ54FGRXJGrQE-Q9WvxKVyE_6DdGNwgllVg3VkcIJZV4V3YWt1MgU"}'
2026-02-14 04:42:05.679 INFO [src.node.waku_node] REST service is ready !!
2026-02-14 04:42:05.686 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-14 04:42:05.687 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-14_04-42-04__0284898c-16e6-4bb4-950e-95b9c32157ea__wakuorg_nwaku:latest.log
2026-02-14 04:42:05.687 DEBUG [src.node.waku_node] Starting Node...
2026-02-14 04:42:05.687 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-14 04:42:05.688 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-14 04:42:05.688 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.233.60
2026-02-14 04:42:05.689 DEBUG [src.node.docker_mananger] Generated ports ['16753', '16754', '16755', '16756', '16757']
2026-02-14 04:42:05.689 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-14 04:42:05.689 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-14 04:42:05.689 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-14 04:42:05.689 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-14 04:42:05.689 DEBUG [src.node.waku_node] Using volumes []
2026-02-14 04:42:05.689 DEBUG [src.node.docker_mananger] docker run -i -t -p 16753:16753 -p 16754:16754 -p 16755:16755 -p 16756:16756 -p 16757:16757 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16755 --rest-port=16753 --tcp-port=16754 --discv5-udp-port=16756 --rest-address=0.0.0.0 --nat=extip:172.18.233.60 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=8a81e5f8b14fb6fbff1edfcefec9adbfcaf85bd31ff8da9df93b002dbb07c4dc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16757 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QJ-SCSR3QzsqolNu66ovxYWQfZR-FKvHSVHxaboBbB4-JWAse4hkm93FDswp34G2uJYeg7FoULpcE-3eBtanlxoCgmlkgnY0gmlwhKwSLM-KbXVsdGlhZGRyc5YACASsEizPBllVAAoErBIszwZZVt0DgnJzhQACAQAAiXNlY3AyNTZrMaED-8XC8SIxPv8432RrfHYZ54FGRXJGrQE-Q9WvxKVyE_6DdGNwgllVg3VkcIJZV4V3YWt1MgU
2026-02-14 04:42:05.891 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.233.60 waku 718dbbe3b88bf850aa11cf32aae4140f363a9cb0d28ff929e3c2ed721b22351e
2026-02-14 04:42:05.942 DEBUG [src.node.docker_mananger] Container started with ID 718dbbe3b88b. Setting up logs at ./log/docker/node2_2026-02-14_04-42-04__0284898c-16e6-4bb4-950e-95b9c32157ea__wakuorg_nwaku:latest.log
2026-02-14 04:42:05.942 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 16753
2026-02-14 04:42:05.942 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-14 04:42:06.943 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16753/health" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:42:06.950 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","connectionStatus":"PartiallyConnected","protocolsHealth":[{"Relay":"READY"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"},{"Rln Relay":"NOT_MOUNTED"}]}'
2026-02-14 04:42:06.953 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-14 04:42:06.953 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16753/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:42:06.958 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.233.60/tcp/16754/p2p/16Uiu2HAmS8UZq4MShE4XYQPEjRdXhPavPGmTgHRk2i4xaYWxk4us","/ip4/172.18.233.60/tcp/16755/ws/p2p/16Uiu2HAmS8UZq4MShE4XYQPEjRdXhPavPGmTgHRk2i4xaYWxk4us"],"enrUri":"enr:-L24QL3rZepYVurnA2m-nCVlN8cio31Q6bLCKlaqDRfs9HPlAWNHv4xRsWbNOPcgMKrZs-WX3Ds2kvoAgwGJrSF_00ACgmlkgnY0gmlwhKwS6TyKbXVsdGlhZGRyc5YACASsEuk8BkFyAAoErBLpPAZBc90DgnJzhQACAQAAiXNlY3AyNTZrMaEDyDKEG4kgWfRZyr4uSnHYaB-g1Q1EnM16aOGuHtoftu6DdGNwgkFyg3VkcIJBdIV3YWt1MgE"}'
2026-02-14 04:42:06.959 INFO [src.node.waku_node] REST service is ready !!
2026-02-14 04:42:06.959 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16753/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.44.207/tcp/22869/p2p/16Uiu2HAmVboapwKvkfYQjLuYWT5GLmCpUxwgoS9jThD2WX3amtah"]'
2026-02-14 04:42:06.961 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:42:06.962 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22868/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
2026-02-14 04:42:06.966 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:42:06.967 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16753/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
2026-02-14 04:42:06.971 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:42:06.973 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22868/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-14 04:42:06.978 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:42:06.979 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-14 04:42:07.079 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-14 04:42:07.080 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22868/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:42:07.083 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1771044126972946356,"ephemeral":false,"proof":""}]'
2026-02-14 04:42:07.085 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-14 04:42:07.085 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16753/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:42:07.087 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1771044126972946356,"ephemeral":false,"proof":""}]'
2026-02-14 04:42:07.089 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22868/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-14 04:42:07.094 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:42:07.094 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-14 04:42:07.195 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-14 04:42:07.195 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22868/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:42:07.198 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1771044127089302381,"ephemeral":false,"proof":""}]'
2026-02-14 04:42:07.199 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-14 04:42:07.200 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16753/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:42:07.202 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1771044127089302381,"ephemeral":false,"proof":""}]'
2026-02-14 04:42:07.205 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-14 04:42:07.206 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-14 04:42:07.206 DEBUG [src.node.waku_node] Stopping container with id b5deb00b1207
2026-02-14 04:42:07.468 DEBUG [src.node.waku_node] Container stopped.
2026-02-14 04:42:07.469 DEBUG [src.node.waku_node] Stopping container with id 718dbbe3b88b
2026-02-14 04:42:07.736 DEBUG [src.node.waku_node] Container stopped.
2026-02-14 04:42:07.739 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-14 04:42:07.750 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-14 04:42:07.758 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
