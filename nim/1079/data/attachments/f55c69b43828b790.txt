2026-02-14 04:33:05.419 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-14 04:33:05.420 DEBUG [tests.conftest] Running test: test_filter_update_subscription_add_a_new_pubsub_topic with id: 2026-02-14_04-33-05__bdabf173-c62b-454b-b02e-f271308d1bbc
2026-02-14 04:33:05.420 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-14 04:33:05.421 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2026-02-14 04:33:05.421 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2026-02-14 04:33:05.429 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-14 04:33:05.429 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-14_04-33-05__bdabf173-c62b-454b-b02e-f271308d1bbc__wakuorg_nwaku:latest.log
2026-02-14 04:33:05.429 DEBUG [src.node.waku_node] Starting Node...
2026-02-14 04:33:05.430 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-14 04:33:05.432 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-14 04:33:05.433 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.117.132
2026-02-14 04:33:05.433 DEBUG [src.node.docker_mananger] Generated ports ['24170', '24171', '24172', '24173', '24174']
2026-02-14 04:33:05.434 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-14 04:33:05.434 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-14 04:33:05.434 DEBUG [src.node.waku_node] Using volumes []
2026-02-14 04:33:05.434 DEBUG [src.node.docker_mananger] docker run -i -t -p 24170:24170 -p 24171:24171 -p 24172:24172 -p 24173:24173 -p 24174:24174 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24172 --rest-port=24170 --tcp-port=24171 --discv5-udp-port=24173 --rest-address=0.0.0.0 --nat=extip:172.18.117.132 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ef478474cdad10cc9a7dacfba52d07dd8b5e7d91cbd8388ec28dd529cccaeb47 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24174 --metrics-logging=true --relay=true --filter=true
2026-02-14 04:33:05.594 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.117.132 waku 42ef6980cebd0e3c533cefc536abdfc8f5e72fc7f4ae81da5dc0cf4e2a9bdf9c
2026-02-14 04:33:05.628 DEBUG [src.node.docker_mananger] Container started with ID 42ef6980cebd. Setting up logs at ./log/docker/node1_2026-02-14_04-33-05__bdabf173-c62b-454b-b02e-f271308d1bbc__wakuorg_nwaku:latest.log
2026-02-14 04:33:05.628 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 24170
2026-02-14 04:33:05.629 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-14 04:33:05.957 ERROR [src.node.docker_mananger] Max retries reached for container fd5de96e9b18. Exiting log stream.
2026-02-14 04:33:06.248 ERROR [src.node.docker_mananger] Max retries reached for container 7b80885af97e. Exiting log stream.
2026-02-14 04:33:06.630 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24170/health" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:33:06.633 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","connectionStatus":"Disconnected","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"},{"Rln Relay":"NOT_MOUNTED"}]}'
2026-02-14 04:33:06.633 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-14 04:33:06.633 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24170/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:33:06.635 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.117.132/tcp/24171/p2p/16Uiu2HAmQaFAww5R9q3imgEifvbc14xx3bcUVzKBmnZr3xhAEh2A","/ip4/172.18.117.132/tcp/24172/ws/p2p/16Uiu2HAmQaFAww5R9q3imgEifvbc14xx3bcUVzKBmnZr3xhAEh2A"],"enrUri":"enr:-L24QNHy_eMUkqxBlebypFVhsxCahtRi0AulpuFgkIoYcHpBBMgs8DSB5nza-SDARI5Eb9ZujT5t79IfC4u8gGbC_asCgmlkgnY0gmlwhKwSdYSKbXVsdGlhZGRyc5YACASsEnWEBl5rAAoErBJ1hAZebN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDsRUZFyqrv2G4dEAMB_Z4t35SV8q44AzAjN7DaN0EqjuDdGNwgl5rg3VkcIJebYV3YWt1MgU"}'
2026-02-14 04:33:06.636 INFO [src.node.waku_node] REST service is ready !!
2026-02-14 04:33:06.636 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2026-02-14 04:33:06.642 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-14 04:33:06.642 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-14_04-33-05__bdabf173-c62b-454b-b02e-f271308d1bbc__wakuorg_nwaku:latest.log
2026-02-14 04:33:06.642 DEBUG [src.node.waku_node] Starting Node...
2026-02-14 04:33:06.642 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-14 04:33:06.643 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-14 04:33:06.643 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.18.207
2026-02-14 04:33:06.643 DEBUG [src.node.docker_mananger] Generated ports ['27175', '27176', '27177', '27178', '27179']
2026-02-14 04:33:06.643 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-14 04:33:06.644 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-14 04:33:06.644 DEBUG [src.node.waku_node] Using volumes []
2026-02-14 04:33:06.644 DEBUG [src.node.docker_mananger] docker run -i -t -p 27175:27175 -p 27176:27176 -p 27177:27177 -p 27178:27178 -p 27179:27179 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=27177 --rest-port=27175 --tcp-port=27176 --discv5-udp-port=27178 --rest-address=0.0.0.0 --nat=extip:172.18.18.207 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d6d8095e8e5aaffb40b9ee5b2eade9ae513c27ccc7c8020ce33fc0dfeccb4dd4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=27179 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QNHy_eMUkqxBlebypFVhsxCahtRi0AulpuFgkIoYcHpBBMgs8DSB5nza-SDARI5Eb9ZujT5t79IfC4u8gGbC_asCgmlkgnY0gmlwhKwSdYSKbXVsdGlhZGRyc5YACASsEnWEBl5rAAoErBJ1hAZebN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDsRUZFyqrv2G4dEAMB_Z4t35SV8q44AzAjN7DaN0EqjuDdGNwgl5rg3VkcIJebYV3YWt1MgU --filternode=/ip4/172.18.117.132/tcp/24171/p2p/16Uiu2HAmQaFAww5R9q3imgEifvbc14xx3bcUVzKBmnZr3xhAEh2A
2026-02-14 04:33:06.797 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.18.207 waku 00dab82b2c5a2e237eddefc5d814120af68d2cb7fce837045017a486ff535d8c
2026-02-14 04:33:06.830 DEBUG [src.node.docker_mananger] Container started with ID 00dab82b2c5a. Setting up logs at ./log/docker/node2_2026-02-14_04-33-05__bdabf173-c62b-454b-b02e-f271308d1bbc__wakuorg_nwaku:latest.log
2026-02-14 04:33:06.830 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 27175
2026-02-14 04:33:06.831 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-14 04:33:07.832 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27175/health" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:33:07.834 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","connectionStatus":"Disconnected","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"},{"Rln Relay":"NOT_MOUNTED"}]}'
2026-02-14 04:33:07.834 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-14 04:33:07.834 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27175/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:33:07.837 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.18.207/tcp/27176/p2p/16Uiu2HAmLHuZWYNR8wHmHe5UnbgGqtZip7bz2B2b3MNYkfbkaUmz","/ip4/172.18.18.207/tcp/27177/ws/p2p/16Uiu2HAmLHuZWYNR8wHmHe5UnbgGqtZip7bz2B2b3MNYkfbkaUmz"],"enrUri":"enr:-L24QLGA1pIs7SRnvupgrENwgFCkv7iBFzUT1VzZSj2xJuRZWX04uxpiYXx0UJ-fHLiDvax0GIZsjg3SxtEwVP0JPTMCgmlkgnY0gmlwhKwSEs-KbXVsdGlhZGRyc5YACASsEhLPBmooAAoErBISzwZqKd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDcXbiFSG6A3pGuLl88-VVUnHSXpQPsi89NWjVyLfKjxWDdGNwgmoog3VkcIJqKoV3YWt1MgA"}'
2026-02-14 04:33:07.837 INFO [src.node.waku_node] REST service is ready !!
2026-02-14 04:33:07.837 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:27175/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.117.132/tcp/24171/p2p/16Uiu2HAmQaFAww5R9q3imgEifvbc14xx3bcUVzKBmnZr3xhAEh2A"]'
2026-02-14 04:33:07.867 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:33:07.871 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24170/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-14 04:33:07.887 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:33:07.887 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:27175/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "55e8e54e-3573-4690-9e11-bc336700b2ea", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-14 04:33:07.901 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"55e8e54e-3573-4690-9e11-bc336700b2ea","statusDesc":"OK"}'
2026-02-14 04:33:07.901 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:27175/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto", "/test/2/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1000"}'
2026-02-14 04:33:07.909 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
2026-02-14 04:33:07.910 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24170/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1000"]'
2026-02-14 04:33:07.912 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:33:07.913 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24170/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-02-14 04:33:07.919 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:33:07.919 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-14 04:33:08.019 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-14 04:33:08.020 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27175/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:33:08.022 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1771043587912900769,"ephemeral":false}]'
2026-02-14 04:33:08.024 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24170/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1000" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-02-14 04:33:08.029 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:33:08.029 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-14 04:33:08.129 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-14 04:33:08.129 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27175/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:33:08.132 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1771043588024294802,"ephemeral":false}]'
2026-02-14 04:33:08.133 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24170/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1000" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/2/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-02-14 04:33:08.138 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-14 04:33:08.138 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-14 04:33:08.238 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-14 04:33:08.239 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27175/filter/v2/messages/%2Ftest%2F2%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-14 04:33:08.241 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/2/waku-filter/proto","version":0,"timestamp":1771043588133730488,"ephemeral":false}]'
2026-02-14 04:33:08.244 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-14 04:33:08.245 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-14 04:33:08.245 DEBUG [src.node.waku_node] Stopping container with id 42ef6980cebd
2026-02-14 04:33:08.470 DEBUG [src.node.waku_node] Container stopped.
2026-02-14 04:33:08.470 DEBUG [src.node.waku_node] Stopping container with id 00dab82b2c5a
2026-02-14 04:33:08.677 DEBUG [src.node.waku_node] Container stopped.
2026-02-14 04:33:08.678 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-14 04:33:08.683 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-14 04:33:08.687 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
