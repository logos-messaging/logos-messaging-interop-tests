2026-02-10 04:48:07.061 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-10 04:48:07.062 DEBUG [tests.conftest] Running test: test_message_relayed_while_store_node_is_stopped_without_removing with id: 2026-02-10_04-48-07__a3c5a1cc-0b8a-4b2f-aaf3-2f7b08c913ee
2026-02-10 04:48:07.062 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-10 04:48:07.062 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-02-10 04:48:07.069 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-10 04:48:07.069 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-02-10_04-48-07__a3c5a1cc-0b8a-4b2f-aaf3-2f7b08c913ee__wakuorg_nwaku:latest.log
2026-02-10 04:48:07.069 DEBUG [src.node.waku_node] Starting Node...
2026-02-10 04:48:07.069 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-10 04:48:07.071 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-10 04:48:07.071 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.77.214
2026-02-10 04:48:07.071 DEBUG [src.node.docker_mananger] Generated ports ['39789', '39790', '39791', '39792', '39793']
2026-02-10 04:48:07.071 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-10 04:48:07.071 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-10 04:48:07.071 DEBUG [src.node.waku_node] Using volumes []
2026-02-10 04:48:07.072 DEBUG [src.node.docker_mananger] docker run -i -t -p 39789:39789 -p 39790:39790 -p 39791:39791 -p 39792:39792 -p 39793:39793 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39791 --rest-port=39789 --tcp-port=39790 --discv5-udp-port=39792 --rest-address=0.0.0.0 --nat=extip:172.18.77.214 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=db11e7cebae9f22bdbcbdfdb8db8d0dcea181f4d5f699feb1fa5bcdedb59f2ed --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39793 --metrics-logging=true --store=true --relay=true
2026-02-10 04:48:07.257 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.77.214 waku 4b64826cc2be577969b849c278b49eb9f5846881f14c1dd76922f7026cf185f0
2026-02-10 04:48:07.291 DEBUG [src.node.docker_mananger] Container started with ID 4b64826cc2be. Setting up logs at ./log/docker/publishing_node1_2026-02-10_04-48-07__a3c5a1cc-0b8a-4b2f-aaf3-2f7b08c913ee__wakuorg_nwaku:latest.log
2026-02-10 04:48:07.292 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 39789
2026-02-10 04:48:07.293 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-10 04:48:07.345 ERROR [src.node.docker_mananger] Max retries reached for container 6d76b77f6c81. Exiting log stream.
2026-02-10 04:48:07.870 ERROR [src.node.docker_mananger] Max retries reached for container 23e374528d9e. Exiting log stream.
2026-02-10 04:48:08.294 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39789/health" -H "Content-Type: application/json" -d 'None'
2026-02-10 04:48:08.297 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-10 04:48:08.297 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-10 04:48:08.298 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39789/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-10 04:48:08.300 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.77.214/tcp/39790/p2p/16Uiu2HAmMivnjNDv7141jYSyFC1qi1PEbWbq4Ck8t88yUJunsc3v","/ip4/172.18.77.214/tcp/39791/ws/p2p/16Uiu2HAmMivnjNDv7141jYSyFC1qi1PEbWbq4Ck8t88yUJunsc3v"],"enrUri":"enr:-L24QA4X49Hz2jgK8JADsAFRix6s3VAR79RgXSkvBRFxeWx7EiiYJAnZIoD0YkoPpbEPLqqhxC8mNktIuTZuC0ISNZECgmlkgnY0gmlwhKwSTdaKbXVsdGlhZGRyc5YACASsEk3WBptuAAoErBJN1gabb90DgnJzhQADAQAAiXNlY3AyNTZrMaEDhrt6jnLBIy92neoZQkojFn4Zrha16Wiz9w_mvm0fEHWDdGNwgptug3VkcIKbcIV3YWt1MgM"}'
2026-02-10 04:48:08.300 INFO [src.node.waku_node] REST service is ready !!
2026-02-10 04:48:08.307 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-10 04:48:08.307 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-02-10_04-48-07__a3c5a1cc-0b8a-4b2f-aaf3-2f7b08c913ee__wakuorg_nwaku:latest.log
2026-02-10 04:48:08.307 DEBUG [src.node.waku_node] Starting Node...
2026-02-10 04:48:08.307 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-10 04:48:08.308 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-10 04:48:08.308 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.254.242
2026-02-10 04:48:08.309 DEBUG [src.node.docker_mananger] Generated ports ['50204', '50205', '50206', '50207', '50208']
2026-02-10 04:48:08.309 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-10 04:48:08.309 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-10 04:48:08.309 DEBUG [src.node.waku_node] Using volumes []
2026-02-10 04:48:08.310 DEBUG [src.node.docker_mananger] docker run -i -t -p 50204:50204 -p 50205:50205 -p 50206:50206 -p 50207:50207 -p 50208:50208 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=50206 --rest-port=50204 --tcp-port=50205 --discv5-udp-port=50207 --rest-address=0.0.0.0 --nat=extip:172.18.254.242 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f1e845bbb1248bbb65a8d66d8b8fbb2ed05bfb30ee110a8fa847dc654c66ea8f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=50208 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QA4X49Hz2jgK8JADsAFRix6s3VAR79RgXSkvBRFxeWx7EiiYJAnZIoD0YkoPpbEPLqqhxC8mNktIuTZuC0ISNZECgmlkgnY0gmlwhKwSTdaKbXVsdGlhZGRyc5YACASsEk3WBptuAAoErBJN1gabb90DgnJzhQADAQAAiXNlY3AyNTZrMaEDhrt6jnLBIy92neoZQkojFn4Zrha16Wiz9w_mvm0fEHWDdGNwgptug3VkcIKbcIV3YWt1MgM --storenode=/ip4/172.18.77.214/tcp/39790/p2p/16Uiu2HAmMivnjNDv7141jYSyFC1qi1PEbWbq4Ck8t88yUJunsc3v --store=false --relay=false
2026-02-10 04:48:08.499 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.254.242 waku 7f1a6d69aa8a3d694a437b7876bfdbe9f19f7e22ece39f11b82bd35ac1982227
2026-02-10 04:48:08.530 DEBUG [src.node.docker_mananger] Container started with ID 7f1a6d69aa8a. Setting up logs at ./log/docker/store_node1_2026-02-10_04-48-07__a3c5a1cc-0b8a-4b2f-aaf3-2f7b08c913ee__wakuorg_nwaku:latest.log
2026-02-10 04:48:08.530 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 50204
2026-02-10 04:48:08.530 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-10 04:48:09.531 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50204/health" -H "Content-Type: application/json" -d 'None'
2026-02-10 04:48:09.535 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-10 04:48:09.535 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-10 04:48:09.535 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50204/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-10 04:48:09.537 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.254.242/tcp/50205/p2p/16Uiu2HAm5nd62M3ysCySWBSYbnfSAiHuHTFYDA5pQe3pzEqM1Rjh","/ip4/172.18.254.242/tcp/50206/ws/p2p/16Uiu2HAm5nd62M3ysCySWBSYbnfSAiHuHTFYDA5pQe3pzEqM1Rjh"],"enrUri":"enr:-L24QDh_HuISy5yILdcUCmxnM9fp0-uGLmlCfox9rWibDp5zQq9hQhX-LG2Jhue4bnsGtLZRmUyfg8c_vktlLjT3SzwCgmlkgnY0gmlwhKwS_vKKbXVsdGlhZGRyc5YACASsEv7yBsQdAAoErBL-8gbEHt0DgnJzhQADAQAAiXNlY3AyNTZrMaECmfLLrNlvRoln2uqHo8K5PBW-XTDmW7qOBS2qkutiPwyDdGNwgsQdg3VkcILEH4V3YWt1MgA"}'
2026-02-10 04:48:09.537 INFO [src.node.waku_node] REST service is ready !!
2026-02-10 04:48:09.538 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50204/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.77.214/tcp/39790/p2p/16Uiu2HAmMivnjNDv7141jYSyFC1qi1PEbWbq4Ck8t88yUJunsc3v"]'
2026-02-10 04:48:09.568 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-10 04:48:09.569 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39789/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-10 04:48:09.581 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-10 04:48:09.582 DEBUG [src.steps.store] Relaying message
2026-02-10 04:48:09.583 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39789/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-10 04:48:09.588 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-10 04:48:09.589 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-10 04:48:09.790 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-10 04:48:09.790 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39789/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2026-02-10 04:48:09.793 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3ad4400c97a5f186d223ff4adc57c93794616fcb3ca4637f110b7eaeb628c174"}]}'
2026-02-10 04:48:09.794 DEBUG [src.steps.store] messages length is 1
2026-02-10 04:48:09.794 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-10 04:48:09.794 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50204/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2026-02-10 04:48:09.802 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"7baaf9b8c92762910d5a","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3ad4400c97a5f186d223ff4adc57c93794616fcb3ca4637f110b7eaeb628c174"}]}'
2026-02-10 04:48:09.802 DEBUG [src.steps.store] messages length is 1
2026-02-10 04:48:10.322 DEBUG [src.steps.store] Relaying message
2026-02-10 04:48:10.322 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39789/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-10 04:48:10.327 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-10 04:48:10.328 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-10 04:48:11.012 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50204/health" -H "Content-Type: application/json" -d 'None'
2026-02-10 04:48:11.116 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50204/health" -H "Content-Type: application/json" -d 'None'
2026-02-10 04:48:11.119 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-10 04:48:11.120 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-10 04:48:11.120 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50204/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-10 04:48:11.122 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.254.242/tcp/50205/p2p/16Uiu2HAm5nd62M3ysCySWBSYbnfSAiHuHTFYDA5pQe3pzEqM1Rjh","/ip4/172.18.254.242/tcp/50206/ws/p2p/16Uiu2HAm5nd62M3ysCySWBSYbnfSAiHuHTFYDA5pQe3pzEqM1Rjh"],"enrUri":"enr:-L24QDh_HuISy5yILdcUCmxnM9fp0-uGLmlCfox9rWibDp5zQq9hQhX-LG2Jhue4bnsGtLZRmUyfg8c_vktlLjT3SzwCgmlkgnY0gmlwhKwS_vKKbXVsdGlhZGRyc5YACASsEv7yBsQdAAoErBL-8gbEHt0DgnJzhQADAQAAiXNlY3AyNTZrMaECmfLLrNlvRoln2uqHo8K5PBW-XTDmW7qOBS2qkutiPwyDdGNwgsQdg3VkcILEH4V3YWt1MgA"}'
2026-02-10 04:48:11.122 INFO [src.node.waku_node] REST service is ready !!
2026-02-10 04:48:11.123 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39789/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-10 04:48:11.126 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3ad4400c97a5f186d223ff4adc57c93794616fcb3ca4637f110b7eaeb628c174"},{"messageHash":"0x7b70f2d21a8b0decce814d5987c6d88ffb316575be91daacfc3ddbcab1f8ccbe"}]}'
2026-02-10 04:48:11.126 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50204/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-10 04:48:11.163 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"9b022d0cb3b2a478ad85","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3ad4400c97a5f186d223ff4adc57c93794616fcb3ca4637f110b7eaeb628c174"},{"messageHash":"0x7b70f2d21a8b0decce814d5987c6d88ffb316575be91daacfc3ddbcab1f8ccbe"}]}'
2026-02-10 04:48:11.168 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-10 04:48:11.170 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-10 04:48:11.171 DEBUG [src.node.waku_node] Stopping container with id 4b64826cc2be
2026-02-10 04:48:11.724 DEBUG [src.node.waku_node] Container stopped.
2026-02-10 04:48:11.725 DEBUG [src.node.waku_node] Stopping container with id 7f1a6d69aa8a
2026-02-10 04:48:12.220 DEBUG [src.node.waku_node] Container stopped.
2026-02-10 04:48:12.222 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-10 04:48:12.231 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-10 04:48:12.309 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
