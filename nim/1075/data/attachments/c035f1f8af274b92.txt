2026-02-10 04:51:06.668 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-10 04:51:06.668 DEBUG [tests.conftest] Running test: test_cant_publish_on_not_subscribed_shard with id: 2026-02-10_04-51-06__732a4344-9363-4b39-a813-f82c83927821
2026-02-10 04:51:06.668 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-10 04:51:06.668 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-10 04:51:06.669 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-10 04:51:06.676 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-10 04:51:06.676 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-10_04-51-06__732a4344-9363-4b39-a813-f82c83927821__wakuorg_nwaku:latest.log
2026-02-10 04:51:06.677 DEBUG [src.node.waku_node] Starting Node...
2026-02-10 04:51:06.677 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-10 04:51:06.678 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-10 04:51:06.678 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.238.197
2026-02-10 04:51:06.679 DEBUG [src.node.docker_mananger] Generated ports ['33015', '33016', '33017', '33018', '33019']
2026-02-10 04:51:06.679 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-10 04:51:06.679 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-10 04:51:06.679 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-10 04:51:06.679 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-10 04:51:06.679 DEBUG [src.node.waku_node] Using volumes []
2026-02-10 04:51:06.679 DEBUG [src.node.docker_mananger] docker run -i -t -p 33015:33015 -p 33016:33016 -p 33017:33017 -p 33018:33018 -p 33019:33019 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33017 --rest-port=33015 --tcp-port=33016 --discv5-udp-port=33018 --rest-address=0.0.0.0 --nat=extip:172.18.238.197 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=2bb9efb3cb1d07cdccd2ecb8929ab8aec7e1ccce71baa3037d95f4e05dc48d54 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33019 --metrics-logging=true --relay=true --filter=true
2026-02-10 04:51:06.861 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.238.197 waku db7a553547e87a746ab891d75cf679867684008ce516e2387c1ba387938dc3e4
2026-02-10 04:51:06.893 DEBUG [src.node.docker_mananger] Container started with ID db7a553547e8. Setting up logs at ./log/docker/node1_2026-02-10_04-51-06__732a4344-9363-4b39-a813-f82c83927821__wakuorg_nwaku:latest.log
2026-02-10 04:51:06.893 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 33015
2026-02-10 04:51:06.893 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-10 04:51:06.925 ERROR [src.node.docker_mananger] Max retries reached for container 104b50bd715c. Exiting log stream.
2026-02-10 04:51:07.443 ERROR [src.node.docker_mananger] Max retries reached for container 03cefb00fa99. Exiting log stream.
2026-02-10 04:51:07.895 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33015/health" -H "Content-Type: application/json" -d 'None'
2026-02-10 04:51:07.898 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-10 04:51:07.898 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-10 04:51:07.898 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33015/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-10 04:51:07.901 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.238.197/tcp/33016/p2p/16Uiu2HAm3yvXwyEDNirY8D2vbKrv4qVyFSzZu75RxvK8AVwGzRR4","/ip4/172.18.238.197/tcp/33017/ws/p2p/16Uiu2HAm3yvXwyEDNirY8D2vbKrv4qVyFSzZu75RxvK8AVwGzRR4"],"enrUri":"enr:-L24QCoscaPqzwKADj48bmfanGdCWW_LFB50hW2O9XgOPqeEH7AKFh62l1LpawYDTvVshJTjqbZgE7aK0dpNbHduCzECgmlkgnY0gmlwhKwS7sWKbXVsdGlhZGRyc5YACASsEu7FBoD4AAoErBLuxQaA-d0DgnJzhQACAQAAiXNlY3AyNTZrMaECfyCJuxOS8yXm303O1ivhUsolCWJmixRkobrKvmgHm-uDdGNwgoD4g3VkcIKA-oV3YWt1MgU"}'
2026-02-10 04:51:07.901 INFO [src.node.waku_node] REST service is ready !!
2026-02-10 04:51:07.908 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-10 04:51:07.908 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-10_04-51-06__732a4344-9363-4b39-a813-f82c83927821__wakuorg_nwaku:latest.log
2026-02-10 04:51:07.908 DEBUG [src.node.waku_node] Starting Node...
2026-02-10 04:51:07.908 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-10 04:51:07.910 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-10 04:51:07.910 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.100.142
2026-02-10 04:51:07.910 DEBUG [src.node.docker_mananger] Generated ports ['3159', '3160', '3161', '3162', '3163']
2026-02-10 04:51:07.910 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-10 04:51:07.910 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-10 04:51:07.910 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-10 04:51:07.910 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-10 04:51:07.910 DEBUG [src.node.waku_node] Using volumes []
2026-02-10 04:51:07.911 DEBUG [src.node.docker_mananger] docker run -i -t -p 3159:3159 -p 3160:3160 -p 3161:3161 -p 3162:3162 -p 3163:3163 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3161 --rest-port=3159 --tcp-port=3160 --discv5-udp-port=3162 --rest-address=0.0.0.0 --nat=extip:172.18.100.142 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=4eaf1a78aa0c5e5bdca5226a49c6afe9cad47cf4cacccfd59023bdeb947fe7aa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3163 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QCoscaPqzwKADj48bmfanGdCWW_LFB50hW2O9XgOPqeEH7AKFh62l1LpawYDTvVshJTjqbZgE7aK0dpNbHduCzECgmlkgnY0gmlwhKwS7sWKbXVsdGlhZGRyc5YACASsEu7FBoD4AAoErBLuxQaA-d0DgnJzhQACAQAAiXNlY3AyNTZrMaECfyCJuxOS8yXm303O1ivhUsolCWJmixRkobrKvmgHm-uDdGNwgoD4g3VkcIKA-oV3YWt1MgU
2026-02-10 04:51:08.100 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.100.142 waku fdbc11a6bda1a4e9384f3ff54955370fb50cea575bb50c1af24fbae9e922d206
2026-02-10 04:51:08.132 DEBUG [src.node.docker_mananger] Container started with ID fdbc11a6bda1. Setting up logs at ./log/docker/node2_2026-02-10_04-51-06__732a4344-9363-4b39-a813-f82c83927821__wakuorg_nwaku:latest.log
2026-02-10 04:51:08.132 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 3159
2026-02-10 04:51:08.132 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-10 04:51:09.133 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3159/health" -H "Content-Type: application/json" -d 'None'
2026-02-10 04:51:09.143 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-10 04:51:09.145 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-10 04:51:09.146 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3159/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-10 04:51:09.153 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.100.142/tcp/3160/p2p/16Uiu2HAmSw5uPd9JcsV2AA8rtEoP2pzkWMCauDyWdhquGqxLJoZL","/ip4/172.18.100.142/tcp/3161/ws/p2p/16Uiu2HAmSw5uPd9JcsV2AA8rtEoP2pzkWMCauDyWdhquGqxLJoZL"],"enrUri":"enr:-L24QAEhfbixFmZ8PivJj1IX6w9FAWU53xZ3V-saBUzuqTxfMh6jxPpSJa1ttK4H6DOopWQGch3iKAXV-WOQB5uBqUoCgmlkgnY0gmlwhKwSZI6KbXVsdGlhZGRyc5YACASsEmSOBgxYAAoErBJkjgYMWd0DgnJzhQACAQAAiXNlY3AyNTZrMaED1CMwcd6cnKodAxVvmaD269FuqG1WnbnnuvtyFLeOK4ODdGNwggxYg3VkcIIMWoV3YWt1MgE"}'
2026-02-10 04:51:09.153 INFO [src.node.waku_node] REST service is ready !!
2026-02-10 04:51:09.153 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3159/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.238.197/tcp/33016/p2p/16Uiu2HAm3yvXwyEDNirY8D2vbKrv4qVyFSzZu75RxvK8AVwGzRR4"]'
2026-02-10 04:51:09.156 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-10 04:51:09.156 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33015/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2026-02-10 04:51:09.159 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-10 04:51:09.159 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3159/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2026-02-10 04:51:09.161 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-10 04:51:09.162 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33015/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-10 04:51:09.164 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:33015/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1. Response content: b'Failed to publish: Node not subscribed to topic: /waku/2/rs/2/1'
2026-02-10 04:51:09.167 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-10 04:51:09.168 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-10 04:51:09.168 DEBUG [src.node.waku_node] Stopping container with id db7a553547e8
2026-02-10 04:51:09.721 DEBUG [src.node.waku_node] Container stopped.
2026-02-10 04:51:09.722 DEBUG [src.node.waku_node] Stopping container with id fdbc11a6bda1
2026-02-10 04:51:10.231 DEBUG [src.node.waku_node] Container stopped.
2026-02-10 04:51:10.233 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-10 04:51:10.242 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-10 04:51:10.246 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
