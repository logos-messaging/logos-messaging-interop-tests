2026-02-07 04:32:14.167 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-07 04:32:14.168 DEBUG [tests.conftest] Running test: test_filter_works_with_static_sharding with id: 2026-02-07_04-32-14__055aefe1-99c2-4e46-849b-ff150c040145
2026-02-07 04:32:14.168 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-07 04:32:14.168 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-07 04:32:14.169 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-07 04:32:14.176 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-07 04:32:14.176 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-07_04-32-14__055aefe1-99c2-4e46-849b-ff150c040145__wakuorg_nwaku:latest.log
2026-02-07 04:32:14.176 DEBUG [src.node.waku_node] Starting Node...
2026-02-07 04:32:14.176 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-07 04:32:14.178 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-07 04:32:14.178 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.99.101
2026-02-07 04:32:14.178 DEBUG [src.node.docker_mananger] Generated ports ['25462', '25463', '25464', '25465', '25466']
2026-02-07 04:32:14.178 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-07 04:32:14.178 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-07 04:32:14.178 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-07 04:32:14.179 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-07 04:32:14.179 DEBUG [src.node.waku_node] Using volumes []
2026-02-07 04:32:14.179 DEBUG [src.node.docker_mananger] docker run -i -t -p 25462:25462 -p 25463:25463 -p 25464:25464 -p 25465:25465 -p 25466:25466 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=25464 --rest-port=25462 --tcp-port=25463 --discv5-udp-port=25465 --rest-address=0.0.0.0 --nat=extip:172.18.99.101 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=d6de7d6c57d359e2d92df0f8ce6c82e2e244865aaa362d0addfef8aad48b6218 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=25466 --metrics-logging=true --relay=true --filter=true
2026-02-07 04:32:14.366 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.99.101 waku a03fe77484048a118be3e71bf0dc87c72c21850d98caa54002c5c87aa946bdad
2026-02-07 04:32:14.396 DEBUG [src.node.docker_mananger] Container started with ID a03fe7748404. Setting up logs at ./log/docker/node1_2026-02-07_04-32-14__055aefe1-99c2-4e46-849b-ff150c040145__wakuorg_nwaku:latest.log
2026-02-07 04:32:14.396 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 25462
2026-02-07 04:32:14.397 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-07 04:32:14.443 ERROR [src.node.docker_mananger] Max retries reached for container 2ad15e5fb0a8. Exiting log stream.
2026-02-07 04:32:14.968 ERROR [src.node.docker_mananger] Max retries reached for container 256f03668028. Exiting log stream.
2026-02-07 04:32:15.397 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25462/health" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:32:15.400 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-07 04:32:15.401 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-07 04:32:15.401 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25462/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:32:15.403 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.99.101/tcp/25463/p2p/16Uiu2HAm8eYrqrtrTBdybCKFfRcKGikgShQAL82Tt8WwPtZbMoTk","/ip4/172.18.99.101/tcp/25464/ws/p2p/16Uiu2HAm8eYrqrtrTBdybCKFfRcKGikgShQAL82Tt8WwPtZbMoTk"],"enrUri":"enr:-L24QKFA-p9mC7TgPU5d9N5wE16rMRbwOf9-F6z-ZALWwhLGH7ObfN7bj4f3l8IojkhSYB8fNYzfP3JwE3dfza2F-ZICgmlkgnY0gmlwhKwSY2WKbXVsdGlhZGRyc5YACASsEmNlBmN3AAoErBJjZQZjeN0DgnJzhQACAQAAiXNlY3AyNTZrMaECxHRuHa01eudUNL9TZokqdcnBnj5Np-UC700NC4RBn4eDdGNwgmN3g3VkcIJjeYV3YWt1MgU"}'
2026-02-07 04:32:15.403 INFO [src.node.waku_node] REST service is ready !!
2026-02-07 04:32:15.410 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-07 04:32:15.410 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-07_04-32-14__055aefe1-99c2-4e46-849b-ff150c040145__wakuorg_nwaku:latest.log
2026-02-07 04:32:15.410 DEBUG [src.node.waku_node] Starting Node...
2026-02-07 04:32:15.410 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-07 04:32:15.411 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-07 04:32:15.411 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.188.250
2026-02-07 04:32:15.412 DEBUG [src.node.docker_mananger] Generated ports ['39163', '39164', '39165', '39166', '39167']
2026-02-07 04:32:15.412 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-07 04:32:15.412 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-07 04:32:15.412 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-07 04:32:15.412 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-07 04:32:15.412 DEBUG [src.node.waku_node] Using volumes []
2026-02-07 04:32:15.412 DEBUG [src.node.docker_mananger] docker run -i -t -p 39163:39163 -p 39164:39164 -p 39165:39165 -p 39166:39166 -p 39167:39167 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39165 --rest-port=39163 --tcp-port=39164 --discv5-udp-port=39166 --rest-address=0.0.0.0 --nat=extip:172.18.188.250 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=dc50abbedb0cdbc7e03c5d278f040a2a9902ea40f5b3bd340d8fd9c80587ab4b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39167 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QKFA-p9mC7TgPU5d9N5wE16rMRbwOf9-F6z-ZALWwhLGH7ObfN7bj4f3l8IojkhSYB8fNYzfP3JwE3dfza2F-ZICgmlkgnY0gmlwhKwSY2WKbXVsdGlhZGRyc5YACASsEmNlBmN3AAoErBJjZQZjeN0DgnJzhQACAQAAiXNlY3AyNTZrMaECxHRuHa01eudUNL9TZokqdcnBnj5Np-UC700NC4RBn4eDdGNwgmN3g3VkcIJjeYV3YWt1MgU --filternode=/ip4/172.18.99.101/tcp/25463/p2p/16Uiu2HAm8eYrqrtrTBdybCKFfRcKGikgShQAL82Tt8WwPtZbMoTk
2026-02-07 04:32:15.610 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.188.250 waku 3d92f49aa4d26b655997372d4f86accd739c02c46bbce554f72f66d2c76701ee
2026-02-07 04:32:15.639 DEBUG [src.node.docker_mananger] Container started with ID 3d92f49aa4d2. Setting up logs at ./log/docker/node2_2026-02-07_04-32-14__055aefe1-99c2-4e46-849b-ff150c040145__wakuorg_nwaku:latest.log
2026-02-07 04:32:15.640 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 39163
2026-02-07 04:32:15.640 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-07 04:32:16.640 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39163/health" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:32:16.644 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-07 04:32:16.645 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-07 04:32:16.645 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39163/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:32:16.647 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.188.250/tcp/39164/p2p/16Uiu2HAmHPyw15bnbPRZJ2kTCY6yqG7tEWe2ew4HJpFpb2XrrGSq","/ip4/172.18.188.250/tcp/39165/ws/p2p/16Uiu2HAmHPyw15bnbPRZJ2kTCY6yqG7tEWe2ew4HJpFpb2XrrGSq"],"enrUri":"enr:-L24QP78GcgIgBE1ZlJL6jFDJlO2CplUw-FD0MDmVfJ6LHnWfp4AYEsnFuyuL0V6I5ijW8Ratsklpq3cGKH_EnLagdYCgmlkgnY0gmlwhKwSvPqKbXVsdGlhZGRyc5YACASsErz6Bpj8AAoErBK8-gaY_d0DgnJzhQACAQAAiXNlY3AyNTZrMaEDRnI_vxppudHfzSdFLd0_595y-hI4dOVw7E5BMUe6v66DdGNwgpj8g3VkcIKY_oV3YWt1MgA"}'
2026-02-07 04:32:16.647 INFO [src.node.waku_node] REST service is ready !!
2026-02-07 04:32:16.648 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39163/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.99.101/tcp/25463/p2p/16Uiu2HAm8eYrqrtrTBdybCKFfRcKGikgShQAL82Tt8WwPtZbMoTk"]'
2026-02-07 04:32:16.681 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-07 04:32:16.682 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25462/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2026-02-07 04:32:16.692 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-07 04:32:16.692 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39163/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "c3d2ba8c-5c21-445b-aa33-050bd46132f9", "contentFilters": ["/myapp/1/latest/proto"], "pubsubTopic": "/waku/2/rs/2/0"}'
2026-02-07 04:32:16.703 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"c3d2ba8c-5c21-445b-aa33-050bd46132f9","statusDesc":"OK"}'
2026-02-07 04:32:16.704 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25462/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-07 04:32:16.710 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-07 04:32:16.711 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-07 04:32:16.811 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-07 04:32:16.811 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39163/filter/v2/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:32:16.814 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770438736703905928,"ephemeral":false}]'
2026-02-07 04:32:16.817 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-07 04:32:16.818 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-07 04:32:16.818 DEBUG [src.node.waku_node] Stopping container with id a03fe7748404
2026-02-07 04:32:17.364 DEBUG [src.node.waku_node] Container stopped.
2026-02-07 04:32:17.365 DEBUG [src.node.waku_node] Stopping container with id 3d92f49aa4d2
2026-02-07 04:32:17.907 DEBUG [src.node.waku_node] Container stopped.
2026-02-07 04:32:17.910 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-07 04:32:17.916 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-07 04:32:17.922 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
