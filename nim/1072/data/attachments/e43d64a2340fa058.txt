2026-02-07 04:35:39.941 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-07 04:35:39.941 DEBUG [tests.conftest] Running test: test_single_pubsub_topic[/waku/2/rs/2/0] with id: 2026-02-07_04-35-39__42e66417-0b31-40b9-afe5-b5f856d90b7c
2026-02-07 04:35:39.942 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-07 04:35:39.942 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-07 04:35:39.942 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-07 04:35:39.950 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-07 04:35:39.950 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-07_04-35-39__42e66417-0b31-40b9-afe5-b5f856d90b7c__wakuorg_nwaku:latest.log
2026-02-07 04:35:39.950 DEBUG [src.node.waku_node] Starting Node...
2026-02-07 04:35:39.950 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-07 04:35:39.952 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-07 04:35:39.952 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.26.28
2026-02-07 04:35:39.952 DEBUG [src.node.docker_mananger] Generated ports ['42403', '42404', '42405', '42406', '42407']
2026-02-07 04:35:39.952 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-07 04:35:39.952 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-07 04:35:39.952 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-07 04:35:39.953 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-07 04:35:39.953 DEBUG [src.node.waku_node] Using volumes []
2026-02-07 04:35:39.953 DEBUG [src.node.docker_mananger] docker run -i -t -p 42403:42403 -p 42404:42404 -p 42405:42405 -p 42406:42406 -p 42407:42407 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42405 --rest-port=42403 --tcp-port=42404 --discv5-udp-port=42406 --rest-address=0.0.0.0 --nat=extip:172.18.26.28 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=f02bcecd6c978c62dbf89239b811db76c0dc161c73a27b7fd8dd7955deffdb70 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42407 --metrics-logging=true --relay=true --filter=true
2026-02-07 04:35:40.144 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.26.28 waku a89b644a36808e55e1238a31a3434c3a8f6c77b8514e9a1d0d37e5f51bb1e4cf
2026-02-07 04:35:40.174 DEBUG [src.node.docker_mananger] Container started with ID a89b644a3680. Setting up logs at ./log/docker/node1_2026-02-07_04-35-39__42e66417-0b31-40b9-afe5-b5f856d90b7c__wakuorg_nwaku:latest.log
2026-02-07 04:35:40.176 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 42403
2026-02-07 04:35:40.176 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-07 04:35:40.200 ERROR [src.node.docker_mananger] Max retries reached for container 9c8b878efd6d. Exiting log stream.
2026-02-07 04:35:40.748 ERROR [src.node.docker_mananger] Max retries reached for container 0fa6afbfbe23. Exiting log stream.
2026-02-07 04:35:41.176 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42403/health" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:35:41.180 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-07 04:35:41.180 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-07 04:35:41.180 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42403/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:35:41.183 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.26.28/tcp/42404/p2p/16Uiu2HAmREbU85zdpwFtVQZUMcRJfMzoEtwZNYU1bY3c7Ts6PoeX","/ip4/172.18.26.28/tcp/42405/ws/p2p/16Uiu2HAmREbU85zdpwFtVQZUMcRJfMzoEtwZNYU1bY3c7Ts6PoeX"],"enrUri":"enr:-L24QIm9tC0skgIxdEdGswAJWG2poGq0gyD8uWg4CHlu7wO4TqG5wdvM8Rh4PKEwbvCKwsP5xCzjmbJgO56WT4oYFtICgmlkgnY0gmlwhKwSGhyKbXVsdGlhZGRyc5YACASsEhocBqWkAAoErBIaHAalpd0DgnJzhQACAQAAiXNlY3AyNTZrMaEDuugeHnx95B4NRmmiQ2I_tAdvJXRzKk6mtG5fPhq-43iDdGNwgqWkg3VkcIKlpoV3YWt1MgU"}'
2026-02-07 04:35:41.183 INFO [src.node.waku_node] REST service is ready !!
2026-02-07 04:35:41.190 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-07 04:35:41.190 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-07_04-35-39__42e66417-0b31-40b9-afe5-b5f856d90b7c__wakuorg_nwaku:latest.log
2026-02-07 04:35:41.190 DEBUG [src.node.waku_node] Starting Node...
2026-02-07 04:35:41.190 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-07 04:35:41.192 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-07 04:35:41.192 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.158.40
2026-02-07 04:35:41.192 DEBUG [src.node.docker_mananger] Generated ports ['24327', '24328', '24329', '24330', '24331']
2026-02-07 04:35:41.192 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-07 04:35:41.192 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-07 04:35:41.192 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-07 04:35:41.192 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-07 04:35:41.192 DEBUG [src.node.waku_node] Using volumes []
2026-02-07 04:35:41.193 DEBUG [src.node.docker_mananger] docker run -i -t -p 24327:24327 -p 24328:24328 -p 24329:24329 -p 24330:24330 -p 24331:24331 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24329 --rest-port=24327 --tcp-port=24328 --discv5-udp-port=24330 --rest-address=0.0.0.0 --nat=extip:172.18.158.40 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=a78a4921fef8bde8a5441bcdd9b1c1f65cfed75e7557dcdb4284ae2fe0e3826b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24331 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QIm9tC0skgIxdEdGswAJWG2poGq0gyD8uWg4CHlu7wO4TqG5wdvM8Rh4PKEwbvCKwsP5xCzjmbJgO56WT4oYFtICgmlkgnY0gmlwhKwSGhyKbXVsdGlhZGRyc5YACASsEhocBqWkAAoErBIaHAalpd0DgnJzhQACAQAAiXNlY3AyNTZrMaEDuugeHnx95B4NRmmiQ2I_tAdvJXRzKk6mtG5fPhq-43iDdGNwgqWkg3VkcIKlpoV3YWt1MgU
2026-02-07 04:35:41.389 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.158.40 waku b18dd62ba70fe85b64ffc93d91c96216b315a5892c95765c8ad90699735b3eaf
2026-02-07 04:35:41.425 DEBUG [src.node.docker_mananger] Container started with ID b18dd62ba70f. Setting up logs at ./log/docker/node2_2026-02-07_04-35-39__42e66417-0b31-40b9-afe5-b5f856d90b7c__wakuorg_nwaku:latest.log
2026-02-07 04:35:41.426 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 24327
2026-02-07 04:35:41.426 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-07 04:35:42.426 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24327/health" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:35:42.435 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-07 04:35:42.436 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-07 04:35:42.436 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24327/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:35:42.441 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.158.40/tcp/24328/p2p/16Uiu2HAmAEW25KxSm7wGkp7CyffU127NgxKS6kURnfg2KhRRnjvj","/ip4/172.18.158.40/tcp/24329/ws/p2p/16Uiu2HAmAEW25KxSm7wGkp7CyffU127NgxKS6kURnfg2KhRRnjvj"],"enrUri":"enr:-L24QKcXOHOytYlbB7ha8hc8wtZSLwYNWcAb1udGi-sLoTv5bAwalTwmkIJI7w2FmR7qncqUByqBdIwOsEIyAn986nsCgmlkgnY0gmlwhKwSniiKbXVsdGlhZGRyc5YACASsEp4oBl8IAAoErBKeKAZfCd0DgnJzhQACAQAAiXNlY3AyNTZrMaEC3AKnBp9PLwOE83Zbh9s60budOMpJpjTZkVEf5K1gm5yDdGNwgl8Ig3VkcIJfCoV3YWt1MgE"}'
2026-02-07 04:35:42.441 INFO [src.node.waku_node] REST service is ready !!
2026-02-07 04:35:42.441 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24327/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.26.28/tcp/42404/p2p/16Uiu2HAmREbU85zdpwFtVQZUMcRJfMzoEtwZNYU1bY3c7Ts6PoeX"]'
2026-02-07 04:35:42.444 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-07 04:35:42.444 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42403/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2026-02-07 04:35:42.447 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-07 04:35:42.447 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24327/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2026-02-07 04:35:42.449 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-07 04:35:42.450 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42403/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-07 04:35:42.454 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-07 04:35:42.455 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-07 04:35:42.555 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-07 04:35:42.555 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42403/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:35:42.558 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770438942450209645,"ephemeral":false,"proof":""}]'
2026-02-07 04:35:42.561 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-07 04:35:42.561 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24327/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:35:42.563 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770438942450209645,"ephemeral":false,"proof":""}]'
2026-02-07 04:35:42.566 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-07 04:35:42.567 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-07 04:35:42.567 DEBUG [src.node.waku_node] Stopping container with id a89b644a3680
2026-02-07 04:35:43.144 DEBUG [src.node.waku_node] Container stopped.
2026-02-07 04:35:43.145 DEBUG [src.node.waku_node] Stopping container with id b18dd62ba70f
2026-02-07 04:35:43.717 DEBUG [src.node.waku_node] Container stopped.
2026-02-07 04:35:43.718 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-07 04:35:43.723 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-07 04:35:43.728 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
