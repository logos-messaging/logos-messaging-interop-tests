2026-02-07 04:32:58.190 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-07 04:32:58.191 DEBUG [tests.conftest] Running test: test_retrieve_messages_without_subscribing_via_api with id: 2026-02-07_04-32-58__8c866a29-6381-4a7b-91ff-885bdfe6f326
2026-02-07 04:32:58.191 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-07 04:32:58.191 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-07 04:32:58.191 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-07 04:32:58.199 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-07 04:32:58.199 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-07_04-32-58__8c866a29-6381-4a7b-91ff-885bdfe6f326__wakuorg_nwaku:latest.log
2026-02-07 04:32:58.199 DEBUG [src.node.waku_node] Starting Node...
2026-02-07 04:32:58.200 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-07 04:32:58.201 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-07 04:32:58.201 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.9.129
2026-02-07 04:32:58.202 DEBUG [src.node.docker_mananger] Generated ports ['6875', '6876', '6877', '6878', '6879']
2026-02-07 04:32:58.202 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-07 04:32:58.202 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-07 04:32:58.202 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-07 04:32:58.202 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-07 04:32:58.202 DEBUG [src.node.waku_node] Using volumes []
2026-02-07 04:32:58.202 DEBUG [src.node.docker_mananger] docker run -i -t -p 6875:6875 -p 6876:6876 -p 6877:6877 -p 6878:6878 -p 6879:6879 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=6877 --rest-port=6875 --tcp-port=6876 --discv5-udp-port=6878 --rest-address=0.0.0.0 --nat=extip:172.18.9.129 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=e8968dba9de8cf45fe9af5fe27fd59ac76accaaa5f72a4af6209ecbd3ea29ba9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=6879 --metrics-logging=true --relay=true --filter=true
2026-02-07 04:32:58.383 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.9.129 waku 2d004d215358f72a9e50c4b46b7d299df2a4b45f28434d073362a9fc7717381a
2026-02-07 04:32:58.415 DEBUG [src.node.docker_mananger] Container started with ID 2d004d215358. Setting up logs at ./log/docker/node1_2026-02-07_04-32-58__8c866a29-6381-4a7b-91ff-885bdfe6f326__wakuorg_nwaku:latest.log
2026-02-07 04:32:58.416 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 6875
2026-02-07 04:32:58.416 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-07 04:32:58.457 ERROR [src.node.docker_mananger] Max retries reached for container da8b0e28916b. Exiting log stream.
2026-02-07 04:32:58.995 ERROR [src.node.docker_mananger] Max retries reached for container 36e40af4b5ac. Exiting log stream.
2026-02-07 04:32:59.416 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6875/health" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:32:59.419 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-07 04:32:59.420 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-07 04:32:59.420 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6875/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:32:59.422 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.9.129/tcp/6876/p2p/16Uiu2HAmMj8XWAeEXgz7gQxdNFcYKhUVhmfD78N2irKKzKqHAEFz","/ip4/172.18.9.129/tcp/6877/ws/p2p/16Uiu2HAmMj8XWAeEXgz7gQxdNFcYKhUVhmfD78N2irKKzKqHAEFz"],"enrUri":"enr:-L24QLE7j6gXCE7ioPiT5rv6erY68zTFqvP20_uxLakIq9u_WoJnJs7-2DqYSJevn5H0JI0ZlT6seeerM01HhRRoFRwCgmlkgnY0gmlwhKwSCYGKbXVsdGlhZGRyc5YACASsEgmBBhrcAAoErBIJgQYa3d0DgnJzhQACAQAAiXNlY3AyNTZrMaEDhsjAFO2tbcOI3-9810iGw-YHYk_Oz0gj8qSNmTcQoaGDdGNwghrcg3VkcIIa3oV3YWt1MgU"}'
2026-02-07 04:32:59.422 INFO [src.node.waku_node] REST service is ready !!
2026-02-07 04:32:59.429 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-07 04:32:59.429 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-07_04-32-58__8c866a29-6381-4a7b-91ff-885bdfe6f326__wakuorg_nwaku:latest.log
2026-02-07 04:32:59.429 DEBUG [src.node.waku_node] Starting Node...
2026-02-07 04:32:59.429 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-07 04:32:59.430 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-07 04:32:59.430 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.7.147
2026-02-07 04:32:59.431 DEBUG [src.node.docker_mananger] Generated ports ['47056', '47057', '47058', '47059', '47060']
2026-02-07 04:32:59.431 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-07 04:32:59.431 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-07 04:32:59.431 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-07 04:32:59.431 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-07 04:32:59.431 DEBUG [src.node.waku_node] Using volumes []
2026-02-07 04:32:59.431 DEBUG [src.node.docker_mananger] docker run -i -t -p 47056:47056 -p 47057:47057 -p 47058:47058 -p 47059:47059 -p 47060:47060 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47058 --rest-port=47056 --tcp-port=47057 --discv5-udp-port=47059 --rest-address=0.0.0.0 --nat=extip:172.18.7.147 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=c6b99cf6eb6fb9b2a04bfa26fb511c9ead5bbed734ef2cb9e8837f83b15a40de --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47060 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QLE7j6gXCE7ioPiT5rv6erY68zTFqvP20_uxLakIq9u_WoJnJs7-2DqYSJevn5H0JI0ZlT6seeerM01HhRRoFRwCgmlkgnY0gmlwhKwSCYGKbXVsdGlhZGRyc5YACASsEgmBBhrcAAoErBIJgQYa3d0DgnJzhQACAQAAiXNlY3AyNTZrMaEDhsjAFO2tbcOI3-9810iGw-YHYk_Oz0gj8qSNmTcQoaGDdGNwghrcg3VkcIIa3oV3YWt1MgU
2026-02-07 04:32:59.616 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.7.147 waku 7bbece8cbf67df49045c6f4226d580351d20acf7eb617d05dbbefaea39de4555
2026-02-07 04:32:59.651 DEBUG [src.node.docker_mananger] Container started with ID 7bbece8cbf67. Setting up logs at ./log/docker/node2_2026-02-07_04-32-58__8c866a29-6381-4a7b-91ff-885bdfe6f326__wakuorg_nwaku:latest.log
2026-02-07 04:32:59.652 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 47056
2026-02-07 04:32:59.653 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-07 04:33:00.653 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47056/health" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:33:00.663 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-07 04:33:00.664 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-07 04:33:00.664 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47056/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:33:00.667 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.7.147/tcp/47057/p2p/16Uiu2HAm9AS1GBnVm8RUdhppgSPSTFuuRQ9eysoSeVmSMw58rXuE","/ip4/172.18.7.147/tcp/47058/ws/p2p/16Uiu2HAm9AS1GBnVm8RUdhppgSPSTFuuRQ9eysoSeVmSMw58rXuE"],"enrUri":"enr:-L24QMG47En0tg-Oos_oCSyCBpxmSuGFV9xfZtecPhRgTiDMJ1q7pPTxmSpy4rD8_YhiFggbQd3mfM_Vyypsvj-CS6cCgmlkgnY0gmlwhKwSB5OKbXVsdGlhZGRyc5YACASsEgeTBrfRAAoErBIHkwa30t0DgnJzhQACAQAAiXNlY3AyNTZrMaECzBwahwXn2-CN8APwZGjOBxZwhN2xYU91fR3r44JIpiWDdGNwgrfRg3VkcIK304V3YWt1MgE"}'
2026-02-07 04:33:00.668 INFO [src.node.waku_node] REST service is ready !!
2026-02-07 04:33:00.668 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47056/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.9.129/tcp/6876/p2p/16Uiu2HAmMj8XWAeEXgz7gQxdNFcYKhUVhmfD78N2irKKzKqHAEFz"]'
2026-02-07 04:33:00.670 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-07 04:33:00.671 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6875/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-07 04:33:00.675 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-07 04:33:00.676 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-07 04:33:00.777 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-07 04:33:00.777 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6875/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:33:00.780 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770438780671280030,"ephemeral":false,"proof":""}]'
2026-02-07 04:33:00.782 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-07 04:33:00.782 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47056/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-07 04:33:00.784 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770438780671280030,"ephemeral":false,"proof":""}]'
2026-02-07 04:33:00.787 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-07 04:33:00.788 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-07 04:33:00.788 DEBUG [src.node.waku_node] Stopping container with id 2d004d215358
2026-02-07 04:33:01.338 DEBUG [src.node.waku_node] Container stopped.
2026-02-07 04:33:01.340 DEBUG [src.node.waku_node] Stopping container with id 7bbece8cbf67
2026-02-07 04:33:01.885 DEBUG [src.node.waku_node] Container stopped.
2026-02-07 04:33:01.888 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-07 04:33:01.892 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-07 04:33:01.897 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
