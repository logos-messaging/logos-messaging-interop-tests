2026-01-29 04:31:40.944 DEBUG [tests.conftest] Running fixture setup: test_id
2026-01-29 04:31:40.944 DEBUG [tests.conftest] Running test: test_filter_resubscribe_to_unsubscribed_topics with id: 2026-01-29_04-31-40__ae63d214-9703-49da-9780-3045147e4c7f
2026-01-29 04:31:40.944 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-01-29 04:31:40.945 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2026-01-29 04:31:40.945 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2026-01-29 04:31:40.952 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-29 04:31:40.952 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-01-29_04-31-40__ae63d214-9703-49da-9780-3045147e4c7f__wakuorg_nwaku:latest.log
2026-01-29 04:31:40.952 DEBUG [src.node.waku_node] Starting Node...
2026-01-29 04:31:40.952 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-29 04:31:40.954 DEBUG [src.node.docker_mananger] Network waku already exists
2026-01-29 04:31:40.954 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.231.157
2026-01-29 04:31:40.954 DEBUG [src.node.docker_mananger] Generated ports ['44472', '44473', '44474', '44475', '44476']
2026-01-29 04:31:40.954 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-29 04:31:40.954 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-29 04:31:40.954 DEBUG [src.node.waku_node] Using volumes []
2026-01-29 04:31:40.955 DEBUG [src.node.docker_mananger] docker run -i -t -p 44472:44472 -p 44473:44473 -p 44474:44474 -p 44475:44475 -p 44476:44476 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44474 --rest-port=44472 --tcp-port=44473 --discv5-udp-port=44475 --rest-address=0.0.0.0 --nat=extip:172.18.231.157 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f4c42f5c03d7bfe496627f369dd2ecce0b4c135daba86bc0fafe51dbbd41bc3f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44476 --metrics-logging=true --relay=true --filter=true
2026-01-29 04:31:41.143 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.231.157 waku 353e1c243be98524c67dc304643193a44e17f5271f06673fdb896605977330ff
2026-01-29 04:31:41.173 DEBUG [src.node.docker_mananger] Container started with ID 353e1c243be9. Setting up logs at ./log/docker/node1_2026-01-29_04-31-40__ae63d214-9703-49da-9780-3045147e4c7f__wakuorg_nwaku:latest.log
2026-01-29 04:31:41.175 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 44472
2026-01-29 04:31:41.175 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-29 04:31:41.219 ERROR [src.node.docker_mananger] Max retries reached for container b01bc25000bf. Exiting log stream.
2026-01-29 04:31:41.741 ERROR [src.node.docker_mananger] Max retries reached for container fd87945ebcd0. Exiting log stream.
2026-01-29 04:31:42.175 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44472/health" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:31:42.179 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-01-29 04:31:42.179 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-29 04:31:42.179 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44472/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:31:42.181 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.231.157/tcp/44473/p2p/16Uiu2HAmRh2HWerc9XUi7J8QrQydJoLQJc2L5Cooa952zMByZdhR","/ip4/172.18.231.157/tcp/44474/ws/p2p/16Uiu2HAmRh2HWerc9XUi7J8QrQydJoLQJc2L5Cooa952zMByZdhR"],"enrUri":"enr:-L24QGqa-EdJB-U2nTrQOmYLKkgPM97PpKVXZJmPylWm_O9jP0feqiRE29OC0KcMot5Xon7iFYrR6lZBPxbu2n4ElNoCgmlkgnY0gmlwhKwS552KbXVsdGlhZGRyc5YACASsEuedBq25AAoErBLnnQatut0DgnJzhQADAQAAiXNlY3AyNTZrMaEDwa1HiBH9aoMN5qyN2r-VVOunAs8sy7WzMsUxyfnpP3iDdGNwgq25g3VkcIKtu4V3YWt1MgU"}'
2026-01-29 04:31:42.181 INFO [src.node.waku_node] REST service is ready !!
2026-01-29 04:31:42.182 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2026-01-29 04:31:42.189 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-29 04:31:42.190 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-01-29_04-31-40__ae63d214-9703-49da-9780-3045147e4c7f__wakuorg_nwaku:latest.log
2026-01-29 04:31:42.190 DEBUG [src.node.waku_node] Starting Node...
2026-01-29 04:31:42.190 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-29 04:31:42.191 DEBUG [src.node.docker_mananger] Network waku already exists
2026-01-29 04:31:42.191 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.10.188
2026-01-29 04:31:42.191 DEBUG [src.node.docker_mananger] Generated ports ['10026', '10027', '10028', '10029', '10030']
2026-01-29 04:31:42.191 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-29 04:31:42.192 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-29 04:31:42.192 DEBUG [src.node.waku_node] Using volumes []
2026-01-29 04:31:42.192 DEBUG [src.node.docker_mananger] docker run -i -t -p 10026:10026 -p 10027:10027 -p 10028:10028 -p 10029:10029 -p 10030:10030 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10028 --rest-port=10026 --tcp-port=10027 --discv5-udp-port=10029 --rest-address=0.0.0.0 --nat=extip:172.18.10.188 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c8cf969e7dcadeae44e240da0742c43c6df9074b39ffccb35dfc3e442f137fa1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10030 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QGqa-EdJB-U2nTrQOmYLKkgPM97PpKVXZJmPylWm_O9jP0feqiRE29OC0KcMot5Xon7iFYrR6lZBPxbu2n4ElNoCgmlkgnY0gmlwhKwS552KbXVsdGlhZGRyc5YACASsEuedBq25AAoErBLnnQatut0DgnJzhQADAQAAiXNlY3AyNTZrMaEDwa1HiBH9aoMN5qyN2r-VVOunAs8sy7WzMsUxyfnpP3iDdGNwgq25g3VkcIKtu4V3YWt1MgU --filternode=/ip4/172.18.231.157/tcp/44473/p2p/16Uiu2HAmRh2HWerc9XUi7J8QrQydJoLQJc2L5Cooa952zMByZdhR
2026-01-29 04:31:42.371 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.10.188 waku 103fb255f08eb32f17831c53ab5ac6e25c071eb1fc73c9e81a3d6db5e8c70a75
2026-01-29 04:31:42.399 DEBUG [src.node.docker_mananger] Container started with ID 103fb255f08e. Setting up logs at ./log/docker/node2_2026-01-29_04-31-40__ae63d214-9703-49da-9780-3045147e4c7f__wakuorg_nwaku:latest.log
2026-01-29 04:31:42.400 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 10026
2026-01-29 04:31:42.401 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-29 04:31:43.402 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10026/health" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:31:43.406 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-01-29 04:31:43.406 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-29 04:31:43.406 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10026/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:31:43.409 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.10.188/tcp/10027/p2p/16Uiu2HAmEtNGXRsBmH4DvabLTmCAsbPKrvwjuHz5EeV11xgucXBq","/ip4/172.18.10.188/tcp/10028/ws/p2p/16Uiu2HAmEtNGXRsBmH4DvabLTmCAsbPKrvwjuHz5EeV11xgucXBq"],"enrUri":"enr:-L24QJhZzdOG-0Qw5r7Er13YAHh5WgImY3fRC1thgR5kh9QHK4Md7qRV3Df9TXIjFix4L1Oo6yzW8gOyGONW_gNBIYkCgmlkgnY0gmlwhKwSCryKbXVsdGlhZGRyc5YACASsEgq8BicrAAoErBIKvAYnLN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDISS0-9sJwmDCGjQSKRgTUZ6DUQtlRVQ8nFWkabYSPoSDdGNwgicrg3VkcIInLYV3YWt1MgA"}'
2026-01-29 04:31:43.409 INFO [src.node.waku_node] REST service is ready !!
2026-01-29 04:31:43.409 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10026/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.231.157/tcp/44473/p2p/16Uiu2HAmRh2HWerc9XUi7J8QrQydJoLQJc2L5Cooa952zMByZdhR"]'
2026-01-29 04:31:43.438 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:31:43.438 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2026-01-29 04:31:43.443 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44472/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-01-29 04:31:43.450 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:31:43.451 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10026/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "479b17a1-3d51-44c7-9cff-430be94eee40", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-01-29 04:31:43.462 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"479b17a1-3d51-44c7-9cff-430be94eee40","statusDesc":"OK"}'
2026-01-29 04:31:43.463 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44472/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-01-29 04:31:43.470 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:31:43.470 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-01-29 04:31:43.570 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-01-29 04:31:43.571 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10026/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:31:43.575 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1769661103463634896,"ephemeral":false}]'
2026-01-29 04:31:43.577 INFO [src.node.api_clients.base_client] curl -v -X DELETE "http://127.0.0.1:10026/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-01-29 04:31:43.585 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
2026-01-29 04:31:43.585 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44472/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-01-29 04:31:43.588 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:31:43.588 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-01-29 04:31:43.689 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-01-29 04:31:43.689 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10026/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:31:43.692 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:10026/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto. Response content: b'Not subscribed to topic: /test/1/waku-filter/proto'
2026-01-29 04:31:43.694 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44472/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-01-29 04:31:43.696 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:31:43.697 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10026/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "bbd93f6b-6cc1-41f3-876d-96253c4f9f9f", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-01-29 04:31:43.704 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"bbd93f6b-6cc1-41f3-876d-96253c4f9f9f","statusDesc":"OK"}'
2026-01-29 04:31:43.705 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44472/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-01-29 04:31:43.709 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:31:43.709 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-01-29 04:31:43.810 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-01-29 04:31:43.810 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10026/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:31:43.813 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1769661103705480845,"ephemeral":false}]'
2026-01-29 04:31:43.816 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-01-29 04:31:43.817 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-01-29 04:31:43.817 DEBUG [src.node.waku_node] Stopping container with id 353e1c243be9
2026-01-29 04:31:44.358 DEBUG [src.node.waku_node] Container stopped.
2026-01-29 04:31:44.358 DEBUG [src.node.waku_node] Stopping container with id 103fb255f08e
2026-01-29 04:31:44.921 DEBUG [src.node.waku_node] Container stopped.
2026-01-29 04:31:44.924 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-01-29 04:31:44.930 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-01-29 04:31:44.936 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
