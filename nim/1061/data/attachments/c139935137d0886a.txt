2026-01-29 04:47:40.900 DEBUG [tests.conftest] Running fixture setup: test_id
2026-01-29 04:47:40.900 DEBUG [tests.conftest] Running test: test_metrics_after_store_get with id: 2026-01-29_04-47-40__a0241260-c90c-4713-b2fd-1c76d0482758
2026-01-29 04:47:40.900 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-01-29 04:47:40.901 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2026-01-29 04:47:40.901 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2026-01-29 04:47:40.901 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-01-29 04:47:40.901 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-01-29 04:47:40.902 DEBUG [src.steps.store] Running fixture setup: node_setup
2026-01-29 04:47:40.908 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-29 04:47:40.908 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-01-29_04-47-40__a0241260-c90c-4713-b2fd-1c76d0482758__wakuorg_nwaku:latest.log
2026-01-29 04:47:40.909 DEBUG [src.node.waku_node] Starting Node...
2026-01-29 04:47:40.909 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-29 04:47:40.910 DEBUG [src.node.docker_mananger] Network waku already exists
2026-01-29 04:47:40.910 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.157.94
2026-01-29 04:47:40.910 DEBUG [src.node.docker_mananger] Generated ports ['17244', '17245', '17246', '17247', '17248']
2026-01-29 04:47:40.910 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-29 04:47:40.911 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-29 04:47:40.911 DEBUG [src.node.waku_node] Using volumes []
2026-01-29 04:47:40.911 DEBUG [src.node.docker_mananger] docker run -i -t -p 17244:17244 -p 17245:17245 -p 17246:17246 -p 17247:17247 -p 17248:17248 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17246 --rest-port=17244 --tcp-port=17245 --discv5-udp-port=17247 --rest-address=0.0.0.0 --nat=extip:172.18.157.94 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3efbda6dfc54ead7cb71c1dad2fe8f512edfe9dfc5af698c68bf6ba07638afab --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17248 --metrics-logging=true --store=true --relay=true
2026-01-29 04:47:41.107 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.157.94 waku d0b0d501691544b516f577ab1779422a3ebd007cfdfe68d042eeedc34e4d2f21
2026-01-29 04:47:41.146 DEBUG [src.node.docker_mananger] Container started with ID d0b0d5016915. Setting up logs at ./log/docker/publishing_node1_2026-01-29_04-47-40__a0241260-c90c-4713-b2fd-1c76d0482758__wakuorg_nwaku:latest.log
2026-01-29 04:47:41.147 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 17244
2026-01-29 04:47:41.147 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-29 04:47:42.148 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17244/health" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:47:42.151 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-01-29 04:47:42.151 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-29 04:47:42.151 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17244/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:47:42.154 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.157.94/tcp/17245/p2p/16Uiu2HAmHJekRCNxcmTKAwPDpiL3kF5bXFCreAX3b5pM3rors7cf","/ip4/172.18.157.94/tcp/17246/ws/p2p/16Uiu2HAmHJekRCNxcmTKAwPDpiL3kF5bXFCreAX3b5pM3rors7cf"],"enrUri":"enr:-L24QLmLZkWMFUFvTaR67YxXDs44tIJ5qfjLLSHwLiidNwZ-CB9bH3R_hg7BBysYE97reBr3FXL9yg-kDhhlrCtnumQCgmlkgnY0gmlwhKwSnV6KbXVsdGlhZGRyc5YACASsEp1eBkNdAAoErBKdXgZDXt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDRRSnvwD19ge8td7EF033tjeT-szSbOre922Kbf5wFsyDdGNwgkNdg3VkcIJDX4V3YWt1MgM"}'
2026-01-29 04:47:42.154 INFO [src.node.waku_node] REST service is ready !!
2026-01-29 04:47:42.161 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-29 04:47:42.161 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-01-29_04-47-40__a0241260-c90c-4713-b2fd-1c76d0482758__wakuorg_nwaku:latest.log
2026-01-29 04:47:42.161 DEBUG [src.node.waku_node] Starting Node...
2026-01-29 04:47:42.162 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-29 04:47:42.163 DEBUG [src.node.docker_mananger] Network waku already exists
2026-01-29 04:47:42.163 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.155.48
2026-01-29 04:47:42.163 DEBUG [src.node.docker_mananger] Generated ports ['47020', '47021', '47022', '47023', '47024']
2026-01-29 04:47:42.163 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-29 04:47:42.164 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-29 04:47:42.164 DEBUG [src.node.waku_node] Using volumes []
2026-01-29 04:47:42.164 DEBUG [src.node.docker_mananger] docker run -i -t -p 47020:47020 -p 47021:47021 -p 47022:47022 -p 47023:47023 -p 47024:47024 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47022 --rest-port=47020 --tcp-port=47021 --discv5-udp-port=47023 --rest-address=0.0.0.0 --nat=extip:172.18.155.48 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=146799ee4fa42b10af4d821aac0fe9aef56fe7ba8a0f34ec8d4fe9e1eb37a7fd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47024 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QLmLZkWMFUFvTaR67YxXDs44tIJ5qfjLLSHwLiidNwZ-CB9bH3R_hg7BBysYE97reBr3FXL9yg-kDhhlrCtnumQCgmlkgnY0gmlwhKwSnV6KbXVsdGlhZGRyc5YACASsEp1eBkNdAAoErBKdXgZDXt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDRRSnvwD19ge8td7EF033tjeT-szSbOre922Kbf5wFsyDdGNwgkNdg3VkcIJDX4V3YWt1MgM --storenode=/ip4/172.18.157.94/tcp/17245/p2p/16Uiu2HAmHJekRCNxcmTKAwPDpiL3kF5bXFCreAX3b5pM3rors7cf --store=true --relay=true
2026-01-29 04:47:42.351 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.155.48 waku bc6c5f63c1a0bb0714ac02b7dbdcd716f93de4691e515f46ee65186b4bf59872
2026-01-29 04:47:42.381 DEBUG [src.node.docker_mananger] Container started with ID bc6c5f63c1a0. Setting up logs at ./log/docker/store_node1_2026-01-29_04-47-40__a0241260-c90c-4713-b2fd-1c76d0482758__wakuorg_nwaku:latest.log
2026-01-29 04:47:42.382 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 47020
2026-01-29 04:47:42.383 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-29 04:47:43.384 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47020/health" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:47:43.388 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-01-29 04:47:43.388 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-29 04:47:43.388 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47020/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:47:43.391 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.155.48/tcp/47021/p2p/16Uiu2HAmB9fkhvdCajjEsvKh6mNoAakf3SKCgVVxjs1vYpGdrm8W","/ip4/172.18.155.48/tcp/47022/ws/p2p/16Uiu2HAmB9fkhvdCajjEsvKh6mNoAakf3SKCgVVxjs1vYpGdrm8W"],"enrUri":"enr:-L24QEomKpO2gP12CXUPCR6yj0KVda0sw-gpNoTfQmNMsVVQSgU0BXvRLbCgMnt9oMu-GOeuFdC10CFEMO8FpsbykxoCgmlkgnY0gmlwhKwSmzCKbXVsdGlhZGRyc5YACASsEpswBretAAoErBKbMAa3rt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC6aFxV7inxFZlo1AwESlvei5boI1AzMk-HpBbv1YtqGuDdGNwgretg3VkcIK3r4V3YWt1MgM"}'
2026-01-29 04:47:43.391 INFO [src.node.waku_node] REST service is ready !!
2026-01-29 04:47:43.391 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47020/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.157.94/tcp/17245/p2p/16Uiu2HAmHJekRCNxcmTKAwPDpiL3kF5bXFCreAX3b5pM3rors7cf"]'
2026-01-29 04:47:43.394 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:47:43.395 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17244/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-01-29 04:47:43.399 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:47:43.399 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47020/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-01-29 04:47:43.404 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:47:43.407 DEBUG [src.steps.store] Relaying message
2026-01-29 04:47:43.407 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17244/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-01-29 04:47:43.411 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:47:43.412 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-01-29 04:47:43.613 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-01-29 04:47:43.613 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17244/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:47:43.616 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x893bbcc4fbafb6c8e311e5885565b278e52669cf2dff276253aa24e50b227c2c"}]}'
2026-01-29 04:47:43.617 DEBUG [src.steps.store] messages length is 1
2026-01-29 04:47:43.617 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-01-29 04:47:43.617 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47020/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:47:43.620 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x893bbcc4fbafb6c8e311e5885565b278e52669cf2dff276253aa24e50b227c2c"}]}'
2026-01-29 04:47:43.620 DEBUG [src.steps.store] messages length is 1
2026-01-29 04:47:43.620 DEBUG [src.libs.common] Sleeping for 5 seconds
2026-01-29 04:47:48.621 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2026-01-29 04:47:48.625 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 1.0
2026-01-29 04:47:48.625 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_peers has 1
2026-01-29 04:47:48.629 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_peers with value 1.0
2026-01-29 04:47:48.629 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_topics has 1
2026-01-29 04:47:48.632 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_topics with value 2.0
2026-01-29 04:47:48.633 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_subscriptions_total has 1
2026-01-29 04:47:48.636 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_subscriptions_total with value 2.0
2026-01-29 04:47:48.636 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2026-01-29 04:47:48.639 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 1.0
2026-01-29 04:47:48.640 DEBUG [src.steps.metrics] Checking metric: waku_histogram_message_size_count has 1
2026-01-29 04:47:48.643 DEBUG [src.steps.metrics] Found metric: waku_histogram_message_size_count with value 1.0
2026-01-29 04:47:48.643 DEBUG [src.steps.metrics] Checking metric: waku_node_messages_total{type="relay"} has 1
2026-01-29 04:47:48.647 DEBUG [src.steps.metrics] Found metric: waku_node_messages_total{type="relay"} with value 1.0
2026-01-29 04:47:48.647 DEBUG [src.steps.metrics] Checking metric: waku_service_peers{protocol="/vac/waku/store/2.0.0-beta4",peerId="/ip4/172.18.157.94/tcp/17245"} has 1
2026-01-29 04:47:48.650 DEBUG [src.steps.metrics] Found metric: waku_service_peers{protocol="/vac/waku/store/2.0.0-beta4",peerId="/ip4/172.18.157.94/tcp/17245"} with value 1.0
2026-01-29 04:47:48.651 DEBUG [src.steps.metrics] Checking metric: waku_service_peers{protocol="/vac/waku/store-query/3.0.0",peerId="/ip4/172.18.157.94/tcp/17245"} has 1
2026-01-29 04:47:48.654 DEBUG [src.steps.metrics] Found metric: waku_service_peers{protocol="/vac/waku/store-query/3.0.0",peerId="/ip4/172.18.157.94/tcp/17245"} with value 1.0
2026-01-29 04:47:48.654 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2026-01-29 04:47:48.657 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 1.0
2026-01-29 04:47:48.658 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_peers has 1
2026-01-29 04:47:48.661 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_peers with value 1.0
2026-01-29 04:47:48.661 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_topics has 1
2026-01-29 04:47:48.665 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_topics with value 2.0
2026-01-29 04:47:48.665 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_subscriptions_total has 1
2026-01-29 04:47:48.668 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_subscriptions_total with value 2.0
2026-01-29 04:47:48.669 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2026-01-29 04:47:48.672 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 1.0
2026-01-29 04:47:48.672 DEBUG [src.steps.metrics] Checking metric: waku_histogram_message_size_count has 1
2026-01-29 04:47:48.675 DEBUG [src.steps.metrics] Found metric: waku_histogram_message_size_count with value 1.0
2026-01-29 04:47:48.675 DEBUG [src.steps.metrics] Checking metric: waku_node_messages_total{type="relay"} has 1
2026-01-29 04:47:48.678 DEBUG [src.steps.metrics] Found metric: waku_node_messages_total{type="relay"} with value 1.0
2026-01-29 04:47:48.681 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-01-29 04:47:48.682 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-01-29 04:47:48.682 DEBUG [src.node.waku_node] Stopping container with id d0b0d5016915
2026-01-29 04:47:49.267 DEBUG [src.node.waku_node] Container stopped.
2026-01-29 04:47:49.268 DEBUG [src.node.waku_node] Stopping container with id bc6c5f63c1a0
2026-01-29 04:47:49.815 DEBUG [src.node.waku_node] Container stopped.
2026-01-29 04:47:49.817 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-01-29 04:47:49.823 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-01-29 04:47:49.829 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
