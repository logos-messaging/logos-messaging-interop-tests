2026-01-29 04:37:06.587 DEBUG [tests.conftest] Running fixture setup: test_id
2026-01-29 04:37:06.587 DEBUG [tests.conftest] Running test: test_publish_and_retrieve_duplicate_message with id: 2026-01-29_04-37-06__00a6ec78-fc1d-494c-b986-17c8957b8b76
2026-01-29 04:37:06.588 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-01-29 04:37:06.588 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-01-29 04:37:06.588 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2026-01-29 04:37:06.594 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-29 04:37:06.594 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-01-29_04-37-06__00a6ec78-fc1d-494c-b986-17c8957b8b76__wakuorg_nwaku:latest.log
2026-01-29 04:37:06.594 DEBUG [src.node.waku_node] Starting Node...
2026-01-29 04:37:06.595 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-29 04:37:06.596 DEBUG [src.node.docker_mananger] Network waku already exists
2026-01-29 04:37:06.596 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.107.131
2026-01-29 04:37:06.596 DEBUG [src.node.docker_mananger] Generated ports ['6028', '6029', '6030', '6031', '6032']
2026-01-29 04:37:06.596 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-29 04:37:06.596 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-29 04:37:06.596 DEBUG [src.node.waku_node] Using volumes []
2026-01-29 04:37:06.597 DEBUG [src.node.docker_mananger] docker run -i -t -p 6028:6028 -p 6029:6029 -p 6030:6030 -p 6031:6031 -p 6032:6032 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=6030 --rest-port=6028 --tcp-port=6029 --discv5-udp-port=6031 --rest-address=0.0.0.0 --nat=extip:172.18.107.131 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=eaf07f00caca2a0dae8af3c52da49d1e24a23bf1a2b70eeae94cab9fcf2dad5f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=6032 --metrics-logging=true --relay=true
2026-01-29 04:37:06.769 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.107.131 waku d687a490a40410f1b01c07fa6ffebf2f8b4305a9cebdd22bb68b25b7fb18b402
2026-01-29 04:37:06.799 DEBUG [src.node.docker_mananger] Container started with ID d687a490a404. Setting up logs at ./log/docker/node1_2026-01-29_04-37-06__00a6ec78-fc1d-494c-b986-17c8957b8b76__wakuorg_nwaku:latest.log
2026-01-29 04:37:06.800 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 6028
2026-01-29 04:37:06.801 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-29 04:37:06.885 ERROR [src.node.docker_mananger] Max retries reached for container d06143857e75. Exiting log stream.
2026-01-29 04:37:07.384 ERROR [src.node.docker_mananger] Max retries reached for container 08f1cfcee56f. Exiting log stream.
2026-01-29 04:37:07.801 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6028/health" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:37:07.804 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-01-29 04:37:07.804 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-29 04:37:07.805 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6028/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:37:07.807 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.107.131/tcp/6029/p2p/16Uiu2HAmMXKQrEdNd5NFGErLPF2Zc8pak7NDnMZD9aodeXuPkeH5","/ip4/172.18.107.131/tcp/6030/ws/p2p/16Uiu2HAmMXKQrEdNd5NFGErLPF2Zc8pak7NDnMZD9aodeXuPkeH5"],"enrUri":"enr:-L24QJZVMrzvLBP01AarstnM9gwwn8bWsNaza3_xx_AjWzxmISz3l-IfBqYB7kLcEHtYGMU3xQLX2WUbCmsPmH5ChJkCgmlkgnY0gmlwhKwSa4OKbXVsdGlhZGRyc5YACASsEmuDBheNAAoErBJrgwYXjt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDg8IWsIsTI-BQArb6hDHG4wqol2bzFyYQDh7XaJa_BnCDdGNwgheNg3VkcIIXj4V3YWt1MgE"}'
2026-01-29 04:37:07.807 INFO [src.node.waku_node] REST service is ready !!
2026-01-29 04:37:07.814 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-29 04:37:07.814 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-01-29_04-37-06__00a6ec78-fc1d-494c-b986-17c8957b8b76__wakuorg_nwaku:latest.log
2026-01-29 04:37:07.814 DEBUG [src.node.waku_node] Starting Node...
2026-01-29 04:37:07.814 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-29 04:37:07.815 DEBUG [src.node.docker_mananger] Network waku already exists
2026-01-29 04:37:07.815 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.98.169
2026-01-29 04:37:07.816 DEBUG [src.node.docker_mananger] Generated ports ['36760', '36761', '36762', '36763', '36764']
2026-01-29 04:37:07.816 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-29 04:37:07.816 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-29 04:37:07.816 DEBUG [src.node.waku_node] Using volumes []
2026-01-29 04:37:07.816 DEBUG [src.node.docker_mananger] docker run -i -t -p 36760:36760 -p 36761:36761 -p 36762:36762 -p 36763:36763 -p 36764:36764 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36762 --rest-port=36760 --tcp-port=36761 --discv5-udp-port=36763 --rest-address=0.0.0.0 --nat=extip:172.18.98.169 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=de3dac96a7968cebedc8bafce390d4ec0e25e8beed2841ce7b6dbaad10e2bf2e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36764 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QJZVMrzvLBP01AarstnM9gwwn8bWsNaza3_xx_AjWzxmISz3l-IfBqYB7kLcEHtYGMU3xQLX2WUbCmsPmH5ChJkCgmlkgnY0gmlwhKwSa4OKbXVsdGlhZGRyc5YACASsEmuDBheNAAoErBJrgwYXjt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDg8IWsIsTI-BQArb6hDHG4wqol2bzFyYQDh7XaJa_BnCDdGNwgheNg3VkcIIXj4V3YWt1MgE
2026-01-29 04:37:07.995 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.98.169 waku 84a24da0be5d5d02240e616fa7ccd39e8f618e154136979207361d8d3bc8e961
2026-01-29 04:37:08.026 DEBUG [src.node.docker_mananger] Container started with ID 84a24da0be5d. Setting up logs at ./log/docker/node2_2026-01-29_04-37-06__00a6ec78-fc1d-494c-b986-17c8957b8b76__wakuorg_nwaku:latest.log
2026-01-29 04:37:08.027 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 36760
2026-01-29 04:37:08.027 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-29 04:37:09.027 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36760/health" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:37:09.040 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-01-29 04:37:09.043 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-29 04:37:09.045 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36760/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:37:09.050 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.98.169/tcp/36761/p2p/16Uiu2HAmQgSv9y9yFPx5fGXGuSyN5F83ksgTQrrc1oeZjU64dCK5","/ip4/172.18.98.169/tcp/36762/ws/p2p/16Uiu2HAmQgSv9y9yFPx5fGXGuSyN5F83ksgTQrrc1oeZjU64dCK5"],"enrUri":"enr:-L24QCjLK1Y4n1HJWWrRLCFjDtLkTK1sYIc2RGVyb23gVNpeTst3vLobaxUWTFi9WTEMCvvo_CmLVL1vMXLp7OIHUZsCgmlkgnY0gmlwhKwSYqmKbXVsdGlhZGRyc5YACASsEmKpBo-ZAAoErBJiqQaPmt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDsqvc6PPpeeXD5GFHjJo_xQu290Oxphw-tQfgtMmzoVSDdGNwgo-Zg3VkcIKPm4V3YWt1MgE"}'
2026-01-29 04:37:09.050 INFO [src.node.waku_node] REST service is ready !!
2026-01-29 04:37:09.051 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36760/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.107.131/tcp/6029/p2p/16Uiu2HAmMXKQrEdNd5NFGErLPF2Zc8pak7NDnMZD9aodeXuPkeH5"]'
2026-01-29 04:37:09.055 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:37:09.056 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2026-01-29 04:37:09.056 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6028/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-01-29 04:37:09.059 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:37:09.060 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36760/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-01-29 04:37:09.066 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:37:09.067 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6028/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-01-29 04:37:09.072 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:37:09.072 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-01-29 04:37:09.172 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-01-29 04:37:09.172 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6028/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:37:09.175 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1769661429067694080,"ephemeral":false,"proof":""}]'
2026-01-29 04:37:09.177 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-01-29 04:37:09.177 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36760/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:37:09.179 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1769661429067694080,"ephemeral":false,"proof":""}]'
2026-01-29 04:37:09.181 INFO [src.steps.relay] WARM UP successful!!
2026-01-29 04:37:09.182 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6028/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-01-29 04:37:09.186 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:37:09.187 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-01-29 04:37:09.287 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-01-29 04:37:09.288 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6028/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:37:09.290 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1769661429182261325,"ephemeral":false,"proof":""}]'
2026-01-29 04:37:09.292 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-01-29 04:37:09.292 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36760/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:37:09.294 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1769661429182261325,"ephemeral":false,"proof":""}]'
2026-01-29 04:37:09.296 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6028/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-01-29 04:37:09.299 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-29 04:37:09.299 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-01-29 04:37:09.399 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-01-29 04:37:09.399 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6028/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:37:09.402 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1769661429182261325,"ephemeral":false,"proof":""}]'
2026-01-29 04:37:09.404 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-01-29 04:37:09.404 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36760/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-01-29 04:37:09.406 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[]'
2026-01-29 04:37:09.408 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-01-29 04:37:09.409 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-01-29 04:37:09.410 DEBUG [src.node.waku_node] Stopping container with id d687a490a404
2026-01-29 04:37:09.925 DEBUG [src.node.waku_node] Container stopped.
2026-01-29 04:37:09.925 DEBUG [src.node.waku_node] Stopping container with id 84a24da0be5d
2026-01-29 04:37:10.442 DEBUG [src.node.waku_node] Container stopped.
2026-01-29 04:37:10.444 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-01-29 04:37:10.450 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-01-29 04:37:10.456 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
