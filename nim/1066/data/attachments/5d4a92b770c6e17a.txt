2026-02-03 04:35:27.373 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-03 04:35:27.373 DEBUG [tests.conftest] Running test: test_content_topic_also_in_docker_flags[/toychat/2/huilong/proto] with id: 2026-02-03_04-35-27__be5b820a-1273-49b4-947d-1c59162faab3
2026-02-03 04:35:27.374 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-03 04:35:27.374 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-03 04:35:27.374 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-03 04:35:27.381 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-03 04:35:27.381 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-03_04-35-27__be5b820a-1273-49b4-947d-1c59162faab3__wakuorg_nwaku:latest.log
2026-02-03 04:35:27.381 DEBUG [src.node.waku_node] Starting Node...
2026-02-03 04:35:27.382 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-03 04:35:27.383 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-03 04:35:27.383 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.130.3
2026-02-03 04:35:27.383 DEBUG [src.node.docker_mananger] Generated ports ['8570', '8571', '8572', '8573', '8574']
2026-02-03 04:35:27.383 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-03 04:35:27.384 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-03 04:35:27.384 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-03 04:35:27.384 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-03 04:35:27.384 DEBUG [src.node.waku_node] Using volumes []
2026-02-03 04:35:27.384 DEBUG [src.node.docker_mananger] docker run -i -t -p 8570:8570 -p 8571:8571 -p 8572:8572 -p 8573:8573 -p 8574:8574 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=8572 --rest-port=8570 --tcp-port=8571 --discv5-udp-port=8573 --rest-address=0.0.0.0 --nat=extip:172.18.130.3 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=a2cf906dec848c02bec8f0dd9578474eabbb01d1e5e44273fdda96deb25ee3ea --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=8574 --metrics-logging=true --relay=true --filter=true --content-topic=/toychat/2/huilong/proto
2026-02-03 04:35:27.563 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.130.3 waku 330852575ad4efeb2df95e7d83c6ed6f6bb9132459fb0d1032689103bfc2cde3
2026-02-03 04:35:27.598 DEBUG [src.node.docker_mananger] Container started with ID 330852575ad4. Setting up logs at ./log/docker/node1_2026-02-03_04-35-27__be5b820a-1273-49b4-947d-1c59162faab3__wakuorg_nwaku:latest.log
2026-02-03 04:35:27.598 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 8570
2026-02-03 04:35:27.598 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-03 04:35:27.620 ERROR [src.node.docker_mananger] Max retries reached for container 315c650d9fe4. Exiting log stream.
2026-02-03 04:35:28.189 ERROR [src.node.docker_mananger] Max retries reached for container df878d795c6f. Exiting log stream.
2026-02-03 04:35:28.599 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8570/health" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:35:28.602 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-03 04:35:28.602 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-03 04:35:28.602 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8570/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:35:28.604 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.130.3/tcp/8571/p2p/16Uiu2HAmErNDMokraHFQ89so3MLCSEHjmsmnAMZYzaErPLm4fx65","/ip4/172.18.130.3/tcp/8572/ws/p2p/16Uiu2HAmErNDMokraHFQ89so3MLCSEHjmsmnAMZYzaErPLm4fx65"],"enrUri":"enr:-L24QPBDiJ0tFsUAQ7WSuVLQabV39K5dD61d29twh378SHLdFCYeWGsIzIvrdMnm_e32z6H697wU6S9NDh00zOnGvcUCgmlkgnY0gmlwhKwSggOKbXVsdGlhZGRyc5YACASsEoIDBiF7AAoErBKCAwYhfN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDIKF7zzt9_A7mszfe4b-lAA6a3X7twg7OFg3-1gE1MUKDdGNwgiF7g3VkcIIhfYV3YWt1MgU"}'
2026-02-03 04:35:28.605 INFO [src.node.waku_node] REST service is ready !!
2026-02-03 04:35:28.611 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-03 04:35:28.611 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-03_04-35-27__be5b820a-1273-49b4-947d-1c59162faab3__wakuorg_nwaku:latest.log
2026-02-03 04:35:28.612 DEBUG [src.node.waku_node] Starting Node...
2026-02-03 04:35:28.612 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-03 04:35:28.613 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-03 04:35:28.613 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.246.239
2026-02-03 04:35:28.613 DEBUG [src.node.docker_mananger] Generated ports ['33885', '33886', '33887', '33888', '33889']
2026-02-03 04:35:28.613 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2026-02-03 04:35:28.614 DEBUG [src.node.waku_node] Removing pubsub-topic from nwaku args
2026-02-03 04:35:28.614 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-03 04:35:28.614 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-03 04:35:28.614 DEBUG [src.node.waku_node] Using volumes []
2026-02-03 04:35:28.614 DEBUG [src.node.docker_mananger] docker run -i -t -p 33885:33885 -p 33886:33886 -p 33887:33887 -p 33888:33888 -p 33889:33889 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33887 --rest-port=33885 --tcp-port=33886 --discv5-udp-port=33888 --rest-address=0.0.0.0 --nat=extip:172.18.246.239 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=da3db4e3acbd8cdba71a3ca7be6867b77fcd87fc14bda6ec720ba49feec0717d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33889 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QPBDiJ0tFsUAQ7WSuVLQabV39K5dD61d29twh378SHLdFCYeWGsIzIvrdMnm_e32z6H697wU6S9NDh00zOnGvcUCgmlkgnY0gmlwhKwSggOKbXVsdGlhZGRyc5YACASsEoIDBiF7AAoErBKCAwYhfN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDIKF7zzt9_A7mszfe4b-lAA6a3X7twg7OFg3-1gE1MUKDdGNwgiF7g3VkcIIhfYV3YWt1MgU --content-topic=/toychat/2/huilong/proto
2026-02-03 04:35:28.803 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.246.239 waku a8a6134cdee666502d64e216d1e7d450cb562dd98092685af13e9c2c32c555d8
2026-02-03 04:35:28.834 DEBUG [src.node.docker_mananger] Container started with ID a8a6134cdee6. Setting up logs at ./log/docker/node2_2026-02-03_04-35-27__be5b820a-1273-49b4-947d-1c59162faab3__wakuorg_nwaku:latest.log
2026-02-03 04:35:28.834 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 33885
2026-02-03 04:35:28.834 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-03 04:35:29.835 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33885/health" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:35:29.845 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-03 04:35:29.845 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-03 04:35:29.847 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33885/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:35:29.851 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.246.239/tcp/33886/p2p/16Uiu2HAmH4eWCytz2Qcz3wj6EiBbzTJC8WftzBSm42qADrKgfcsd","/ip4/172.18.246.239/tcp/33887/ws/p2p/16Uiu2HAmH4eWCytz2Qcz3wj6EiBbzTJC8WftzBSm42qADrKgfcsd"],"enrUri":"enr:-L24QK1eFLrwdIlJQTiyxLnxi7NvpP6181X-edfgpXfFubxyDV1OFkQMCHvza1fZ4N7i2IwwOIPe8nv8w4YfDOWHSV4CgmlkgnY0gmlwhKwS9u-KbXVsdGlhZGRyc5YACASsEvbvBoReAAoErBL27waEX90DgnJzhQACAQAAiXNlY3AyNTZrMaEDQX4_NKO86I_rGRsYfm-irSK8ITTR8OTAIILTo11LcUSDdGNwgoReg3VkcIKEYIV3YWt1MgE"}'
2026-02-03 04:35:29.852 INFO [src.node.waku_node] REST service is ready !!
2026-02-03 04:35:29.852 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33885/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.130.3/tcp/8571/p2p/16Uiu2HAmErNDMokraHFQ89so3MLCSEHjmsmnAMZYzaErPLm4fx65"]'
2026-02-03 04:35:29.855 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:35:29.856 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8570/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2026-02-03 04:35:29.858 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:35:29.858 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33885/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2026-02-03 04:35:29.860 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:35:29.861 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8570/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-03 04:35:29.865 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:35:29.866 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-03 04:35:29.966 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-03 04:35:29.966 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8570/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:35:29.969 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770093329861294007,"ephemeral":false,"proof":""}]'
2026-02-03 04:35:29.971 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-03 04:35:29.971 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33885/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:35:29.973 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770093329861294007,"ephemeral":false,"proof":""}]'
2026-02-03 04:35:29.976 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-03 04:35:29.977 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-03 04:35:29.977 DEBUG [src.node.waku_node] Stopping container with id 330852575ad4
2026-02-03 04:35:30.538 DEBUG [src.node.waku_node] Container stopped.
2026-02-03 04:35:30.540 DEBUG [src.node.waku_node] Stopping container with id a8a6134cdee6
2026-02-03 04:35:31.098 DEBUG [src.node.waku_node] Container stopped.
2026-02-03 04:35:31.101 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-03 04:35:31.110 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-03 04:35:31.116 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
