2026-02-03 04:35:19.167 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-03 04:35:19.168 DEBUG [tests.conftest] Running test: test_filter_update_subscription_refresh_existing with id: 2026-02-03_04-35-19__42dc3497-1926-434d-a4d5-26c793c3c6f9
2026-02-03 04:35:19.169 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-03 04:35:19.169 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2026-02-03 04:35:19.170 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2026-02-03 04:35:19.180 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-03 04:35:19.180 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-03_04-35-19__42dc3497-1926-434d-a4d5-26c793c3c6f9__wakuorg_nwaku:latest.log
2026-02-03 04:35:19.181 DEBUG [src.node.waku_node] Starting Node...
2026-02-03 04:35:19.181 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-03 04:35:19.182 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-03 04:35:19.183 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.229.77
2026-02-03 04:35:19.183 DEBUG [src.node.docker_mananger] Generated ports ['58124', '58125', '58126', '58127', '58128']
2026-02-03 04:35:19.183 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-03 04:35:19.183 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-03 04:35:19.183 DEBUG [src.node.waku_node] Using volumes []
2026-02-03 04:35:19.183 DEBUG [src.node.docker_mananger] docker run -i -t -p 58124:58124 -p 58125:58125 -p 58126:58126 -p 58127:58127 -p 58128:58128 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58126 --rest-port=58124 --tcp-port=58125 --discv5-udp-port=58127 --rest-address=0.0.0.0 --nat=extip:172.18.229.77 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ec18aded44bced0bbefcbd81890ab1468147ebddc7fccbaabc8d55fce94039fc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58128 --metrics-logging=true --relay=true --filter=true
2026-02-03 04:35:19.382 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.229.77 waku e7bb86e6f66e72e6d451246bbd26f5a1b1102a2a52c62b8f684aa90a0e759c59
2026-02-03 04:35:19.413 DEBUG [src.node.docker_mananger] Container started with ID e7bb86e6f66e. Setting up logs at ./log/docker/node1_2026-02-03_04-35-19__42dc3497-1926-434d-a4d5-26c793c3c6f9__wakuorg_nwaku:latest.log
2026-02-03 04:35:19.413 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 58124
2026-02-03 04:35:19.413 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-03 04:35:19.424 ERROR [src.node.docker_mananger] Max retries reached for container 3a04f89828e3. Exiting log stream.
2026-02-03 04:35:19.994 ERROR [src.node.docker_mananger] Max retries reached for container 0d7857026633. Exiting log stream.
2026-02-03 04:35:20.414 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58124/health" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:35:20.417 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-03 04:35:20.417 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-03 04:35:20.418 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58124/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:35:20.420 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.229.77/tcp/58125/p2p/16Uiu2HAmGCt1ZaYBHcMxALn957KRQwkDJPttiSdzqrCXgqaub5FP","/ip4/172.18.229.77/tcp/58126/ws/p2p/16Uiu2HAmGCt1ZaYBHcMxALn957KRQwkDJPttiSdzqrCXgqaub5FP"],"enrUri":"enr:-L24QNtwXMoGZf_HXUjfHxiGsTHQTkPyAzp0AE-Zw8OV4J16OWDVqNr9tD42ZOzPhZGIESDDpicKWFHKg_dy4g5GTP8CgmlkgnY0gmlwhKwS5U2KbXVsdGlhZGRyc5YACASsEuVNBuMNAAoErBLlTQbjDt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDNL56VVxrsyUru-I2gjcXmsLmu4yQCMIQ5eZuOyTyd4KDdGNwguMNg3VkcILjD4V3YWt1MgU"}'
2026-02-03 04:35:20.420 INFO [src.node.waku_node] REST service is ready !!
2026-02-03 04:35:20.421 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2026-02-03 04:35:20.427 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-03 04:35:20.427 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-03_04-35-19__42dc3497-1926-434d-a4d5-26c793c3c6f9__wakuorg_nwaku:latest.log
2026-02-03 04:35:20.428 DEBUG [src.node.waku_node] Starting Node...
2026-02-03 04:35:20.428 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-03 04:35:20.429 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-03 04:35:20.429 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.90.11
2026-02-03 04:35:20.429 DEBUG [src.node.docker_mananger] Generated ports ['31869', '31870', '31871', '31872', '31873']
2026-02-03 04:35:20.430 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-03 04:35:20.430 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-03 04:35:20.430 DEBUG [src.node.waku_node] Using volumes []
2026-02-03 04:35:20.430 DEBUG [src.node.docker_mananger] docker run -i -t -p 31869:31869 -p 31870:31870 -p 31871:31871 -p 31872:31872 -p 31873:31873 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31871 --rest-port=31869 --tcp-port=31870 --discv5-udp-port=31872 --rest-address=0.0.0.0 --nat=extip:172.18.90.11 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8ccf3dae11fabfb0cacbbd32eafffe6c3a2dcc128067638c2194c07aaf5c69ce --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31873 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QNtwXMoGZf_HXUjfHxiGsTHQTkPyAzp0AE-Zw8OV4J16OWDVqNr9tD42ZOzPhZGIESDDpicKWFHKg_dy4g5GTP8CgmlkgnY0gmlwhKwS5U2KbXVsdGlhZGRyc5YACASsEuVNBuMNAAoErBLlTQbjDt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDNL56VVxrsyUru-I2gjcXmsLmu4yQCMIQ5eZuOyTyd4KDdGNwguMNg3VkcILjD4V3YWt1MgU --filternode=/ip4/172.18.229.77/tcp/58125/p2p/16Uiu2HAmGCt1ZaYBHcMxALn957KRQwkDJPttiSdzqrCXgqaub5FP
2026-02-03 04:35:20.627 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.90.11 waku 73ced8ae5e06c9297dbf098779dd93b66fecabd35e07e65485fb21e4c1108e40
2026-02-03 04:35:20.665 DEBUG [src.node.docker_mananger] Container started with ID 73ced8ae5e06. Setting up logs at ./log/docker/node2_2026-02-03_04-35-19__42dc3497-1926-434d-a4d5-26c793c3c6f9__wakuorg_nwaku:latest.log
2026-02-03 04:35:20.666 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 31869
2026-02-03 04:35:20.666 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-03 04:35:21.666 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31869/health" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:35:21.670 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-03 04:35:21.671 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-03 04:35:21.671 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31869/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:35:21.673 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.90.11/tcp/31870/p2p/16Uiu2HAmQmM1BWSnoQijPk13HHv1dMCA5Ao6Yvhpy7gL2qpSNaBM","/ip4/172.18.90.11/tcp/31871/ws/p2p/16Uiu2HAmQmM1BWSnoQijPk13HHv1dMCA5Ao6Yvhpy7gL2qpSNaBM"],"enrUri":"enr:-L24QHL4BhCgQjcPg-tNPSG4quqdlcu7OVvAVPW4GrqnIbntAwNcPkumLF1oGhD18-v8Y7KyMa6mF6O_YF3TCvoVZrkCgmlkgnY0gmlwhKwSWguKbXVsdGlhZGRyc5YACASsEloLBnx-AAoErBJaCwZ8f90DgnJzhQADAQAAiXNlY3AyNTZrMaEDs-0Uq7gHLGwl2V_FZgfAgyfE55uU71ii8WYsIAJln7SDdGNwgnx-g3VkcIJ8gIV3YWt1MgA"}'
2026-02-03 04:35:21.673 INFO [src.node.waku_node] REST service is ready !!
2026-02-03 04:35:21.674 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31869/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.229.77/tcp/58125/p2p/16Uiu2HAmGCt1ZaYBHcMxALn957KRQwkDJPttiSdzqrCXgqaub5FP"]'
2026-02-03 04:35:21.705 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:35:21.709 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58124/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-03 04:35:21.721 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:35:21.722 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31869/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "0a232322-819d-4d3f-832d-ad26e5137517", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-03 04:35:21.734 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"0a232322-819d-4d3f-832d-ad26e5137517","statusDesc":"OK"}'
2026-02-03 04:35:21.734 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:31869/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-02-03 04:35:21.744 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
2026-02-03 04:35:21.744 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58124/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2026-02-03 04:35:21.752 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:35:21.752 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-03 04:35:21.853 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-03 04:35:21.853 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31869/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:35:21.856 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1770093321744596252,"ephemeral":false}]'
2026-02-03 04:35:21.859 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-03 04:35:21.861 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-03 04:35:21.861 DEBUG [src.node.waku_node] Stopping container with id e7bb86e6f66e
2026-02-03 04:35:22.418 DEBUG [src.node.waku_node] Container stopped.
2026-02-03 04:35:22.418 DEBUG [src.node.waku_node] Stopping container with id 73ced8ae5e06
2026-02-03 04:35:22.961 DEBUG [src.node.waku_node] Container stopped.
2026-02-03 04:35:22.963 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-03 04:35:22.969 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-03 04:35:22.974 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
