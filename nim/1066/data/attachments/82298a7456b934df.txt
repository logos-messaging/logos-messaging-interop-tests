2026-02-03 04:34:01.867 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-03 04:34:01.868 DEBUG [tests.conftest] Running test: test_relay_resubscribe_to_unsubscribed_pubsub_topic with id: 2026-02-03_04-34-01__f9f025b2-7286-438b-b76f-58d0310ae198
2026-02-03 04:34:01.868 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-03 04:34:01.868 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-03 04:34:01.868 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2026-02-03 04:34:01.875 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-03 04:34:01.875 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-03_04-34-01__f9f025b2-7286-438b-b76f-58d0310ae198__wakuorg_nwaku:latest.log
2026-02-03 04:34:01.876 DEBUG [src.node.waku_node] Starting Node...
2026-02-03 04:34:01.876 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-03 04:34:01.877 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-03 04:34:01.877 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.58.214
2026-02-03 04:34:01.878 DEBUG [src.node.docker_mananger] Generated ports ['57468', '57469', '57470', '57471', '57472']
2026-02-03 04:34:01.878 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-03 04:34:01.878 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-03 04:34:01.878 DEBUG [src.node.waku_node] Using volumes []
2026-02-03 04:34:01.878 DEBUG [src.node.docker_mananger] docker run -i -t -p 57468:57468 -p 57469:57469 -p 57470:57470 -p 57471:57471 -p 57472:57472 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57470 --rest-port=57468 --tcp-port=57469 --discv5-udp-port=57471 --rest-address=0.0.0.0 --nat=extip:172.18.58.214 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=399d68dec79184a716331ab6aaded2cac909aaef82c8affbdbdbf9dcd7e1d90c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57472 --metrics-logging=true --relay=true
2026-02-03 04:34:02.061 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.58.214 waku 39173705b7e236ada8f493f80ef3520b7edc6e13f457436cff60cac9349def6f
2026-02-03 04:34:02.093 DEBUG [src.node.docker_mananger] Container started with ID 39173705b7e2. Setting up logs at ./log/docker/node1_2026-02-03_04-34-01__f9f025b2-7286-438b-b76f-58d0310ae198__wakuorg_nwaku:latest.log
2026-02-03 04:34:02.094 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 57468
2026-02-03 04:34:02.094 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-03 04:34:02.122 ERROR [src.node.docker_mananger] Max retries reached for container 6377cad40d81. Exiting log stream.
2026-02-03 04:34:02.670 ERROR [src.node.docker_mananger] Max retries reached for container 9b5512256e1e. Exiting log stream.
2026-02-03 04:34:03.094 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57468/health" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:34:03.097 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-03 04:34:03.098 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-03 04:34:03.098 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57468/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:34:03.100 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.58.214/tcp/57469/p2p/16Uiu2HAmRipJhZsKJF8hxDVvfzpHU69EpngMZ7GM7z9mCdNDPaMf","/ip4/172.18.58.214/tcp/57470/ws/p2p/16Uiu2HAmRipJhZsKJF8hxDVvfzpHU69EpngMZ7GM7z9mCdNDPaMf"],"enrUri":"enr:-L24QLszec_UFEewY-nRKcscK9ERDh9QjtL5tisqLEkxHsNGU_vM9a0SzWFpPgWb232pZuMipKUem6ZRuHlBHJ7wsiQCgmlkgnY0gmlwhKwSOtaKbXVsdGlhZGRyc5YACASsEjrWBuB9AAoErBI61gbgft0DgnJzhQADAQAAiXNlY3AyNTZrMaEDwiLlUGjYEHOhaZqSBAVN99eBIJQFapxkSEUm_c3OfSKDdGNwguB9g3VkcILgf4V3YWt1MgE"}'
2026-02-03 04:34:03.100 INFO [src.node.waku_node] REST service is ready !!
2026-02-03 04:34:03.108 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-03 04:34:03.108 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-03_04-34-01__f9f025b2-7286-438b-b76f-58d0310ae198__wakuorg_nwaku:latest.log
2026-02-03 04:34:03.108 DEBUG [src.node.waku_node] Starting Node...
2026-02-03 04:34:03.108 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-03 04:34:03.110 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-03 04:34:03.110 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.59.222
2026-02-03 04:34:03.110 DEBUG [src.node.docker_mananger] Generated ports ['61090', '61091', '61092', '61093', '61094']
2026-02-03 04:34:03.110 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-03 04:34:03.110 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-03 04:34:03.110 DEBUG [src.node.waku_node] Using volumes []
2026-02-03 04:34:03.111 DEBUG [src.node.docker_mananger] docker run -i -t -p 61090:61090 -p 61091:61091 -p 61092:61092 -p 61093:61093 -p 61094:61094 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61092 --rest-port=61090 --tcp-port=61091 --discv5-udp-port=61093 --rest-address=0.0.0.0 --nat=extip:172.18.59.222 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=acbc0de56f2bdd460f081a0d5ce030f381b91eaf1a7fb5d639e951fc7aaffb10 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61094 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QLszec_UFEewY-nRKcscK9ERDh9QjtL5tisqLEkxHsNGU_vM9a0SzWFpPgWb232pZuMipKUem6ZRuHlBHJ7wsiQCgmlkgnY0gmlwhKwSOtaKbXVsdGlhZGRyc5YACASsEjrWBuB9AAoErBI61gbgft0DgnJzhQADAQAAiXNlY3AyNTZrMaEDwiLlUGjYEHOhaZqSBAVN99eBIJQFapxkSEUm_c3OfSKDdGNwguB9g3VkcILgf4V3YWt1MgE
2026-02-03 04:34:03.295 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.59.222 waku 28e9b96db06de502ec7d745955c0e9fa9b0f148a035c88c2461eefdb10701543
2026-02-03 04:34:03.330 DEBUG [src.node.docker_mananger] Container started with ID 28e9b96db06d. Setting up logs at ./log/docker/node2_2026-02-03_04-34-01__f9f025b2-7286-438b-b76f-58d0310ae198__wakuorg_nwaku:latest.log
2026-02-03 04:34:03.330 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 61090
2026-02-03 04:34:03.331 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-03 04:34:04.332 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61090/health" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:34:04.344 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-03 04:34:04.347 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-03 04:34:04.348 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61090/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:34:04.352 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.59.222/tcp/61091/p2p/16Uiu2HAkuyxM2ErorjJWQ7zrb5XZ9HpNJpoaseG1cuGpNv7rMMgt","/ip4/172.18.59.222/tcp/61092/ws/p2p/16Uiu2HAkuyxM2ErorjJWQ7zrb5XZ9HpNJpoaseG1cuGpNv7rMMgt"],"enrUri":"enr:-L24QFfRPFRAK7Fo3JyoMelLn3mo3Gzc3Icxn1D01RfhuqMSHjNrrk6a5jn5eiiGG5zF46Ju5YboiAnAfOuwmqqS9FMCgmlkgnY0gmlwhKwSO96KbXVsdGlhZGRyc5YACASsEjveBu6jAAoErBI73gbupN0DgnJzhQADAQAAiXNlY3AyNTZrMaECCEUXS60HJ6j97CwvhEGJgXWGw6Xm8Gz1tFQQm9UhAYmDdGNwgu6jg3VkcILupYV3YWt1MgE"}'
2026-02-03 04:34:04.352 INFO [src.node.waku_node] REST service is ready !!
2026-02-03 04:34:04.353 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61090/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.58.214/tcp/57469/p2p/16Uiu2HAmRipJhZsKJF8hxDVvfzpHU69EpngMZ7GM7z9mCdNDPaMf"]'
2026-02-03 04:34:04.359 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:34:04.360 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57468/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-03 04:34:04.364 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:34:04.364 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61090/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-03 04:34:04.369 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:34:04.371 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57468/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-03 04:34:04.375 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:34:04.376 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-03 04:34:04.476 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-03 04:34:04.476 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57468/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:34:04.479 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770093244371685888,"ephemeral":false,"proof":""}]'
2026-02-03 04:34:04.481 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-03 04:34:04.481 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61090/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:34:04.483 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770093244371685888,"ephemeral":false,"proof":""}]'
2026-02-03 04:34:04.484 INFO [src.node.api_clients.base_client] curl -v -X DELETE "http://127.0.0.1:57468/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-03 04:34:04.489 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:34:04.489 INFO [src.node.api_clients.base_client] curl -v -X DELETE "http://127.0.0.1:61090/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-03 04:34:04.492 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:34:04.493 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57468/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-03 04:34:04.496 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:57468/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Failed to publish: Node not subscribed to topic: /waku/2/rs/3/1'
2026-02-03 04:34:04.496 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57468/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-03 04:34:04.500 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:34:04.500 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61090/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-03 04:34:04.504 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:34:04.504 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57468/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-03 04:34:04.509 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-03 04:34:04.509 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-03 04:34:04.610 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-03 04:34:04.610 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57468/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:34:04.613 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770093244504916308,"ephemeral":false,"proof":""}]'
2026-02-03 04:34:04.614 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-03 04:34:04.614 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61090/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-03 04:34:04.616 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770093244504916308,"ephemeral":false,"proof":""}]'
2026-02-03 04:34:04.619 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-03 04:34:04.620 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-03 04:34:04.620 DEBUG [src.node.waku_node] Stopping container with id 39173705b7e2
2026-02-03 04:34:05.151 DEBUG [src.node.waku_node] Container stopped.
2026-02-03 04:34:05.151 DEBUG [src.node.waku_node] Stopping container with id 28e9b96db06d
2026-02-03 04:34:05.684 DEBUG [src.node.waku_node] Container stopped.
2026-02-03 04:34:05.687 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-03 04:34:05.693 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-03 04:34:05.699 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
