2026-01-31 04:35:16.381 DEBUG [tests.conftest] Running fixture setup: test_id
2026-01-31 04:35:16.381 DEBUG [tests.conftest] Running test: test_filter_get_message_with_ephemeral with id: 2026-01-31_04-35-16__61ad14b7-7200-43d4-84f5-816cff4a5bf0
2026-01-31 04:35:16.381 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-01-31 04:35:16.381 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2026-01-31 04:35:16.382 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2026-01-31 04:35:16.389 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-31 04:35:16.389 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-01-31_04-35-16__61ad14b7-7200-43d4-84f5-816cff4a5bf0__wakuorg_nwaku:latest.log
2026-01-31 04:35:16.389 DEBUG [src.node.waku_node] Starting Node...
2026-01-31 04:35:16.389 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-31 04:35:16.391 DEBUG [src.node.docker_mananger] Network waku already exists
2026-01-31 04:35:16.391 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.60.187
2026-01-31 04:35:16.391 DEBUG [src.node.docker_mananger] Generated ports ['39284', '39285', '39286', '39287', '39288']
2026-01-31 04:35:16.391 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-31 04:35:16.391 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-31 04:35:16.391 DEBUG [src.node.waku_node] Using volumes []
2026-01-31 04:35:16.391 DEBUG [src.node.docker_mananger] docker run -i -t -p 39284:39284 -p 39285:39285 -p 39286:39286 -p 39287:39287 -p 39288:39288 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39286 --rest-port=39284 --tcp-port=39285 --discv5-udp-port=39287 --rest-address=0.0.0.0 --nat=extip:172.18.60.187 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d46b5ade3af66ebb7815cba3cae048ac3f3105355052a0f8dc8bdeaf99dbedfe --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39288 --metrics-logging=true --relay=true --filter=true
2026-01-31 04:35:16.503 ERROR [src.node.docker_mananger] Max retries reached for container 1854a79a2e84. Exiting log stream.
2026-01-31 04:35:16.584 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.60.187 waku 377d489d1f265d36c4c0966e5b1c8d6622e7797422669005d21b50be38cc0e87
2026-01-31 04:35:16.615 DEBUG [src.node.docker_mananger] Container started with ID 377d489d1f26. Setting up logs at ./log/docker/node1_2026-01-31_04-35-16__61ad14b7-7200-43d4-84f5-816cff4a5bf0__wakuorg_nwaku:latest.log
2026-01-31 04:35:16.615 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 39284
2026-01-31 04:35:16.615 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-31 04:35:17.616 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39284/health" -H "Content-Type: application/json" -d 'None'
2026-01-31 04:35:17.619 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-01-31 04:35:17.619 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-31 04:35:17.619 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39284/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-31 04:35:17.622 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.60.187/tcp/39285/p2p/16Uiu2HAmS73wLZknoe7vBdVhQaRYHEsMYxnyrN6remDPmMHeTXts","/ip4/172.18.60.187/tcp/39286/ws/p2p/16Uiu2HAmS73wLZknoe7vBdVhQaRYHEsMYxnyrN6remDPmMHeTXts"],"enrUri":"enr:-L24QItxA1PQaEOp8B1_ODo1iydNpsa0tGz9rD6qSG34udTVZptnvKADOXf-SvmoJeB8chcT84WAr2qa9b6jJS2q9gMCgmlkgnY0gmlwhKwSPLuKbXVsdGlhZGRyc5YACASsEjy7Bpl1AAoErBI8uwaZdt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDx9UWQsfKdMfvbVdh2B9w59epCHE1yK5W_EL-hu3yHFiDdGNwgpl1g3VkcIKZd4V3YWt1MgU"}'
2026-01-31 04:35:17.622 INFO [src.node.waku_node] REST service is ready !!
2026-01-31 04:35:17.622 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2026-01-31 04:35:17.629 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-31 04:35:17.629 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-01-31_04-35-16__61ad14b7-7200-43d4-84f5-816cff4a5bf0__wakuorg_nwaku:latest.log
2026-01-31 04:35:17.629 DEBUG [src.node.waku_node] Starting Node...
2026-01-31 04:35:17.629 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-31 04:35:17.631 DEBUG [src.node.docker_mananger] Network waku already exists
2026-01-31 04:35:17.631 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.187.136
2026-01-31 04:35:17.631 DEBUG [src.node.docker_mananger] Generated ports ['58507', '58508', '58509', '58510', '58511']
2026-01-31 04:35:17.631 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-31 04:35:17.631 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-31 04:35:17.631 DEBUG [src.node.waku_node] Using volumes []
2026-01-31 04:35:17.631 DEBUG [src.node.docker_mananger] docker run -i -t -p 58507:58507 -p 58508:58508 -p 58509:58509 -p 58510:58510 -p 58511:58511 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58509 --rest-port=58507 --tcp-port=58508 --discv5-udp-port=58510 --rest-address=0.0.0.0 --nat=extip:172.18.187.136 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f7a0d64fb11e36a0c0ee4b56bb3b5bfa8b9b4ea2cd9f16d492cac6aa59b4ece7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58511 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QItxA1PQaEOp8B1_ODo1iydNpsa0tGz9rD6qSG34udTVZptnvKADOXf-SvmoJeB8chcT84WAr2qa9b6jJS2q9gMCgmlkgnY0gmlwhKwSPLuKbXVsdGlhZGRyc5YACASsEjy7Bpl1AAoErBI8uwaZdt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDx9UWQsfKdMfvbVdh2B9w59epCHE1yK5W_EL-hu3yHFiDdGNwgpl1g3VkcIKZd4V3YWt1MgU --filternode=/ip4/172.18.60.187/tcp/39285/p2p/16Uiu2HAmS73wLZknoe7vBdVhQaRYHEsMYxnyrN6remDPmMHeTXts
2026-01-31 04:35:17.818 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.187.136 waku ae5d19941de128b42f149816d1be32891c7c175446ae633589b43e70f09da0bc
2026-01-31 04:35:17.848 DEBUG [src.node.docker_mananger] Container started with ID ae5d19941de1. Setting up logs at ./log/docker/node2_2026-01-31_04-35-16__61ad14b7-7200-43d4-84f5-816cff4a5bf0__wakuorg_nwaku:latest.log
2026-01-31 04:35:17.848 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 58507
2026-01-31 04:35:17.848 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-31 04:35:18.849 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58507/health" -H "Content-Type: application/json" -d 'None'
2026-01-31 04:35:18.853 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-01-31 04:35:18.853 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-31 04:35:18.854 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58507/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-31 04:35:18.856 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.187.136/tcp/58508/p2p/16Uiu2HAmSq3SWFWBeVwmP8zrKtTaSWUNPxBbxooYx4tCp2Hcitds","/ip4/172.18.187.136/tcp/58509/ws/p2p/16Uiu2HAmSq3SWFWBeVwmP8zrKtTaSWUNPxBbxooYx4tCp2Hcitds"],"enrUri":"enr:-L24QLC9NYghPM3yuWNtkDua76VEOpPwiad3xN-lOshOoYUuVrnqGOAdmaVPn4_2evZbHQri7XAzVE6FeNvBfnq9dJYCgmlkgnY0gmlwhKwSu4iKbXVsdGlhZGRyc5YACASsEruIBuSMAAoErBK7iAbkjd0DgnJzhQADAQAAiXNlY3AyNTZrMaED0pbrOS4upztYMaH0bURXz-Lfi1QTUGLtxMot9prDmt6DdGNwguSMg3VkcILkjoV3YWt1MgA"}'
2026-01-31 04:35:18.856 INFO [src.node.waku_node] REST service is ready !!
2026-01-31 04:35:18.856 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58507/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.60.187/tcp/39285/p2p/16Uiu2HAmS73wLZknoe7vBdVhQaRYHEsMYxnyrN6remDPmMHeTXts"]'
2026-01-31 04:35:18.885 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-31 04:35:18.887 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2026-01-31 04:35:18.888 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39284/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-01-31 04:35:18.899 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-31 04:35:18.901 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58507/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1e1416f2-da79-4283-98d4-18f585d46fa2", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2026-01-31 04:35:18.913 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1e1416f2-da79-4283-98d4-18f585d46fa2","statusDesc":"OK"}'
2026-01-31 04:35:18.914 DEBUG [tests.filter.test_get_messages] Running test with Ephemeral True
2026-01-31 04:35:18.914 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39284/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
2026-01-31 04:35:18.921 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-31 04:35:18.921 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-01-31 04:35:19.022 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-01-31 04:35:19.022 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58507/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-01-31 04:35:19.025 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1769834118914830301,"ephemeral":true}]'
2026-01-31 04:35:19.027 DEBUG [tests.filter.test_get_messages] Running test with Ephemeral False
2026-01-31 04:35:19.027 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39284/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
2026-01-31 04:35:19.031 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-31 04:35:19.031 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-01-31 04:35:19.132 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-01-31 04:35:19.132 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58507/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-01-31 04:35:19.135 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1769834119027359458,"ephemeral":false}]'
2026-01-31 04:35:19.138 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-01-31 04:35:19.139 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-01-31 04:35:19.139 DEBUG [src.node.waku_node] Stopping container with id 377d489d1f26
2026-01-31 04:35:19.672 DEBUG [src.node.waku_node] Container stopped.
2026-01-31 04:35:19.672 DEBUG [src.node.waku_node] Stopping container with id ae5d19941de1
2026-01-31 04:35:20.216 DEBUG [src.node.waku_node] Container stopped.
2026-01-31 04:35:20.219 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-01-31 04:35:20.225 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-01-31 04:35:20.231 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
