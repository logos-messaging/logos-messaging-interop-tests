2026-01-31 04:29:49.236 DEBUG [tests.conftest] Running fixture setup: test_id
2026-01-31 04:29:49.237 DEBUG [tests.conftest] Running test: test_relay_different_latency_between_two_nodes[5000] with id: 2026-01-31_04-29-49__72a1f12b-f182-4ecb-8fa3-296a09ab97f6
2026-01-31 04:29:49.237 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-01-31 04:29:49.237 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-01-31 04:29:49.248 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-31 04:29:49.248 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-01-31_04-29-49__72a1f12b-f182-4ecb-8fa3-296a09ab97f6__wakuorg_nwaku:latest.log
2026-01-31 04:29:49.256 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-01-31 04:29:49.256 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-01-31_04-29-49__72a1f12b-f182-4ecb-8fa3-296a09ab97f6__wakuorg_nwaku:latest.log
2026-01-31 04:29:49.258 INFO [tests.e2e.test_network_conditions] Starting node1 and node2 with relay enabled
2026-01-31 04:29:49.258 DEBUG [src.node.waku_node] Starting Node...
2026-01-31 04:29:49.258 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-31 04:29:49.303 DEBUG [src.node.docker_mananger] Network waku created
2026-01-31 04:29:49.303 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.80.101
2026-01-31 04:29:49.303 DEBUG [src.node.docker_mananger] Generated ports ['47880', '47881', '47882', '47883', '47884']
2026-01-31 04:29:49.303 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-31 04:29:49.304 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-31 04:29:49.304 DEBUG [src.node.waku_node] Using volumes []
2026-01-31 04:29:49.304 DEBUG [src.node.docker_mananger] docker run -i -t -p 47880:47880 -p 47881:47881 -p 47882:47882 -p 47883:47883 -p 47884:47884 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47882 --rest-port=47880 --tcp-port=47881 --discv5-udp-port=47883 --rest-address=0.0.0.0 --nat=extip:172.18.80.101 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a4ae7eb9bb5ce1b0cbf05ab2db5e0decafacb0cce7dc0bc36accabc4eeca06f5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47884 --metrics-logging=true --relay=true
2026-01-31 04:29:51.882 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.80.101 waku 80ac32d6739a64ef382d6419ddadf8b0279e9f2bb1b61242a0c1ba131f57831a
2026-01-31 04:29:51.916 DEBUG [src.node.docker_mananger] Container started with ID 80ac32d6739a. Setting up logs at ./log/docker/node1_2026-01-31_04-29-49__72a1f12b-f182-4ecb-8fa3-296a09ab97f6__wakuorg_nwaku:latest.log
2026-01-31 04:29:51.918 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 47880
2026-01-31 04:29:51.918 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-31 04:29:52.919 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47880/health" -H "Content-Type: application/json" -d 'None'
2026-01-31 04:29:52.923 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-01-31 04:29:52.923 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-31 04:29:52.923 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47880/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-31 04:29:52.926 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.80.101/tcp/47881/p2p/16Uiu2HAmFcQUQbUhiySnBqMGpdopDsqzLzVLwDiWw8q8P8UvhLcD","/ip4/172.18.80.101/tcp/47882/ws/p2p/16Uiu2HAmFcQUQbUhiySnBqMGpdopDsqzLzVLwDiWw8q8P8UvhLcD"],"enrUri":"enr:-L24QE0DFxe29h1MUvhREZjt62L1LJKmUrMIMrpvn9XmB1T0JzYgXW4i0Hr1Sw-kCOu9T7Xb_qt7PgpLdEvWGbcWJccCgmlkgnY0gmlwhKwSUGWKbXVsdGlhZGRyc5YACASsElBlBrsJAAoErBJQZQa7Ct0DgnJzhQADAQAAiXNlY3AyNTZrMaEDK-mYED92j9jyMMdHjBf-hUUCf2Z6kAH-2Dumf2MB6daDdGNwgrsJg3VkcIK7C4V3YWt1MgE"}'
2026-01-31 04:29:52.926 INFO [src.node.waku_node] REST service is ready !!
2026-01-31 04:29:52.926 DEBUG [src.node.waku_node] Starting Node...
2026-01-31 04:29:52.927 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-01-31 04:29:52.928 DEBUG [src.node.docker_mananger] Network waku already exists
2026-01-31 04:29:52.928 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.80.82
2026-01-31 04:29:52.928 DEBUG [src.node.docker_mananger] Generated ports ['16788', '16789', '16790', '16791', '16792']
2026-01-31 04:29:52.929 DEBUG [src.node.waku_node] RLN credentials were not set
2026-01-31 04:29:52.929 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-01-31 04:29:52.929 DEBUG [src.node.waku_node] Using volumes []
2026-01-31 04:29:52.929 DEBUG [src.node.docker_mananger] docker run -i -t -p 16788:16788 -p 16789:16789 -p 16790:16790 -p 16791:16791 -p 16792:16792 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16790 --rest-port=16788 --tcp-port=16789 --discv5-udp-port=16791 --rest-address=0.0.0.0 --nat=extip:172.18.80.82 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=661f511f7b2b9cc1888aaeaaf7faad6aba0b3159e55fa877aaab3b6cdddbb9eb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16792 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QE0DFxe29h1MUvhREZjt62L1LJKmUrMIMrpvn9XmB1T0JzYgXW4i0Hr1Sw-kCOu9T7Xb_qt7PgpLdEvWGbcWJccCgmlkgnY0gmlwhKwSUGWKbXVsdGlhZGRyc5YACASsElBlBrsJAAoErBJQZQa7Ct0DgnJzhQADAQAAiXNlY3AyNTZrMaEDK-mYED92j9jyMMdHjBf-hUUCf2Z6kAH-2Dumf2MB6daDdGNwgrsJg3VkcIK7C4V3YWt1MgE
2026-01-31 04:29:53.119 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.80.82 waku 2333f139510ef0adf5fe268541a039ab29953bf5ddb2261c6825cf777740ccdd
2026-01-31 04:29:53.150 DEBUG [src.node.docker_mananger] Container started with ID 2333f139510e. Setting up logs at ./log/docker/node2_2026-01-31_04-29-49__72a1f12b-f182-4ecb-8fa3-296a09ab97f6__wakuorg_nwaku:latest.log
2026-01-31 04:29:53.150 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 16788
2026-01-31 04:29:53.151 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-01-31 04:29:54.151 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16788/health" -H "Content-Type: application/json" -d 'None'
2026-01-31 04:29:54.167 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-01-31 04:29:54.170 INFO [src.node.waku_node] Node protocols are initialized !!
2026-01-31 04:29:54.171 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16788/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-01-31 04:29:54.177 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.80.82/tcp/16789/p2p/16Uiu2HAmPi8wqhhpPbKaqghbLyZBWMzuSfv14xzonuMtG2zaNAFv","/ip4/172.18.80.82/tcp/16790/ws/p2p/16Uiu2HAmPi8wqhhpPbKaqghbLyZBWMzuSfv14xzonuMtG2zaNAFv"],"enrUri":"enr:-L24QBAEcjYvXDuB4XbJ1sE2cFMPPGn5d2Ox8Epxjv5FVy1-G3dtY4Ags9LBdmrvhkdE89g_kWaFGTQUV7oYqtITDiUCgmlkgnY0gmlwhKwSUFKKbXVsdGlhZGRyc5YACASsElBSBkGVAAoErBJQUgZBlt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDpD8EjvkEXRLELbNhuT_eFuKdoF9kEEEFjtwvkGE-FV2DdGNwgkGVg3VkcIJBl4V3YWt1MgE"}'
2026-01-31 04:29:54.177 INFO [src.node.waku_node] REST service is ready !!
2026-01-31 04:29:54.178 INFO [tests.e2e.test_network_conditions] Subscribing both nodes to relay topic
2026-01-31 04:29:54.178 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47880/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-01-31 04:29:54.182 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-31 04:29:54.182 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16788/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-01-31 04:29:54.187 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-31 04:29:54.188 INFO [tests.e2e.test_network_conditions] Waiting for autoconnection
2026-01-31 04:29:54.189 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47880/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2026-01-31 04:29:54.192 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.80.82/tcp/60470/p2p/16Uiu2HAmPi8wqhhpPbKaqghbLyZBWMzuSfv14xzonuMtG2zaNAFv","protocols":["/ipfs/id/1.0.0","/libp2p/autonat/1.0.0","/libp2p/circuit/relay/0.2.0/hop","/vac/waku/metadata/1.0.0","/vac/waku/relay/2.0.0","/vac/waku/rendezvous/1.0.0","/ipfs/ping/1.0.0","/vac/waku/filter-push/2.0.0-beta1","/vac/waku/peer-exchange/2.0.0-alpha1"],"shards":[0],"connected":"Connected","agent":"nwaku-v0.36.0-127-ga4e44d","origin":"UnknownOrigin"}]'
2026-01-31 04:29:54.193 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16788/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2026-01-31 04:29:54.195 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.80.101/tcp/47881/p2p/16Uiu2HAmFcQUQbUhiySnBqMGpdopDsqzLzVLwDiWw8q8P8UvhLcD","protocols":["/ipfs/id/1.0.0","/libp2p/autonat/1.0.0","/libp2p/circuit/relay/0.2.0/hop","/vac/waku/metadata/1.0.0","/vac/waku/relay/2.0.0","/vac/waku/rendezvous/1.0.0","/ipfs/ping/1.0.0","/vac/waku/filter-push/2.0.0-beta1","/vac/waku/peer-exchange/2.0.0-alpha1"],"shards":[0],"connected":"Connected","agent":"nwaku-v0.36.0-127-ga4e44d","origin":"Discv5"}]'
2026-01-31 04:29:54.196 DEBUG [src.libs.common] Sleeping for 10 seconds
2026-01-31 04:30:04.196 INFO [tests.e2e.test_network_conditions] Applying 5000ms latency to node2
2026-01-31 04:30:04.198 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '3635', '-n', 'tc', 'qdisc', 'del', 'dev', 'eth0', 'root']
2026-01-31 04:30:04.224 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '3635', '-n', 'tc', 'qdisc', 'del', 'dev', 'eth0', 'root']
2026-01-31 04:30:04.235 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '3635', '-n', 'tc', 'qdisc', 'add', 'dev', 'eth0', 'root', 'netem', 'delay', '5000ms']
2026-01-31 04:30:04.300 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47880/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-01-31 04:30:04.305 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-01-31 04:30:04.306 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16788/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-01-31 04:30:14.309 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1769833804300592130,"ephemeral":false,"proof":""}]'
2026-01-31 04:30:14.311 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '3635', '-n', 'tc', 'qdisc', 'del', 'dev', 'eth0', 'root']
2026-01-31 04:30:14.322 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-01-31 04:30:14.323 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-01-31 04:30:14.324 DEBUG [src.node.waku_node] Stopping container with id 80ac32d6739a
2026-01-31 04:30:14.892 DEBUG [src.node.waku_node] Container stopped.
2026-01-31 04:30:14.893 DEBUG [src.node.waku_node] Stopping container with id 2333f139510e
2026-01-31 04:30:15.455 DEBUG [src.node.waku_node] Container stopped.
2026-01-31 04:30:15.456 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-01-31 04:30:15.482 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-01-31 04:30:15.494 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
