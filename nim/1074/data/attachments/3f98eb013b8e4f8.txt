2026-02-09 04:47:39.104 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-09 04:47:39.105 DEBUG [tests.conftest] Running test: test_main_node_relay_and_store__peer_neither_relay_nor_store with id: 2026-02-09_04-47-39__c2978045-82d9-494d-84b4-2674818d0dca
2026-02-09 04:47:39.105 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-09 04:47:39.105 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-02-09 04:47:39.117 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:47:39.117 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-02-09_04-47-39__c2978045-82d9-494d-84b4-2674818d0dca__wakuorg_nwaku:latest.log
2026-02-09 04:47:39.117 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:47:39.117 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:47:39.120 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-09 04:47:39.120 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.194.156
2026-02-09 04:47:39.120 DEBUG [src.node.docker_mananger] Generated ports ['39299', '39300', '39301', '39302', '39303']
2026-02-09 04:47:39.120 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:47:39.120 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:47:39.121 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:47:39.121 DEBUG [src.node.docker_mananger] docker run -i -t -p 39299:39299 -p 39300:39300 -p 39301:39301 -p 39302:39302 -p 39303:39303 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39301 --rest-port=39299 --tcp-port=39300 --discv5-udp-port=39302 --rest-address=0.0.0.0 --nat=extip:172.18.194.156 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5b49b2914ed0c1ee4ef4728772fbc1e4dd9696be3fd4e6f2e55d3a433c5dbdea --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39303 --metrics-logging=true --store=true --relay=true
2026-02-09 04:47:39.331 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.194.156 waku 1f837001e86453c6b6a8230478e5a7149960be76a57bc5cc7c34b22f4fcceb1e
2026-02-09 04:47:39.352 ERROR [src.node.docker_mananger] Max retries reached for container beab7c9c2180. Exiting log stream.
2026-02-09 04:47:39.363 DEBUG [src.node.docker_mananger] Container started with ID 1f837001e864. Setting up logs at ./log/docker/publishing_node1_2026-02-09_04-47-39__c2978045-82d9-494d-84b4-2674818d0dca__wakuorg_nwaku:latest.log
2026-02-09 04:47:39.364 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 39299
2026-02-09 04:47:39.364 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:47:40.078 ERROR [src.node.docker_mananger] Max retries reached for container 03de3f49d4ae. Exiting log stream.
2026-02-09 04:47:40.365 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39299/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:47:40.369 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:47:40.369 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:47:40.370 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39299/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:47:40.373 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.194.156/tcp/39300/p2p/16Uiu2HAmDANWVRoo49GVvQe1KcW5RG9PBKasrqt5Pcgem5qZthiU","/ip4/172.18.194.156/tcp/39301/ws/p2p/16Uiu2HAmDANWVRoo49GVvQe1KcW5RG9PBKasrqt5Pcgem5qZthiU"],"enrUri":"enr:-L24QJ5DHh10-7Y4roL9k4N9jTcxfzg0NUgIhNfdn_e4f75BTXB0koF7BwlNtxIiNI_Gn-Lnf8Jgs1m2AnMFGc-Sn6cCgmlkgnY0gmlwhKwSwpyKbXVsdGlhZGRyc5YACASsEsKcBpmEAAoErBLCnAaZhd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDB4bl-BAR2QnOvXy_wUxGmG6BOJjXy_qZA_d3Id712v2DdGNwgpmEg3VkcIKZhoV3YWt1MgM"}'
2026-02-09 04:47:40.373 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:47:40.381 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:47:40.381 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-02-09_04-47-39__c2978045-82d9-494d-84b4-2674818d0dca__wakuorg_nwaku:latest.log
2026-02-09 04:47:40.381 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:47:40.381 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:47:40.383 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-09 04:47:40.383 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.174.50
2026-02-09 04:47:40.383 DEBUG [src.node.docker_mananger] Generated ports ['23573', '23574', '23575', '23576', '23577']
2026-02-09 04:47:40.383 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:47:40.383 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:47:40.384 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:47:40.384 DEBUG [src.node.docker_mananger] docker run -i -t -p 23573:23573 -p 23574:23574 -p 23575:23575 -p 23576:23576 -p 23577:23577 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23575 --rest-port=23573 --tcp-port=23574 --discv5-udp-port=23576 --rest-address=0.0.0.0 --nat=extip:172.18.174.50 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cbb59215af9cea00d325a221818f1dbbab3e40be81d2f5ed6ea1779fcccda0c8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23577 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QJ5DHh10-7Y4roL9k4N9jTcxfzg0NUgIhNfdn_e4f75BTXB0koF7BwlNtxIiNI_Gn-Lnf8Jgs1m2AnMFGc-Sn6cCgmlkgnY0gmlwhKwSwpyKbXVsdGlhZGRyc5YACASsEsKcBpmEAAoErBLCnAaZhd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDB4bl-BAR2QnOvXy_wUxGmG6BOJjXy_qZA_d3Id712v2DdGNwgpmEg3VkcIKZhoV3YWt1MgM --storenode=/ip4/172.18.194.156/tcp/39300/p2p/16Uiu2HAmDANWVRoo49GVvQe1KcW5RG9PBKasrqt5Pcgem5qZthiU --store=false --relay=false
2026-02-09 04:47:40.633 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.174.50 waku 98898e3a282b6e59ae92fc047d42928f6818f7c7083a3e4563c7681bdbc897ec
2026-02-09 04:47:40.663 DEBUG [src.node.docker_mananger] Container started with ID 98898e3a282b. Setting up logs at ./log/docker/store_node1_2026-02-09_04-47-39__c2978045-82d9-494d-84b4-2674818d0dca__wakuorg_nwaku:latest.log
2026-02-09 04:47:40.663 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 23573
2026-02-09 04:47:40.663 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:47:41.417 ERROR [src.node.docker_mananger] Max retries reached for container f0cc77cfbba7. Exiting log stream.
2026-02-09 04:47:41.663 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23573/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:47:41.667 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:47:41.668 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:47:41.668 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23573/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:47:41.670 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.174.50/tcp/23574/p2p/16Uiu2HAkw6yjEPkGMbWNBdyEyyxMLiV7URG2JG9KospzaL6TBUq5","/ip4/172.18.174.50/tcp/23575/ws/p2p/16Uiu2HAkw6yjEPkGMbWNBdyEyyxMLiV7URG2JG9KospzaL6TBUq5"],"enrUri":"enr:-L24QC5WxqMNJ8d_YMjEXIv-FAj2ZhY61LQVWDxdnU1EQm89VykbDLLkmpy8G0VHs2hguLkxLMXn91slmPk2Qc34FNACgmlkgnY0gmlwhKwSrjKKbXVsdGlhZGRyc5YACASsEq4yBlwWAAoErBKuMgZcF90DgnJzhQADAQAAiXNlY3AyNTZrMaECGO1oQnvELXhfHJ_iFX8UMkXMDo_9cCemD_LejwLie0CDdGNwglwWg3VkcIJcGIV3YWt1MgA"}'
2026-02-09 04:47:41.670 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:47:41.671 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23573/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.194.156/tcp/39300/p2p/16Uiu2HAmDANWVRoo49GVvQe1KcW5RG9PBKasrqt5Pcgem5qZthiU"]'
2026-02-09 04:47:41.703 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:47:41.703 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39299/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-09 04:47:41.715 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:47:41.716 DEBUG [src.steps.store] Relaying message
2026-02-09 04:47:41.717 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39299/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-09 04:47:41.722 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:47:41.722 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-09 04:47:41.923 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-09 04:47:41.923 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39299/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:47:41.926 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x5c1811a3b3175805927b3c7279ede0ace4f9b5db8ae6481fc35fa50a54e6e161"}]}'
2026-02-09 04:47:41.927 DEBUG [src.steps.store] messages length is 1
2026-02-09 04:47:41.927 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-09 04:47:41.927 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23573/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:47:41.935 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"5f61daf39e59e07583c0","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x5c1811a3b3175805927b3c7279ede0ace4f9b5db8ae6481fc35fa50a54e6e161"}]}'
2026-02-09 04:47:41.935 DEBUG [src.steps.store] messages length is 1
2026-02-09 04:47:41.937 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-09 04:47:41.938 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-09 04:47:41.938 DEBUG [src.node.waku_node] Stopping container with id 1f837001e864
2026-02-09 04:47:42.478 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:47:42.478 DEBUG [src.node.waku_node] Stopping container with id 98898e3a282b
2026-02-09 04:47:43.034 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:47:43.036 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-09 04:47:43.041 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-09 04:47:43.046 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
