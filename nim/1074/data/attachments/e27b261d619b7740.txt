2026-02-09 04:41:29.853 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-09 04:41:29.853 DEBUG [tests.conftest] Running test: test_relay_different_latency_between_two_nodes[5000] with id: 2026-02-09_04-41-29__59eaa258-487e-4a5a-beec-1343c1b8711b
2026-02-09 04:41:29.854 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-09 04:41:29.854 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-09 04:41:29.863 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:41:29.863 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-09_04-41-29__59eaa258-487e-4a5a-beec-1343c1b8711b__wakuorg_nwaku:latest.log
2026-02-09 04:41:29.869 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:41:29.870 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-09_04-41-29__59eaa258-487e-4a5a-beec-1343c1b8711b__wakuorg_nwaku:latest.log
2026-02-09 04:41:29.871 INFO [tests.e2e.test_network_conditions] Starting node1 and node2 with relay enabled
2026-02-09 04:41:29.871 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:41:29.871 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:41:29.911 DEBUG [src.node.docker_mananger] Network waku created
2026-02-09 04:41:29.911 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.188.55
2026-02-09 04:41:29.911 DEBUG [src.node.docker_mananger] Generated ports ['5413', '5414', '5415', '5416', '5417']
2026-02-09 04:41:29.912 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:41:29.912 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:41:29.912 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:41:29.912 DEBUG [src.node.docker_mananger] docker run -i -t -p 5413:5413 -p 5414:5414 -p 5415:5415 -p 5416:5416 -p 5417:5417 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=5415 --rest-port=5413 --tcp-port=5414 --discv5-udp-port=5416 --rest-address=0.0.0.0 --nat=extip:172.18.188.55 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4adf95a4ff7390f97ccb619fdcececddfaeed36f701f379da9c43da0d7f0fbf6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=5417 --metrics-logging=true --relay=true
2026-02-09 04:41:33.245 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.188.55 waku 2cf4d9dc134a8eb26dc961a4c32bb732e781bc55accbbee320ee5f50988e6600
2026-02-09 04:41:33.278 DEBUG [src.node.docker_mananger] Container started with ID 2cf4d9dc134a. Setting up logs at ./log/docker/node1_2026-02-09_04-41-29__59eaa258-487e-4a5a-beec-1343c1b8711b__wakuorg_nwaku:latest.log
2026-02-09 04:41:33.279 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 5413
2026-02-09 04:41:33.279 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:41:34.279 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5413/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:41:34.283 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:41:34.283 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:41:34.283 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5413/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:41:34.286 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.188.55/tcp/5414/p2p/16Uiu2HAm5W9jYoezCtQsHb9BCofUCJRivkDWHpqKEL4EyXetf7n3","/ip4/172.18.188.55/tcp/5415/ws/p2p/16Uiu2HAm5W9jYoezCtQsHb9BCofUCJRivkDWHpqKEL4EyXetf7n3"],"enrUri":"enr:-L24QMAqmdTpXJ2aoGjKkvKTkYaBOgRhe_GEKKZ1jk4Tgui1cttOXlBt1BmrO7rTkM_bWqG5r2n5ccRcp7Sk_myal4cCgmlkgnY0gmlwhKwSvDeKbXVsdGlhZGRyc5YACASsErw3BhUmAAoErBK8NwYVJ90DgnJzhQADAQAAiXNlY3AyNTZrMaEClbqTEwFKan8ye_Kt7N5asPShf1yNUM9vrACQ2iNCK8yDdGNwghUmg3VkcIIVKIV3YWt1MgE"}'
2026-02-09 04:41:34.286 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:41:34.286 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:41:34.286 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:41:34.288 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-09 04:41:34.288 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.76.229
2026-02-09 04:41:34.288 DEBUG [src.node.docker_mananger] Generated ports ['48573', '48574', '48575', '48576', '48577']
2026-02-09 04:41:34.288 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:41:34.288 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:41:34.288 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:41:34.288 DEBUG [src.node.docker_mananger] docker run -i -t -p 48573:48573 -p 48574:48574 -p 48575:48575 -p 48576:48576 -p 48577:48577 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48575 --rest-port=48573 --tcp-port=48574 --discv5-udp-port=48576 --rest-address=0.0.0.0 --nat=extip:172.18.76.229 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ad67b7e366a4cd561e6e0e8e95ce727e5caf1bdd89ff02baac64dbc7ad73a698 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48577 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QMAqmdTpXJ2aoGjKkvKTkYaBOgRhe_GEKKZ1jk4Tgui1cttOXlBt1BmrO7rTkM_bWqG5r2n5ccRcp7Sk_myal4cCgmlkgnY0gmlwhKwSvDeKbXVsdGlhZGRyc5YACASsErw3BhUmAAoErBK8NwYVJ90DgnJzhQADAQAAiXNlY3AyNTZrMaEClbqTEwFKan8ye_Kt7N5asPShf1yNUM9vrACQ2iNCK8yDdGNwghUmg3VkcIIVKIV3YWt1MgE
2026-02-09 04:41:34.465 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.76.229 waku 694e915931273cb5b41bf8845061f002689a63152ebb3f922be0f3d902daf8cb
2026-02-09 04:41:34.496 DEBUG [src.node.docker_mananger] Container started with ID 694e91593127. Setting up logs at ./log/docker/node2_2026-02-09_04-41-29__59eaa258-487e-4a5a-beec-1343c1b8711b__wakuorg_nwaku:latest.log
2026-02-09 04:41:34.497 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 48573
2026-02-09 04:41:34.498 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:41:35.498 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48573/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:41:35.507 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:41:35.508 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:41:35.508 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48573/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:41:35.512 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.76.229/tcp/48574/p2p/16Uiu2HAmENhtdKi4rEkEW2QwtsmkKBzdabcU52sc3Srk1hiwZkMn","/ip4/172.18.76.229/tcp/48575/ws/p2p/16Uiu2HAmENhtdKi4rEkEW2QwtsmkKBzdabcU52sc3Srk1hiwZkMn"],"enrUri":"enr:-L24QJM-Ky-p9P-_yU_KiCf3-q4f7In_-eGIqyRVn13TJg93WXMepGE4Nf3y9PnPOJm9VgQTn7M7t3rsFUGE-AkRdUkCgmlkgnY0gmlwhKwSTOWKbXVsdGlhZGRyc5YACASsEkzlBr2-AAoErBJM5Qa9v90DgnJzhQADAQAAiXNlY3AyNTZrMaEDGYt4SNS33mOC8x5DdMkdVM7RqN62rxurZ-JUAjQi-cGDdGNwgr2-g3VkcIK9wIV3YWt1MgE"}'
2026-02-09 04:41:35.513 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:41:35.513 INFO [tests.e2e.test_network_conditions] Subscribing both nodes to relay topic
2026-02-09 04:41:35.514 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:5413/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:41:35.518 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:41:35.519 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48573/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:41:35.523 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:41:35.524 INFO [tests.e2e.test_network_conditions] Waiting for autoconnection
2026-02-09 04:41:35.524 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5413/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:41:35.527 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.76.229/tcp/36542/p2p/16Uiu2HAmENhtdKi4rEkEW2QwtsmkKBzdabcU52sc3Srk1hiwZkMn","protocols":["/ipfs/id/1.0.0","/libp2p/autonat/1.0.0","/libp2p/circuit/relay/0.2.0/hop","/vac/waku/metadata/1.0.0","/vac/waku/relay/2.0.0","/vac/waku/rendezvous/1.0.0","/ipfs/ping/1.0.0","/vac/waku/filter-push/2.0.0-beta1","/vac/waku/peer-exchange/2.0.0-alpha1"],"shards":[0],"connected":"Connected","agent":"nwaku-v0.36.0-127-ga4e44d","origin":"UnknownOrigin"}]'
2026-02-09 04:41:35.527 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48573/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:41:35.530 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.188.55/tcp/5414/p2p/16Uiu2HAm5W9jYoezCtQsHb9BCofUCJRivkDWHpqKEL4EyXetf7n3","protocols":["/ipfs/id/1.0.0","/libp2p/autonat/1.0.0","/libp2p/circuit/relay/0.2.0/hop","/vac/waku/metadata/1.0.0","/vac/waku/relay/2.0.0","/vac/waku/rendezvous/1.0.0","/ipfs/ping/1.0.0","/vac/waku/filter-push/2.0.0-beta1","/vac/waku/peer-exchange/2.0.0-alpha1"],"shards":[0],"connected":"Connected","agent":"nwaku-v0.36.0-127-ga4e44d","origin":"Discv5"}]'
2026-02-09 04:41:35.530 DEBUG [src.libs.common] Sleeping for 10 seconds
2026-02-09 04:41:45.531 INFO [tests.e2e.test_network_conditions] Applying 5000ms latency to node2
2026-02-09 04:41:45.533 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '3740', '-n', 'tc', 'qdisc', 'del', 'dev', 'eth0', 'root']
2026-02-09 04:41:45.574 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '3740', '-n', 'tc', 'qdisc', 'del', 'dev', 'eth0', 'root']
2026-02-09 04:41:45.585 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '3740', '-n', 'tc', 'qdisc', 'add', 'dev', 'eth0', 'root', 'netem', 'delay', '5000ms']
2026-02-09 04:41:45.601 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:5413/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-09 04:41:45.606 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:41:45.607 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48573/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:41:55.610 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612105601582006,"ephemeral":false,"proof":""}]'
2026-02-09 04:41:55.612 INFO [src.steps.network_conditions] TC exec: ['sudo', '-n', 'nsenter', '-t', '3740', '-n', 'tc', 'qdisc', 'del', 'dev', 'eth0', 'root']
2026-02-09 04:41:55.623 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-09 04:41:55.624 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-09 04:41:55.624 DEBUG [src.node.waku_node] Stopping container with id 2cf4d9dc134a
2026-02-09 04:41:56.126 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:41:56.126 DEBUG [src.node.waku_node] Stopping container with id 694e91593127
2026-02-09 04:41:56.665 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:41:56.668 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-09 04:41:56.681 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-09 04:41:56.692 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
