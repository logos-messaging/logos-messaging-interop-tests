2026-02-09 04:43:24.050 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-09 04:43:24.050 DEBUG [tests.conftest] Running test: test_publish_with_ephemeral with id: 2026-02-09_04-43-24__f3b1f83f-068a-4534-86d4-a623cd00fe7d
2026-02-09 04:43:24.050 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-09 04:43:24.051 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-09 04:43:24.051 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2026-02-09 04:43:24.057 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:43:24.057 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-09_04-43-24__f3b1f83f-068a-4534-86d4-a623cd00fe7d__wakuorg_nwaku:latest.log
2026-02-09 04:43:24.057 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:43:24.057 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:43:24.059 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-09 04:43:24.059 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.9.130
2026-02-09 04:43:24.059 DEBUG [src.node.docker_mananger] Generated ports ['24910', '24911', '24912', '24913', '24914']
2026-02-09 04:43:24.059 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:43:24.059 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:43:24.059 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:43:24.060 DEBUG [src.node.docker_mananger] docker run -i -t -p 24910:24910 -p 24911:24911 -p 24912:24912 -p 24913:24913 -p 24914:24914 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24912 --rest-port=24910 --tcp-port=24911 --discv5-udp-port=24913 --rest-address=0.0.0.0 --nat=extip:172.18.9.130 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8d11da49ffcec6ea2becbda3ecc1a66e080c7df9fac9fd5c613855fd70cf6db5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24914 --metrics-logging=true --relay=true
2026-02-09 04:43:24.238 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.9.130 waku ce8f7a675e5a63d6b86e2aef399aa3c01f83e456279f5c2d442423d3210af6bc
2026-02-09 04:43:24.274 DEBUG [src.node.docker_mananger] Container started with ID ce8f7a675e5a. Setting up logs at ./log/docker/node1_2026-02-09_04-43-24__f3b1f83f-068a-4534-86d4-a623cd00fe7d__wakuorg_nwaku:latest.log
2026-02-09 04:43:24.275 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 24910
2026-02-09 04:43:24.275 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:43:24.356 ERROR [src.node.docker_mananger] Max retries reached for container 68ab75c6b1d7. Exiting log stream.
2026-02-09 04:43:24.853 ERROR [src.node.docker_mananger] Max retries reached for container 16a8e3edd442. Exiting log stream.
2026-02-09 04:43:25.275 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24910/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:43:25.279 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:43:25.279 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:43:25.279 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24910/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:43:25.281 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.9.130/tcp/24911/p2p/16Uiu2HAm2RqxMvgrf7VTGrosZmiVtfvEm9maFNRFE3EezsNRFWhu","/ip4/172.18.9.130/tcp/24912/ws/p2p/16Uiu2HAm2RqxMvgrf7VTGrosZmiVtfvEm9maFNRFE3EezsNRFWhu"],"enrUri":"enr:-L24QHeGHTO1itOIgY4nInpoWGZvq98CHQx8s9wp8SCQKi2XKH4-WqLsbD5LywABEwyr2I4ESNsxzXBwRS444SHHZSoCgmlkgnY0gmlwhKwSCYKKbXVsdGlhZGRyc5YACASsEgmCBmFPAAoErBIJggZhUN0DgnJzhQADAQAAiXNlY3AyNTZrMaECaA0WbVCh4gY-TF79_l5jF0sAjPVuALHatyImdLHNKiiDdGNwgmFPg3VkcIJhUYV3YWt1MgE"}'
2026-02-09 04:43:25.281 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:43:25.287 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:43:25.287 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-09_04-43-24__f3b1f83f-068a-4534-86d4-a623cd00fe7d__wakuorg_nwaku:latest.log
2026-02-09 04:43:25.288 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:43:25.288 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:43:25.289 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-09 04:43:25.289 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.38.77
2026-02-09 04:43:25.289 DEBUG [src.node.docker_mananger] Generated ports ['23124', '23125', '23126', '23127', '23128']
2026-02-09 04:43:25.289 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:43:25.290 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:43:25.290 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:43:25.290 DEBUG [src.node.docker_mananger] docker run -i -t -p 23124:23124 -p 23125:23125 -p 23126:23126 -p 23127:23127 -p 23128:23128 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23126 --rest-port=23124 --tcp-port=23125 --discv5-udp-port=23127 --rest-address=0.0.0.0 --nat=extip:172.18.38.77 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=22abb916eca0f05c4abd1bf63f837232b0ecdc9bfe997581c1e7c8ee5c9bcaeb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23128 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QHeGHTO1itOIgY4nInpoWGZvq98CHQx8s9wp8SCQKi2XKH4-WqLsbD5LywABEwyr2I4ESNsxzXBwRS444SHHZSoCgmlkgnY0gmlwhKwSCYKKbXVsdGlhZGRyc5YACASsEgmCBmFPAAoErBIJggZhUN0DgnJzhQADAQAAiXNlY3AyNTZrMaECaA0WbVCh4gY-TF79_l5jF0sAjPVuALHatyImdLHNKiiDdGNwgmFPg3VkcIJhUYV3YWt1MgE
2026-02-09 04:43:25.467 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.38.77 waku c5ec11d5b364fd3b3975f062dcd9c4e8c75c43dcc4f7db671f9a965309750df2
2026-02-09 04:43:25.497 DEBUG [src.node.docker_mananger] Container started with ID c5ec11d5b364. Setting up logs at ./log/docker/node2_2026-02-09_04-43-24__f3b1f83f-068a-4534-86d4-a623cd00fe7d__wakuorg_nwaku:latest.log
2026-02-09 04:43:25.497 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 23124
2026-02-09 04:43:25.497 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:43:26.499 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23124/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:43:26.515 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:43:26.516 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:43:26.516 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23124/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:43:26.520 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.38.77/tcp/23125/p2p/16Uiu2HAmSq6UQptWLr2P4DUUXip5Ah9E1eYq2dpYqGHquoV4D7tS","/ip4/172.18.38.77/tcp/23126/ws/p2p/16Uiu2HAmSq6UQptWLr2P4DUUXip5Ah9E1eYq2dpYqGHquoV4D7tS"],"enrUri":"enr:-L24QKFptyEc1GoW4W5lZHat6EEJUDHjxAXGS1V1jk6mrQdvTKZZrG9cfWPDmjLlkoBKCaxH5xxB0tvOJNvCUQ2bQFICgmlkgnY0gmlwhKwSJk2KbXVsdGlhZGRyc5YACASsEiZNBlpVAAoErBImTQZaVt0DgnJzhQADAQAAiXNlY3AyNTZrMaED0ppZHk0Hjw8Ft4ED_vpfOIku3mw9mq6s_hXLlkq6No-DdGNwglpVg3VkcIJaV4V3YWt1MgE"}'
2026-02-09 04:43:26.520 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:43:26.521 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23124/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.9.130/tcp/24911/p2p/16Uiu2HAm2RqxMvgrf7VTGrosZmiVtfvEm9maFNRFE3EezsNRFWhu"]'
2026-02-09 04:43:26.526 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:43:26.528 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2026-02-09 04:43:26.528 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24910/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:43:26.531 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:43:26.532 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23124/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:43:26.535 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:43:26.537 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-09 04:43:26.544 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:43:26.544 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-09 04:43:26.644 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-09 04:43:26.644 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:43:26.647 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612206537241344,"ephemeral":false,"proof":""}]'
2026-02-09 04:43:26.649 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-09 04:43:26.649 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23124/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:43:26.651 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612206537241344,"ephemeral":false,"proof":""}]'
2026-02-09 04:43:26.652 INFO [src.steps.relay] WARM UP successful!!
2026-02-09 04:43:26.653 DEBUG [tests.relay.test_publish] Running test with Ephemeral True
2026-02-09 04:43:26.654 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
2026-02-09 04:43:26.657 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:43:26.658 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-09 04:43:26.758 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-09 04:43:26.758 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:43:26.760 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612206654012719,"ephemeral":true,"proof":""}]'
2026-02-09 04:43:26.762 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-09 04:43:26.762 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23124/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:43:26.764 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612206654012719,"ephemeral":true,"proof":""}]'
2026-02-09 04:43:26.765 DEBUG [tests.relay.test_publish] Running test with Ephemeral False
2026-02-09 04:43:26.766 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
2026-02-09 04:43:26.770 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:43:26.770 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-09 04:43:26.871 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-09 04:43:26.871 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24910/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:43:26.873 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612206766163444,"ephemeral":false,"proof":""}]'
2026-02-09 04:43:26.874 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-09 04:43:26.874 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23124/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:43:26.877 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612206766163444,"ephemeral":false,"proof":""}]'
2026-02-09 04:43:26.880 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-09 04:43:26.881 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-09 04:43:26.881 DEBUG [src.node.waku_node] Stopping container with id ce8f7a675e5a
2026-02-09 04:43:27.416 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:43:27.417 DEBUG [src.node.waku_node] Stopping container with id c5ec11d5b364
2026-02-09 04:43:27.981 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:43:27.984 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-09 04:43:27.989 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-09 04:43:27.995 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
