2026-02-09 04:47:04.972 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-09 04:47:04.973 DEBUG [tests.conftest] Running test: test_cant_retrieve_messages_on_not_subscribed_content_topic with id: 2026-02-09_04-47-04__a7d3fd1f-d476-4294-a85f-cc7f99ed5349
2026-02-09 04:47:04.973 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-09 04:47:04.973 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-09 04:47:04.973 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-09 04:47:04.981 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:47:04.981 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-09_04-47-04__a7d3fd1f-d476-4294-a85f-cc7f99ed5349__wakuorg_nwaku:latest.log
2026-02-09 04:47:04.981 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:47:04.982 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:47:04.983 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-09 04:47:04.983 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.142.202
2026-02-09 04:47:04.983 DEBUG [src.node.docker_mananger] Generated ports ['58851', '58852', '58853', '58854', '58855']
2026-02-09 04:47:04.984 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:47:04.984 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:47:04.984 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:47:04.984 DEBUG [src.node.docker_mananger] docker run -i -t -p 58851:58851 -p 58852:58852 -p 58853:58853 -p 58854:58854 -p 58855:58855 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58853 --rest-port=58851 --tcp-port=58852 --discv5-udp-port=58854 --rest-address=0.0.0.0 --nat=extip:172.18.142.202 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=ccb39bac146e0c64e080bd86d86479947cfb71cd313b1c49a5eb073db2853ba8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58855 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto --num-shards-in-network=8
2026-02-09 04:47:05.178 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.142.202 waku 7bd749649f76971c5dccaa2356962c2726315ffea7922343214686410825ba49
2026-02-09 04:47:05.209 DEBUG [src.node.docker_mananger] Container started with ID 7bd749649f76. Setting up logs at ./log/docker/node1_2026-02-09_04-47-04__a7d3fd1f-d476-4294-a85f-cc7f99ed5349__wakuorg_nwaku:latest.log
2026-02-09 04:47:05.210 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 58851
2026-02-09 04:47:05.211 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:47:05.781 ERROR [src.node.docker_mananger] Max retries reached for container 693a0f105b90. Exiting log stream.
2026-02-09 04:47:06.211 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58851/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:47:06.214 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:47:06.215 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:47:06.215 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58851/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:47:06.217 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.142.202/tcp/58852/p2p/16Uiu2HAmUUAvCVgSFXv3UPhPJR8uW1Qu2WoBYPF2SF348bjUfTWy","/ip4/172.18.142.202/tcp/58853/ws/p2p/16Uiu2HAmUUAvCVgSFXv3UPhPJR8uW1Qu2WoBYPF2SF348bjUfTWy"],"enrUri":"enr:-L24QA3bm3P6SRXtnLmuk75XOA9WDCK8LG0X4QIqFGaXoRX4CgUET-Lg9gqgqSoHixCnFUGkYKzkEZOwvOLNGULdTZkCgmlkgnY0gmlwhKwSjsqKbXVsdGlhZGRyc5YACASsEo7KBuXkAAoErBKOygbl5d0DgnJzhQACAQAAiXNlY3AyNTZrMaED6vWM7rfKnglXqb4FUxUFqgj430dvEYd1TRKN0Jrm0FKDdGNwguXkg3VkcILl5oV3YWt1MgU"}'
2026-02-09 04:47:06.218 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:47:06.225 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:47:06.225 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-09_04-47-04__a7d3fd1f-d476-4294-a85f-cc7f99ed5349__wakuorg_nwaku:latest.log
2026-02-09 04:47:06.225 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:47:06.225 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:47:06.227 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-09 04:47:06.227 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.132.77
2026-02-09 04:47:06.227 DEBUG [src.node.docker_mananger] Generated ports ['59274', '59275', '59276', '59277', '59278']
2026-02-09 04:47:06.227 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:47:06.227 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:47:06.227 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:47:06.227 DEBUG [src.node.docker_mananger] docker run -i -t -p 59274:59274 -p 59275:59275 -p 59276:59276 -p 59277:59277 -p 59278:59278 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59276 --rest-port=59274 --tcp-port=59275 --discv5-udp-port=59277 --rest-address=0.0.0.0 --nat=extip:172.18.132.77 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=9eadbf4ee31d78bf88f47c1afbf2febb3ce4be14e6afc2fe5514b0fb1d59be90 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59278 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QA3bm3P6SRXtnLmuk75XOA9WDCK8LG0X4QIqFGaXoRX4CgUET-Lg9gqgqSoHixCnFUGkYKzkEZOwvOLNGULdTZkCgmlkgnY0gmlwhKwSjsqKbXVsdGlhZGRyc5YACASsEo7KBuXkAAoErBKOygbl5d0DgnJzhQACAQAAiXNlY3AyNTZrMaED6vWM7rfKnglXqb4FUxUFqgj430dvEYd1TRKN0Jrm0FKDdGNwguXkg3VkcILl5oV3YWt1MgU --content-topic=/myapp/1/latest/proto --num-shards-in-network=8
2026-02-09 04:47:06.416 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.132.77 waku 9f3cdef630a7ba8bec46e2c967e0a2d3b9681fd8dc5a1271edb3ac8a8bc8ed7d
2026-02-09 04:47:06.453 DEBUG [src.node.docker_mananger] Container started with ID 9f3cdef630a7. Setting up logs at ./log/docker/node2_2026-02-09_04-47-04__a7d3fd1f-d476-4294-a85f-cc7f99ed5349__wakuorg_nwaku:latest.log
2026-02-09 04:47:06.453 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 59274
2026-02-09 04:47:06.453 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:47:07.454 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59274/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:47:07.463 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-09 04:47:07.466 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:47:07.468 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59274/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:47:07.471 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.132.77/tcp/59275/p2p/16Uiu2HAmAkwXDnYgtaUAeg1RFMhNu3WEkDsbVe8YejLJBYFKWDoq","/ip4/172.18.132.77/tcp/59276/ws/p2p/16Uiu2HAmAkwXDnYgtaUAeg1RFMhNu3WEkDsbVe8YejLJBYFKWDoq"],"enrUri":"enr:-L24QFKUcUFIMWbYYwfg9JDHTymnqRP-FjgvFZE_AOdGUbR0V0m1j56JnE8jcEJcqzCezNJeA7B_9qAST5hqQbFe1_MCgmlkgnY0gmlwhKwShE2KbXVsdGlhZGRyc5YACASsEoRNBueLAAoErBKETQbnjN0DgnJzhQACAQAAiXNlY3AyNTZrMaEC487pmbttJElcdHMDAMwx9evhJz8we-kx6Xtg2k8CYnSDdGNwgueLg3VkcILnjYV3YWt1MgE"}'
2026-02-09 04:47:07.471 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:47:07.472 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59274/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.142.202/tcp/58852/p2p/16Uiu2HAmUUAvCVgSFXv3UPhPJR8uW1Qu2WoBYPF2SF348bjUfTWy"]'
2026-02-09 04:47:07.475 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:47:07.475 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58851/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
2026-02-09 04:47:07.478 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:47:07.478 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59274/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
2026-02-09 04:47:07.480 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:47:07.481 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58851/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/toychat/2/huilong/proto", "timestamp": '$(date +%s%N)'}'
2026-02-09 04:47:07.483 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:47:07.484 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-09 04:47:07.584 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-09 04:47:07.584 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58851/relay/v1/auto/messages/%2Ftoychat%2F2%2Fhuilong%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:47:07.587 ERROR [src.node.api_clients.base_client] HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:58851/relay/v1/auto/messages/%2Ftoychat%2F2%2Fhuilong%2Fproto. Response content: b'/toychat/2/huilong/proto'
2026-02-09 04:47:07.590 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-09 04:47:07.591 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-09 04:47:07.591 DEBUG [src.node.waku_node] Stopping container with id 7bd749649f76
2026-02-09 04:47:08.130 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:47:08.130 DEBUG [src.node.waku_node] Stopping container with id 9f3cdef630a7
2026-02-09 04:47:08.688 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:47:08.691 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-09 04:47:08.696 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-09 04:47:08.700 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
