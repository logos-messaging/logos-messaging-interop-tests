2026-02-09 04:46:35.780 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-09 04:46:35.781 DEBUG [tests.conftest] Running test: test_publish_with_payload_equal_or_more_150_kb with id: 2026-02-09_04-46-35__703add17-3243-43c2-b73b-954a2bf18259
2026-02-09 04:46:35.781 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-09 04:46:35.781 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-09 04:46:35.781 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2026-02-09 04:46:35.788 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:46:35.788 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-09_04-46-35__703add17-3243-43c2-b73b-954a2bf18259__wakuorg_nwaku:latest.log
2026-02-09 04:46:35.789 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:46:35.789 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:46:35.790 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-09 04:46:35.790 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.54.206
2026-02-09 04:46:35.790 DEBUG [src.node.docker_mananger] Generated ports ['44680', '44681', '44682', '44683', '44684']
2026-02-09 04:46:35.791 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:46:35.791 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:46:35.791 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:46:35.791 DEBUG [src.node.docker_mananger] docker run -i -t -p 44680:44680 -p 44681:44681 -p 44682:44682 -p 44683:44683 -p 44684:44684 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44682 --rest-port=44680 --tcp-port=44681 --discv5-udp-port=44683 --rest-address=0.0.0.0 --nat=extip:172.18.54.206 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8e3b21e025f6dbbdaace9073b7afcbe1adebf6401f6d31d60c3a2c6bfcbdd269 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44684 --metrics-logging=true --relay=true
2026-02-09 04:46:35.974 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.54.206 waku b74b802c27f662281a2342c513827f6a3b5e4670e68c58694035f037bfc3fa06
2026-02-09 04:46:36.008 DEBUG [src.node.docker_mananger] Container started with ID b74b802c27f6. Setting up logs at ./log/docker/node1_2026-02-09_04-46-35__703add17-3243-43c2-b73b-954a2bf18259__wakuorg_nwaku:latest.log
2026-02-09 04:46:36.010 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 44680
2026-02-09 04:46:36.010 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:46:36.023 ERROR [src.node.docker_mananger] Max retries reached for container 3d69aabb8fba. Exiting log stream.
2026-02-09 04:46:36.579 ERROR [src.node.docker_mananger] Max retries reached for container 2ccc1bdbfc61. Exiting log stream.
2026-02-09 04:46:37.010 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44680/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:46:37.014 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:46:37.014 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:46:37.014 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44680/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:46:37.017 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.54.206/tcp/44681/p2p/16Uiu2HAmSs4mChZ5Km29CFguk1bq1SXBnjNQTugnTVrCasmLyRbM","/ip4/172.18.54.206/tcp/44682/ws/p2p/16Uiu2HAmSs4mChZ5Km29CFguk1bq1SXBnjNQTugnTVrCasmLyRbM"],"enrUri":"enr:-L24QCnwAECTN1mgWaDGt4qiVPEFs9wVllRFD-RQYUk9qaSgC1thyq0ozvlGmX_iTWKbEMUIAH_ikfVXsCEBj9kU6WYCgmlkgnY0gmlwhKwSNs6KbXVsdGlhZGRyc5YACASsEjbOBq6JAAoErBI2zgauit0DgnJzhQADAQAAiXNlY3AyNTZrMaED0xuTXuU1cwamAlhgBEN_ANjAtRWHJ2B5ob3FRwxX85iDdGNwgq6Jg3VkcIKui4V3YWt1MgE"}'
2026-02-09 04:46:37.017 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:46:37.024 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:46:37.024 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-09_04-46-35__703add17-3243-43c2-b73b-954a2bf18259__wakuorg_nwaku:latest.log
2026-02-09 04:46:37.024 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:46:37.024 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:46:37.026 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-09 04:46:37.026 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.248.13
2026-02-09 04:46:37.026 DEBUG [src.node.docker_mananger] Generated ports ['36915', '36916', '36917', '36918', '36919']
2026-02-09 04:46:37.026 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:46:37.026 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:46:37.027 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:46:37.027 DEBUG [src.node.docker_mananger] docker run -i -t -p 36915:36915 -p 36916:36916 -p 36917:36917 -p 36918:36918 -p 36919:36919 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36917 --rest-port=36915 --tcp-port=36916 --discv5-udp-port=36918 --rest-address=0.0.0.0 --nat=extip:172.18.248.13 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f097a9dc0ec14b9a9112cf13bd30f1bb77fcfb8b0a1c8574ba2a5e3bddfb5dfb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36919 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QCnwAECTN1mgWaDGt4qiVPEFs9wVllRFD-RQYUk9qaSgC1thyq0ozvlGmX_iTWKbEMUIAH_ikfVXsCEBj9kU6WYCgmlkgnY0gmlwhKwSNs6KbXVsdGlhZGRyc5YACASsEjbOBq6JAAoErBI2zgauit0DgnJzhQADAQAAiXNlY3AyNTZrMaED0xuTXuU1cwamAlhgBEN_ANjAtRWHJ2B5ob3FRwxX85iDdGNwgq6Jg3VkcIKui4V3YWt1MgE
2026-02-09 04:46:37.209 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.248.13 waku 59e9e68119b6ab9c2eaf8295d7469bad0bf70af2d88d62aa450477a98296a9cd
2026-02-09 04:46:37.242 DEBUG [src.node.docker_mananger] Container started with ID 59e9e68119b6. Setting up logs at ./log/docker/node2_2026-02-09_04-46-35__703add17-3243-43c2-b73b-954a2bf18259__wakuorg_nwaku:latest.log
2026-02-09 04:46:37.242 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 36915
2026-02-09 04:46:37.242 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:46:38.243 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36915/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:46:38.250 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:46:38.251 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:46:38.253 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36915/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:46:38.256 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.248.13/tcp/36916/p2p/16Uiu2HAkvXBgxSnWqszCNVghjG2W8minxgoDANs5HEzokYtxbfiz","/ip4/172.18.248.13/tcp/36917/ws/p2p/16Uiu2HAkvXBgxSnWqszCNVghjG2W8minxgoDANs5HEzokYtxbfiz"],"enrUri":"enr:-L24QI3u_6s5IDIh649yDjJ-Kd22Qx5JyA1KANb52wb0wQWuAVSJXeD0PXP4H8cnMxelOWlMougoUExeeOz0_rL04AoCgmlkgnY0gmlwhKwS-A2KbXVsdGlhZGRyc5YACASsEvgNBpA0AAoErBL4DQaQNd0DgnJzhQADAQAAiXNlY3AyNTZrMaECEEUvELvw8P7rL2BfetqDfE0qPKmjR0LCPGEogJKUhLuDdGNwgpA0g3VkcIKQNoV3YWt1MgE"}'
2026-02-09 04:46:38.256 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:46:38.257 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36915/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.54.206/tcp/44681/p2p/16Uiu2HAmSs4mChZ5Km29CFguk1bq1SXBnjNQTugnTVrCasmLyRbM"]'
2026-02-09 04:46:38.260 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:46:38.261 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2026-02-09 04:46:38.261 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44680/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:46:38.265 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:46:38.265 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36915/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:46:38.268 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:46:38.269 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44680/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-09 04:46:38.275 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:46:38.276 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-09 04:46:38.376 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-09 04:46:38.376 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44680/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:46:38.379 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612398269664512,"ephemeral":false,"proof":""}]'
2026-02-09 04:46:38.381 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-09 04:46:38.381 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:46:38.383 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612398269664512,"ephemeral":false,"proof":""}]'
2026-02-09 04:46:38.385 INFO [src.steps.relay] WARM UP successful!!
2026-02-09 04:46:38.386 DEBUG [tests.relay.test_publish] Running test with payload length of 204800 bytes
2026-02-09 04:46:38.390 INFO [src.node.api_clients.base_client] Log line was discarded because it's longer than max_log_line_length=5000
2026-02-09 04:46:38.409 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:44680/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Failed to publish: Message size exceeded maximum of 153600 bytes'
2026-02-09 04:46:38.410 DEBUG [tests.relay.test_publish] Running test with payload length of 1048576 bytes
2026-02-09 04:46:38.429 INFO [src.node.api_clients.base_client] Log line was discarded because it's longer than max_log_line_length=5000
2026-02-09 04:46:38.507 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:44680/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Failed to publish: Message size exceeded maximum of 153600 bytes'
2026-02-09 04:46:38.508 DEBUG [tests.relay.test_publish] Running test with payload length of 10485760 bytes
2026-02-09 04:46:38.651 INFO [src.node.api_clients.base_client] Log line was discarded because it's longer than max_log_line_length=5000
2026-02-09 04:46:39.346 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:44680/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Failed to publish: Message size exceeded maximum of 153600 bytes'
2026-02-09 04:46:39.349 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-09 04:46:39.350 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-09 04:46:39.351 DEBUG [src.node.waku_node] Stopping container with id b74b802c27f6
2026-02-09 04:46:39.890 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:46:39.891 DEBUG [src.node.waku_node] Stopping container with id 59e9e68119b6
2026-02-09 04:46:40.438 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:46:40.439 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-09 04:46:40.449 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-09 04:46:40.454 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
