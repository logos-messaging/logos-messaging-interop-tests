2026-02-09 04:45:30.986 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-09 04:45:30.986 DEBUG [tests.conftest] Running test: test_message_relayed_while_store_node_is_stopped_without_removing with id: 2026-02-09_04-45-30__a0017a40-d03a-4b1a-b9b6-99ca45c99da4
2026-02-09 04:45:30.987 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-09 04:45:30.987 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-02-09 04:45:30.993 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:45:30.994 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-02-09_04-45-30__a0017a40-d03a-4b1a-b9b6-99ca45c99da4__wakuorg_nwaku:latest.log
2026-02-09 04:45:30.994 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:45:30.994 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:45:30.995 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-09 04:45:30.995 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.124.137
2026-02-09 04:45:30.995 DEBUG [src.node.docker_mananger] Generated ports ['7276', '7277', '7278', '7279', '7280']
2026-02-09 04:45:30.995 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:45:30.996 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:45:30.996 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:45:30.996 DEBUG [src.node.docker_mananger] docker run -i -t -p 7276:7276 -p 7277:7277 -p 7278:7278 -p 7279:7279 -p 7280:7280 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=7278 --rest-port=7276 --tcp-port=7277 --discv5-udp-port=7279 --rest-address=0.0.0.0 --nat=extip:172.18.124.137 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a3830e0fda3a2a6e4368fccb7cff23f44cb5b804c00ffaffad1e95ccf1fd502a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=7280 --metrics-logging=true --store=true --relay=true
2026-02-09 04:45:31.169 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.124.137 waku 71a982fd0cefc44c8d2f92abc7890ba9be5c920f2ab2800fdbedf2c021207270
2026-02-09 04:45:31.204 DEBUG [src.node.docker_mananger] Container started with ID 71a982fd0cef. Setting up logs at ./log/docker/publishing_node1_2026-02-09_04-45-30__a0017a40-d03a-4b1a-b9b6-99ca45c99da4__wakuorg_nwaku:latest.log
2026-02-09 04:45:31.205 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 7276
2026-02-09 04:45:31.207 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:45:31.245 ERROR [src.node.docker_mananger] Max retries reached for container 9ef7769b66f0. Exiting log stream.
2026-02-09 04:45:31.782 ERROR [src.node.docker_mananger] Max retries reached for container d8e19d7775fe. Exiting log stream.
2026-02-09 04:45:32.208 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7276/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:45:32.211 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:45:32.212 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:45:32.212 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7276/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:45:32.214 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.124.137/tcp/7277/p2p/16Uiu2HAmKHEfU1KY4t2BkbsQM4PPaAcCyJRVDRhDdkiLayx1PSJr","/ip4/172.18.124.137/tcp/7278/ws/p2p/16Uiu2HAmKHEfU1KY4t2BkbsQM4PPaAcCyJRVDRhDdkiLayx1PSJr"],"enrUri":"enr:-L24QHtaGdSnIXD50COWVlzCbui0Ossi_Yq9djnuW3FsuqaAHr8rd5ZUUIj_UKFiuxIhSGi-L9-6wIwaLDv0_aqUq9cCgmlkgnY0gmlwhKwSfImKbXVsdGlhZGRyc5YACASsEnyJBhxtAAoErBJ8iQYcbt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDYm83ArbtNLaHhdLWTZ2LL4U8QbXHExEiK8a_x_urEt-DdGNwghxtg3VkcIIcb4V3YWt1MgM"}'
2026-02-09 04:45:32.214 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:45:32.221 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:45:32.221 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-02-09_04-45-30__a0017a40-d03a-4b1a-b9b6-99ca45c99da4__wakuorg_nwaku:latest.log
2026-02-09 04:45:32.221 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:45:32.221 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:45:32.222 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-09 04:45:32.223 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.19.61
2026-02-09 04:45:32.223 DEBUG [src.node.docker_mananger] Generated ports ['19084', '19085', '19086', '19087', '19088']
2026-02-09 04:45:32.223 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:45:32.223 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:45:32.223 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:45:32.223 DEBUG [src.node.docker_mananger] docker run -i -t -p 19084:19084 -p 19085:19085 -p 19086:19086 -p 19087:19087 -p 19088:19088 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=19086 --rest-port=19084 --tcp-port=19085 --discv5-udp-port=19087 --rest-address=0.0.0.0 --nat=extip:172.18.19.61 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=833ea0eb320bfbe6c572c4af8fb2cb7c5fb52cac913c335ea3dffef66ebbdda0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=19088 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QHtaGdSnIXD50COWVlzCbui0Ossi_Yq9djnuW3FsuqaAHr8rd5ZUUIj_UKFiuxIhSGi-L9-6wIwaLDv0_aqUq9cCgmlkgnY0gmlwhKwSfImKbXVsdGlhZGRyc5YACASsEnyJBhxtAAoErBJ8iQYcbt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDYm83ArbtNLaHhdLWTZ2LL4U8QbXHExEiK8a_x_urEt-DdGNwghxtg3VkcIIcb4V3YWt1MgM --storenode=/ip4/172.18.124.137/tcp/7277/p2p/16Uiu2HAmKHEfU1KY4t2BkbsQM4PPaAcCyJRVDRhDdkiLayx1PSJr --store=false --relay=false
2026-02-09 04:45:32.398 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.19.61 waku e066d108596f210bc7ba193fd0b6da1c2cb3fa901a9dff6a57b11d1d03a87d0f
2026-02-09 04:45:32.425 DEBUG [src.node.docker_mananger] Container started with ID e066d108596f. Setting up logs at ./log/docker/store_node1_2026-02-09_04-45-30__a0017a40-d03a-4b1a-b9b6-99ca45c99da4__wakuorg_nwaku:latest.log
2026-02-09 04:45:32.425 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 19084
2026-02-09 04:45:32.425 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:45:33.427 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19084/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:45:33.430 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:45:33.431 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:45:33.431 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19084/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:45:33.433 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.19.61/tcp/19085/p2p/16Uiu2HAmJJTkDvLaLDC3NW3TehSV7oagbog8a2zTP7bvj3p7VNk7","/ip4/172.18.19.61/tcp/19086/ws/p2p/16Uiu2HAmJJTkDvLaLDC3NW3TehSV7oagbog8a2zTP7bvj3p7VNk7"],"enrUri":"enr:-L24QDLfkYKsezzFubyqYffXaLQlQhwczelxGCrCVzPqCGbkKvGiKazuNfb-EQ70WnLXUuzDQyJC8yVTE_76tvcbQZACgmlkgnY0gmlwhKwSEz2KbXVsdGlhZGRyc5YACASsEhM9BkqNAAoErBITPQZKjt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDU-PmkU3rx8-om5DkGXhKEMXZtHftITA-EnZQnxYAd1iDdGNwgkqNg3VkcIJKj4V3YWt1MgA"}'
2026-02-09 04:45:33.433 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:45:33.433 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19084/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.124.137/tcp/7277/p2p/16Uiu2HAmKHEfU1KY4t2BkbsQM4PPaAcCyJRVDRhDdkiLayx1PSJr"]'
2026-02-09 04:45:33.465 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:45:33.466 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:7276/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-09 04:45:33.478 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:45:33.479 DEBUG [src.steps.store] Relaying message
2026-02-09 04:45:33.481 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:7276/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-09 04:45:33.487 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:45:33.487 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-09 04:45:33.688 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-09 04:45:33.688 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7276/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:45:33.691 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3b81b0b6c8c3b039a99116921baf2d7ea31f6b8f100d9889dd0ab763f3cdb069"}]}'
2026-02-09 04:45:33.691 DEBUG [src.steps.store] messages length is 1
2026-02-09 04:45:33.691 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-09 04:45:33.692 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19084/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:45:33.699 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"3c419486c39b6e83c0f6","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3b81b0b6c8c3b039a99116921baf2d7ea31f6b8f100d9889dd0ab763f3cdb069"}]}'
2026-02-09 04:45:33.699 DEBUG [src.steps.store] messages length is 1
2026-02-09 04:45:34.192 DEBUG [src.steps.store] Relaying message
2026-02-09 04:45:34.192 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:7276/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-09 04:45:34.198 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:45:34.199 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-09 04:45:34.593 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19084/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:45:34.696 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19084/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:45:34.699 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:45:34.699 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:45:34.700 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19084/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:45:34.702 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.19.61/tcp/19085/p2p/16Uiu2HAmJJTkDvLaLDC3NW3TehSV7oagbog8a2zTP7bvj3p7VNk7","/ip4/172.18.19.61/tcp/19086/ws/p2p/16Uiu2HAmJJTkDvLaLDC3NW3TehSV7oagbog8a2zTP7bvj3p7VNk7"],"enrUri":"enr:-L24QDLfkYKsezzFubyqYffXaLQlQhwczelxGCrCVzPqCGbkKvGiKazuNfb-EQ70WnLXUuzDQyJC8yVTE_76tvcbQZACgmlkgnY0gmlwhKwSEz2KbXVsdGlhZGRyc5YACASsEhM9BkqNAAoErBITPQZKjt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDU-PmkU3rx8-om5DkGXhKEMXZtHftITA-EnZQnxYAd1iDdGNwgkqNg3VkcIJKj4V3YWt1MgA"}'
2026-02-09 04:45:34.702 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:45:34.703 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7276/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:45:34.705 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3b81b0b6c8c3b039a99116921baf2d7ea31f6b8f100d9889dd0ab763f3cdb069"},{"messageHash":"0x7396bab989676a79dff43d3c98dbd1989f4d83bded3ad1760e4e4c2c5c50e639"}]}'
2026-02-09 04:45:34.705 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19084/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:45:34.742 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"562ea70abd0dc071e9e9","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3b81b0b6c8c3b039a99116921baf2d7ea31f6b8f100d9889dd0ab763f3cdb069"},{"messageHash":"0x7396bab989676a79dff43d3c98dbd1989f4d83bded3ad1760e4e4c2c5c50e639"}]}'
2026-02-09 04:45:34.745 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-09 04:45:34.751 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-09 04:45:34.751 DEBUG [src.node.waku_node] Stopping container with id 71a982fd0cef
2026-02-09 04:45:35.279 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:45:35.279 DEBUG [src.node.waku_node] Stopping container with id e066d108596f
2026-02-09 04:45:35.807 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:45:35.810 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-09 04:45:35.826 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-09 04:45:35.900 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
