2026-02-09 04:42:05.683 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-09 04:42:05.684 DEBUG [tests.conftest] Running test: test_relay_resubscribe_to_unsubscribed_pubsub_topic with id: 2026-02-09_04-42-05__1f5dfa84-8436-4611-9e30-be0c35ecdca0
2026-02-09 04:42:05.684 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-09 04:42:05.684 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-09 04:42:05.684 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2026-02-09 04:42:05.691 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:42:05.691 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-09_04-42-05__1f5dfa84-8436-4611-9e30-be0c35ecdca0__wakuorg_nwaku:latest.log
2026-02-09 04:42:05.691 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:42:05.692 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:42:05.693 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-09 04:42:05.694 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.202.65
2026-02-09 04:42:05.694 DEBUG [src.node.docker_mananger] Generated ports ['59933', '59934', '59935', '59936', '59937']
2026-02-09 04:42:05.694 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:42:05.694 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:42:05.694 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:42:05.694 DEBUG [src.node.docker_mananger] docker run -i -t -p 59933:59933 -p 59934:59934 -p 59935:59935 -p 59936:59936 -p 59937:59937 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59935 --rest-port=59933 --tcp-port=59934 --discv5-udp-port=59936 --rest-address=0.0.0.0 --nat=extip:172.18.202.65 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1cfbfcced6cea4fbf5fcfbeb7daa45e18ac9a06ae1021fffa9cafbaad7d403cc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59937 --metrics-logging=true --relay=true
2026-02-09 04:42:05.890 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.202.65 waku e095bc6d97e577a95b5e145608393ff9dcbfa3b81c6439ccc121f8d70be70a9c
2026-02-09 04:42:05.925 DEBUG [src.node.docker_mananger] Container started with ID e095bc6d97e5. Setting up logs at ./log/docker/node1_2026-02-09_04-42-05__1f5dfa84-8436-4611-9e30-be0c35ecdca0__wakuorg_nwaku:latest.log
2026-02-09 04:42:05.925 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 59933
2026-02-09 04:42:05.926 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:42:05.933 ERROR [src.node.docker_mananger] Max retries reached for container 04638f0d3c6a. Exiting log stream.
2026-02-09 04:42:06.486 ERROR [src.node.docker_mananger] Max retries reached for container 50c9939e7ce9. Exiting log stream.
2026-02-09 04:42:06.926 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59933/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:06.929 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:42:06.930 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:42:06.930 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59933/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:06.932 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.202.65/tcp/59934/p2p/16Uiu2HAmV9zs3URNGYyNhCEEdLgQJMmAgtZYZ1ZCeeSeAAjL2NDU","/ip4/172.18.202.65/tcp/59935/ws/p2p/16Uiu2HAmV9zs3URNGYyNhCEEdLgQJMmAgtZYZ1ZCeeSeAAjL2NDU"],"enrUri":"enr:-L24QOQwzFA5tf0xZ0nwledBNnmzTFLq0cX3tY4XGRXYbp5cXP0aub3x9FHk9BH8fjSkedgsuEGHVjhxwLQmo8IdTaECgmlkgnY0gmlwhKwSykGKbXVsdGlhZGRyc5YACASsEspBBuoeAAoErBLKQQbqH90DgnJzhQADAQAAiXNlY3AyNTZrMaED9SlqEV1SJ3wHt_34eau8u_v6Lhe8K6SH4t9XEjxKZx-DdGNwguoeg3VkcILqIIV3YWt1MgE"}'
2026-02-09 04:42:06.932 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:42:06.939 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:42:06.939 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-09_04-42-05__1f5dfa84-8436-4611-9e30-be0c35ecdca0__wakuorg_nwaku:latest.log
2026-02-09 04:42:06.939 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:42:06.940 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:42:06.941 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-09 04:42:06.941 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.3.126
2026-02-09 04:42:06.941 DEBUG [src.node.docker_mananger] Generated ports ['15922', '15923', '15924', '15925', '15926']
2026-02-09 04:42:06.942 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:42:06.942 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:42:06.942 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:42:06.942 DEBUG [src.node.docker_mananger] docker run -i -t -p 15922:15922 -p 15923:15923 -p 15924:15924 -p 15925:15925 -p 15926:15926 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15924 --rest-port=15922 --tcp-port=15923 --discv5-udp-port=15925 --rest-address=0.0.0.0 --nat=extip:172.18.3.126 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=be3a3f5e37e7eae212afcebeccaf0f33f33a80d3d407dd3fefdd0be899218e52 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15926 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QOQwzFA5tf0xZ0nwledBNnmzTFLq0cX3tY4XGRXYbp5cXP0aub3x9FHk9BH8fjSkedgsuEGHVjhxwLQmo8IdTaECgmlkgnY0gmlwhKwSykGKbXVsdGlhZGRyc5YACASsEspBBuoeAAoErBLKQQbqH90DgnJzhQADAQAAiXNlY3AyNTZrMaED9SlqEV1SJ3wHt_34eau8u_v6Lhe8K6SH4t9XEjxKZx-DdGNwguoeg3VkcILqIIV3YWt1MgE
2026-02-09 04:42:07.134 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.3.126 waku 3f30d41bf29703f2aa3a426fd3f37ce148daa21c580c7c580ab6ee30c62dbb97
2026-02-09 04:42:07.166 DEBUG [src.node.docker_mananger] Container started with ID 3f30d41bf297. Setting up logs at ./log/docker/node2_2026-02-09_04-42-05__1f5dfa84-8436-4611-9e30-be0c35ecdca0__wakuorg_nwaku:latest.log
2026-02-09 04:42:07.166 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 15922
2026-02-09 04:42:07.167 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:42:08.167 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15922/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:08.178 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:42:08.179 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:42:08.181 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15922/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:08.188 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.3.126/tcp/15923/p2p/16Uiu2HAmSHTEV7AeoZFS6UKYoURzeLoeax6aoGWFt1HKEXiU55ac","/ip4/172.18.3.126/tcp/15924/ws/p2p/16Uiu2HAmSHTEV7AeoZFS6UKYoURzeLoeax6aoGWFt1HKEXiU55ac"],"enrUri":"enr:-L24QMTIpBENaf2_Cvlq4tOxVYrvQY2uijlJ2yp8I9eDFTxpGe2bPPcPR38h847Aj5WZfW_3eltK2-UW-TpGWNAfx5kCgmlkgnY0gmlwhKwSA36KbXVsdGlhZGRyc5YACASsEgN-Bj4zAAoErBIDfgY-NN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDyn88SqmS07_UeP025AUTqbmeeLfzPVZ59jskpdBAyh2DdGNwgj4zg3VkcII-NYV3YWt1MgE"}'
2026-02-09 04:42:08.188 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:42:08.189 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15922/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.202.65/tcp/59934/p2p/16Uiu2HAmV9zs3URNGYyNhCEEdLgQJMmAgtZYZ1ZCeeSeAAjL2NDU"]'
2026-02-09 04:42:08.191 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:08.192 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59933/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:42:08.196 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:08.197 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15922/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:42:08.201 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:08.202 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59933/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-09 04:42:08.207 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:08.207 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-09 04:42:08.308 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-09 04:42:08.308 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59933/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:08.311 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612128202388480,"ephemeral":false,"proof":""}]'
2026-02-09 04:42:08.313 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-09 04:42:08.313 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15922/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:08.316 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612128202388480,"ephemeral":false,"proof":""}]'
2026-02-09 04:42:08.317 INFO [src.node.api_clients.base_client] curl -v -X DELETE "http://127.0.0.1:59933/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:42:08.321 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:08.322 INFO [src.node.api_clients.base_client] curl -v -X DELETE "http://127.0.0.1:15922/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:42:08.326 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:08.327 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59933/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-09 04:42:08.330 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:59933/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Failed to publish: Node not subscribed to topic: /waku/2/rs/3/1'
2026-02-09 04:42:08.330 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59933/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:42:08.333 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:08.334 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15922/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:42:08.338 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:08.339 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59933/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-09 04:42:08.343 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:08.344 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-09 04:42:08.444 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-09 04:42:08.444 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59933/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:08.447 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612128339297331,"ephemeral":false,"proof":""}]'
2026-02-09 04:42:08.449 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-09 04:42:08.449 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15922/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:08.451 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612128339297331,"ephemeral":false,"proof":""}]'
2026-02-09 04:42:08.454 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-09 04:42:08.455 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-09 04:42:08.455 DEBUG [src.node.waku_node] Stopping container with id e095bc6d97e5
2026-02-09 04:42:09.045 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:42:09.045 DEBUG [src.node.waku_node] Stopping container with id 3f30d41bf297
2026-02-09 04:42:09.616 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:42:09.619 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-09 04:42:09.625 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-09 04:42:09.631 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
