2026-02-09 04:42:55.377 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-09 04:42:55.377 DEBUG [tests.conftest] Running test: test_relay_subscribe_to_already_existing_pubsub_topic with id: 2026-02-09_04-42-55__91021ed9-6d01-496c-9733-7abed53b46d5
2026-02-09 04:42:55.377 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-09 04:42:55.378 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-09 04:42:55.378 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2026-02-09 04:42:55.384 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:42:55.385 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-09_04-42-55__91021ed9-6d01-496c-9733-7abed53b46d5__wakuorg_nwaku:latest.log
2026-02-09 04:42:55.385 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:42:55.385 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:42:55.386 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-09 04:42:55.386 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.33.88
2026-02-09 04:42:55.387 DEBUG [src.node.docker_mananger] Generated ports ['29374', '29375', '29376', '29377', '29378']
2026-02-09 04:42:55.387 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:42:55.387 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:42:55.387 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:42:55.387 DEBUG [src.node.docker_mananger] docker run -i -t -p 29374:29374 -p 29375:29375 -p 29376:29376 -p 29377:29377 -p 29378:29378 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29376 --rest-port=29374 --tcp-port=29375 --discv5-udp-port=29377 --rest-address=0.0.0.0 --nat=extip:172.18.33.88 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a541cb0ff8ddb67b625967eb29c7c02dfddccd03bd9fa2e5b25a32593ca775a7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29378 --metrics-logging=true --relay=true
2026-02-09 04:42:55.583 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.33.88 waku d44ec5c1af686e741b259f4a1a4cdfd0b94c1bcc3d67b7d23bfeaf7e22b757df
2026-02-09 04:42:55.605 ERROR [src.node.docker_mananger] Max retries reached for container 94b3e83c76d5. Exiting log stream.
2026-02-09 04:42:55.616 DEBUG [src.node.docker_mananger] Container started with ID d44ec5c1af68. Setting up logs at ./log/docker/node1_2026-02-09_04-42-55__91021ed9-6d01-496c-9733-7abed53b46d5__wakuorg_nwaku:latest.log
2026-02-09 04:42:55.617 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 29374
2026-02-09 04:42:55.617 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:42:56.179 ERROR [src.node.docker_mananger] Max retries reached for container 890e788ff4d1. Exiting log stream.
2026-02-09 04:42:56.618 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29374/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:56.621 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:42:56.622 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:42:56.622 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29374/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:56.624 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.33.88/tcp/29375/p2p/16Uiu2HAkvWZSDiHuasDj5SpHKsVkQ3QBEn162TDrz4z6EcoKibqg","/ip4/172.18.33.88/tcp/29376/ws/p2p/16Uiu2HAkvWZSDiHuasDj5SpHKsVkQ3QBEn162TDrz4z6EcoKibqg"],"enrUri":"enr:-L24QBwXg4br8xpSoMAME29ahJ-9QTeMjGLlKKuwb05LxgnjQ5pmGkHJFfWCuZ2VWAp11P_ADcQw97kHIdSUi-NYAewCgmlkgnY0gmlwhKwSIViKbXVsdGlhZGRyc5YACASsEiFYBnK_AAoErBIhWAZywN0DgnJzhQADAQAAiXNlY3AyNTZrMaECEBww9EseDPtIcV-OJDz_8sddnj1u0dllXNy5FKeiPleDdGNwgnK_g3VkcIJywYV3YWt1MgE"}'
2026-02-09 04:42:56.624 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:42:56.631 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-09 04:42:56.631 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-09_04-42-55__91021ed9-6d01-496c-9733-7abed53b46d5__wakuorg_nwaku:latest.log
2026-02-09 04:42:56.631 DEBUG [src.node.waku_node] Starting Node...
2026-02-09 04:42:56.631 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-09 04:42:56.633 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-09 04:42:56.633 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.44.131
2026-02-09 04:42:56.633 DEBUG [src.node.docker_mananger] Generated ports ['24722', '24723', '24724', '24725', '24726']
2026-02-09 04:42:56.633 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-09 04:42:56.633 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-09 04:42:56.633 DEBUG [src.node.waku_node] Using volumes []
2026-02-09 04:42:56.634 DEBUG [src.node.docker_mananger] docker run -i -t -p 24722:24722 -p 24723:24723 -p 24724:24724 -p 24725:24725 -p 24726:24726 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24724 --rest-port=24722 --tcp-port=24723 --discv5-udp-port=24725 --rest-address=0.0.0.0 --nat=extip:172.18.44.131 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e08ad182cde4cb8e0c2f1a3e20f7bcc07f78b166aefde8d89c4085a0eaea0cfa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24726 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QBwXg4br8xpSoMAME29ahJ-9QTeMjGLlKKuwb05LxgnjQ5pmGkHJFfWCuZ2VWAp11P_ADcQw97kHIdSUi-NYAewCgmlkgnY0gmlwhKwSIViKbXVsdGlhZGRyc5YACASsEiFYBnK_AAoErBIhWAZywN0DgnJzhQADAQAAiXNlY3AyNTZrMaECEBww9EseDPtIcV-OJDz_8sddnj1u0dllXNy5FKeiPleDdGNwgnK_g3VkcIJywYV3YWt1MgE
2026-02-09 04:42:56.823 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.44.131 waku ae20c28b18a87de71736168d34e050742f43949f11a9e68f541edbead06cbe0a
2026-02-09 04:42:56.853 DEBUG [src.node.docker_mananger] Container started with ID ae20c28b18a8. Setting up logs at ./log/docker/node2_2026-02-09_04-42-55__91021ed9-6d01-496c-9733-7abed53b46d5__wakuorg_nwaku:latest.log
2026-02-09 04:42:56.853 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 24722
2026-02-09 04:42:56.853 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-09 04:42:57.854 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24722/health" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:57.869 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-09 04:42:57.872 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-09 04:42:57.872 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24722/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:57.876 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.44.131/tcp/24723/p2p/16Uiu2HAmMztkyVy1iCXcHmruvMb8oVTjFAM9oUFFbrVHYwCXr3fr","/ip4/172.18.44.131/tcp/24724/ws/p2p/16Uiu2HAmMztkyVy1iCXcHmruvMb8oVTjFAM9oUFFbrVHYwCXr3fr"],"enrUri":"enr:-L24QN-1Gf-pWWHFSp0XQbVtZS0a_L1A1P-VVlxessQ2XssgKJCDkk8Ev6uKqgvWtbEdFyV-dnKfNBZog_9hGifCwjcCgmlkgnY0gmlwhKwSLIOKbXVsdGlhZGRyc5YACASsEiyDBmCTAAoErBIsgwZglN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDitJ53Ws_QNIkFOMh6Nlr4K7EjkenSyW8iP3zJMRQzX2DdGNwgmCTg3VkcIJglYV3YWt1MgE"}'
2026-02-09 04:42:57.876 INFO [src.node.waku_node] REST service is ready !!
2026-02-09 04:42:57.877 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24722/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.33.88/tcp/29375/p2p/16Uiu2HAkvWZSDiHuasDj5SpHKsVkQ3QBEn162TDrz4z6EcoKibqg"]'
2026-02-09 04:42:57.882 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:57.884 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29374/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:42:57.888 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:57.889 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24722/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:42:57.894 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:57.895 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29374/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-09 04:42:57.900 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:57.901 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-09 04:42:58.001 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-09 04:42:58.001 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29374/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:58.004 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612177894904576,"ephemeral":false,"proof":""}]'
2026-02-09 04:42:58.006 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-09 04:42:58.006 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24722/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:58.008 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612177894904576,"ephemeral":false,"proof":""}]'
2026-02-09 04:42:58.010 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29374/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:42:58.012 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:58.013 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24722/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-09 04:42:58.015 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:58.015 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29374/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-09 04:42:58.019 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-09 04:42:58.020 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-09 04:42:58.120 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-09 04:42:58.120 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29374/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:58.123 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612178015909693,"ephemeral":false,"proof":""}]'
2026-02-09 04:42:58.124 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-09 04:42:58.125 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24722/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-09 04:42:58.127 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770612178015909693,"ephemeral":false,"proof":""}]'
2026-02-09 04:42:58.129 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-09 04:42:58.130 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-09 04:42:58.131 DEBUG [src.node.waku_node] Stopping container with id d44ec5c1af68
2026-02-09 04:42:58.670 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:42:58.670 DEBUG [src.node.waku_node] Stopping container with id ae20c28b18a8
2026-02-09 04:42:59.212 DEBUG [src.node.waku_node] Container stopped.
2026-02-09 04:42:59.213 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-09 04:42:59.219 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-09 04:42:59.225 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
