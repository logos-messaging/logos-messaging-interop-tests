2026-02-04 12:02:14.101 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 12:02:14.101 DEBUG [tests.conftest] Running test: test_retrieve_messages_without_subscribing_via_api with id: 2026-02-04_12-02-14__bd69cb22-7a98-4c57-bfdb-a0f5bb09ee3a
2026-02-04 12:02:14.102 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 12:02:14.102 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-04 12:02:14.102 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2026-02-04 12:02:14.110 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 12:02:14.110 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-04_12-02-14__bd69cb22-7a98-4c57-bfdb-a0f5bb09ee3a__wakuorg_nwaku:latest.log
2026-02-04 12:02:14.110 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 12:02:14.110 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 12:02:14.112 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 12:02:14.112 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.6.154
2026-02-04 12:02:14.112 DEBUG [src.node.docker_mananger] Generated ports ['31559', '31560', '31561', '31562', '31563']
2026-02-04 12:02:14.112 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 12:02:14.112 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 12:02:14.112 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 12:02:14.112 DEBUG [src.node.docker_mananger] docker run -i -t -p 31559:31559 -p 31560:31560 -p 31561:31561 -p 31562:31562 -p 31563:31563 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31561 --rest-port=31559 --tcp-port=31560 --discv5-udp-port=31562 --rest-address=0.0.0.0 --nat=extip:172.18.6.154 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=d451b8c6bef8be4ed912fbff84e81f66af3ebdc01e9e6932ed047b15ebc9ae23 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31563 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto --num-shards-in-network=8
2026-02-04 12:02:14.223 ERROR [src.node.docker_mananger] Max retries reached for container 8ac76611ae64. Exiting log stream.
2026-02-04 12:02:14.296 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.6.154 waku f0eda3fead3a281bd88c7e37460105b8959df723b1f50272847ba2c7c2fd922d
2026-02-04 12:02:14.326 DEBUG [src.node.docker_mananger] Container started with ID f0eda3fead3a. Setting up logs at ./log/docker/node1_2026-02-04_12-02-14__bd69cb22-7a98-4c57-bfdb-a0f5bb09ee3a__wakuorg_nwaku:latest.log
2026-02-04 12:02:14.326 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 31559
2026-02-04 12:02:14.326 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 12:02:14.766 ERROR [src.node.docker_mananger] Max retries reached for container 098371285be5. Exiting log stream.
2026-02-04 12:02:15.327 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31559/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:02:15.331 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_READY","desc":"Relay is not ready, filter will not be able to sort out messages"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 12:02:15.331 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 12:02:15.331 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31559/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:02:15.333 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.6.154/tcp/31560/p2p/16Uiu2HAmF6SU7BkhfEVdR6PL1AKSSzPfPZPvqpaUj2dN6brJpCnJ","/ip4/172.18.6.154/tcp/31561/ws/p2p/16Uiu2HAmF6SU7BkhfEVdR6PL1AKSSzPfPZPvqpaUj2dN6brJpCnJ"],"enrUri":"enr:-L24QJqCh9kGfDn6aByvuucNjFfWnCeqpg4Y9In5-X6h9rzgLNRfSXtVhJDclD6IPe9tTTaEjG6npYZawjiHTo5GrqACgmlkgnY0gmlwhKwSBpqKbXVsdGlhZGRyc5YACASsEgaaBntIAAoErBIGmgZ7Sd0DgnJzhQACAQAAiXNlY3AyNTZrMaEDJDxs3z2GL4SvYjVdYlddxFOMryEsvaASizR_ZSP9U9eDdGNwgntIg3VkcIJ7SoV3YWt1MgU"}'
2026-02-04 12:02:15.333 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 12:02:15.340 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 12:02:15.340 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-04_12-02-14__bd69cb22-7a98-4c57-bfdb-a0f5bb09ee3a__wakuorg_nwaku:latest.log
2026-02-04 12:02:15.340 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 12:02:15.340 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 12:02:15.342 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 12:02:15.342 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.29.21
2026-02-04 12:02:15.342 DEBUG [src.node.docker_mananger] Generated ports ['6414', '6415', '6416', '6417', '6418']
2026-02-04 12:02:15.342 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 12:02:15.342 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 12:02:15.343 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 12:02:15.343 DEBUG [src.node.docker_mananger] docker run -i -t -p 6414:6414 -p 6415:6415 -p 6416:6416 -p 6417:6417 -p 6418:6418 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=6416 --rest-port=6414 --tcp-port=6415 --discv5-udp-port=6417 --rest-address=0.0.0.0 --nat=extip:172.18.29.21 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=8404f5c2ad9ab4ce4fe5b72dd550a8b2dda70dcd9cda9577bdfafeecc3bffd5e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=6418 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QJqCh9kGfDn6aByvuucNjFfWnCeqpg4Y9In5-X6h9rzgLNRfSXtVhJDclD6IPe9tTTaEjG6npYZawjiHTo5GrqACgmlkgnY0gmlwhKwSBpqKbXVsdGlhZGRyc5YACASsEgaaBntIAAoErBIGmgZ7Sd0DgnJzhQACAQAAiXNlY3AyNTZrMaEDJDxs3z2GL4SvYjVdYlddxFOMryEsvaASizR_ZSP9U9eDdGNwgntIg3VkcIJ7SoV3YWt1MgU --content-topic=/myapp/1/latest/proto --num-shards-in-network=8
2026-02-04 12:02:15.546 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.29.21 waku f461b929276a0a819a247bdf6e8bad6ece4cf83dd3202c4f5e273d00d13d9a2c
2026-02-04 12:02:15.577 DEBUG [src.node.docker_mananger] Container started with ID f461b929276a. Setting up logs at ./log/docker/node2_2026-02-04_12-02-14__bd69cb22-7a98-4c57-bfdb-a0f5bb09ee3a__wakuorg_nwaku:latest.log
2026-02-04 12:02:15.578 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 6414
2026-02-04 12:02:15.578 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 12:02:16.579 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6414/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:02:16.592 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"READY"}]}'
2026-02-04 12:02:16.592 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 12:02:16.593 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6414/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:02:16.600 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.29.21/tcp/6415/p2p/16Uiu2HAmPyfoMcNnFEg77EYmcQuizJQAgNKLC3L3DkgsEud73SHh","/ip4/172.18.29.21/tcp/6416/ws/p2p/16Uiu2HAmPyfoMcNnFEg77EYmcQuizJQAgNKLC3L3DkgsEud73SHh"],"enrUri":"enr:-L24QEZkkywRmiojbQh5MjR2F8xwiW7Cu2ntdB_yxaJK0g_rJFkJk9_L7zniJrcIK16nmmpEEPa_Udl8y2wQCQJDwXECgmlkgnY0gmlwhKwSHRWKbXVsdGlhZGRyc5YACASsEh0VBhkPAAoErBIdFQYZEN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDqDmdyVHJGdMCKuw1Vcblb4z8AdqmYRErneS4v7RbuvyDdGNwghkPg3VkcIIZEYV3YWt1MgE"}'
2026-02-04 12:02:16.600 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 12:02:16.600 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6414/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.6.154/tcp/31560/p2p/16Uiu2HAmF6SU7BkhfEVdR6PL1AKSSzPfPZPvqpaUj2dN6brJpCnJ"]'
2026-02-04 12:02:16.603 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 12:02:16.604 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31559/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 12:02:16.608 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 12:02:16.609 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-04 12:02:16.709 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-04 12:02:16.710 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31559/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:02:16.712 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770206536604057262,"ephemeral":false,"proof":""}]'
2026-02-04 12:02:16.714 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-04 12:02:16.714 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6414/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:02:16.716 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770206536604057262,"ephemeral":false,"proof":""}]'
2026-02-04 12:02:16.720 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 12:02:16.721 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 12:02:16.721 DEBUG [src.node.waku_node] Stopping container with id f0eda3fead3a
2026-02-04 12:02:17.286 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 12:02:17.286 DEBUG [src.node.waku_node] Stopping container with id f461b929276a
2026-02-04 12:02:17.806 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 12:02:17.809 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 12:02:17.814 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 12:02:17.818 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
