2026-02-04 11:56:39.394 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 11:56:39.395 DEBUG [tests.conftest] Running test: test_cursor_pointing_to_deleted_message with id: 2026-02-04_11-56-39__750b8600-4d3f-4145-b990-3e85fd037903
2026-02-04 11:56:39.395 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 11:56:39.395 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-02-04 11:56:39.395 DEBUG [src.steps.store] Running fixture setup: node_setup
2026-02-04 11:56:39.403 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 11:56:39.403 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-02-04_11-56-39__750b8600-4d3f-4145-b990-3e85fd037903__wakuorg_nwaku:latest.log
2026-02-04 11:56:39.403 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 11:56:39.403 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 11:56:39.405 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 11:56:39.405 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.199.133
2026-02-04 11:56:39.405 DEBUG [src.node.docker_mananger] Generated ports ['61777', '61778', '61779', '61780', '61781']
2026-02-04 11:56:39.405 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 11:56:39.406 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 11:56:39.406 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 11:56:39.406 DEBUG [src.node.docker_mananger] docker run -i -t -p 61777:61777 -p 61778:61778 -p 61779:61779 -p 61780:61780 -p 61781:61781 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61779 --rest-port=61777 --tcp-port=61778 --discv5-udp-port=61780 --rest-address=0.0.0.0 --nat=extip:172.18.199.133 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=388bedca258f15bbd3a188017505c3ab0a1345636c01dbec9b18f6ad8a8a0aee --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61781 --metrics-logging=true --store=true --relay=true
2026-02-04 11:56:39.583 ERROR [src.node.docker_mananger] Max retries reached for container e8a2c9c53c62. Exiting log stream.
2026-02-04 11:56:39.599 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.199.133 waku 7ccbcf43614cb7f911815914ee0ff3eed891b9ce39675d357adb7e4e6f507d16
2026-02-04 11:56:39.632 DEBUG [src.node.docker_mananger] Container started with ID 7ccbcf43614c. Setting up logs at ./log/docker/publishing_node1_2026-02-04_11-56-39__750b8600-4d3f-4145-b990-3e85fd037903__wakuorg_nwaku:latest.log
2026-02-04 11:56:39.633 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 61777
2026-02-04 11:56:39.633 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 11:56:40.191 ERROR [src.node.docker_mananger] Max retries reached for container aab281d60e19. Exiting log stream.
2026-02-04 11:56:40.634 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61777/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:56:40.637 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 11:56:40.637 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 11:56:40.638 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61777/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:56:40.640 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.199.133/tcp/61778/p2p/16Uiu2HAm6xteiiqrjCt15GhNsryaHbxCSgwZB8gVhS1oQPqBVTtk","/ip4/172.18.199.133/tcp/61779/ws/p2p/16Uiu2HAm6xteiiqrjCt15GhNsryaHbxCSgwZB8gVhS1oQPqBVTtk"],"enrUri":"enr:-L24QOREw6P0kPvxdAfGa_DwYbSgorYsJo7rO6FLknIp3yzOLETikH67ZWEbXpNcBxoy-KDxCVlgPmZf4780q10EsBECgmlkgnY0gmlwhKwSx4WKbXVsdGlhZGRyc5YACASsEseFBvFSAAoErBLHhQbxU90DgnJzhQADAQAAiXNlY3AyNTZrMaECq2_jekzRKAP_AJpr5FiYB3blw4ZoOrljlxOg8qfsO2GDdGNwgvFSg3VkcILxVIV3YWt1MgM"}'
2026-02-04 11:56:40.640 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 11:56:40.648 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 11:56:40.648 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-02-04_11-56-39__750b8600-4d3f-4145-b990-3e85fd037903__wakuorg_nwaku:latest.log
2026-02-04 11:56:40.648 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 11:56:40.648 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 11:56:40.650 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 11:56:40.650 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.129.217
2026-02-04 11:56:40.650 DEBUG [src.node.docker_mananger] Generated ports ['40185', '40186', '40187', '40188', '40189']
2026-02-04 11:56:40.650 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 11:56:40.650 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 11:56:40.650 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 11:56:40.650 DEBUG [src.node.docker_mananger] docker run -i -t -p 40185:40185 -p 40186:40186 -p 40187:40187 -p 40188:40188 -p 40189:40189 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=40187 --rest-port=40185 --tcp-port=40186 --discv5-udp-port=40188 --rest-address=0.0.0.0 --nat=extip:172.18.129.217 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cf0bb44050ed7eadcef959fd8a12751cc5e399e3e44fdc1fc8aaeb3bfcbbff53 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=40189 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QOREw6P0kPvxdAfGa_DwYbSgorYsJo7rO6FLknIp3yzOLETikH67ZWEbXpNcBxoy-KDxCVlgPmZf4780q10EsBECgmlkgnY0gmlwhKwSx4WKbXVsdGlhZGRyc5YACASsEseFBvFSAAoErBLHhQbxU90DgnJzhQADAQAAiXNlY3AyNTZrMaECq2_jekzRKAP_AJpr5FiYB3blw4ZoOrljlxOg8qfsO2GDdGNwgvFSg3VkcILxVIV3YWt1MgM --storenode=/ip4/172.18.199.133/tcp/61778/p2p/16Uiu2HAm6xteiiqrjCt15GhNsryaHbxCSgwZB8gVhS1oQPqBVTtk --store=true --relay=true
2026-02-04 11:56:40.838 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.129.217 waku f6ef67a91f99470fffb6d6e846f395aa4d084a4d299c6ef81c9f9895711463ff
2026-02-04 11:56:40.874 DEBUG [src.node.docker_mananger] Container started with ID f6ef67a91f99. Setting up logs at ./log/docker/store_node1_2026-02-04_11-56-39__750b8600-4d3f-4145-b990-3e85fd037903__wakuorg_nwaku:latest.log
2026-02-04 11:56:40.875 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 40185
2026-02-04 11:56:40.875 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 11:56:41.876 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40185/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:56:41.880 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 11:56:41.881 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 11:56:41.881 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40185/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:56:41.883 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.129.217/tcp/40186/p2p/16Uiu2HAmCZMZift7PTin8kYLhovC8pauD17GYpKpacSw5ayT6yzN","/ip4/172.18.129.217/tcp/40187/ws/p2p/16Uiu2HAmCZMZift7PTin8kYLhovC8pauD17GYpKpacSw5ayT6yzN"],"enrUri":"enr:-L24QHHvgT1VWi4UOc6UZRb43tibdYv8oHVNyMYgyBaU1bdNWpKonGmbmcgY5ZnBbV6udmJZskrdBGNDI4cbTqS43AcCgmlkgnY0gmlwhKwSgdmKbXVsdGlhZGRyc5YACASsEoHZBpz6AAoErBKB2Qac-90DgnJzhQADAQAAiXNlY3AyNTZrMaEC_o6AkjTZBH9VUN5P-OXOqm1kFiAAB49tm9RLFF2BmoeDdGNwgpz6g3VkcIKc_IV3YWt1MgM"}'
2026-02-04 11:56:41.883 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 11:56:41.884 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40185/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.199.133/tcp/61778/p2p/16Uiu2HAm6xteiiqrjCt15GhNsryaHbxCSgwZB8gVhS1oQPqBVTtk"]'
2026-02-04 11:56:41.886 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:41.887 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61777/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 11:56:41.889 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:41.889 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40185/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 11:56:41.892 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:41.893 DEBUG [src.steps.store] Relaying message
2026-02-04 11:56:41.893 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61777/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8w", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 11:56:41.898 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:41.898 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 11:56:42.099 DEBUG [src.steps.store] Relaying message
2026-02-04 11:56:42.100 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61777/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8x", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 11:56:42.105 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:42.106 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 11:56:42.306 DEBUG [src.steps.store] Relaying message
2026-02-04 11:56:42.307 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61777/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8y", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 11:56:42.312 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:42.313 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 11:56:42.514 DEBUG [src.steps.store] Relaying message
2026-02-04 11:56:42.514 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61777/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8z", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 11:56:42.519 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:42.519 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 11:56:42.720 DEBUG [src.steps.store] Relaying message
2026-02-04 11:56:42.720 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61777/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV80", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 11:56:42.725 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:42.726 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 11:56:42.927 DEBUG [src.steps.store] Relaying message
2026-02-04 11:56:42.927 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61777/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV81", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 11:56:42.932 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:42.933 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 11:56:43.134 DEBUG [src.steps.store] Relaying message
2026-02-04 11:56:43.134 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61777/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV82", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 11:56:43.141 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:43.141 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 11:56:43.342 DEBUG [src.steps.store] Relaying message
2026-02-04 11:56:43.342 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61777/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV83", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 11:56:43.347 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:43.348 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 11:56:43.548 DEBUG [src.steps.store] Relaying message
2026-02-04 11:56:43.549 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61777/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV84", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 11:56:43.555 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:43.555 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 11:56:43.756 DEBUG [src.steps.store] Relaying message
2026-02-04 11:56:43.756 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61777/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV85", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 11:56:43.761 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:43.762 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 11:56:43.963 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61777/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x24bad747ad8940de2caf7847b0f8c0827d9d85ab275681b1bfb7b773e1c91cbd&pageSize=100&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:56:43.966 ERROR [src.node.api_clients.base_client] HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:61777/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x24bad747ad8940de2caf7847b0f8c0827d9d85ab275681b1bfb7b773e1c91cbd&pageSize=100&ascending=true. Response content: b'error in handleSelfStoreRequest: BAD_RESPONSE: archive error: DRIVER_ERROR: cursor not found'
2026-02-04 11:56:43.967 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40185/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x24bad747ad8940de2caf7847b0f8c0827d9d85ab275681b1bfb7b773e1c91cbd&pageSize=100&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:56:43.970 ERROR [src.node.api_clients.base_client] HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:40185/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x24bad747ad8940de2caf7847b0f8c0827d9d85ab275681b1bfb7b773e1c91cbd&pageSize=100&ascending=true. Response content: b'error in handleSelfStoreRequest: BAD_RESPONSE: archive error: DRIVER_ERROR: cursor not found'
2026-02-04 11:56:43.971 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 11:56:43.972 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 11:56:43.972 DEBUG [src.node.waku_node] Stopping container with id 7ccbcf43614c
2026-02-04 11:56:44.583 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 11:56:44.584 DEBUG [src.node.waku_node] Stopping container with id f6ef67a91f99
2026-02-04 11:56:45.218 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 11:56:45.219 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 11:56:45.228 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 11:56:45.238 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
