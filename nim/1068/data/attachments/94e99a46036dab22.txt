2026-02-04 11:54:26.079 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 11:54:26.079 DEBUG [tests.conftest] Running test: test_lightpush_with_a_single_receiving_node with id: 2026-02-04_11-54-26__0ff9adc6-ed53-4428-a205-0b92e4664ce1
2026-02-04 11:54:26.080 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 11:54:26.080 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2026-02-04 11:54:26.087 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 11:54:26.087 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2026-02-04_11-54-26__0ff9adc6-ed53-4428-a205-0b92e4664ce1__wakuorg_nwaku:latest.log
2026-02-04 11:54:26.087 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 11:54:26.087 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 11:54:26.089 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 11:54:26.089 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.212.45
2026-02-04 11:54:26.089 DEBUG [src.node.docker_mananger] Generated ports ['27616', '27617', '27618', '27619', '27620']
2026-02-04 11:54:26.089 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 11:54:26.089 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 11:54:26.089 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 11:54:26.089 DEBUG [src.node.docker_mananger] docker run -i -t -p 27616:27616 -p 27617:27617 -p 27618:27618 -p 27619:27619 -p 27620:27620 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=27618 --rest-port=27616 --tcp-port=27617 --discv5-udp-port=27619 --rest-address=0.0.0.0 --nat=extip:172.18.212.45 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ddcfa28abd2f3889a17edc3fecdfba8ddb0295ac5d2c0bef2f5d9e816bafe0a8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=27620 --metrics-logging=true --lightpush=true --relay=true
2026-02-04 11:54:26.283 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.212.45 waku 61804ee7649c1e883a6f1855f18094b5be41e38ea7ae11e7f506c1f64e8dc35c
2026-02-04 11:54:26.303 ERROR [src.node.docker_mananger] Max retries reached for container 206a22fd9b4a. Exiting log stream.
2026-02-04 11:54:26.314 DEBUG [src.node.docker_mananger] Container started with ID 61804ee7649c. Setting up logs at ./log/docker/receiving_node1_2026-02-04_11-54-26__0ff9adc6-ed53-4428-a205-0b92e4664ce1__wakuorg_nwaku:latest.log
2026-02-04 11:54:26.314 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 27616
2026-02-04 11:54:26.314 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 11:54:26.868 ERROR [src.node.docker_mananger] Max retries reached for container 2811ae6626c0. Exiting log stream.
2026-02-04 11:54:27.316 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27616/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:54:27.319 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_READY","desc":"Node has no relay peers to fullfill push requests"},{"Legacy Lightpush":"NOT_READY","desc":"Node has no relay peers to fullfill push requests"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 11:54:27.319 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 11:54:27.319 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27616/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:54:27.321 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.212.45/tcp/27617/p2p/16Uiu2HAm5jBrephvP6LtmnXFprZhtUDveRcLwox2hDB4i1PJV2UM","/ip4/172.18.212.45/tcp/27618/ws/p2p/16Uiu2HAm5jBrephvP6LtmnXFprZhtUDveRcLwox2hDB4i1PJV2UM"],"enrUri":"enr:-L24QKAAFJ9vWcFtyIs5TMSLS6MidgjKHQZDG0AjK9_WLj4kcaNp9Rn5eouzpXZsvbtZQY5EUGihhI8ojdfRv4B93vUCgmlkgnY0gmlwhKwS1C2KbXVsdGlhZGRyc5YACASsEtQtBmvhAAoErBLULQZr4t0DgnJzhQADAQAAiXNlY3AyNTZrMaECmRGGYThMNWvjYGSLP_dZurFS_rBmuRnwKXNEoQPzXwaDdGNwgmvhg3VkcIJr44V3YWt1Mgk"}'
2026-02-04 11:54:27.322 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 11:54:27.329 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 11:54:27.329 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2026-02-04_11-54-26__0ff9adc6-ed53-4428-a205-0b92e4664ce1__wakuorg_nwaku:latest.log
2026-02-04 11:54:27.329 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 11:54:27.329 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 11:54:27.330 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 11:54:27.331 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.41.220
2026-02-04 11:54:27.331 DEBUG [src.node.docker_mananger] Generated ports ['53431', '53432', '53433', '53434', '53435']
2026-02-04 11:54:27.331 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 11:54:27.331 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 11:54:27.331 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 11:54:27.331 DEBUG [src.node.docker_mananger] docker run -i -t -p 53431:53431 -p 53432:53432 -p 53433:53433 -p 53434:53434 -p 53435:53435 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=53433 --rest-port=53431 --tcp-port=53432 --discv5-udp-port=53434 --rest-address=0.0.0.0 --nat=extip:172.18.41.220 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c8c18f7a5d52ab4df1b41e6b8fd0969bb11d70b0bb9be14230ec1bd47b3ee9ad --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=53435 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QKAAFJ9vWcFtyIs5TMSLS6MidgjKHQZDG0AjK9_WLj4kcaNp9Rn5eouzpXZsvbtZQY5EUGihhI8ojdfRv4B93vUCgmlkgnY0gmlwhKwS1C2KbXVsdGlhZGRyc5YACASsEtQtBmvhAAoErBLULQZr4t0DgnJzhQADAQAAiXNlY3AyNTZrMaECmRGGYThMNWvjYGSLP_dZurFS_rBmuRnwKXNEoQPzXwaDdGNwgmvhg3VkcIJr44V3YWt1Mgk --lightpushnode=/ip4/172.18.212.45/tcp/27617/p2p/16Uiu2HAm5jBrephvP6LtmnXFprZhtUDveRcLwox2hDB4i1PJV2UM --lightpush=true --relay=true
2026-02-04 11:54:27.514 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.41.220 waku a8169e1ffb2e2c571c3cdc45fb7a0da8515a2f47d4a8f4c1553bd3dc0b2f2599
2026-02-04 11:54:27.544 DEBUG [src.node.docker_mananger] Container started with ID a8169e1ffb2e. Setting up logs at ./log/docker/lightpush_node1_2026-02-04_11-54-26__0ff9adc6-ed53-4428-a205-0b92e4664ce1__wakuorg_nwaku:latest.log
2026-02-04 11:54:27.544 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 53431
2026-02-04 11:54:27.545 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 11:54:28.546 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53431/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:54:28.550 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_READY","desc":"Node has no relay peers to fullfill push requests"},{"Legacy Lightpush":"NOT_READY","desc":"Node has no relay peers to fullfill push requests"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"READY"},{"Legacy Lightpush Client":"READY"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 11:54:28.550 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 11:54:28.550 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53431/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:54:28.552 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.41.220/tcp/53432/p2p/16Uiu2HAm3rqhEKfDtA4KzVsEbWxcWfh1G2akUBZfE78Sa8KbNXG7","/ip4/172.18.41.220/tcp/53433/ws/p2p/16Uiu2HAm3rqhEKfDtA4KzVsEbWxcWfh1G2akUBZfE78Sa8KbNXG7"],"enrUri":"enr:-L24QIJoS-mYyzYxgOuxEXcWW11d4eZMWAod-qDhWh1jFWpNeNTqWM1HC27rzJtw1hij6lb04Q1-EipV1Cm1AR7hcIgCgmlkgnY0gmlwhKwSKdyKbXVsdGlhZGRyc5YACASsEincBtC4AAoErBIp3AbQud0DgnJzhQADAQAAiXNlY3AyNTZrMaECfU__8Y3SDEpXbegj5dvbDJ0vFEwE2eltVryxGJdNKYyDdGNwgtC4g3VkcILQuoV3YWt1Mgk"}'
2026-02-04 11:54:28.552 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 11:54:28.553 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53431/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.212.45/tcp/27617/p2p/16Uiu2HAm5jBrephvP6LtmnXFprZhtUDveRcLwox2hDB4i1PJV2UM"]'
2026-02-04 11:54:28.579 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:54:28.580 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:27616/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 11:54:28.596 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:54:28.596 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53431/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 11:54:28.600 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:54:28.600 DEBUG [src.steps.light_push] Lightpushing message
2026-02-04 11:54:28.600 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53431/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1770206068600566324}}'
2026-02-04 11:54:28.609 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:54:28.609 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-04 11:54:28.709 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2026-02-04 11:54:28.710 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27616/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:54:28.713 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770206068600566324,"ephemeral":false,"proof":""}]'
2026-02-04 11:54:28.714 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2026-02-04 11:54:28.714 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53431/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:54:28.717 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1770206068600566324,"ephemeral":false,"proof":""}]'
2026-02-04 11:54:28.719 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 11:54:28.720 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 11:54:28.720 DEBUG [src.node.waku_node] Stopping container with id 61804ee7649c
2026-02-04 11:54:29.266 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 11:54:29.266 DEBUG [src.node.waku_node] Stopping container with id a8169e1ffb2e
2026-02-04 11:54:29.808 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 11:54:29.808 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 11:54:29.814 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 11:54:29.820 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
