2026-02-04 12:01:33.218 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 12:01:33.218 DEBUG [tests.conftest] Running test: test_message_with_ephemeral_false with id: 2026-02-04_12-01-33__9f280b9d-91d0-4c61-99e7-fbd1e782ef55
2026-02-04 12:01:33.219 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 12:01:33.219 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-02-04 12:01:33.219 DEBUG [src.steps.store] Running fixture setup: node_setup
2026-02-04 12:01:33.225 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 12:01:33.225 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-02-04_12-01-33__9f280b9d-91d0-4c61-99e7-fbd1e782ef55__wakuorg_nwaku:latest.log
2026-02-04 12:01:33.225 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 12:01:33.225 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 12:01:33.226 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 12:01:33.226 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.175.254
2026-02-04 12:01:33.227 DEBUG [src.node.docker_mananger] Generated ports ['8264', '8265', '8266', '8267', '8268']
2026-02-04 12:01:33.227 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 12:01:33.227 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 12:01:33.227 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 12:01:33.227 DEBUG [src.node.docker_mananger] docker run -i -t -p 8264:8264 -p 8265:8265 -p 8266:8266 -p 8267:8267 -p 8268:8268 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=8266 --rest-port=8264 --tcp-port=8265 --discv5-udp-port=8267 --rest-address=0.0.0.0 --nat=extip:172.18.175.254 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=59d9b49fcdeba2eaccbc5836218fbdfebca91edf50cdcb0495e810eed4ee84ea --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=8268 --metrics-logging=true --store=true --relay=true
2026-02-04 12:01:33.384 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.175.254 waku 09ec0791a92b37537ce57d53e3fece4a481c180bb18cb99f66daf30c2a207797
2026-02-04 12:01:33.410 DEBUG [src.node.docker_mananger] Container started with ID 09ec0791a92b. Setting up logs at ./log/docker/publishing_node1_2026-02-04_12-01-33__9f280b9d-91d0-4c61-99e7-fbd1e782ef55__wakuorg_nwaku:latest.log
2026-02-04 12:01:33.412 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 8264
2026-02-04 12:01:33.413 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 12:01:33.508 ERROR [src.node.docker_mananger] Max retries reached for container c05b58df50b1. Exiting log stream.
2026-02-04 12:01:34.024 ERROR [src.node.docker_mananger] Max retries reached for container cfe656fcaa28. Exiting log stream.
2026-02-04 12:01:34.414 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8264/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:01:34.417 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 12:01:34.417 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 12:01:34.417 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8264/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:01:34.419 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.175.254/tcp/8265/p2p/16Uiu2HAmLT3ZSZdikZykEi3K3pfZEkZHdDCi5wsDpfH8K8fNqVdX","/ip4/172.18.175.254/tcp/8266/ws/p2p/16Uiu2HAmLT3ZSZdikZykEi3K3pfZEkZHdDCi5wsDpfH8K8fNqVdX"],"enrUri":"enr:-L24QNB-9eh5XgCEIFUSw9ARQ1R39i0AoHpPb90uTQx24_6vcNR2R8k90ZpXXCRouoFMuJfv68bw7m-eTGsmSJJygEICgmlkgnY0gmlwhKwSr_6KbXVsdGlhZGRyc5YACASsEq_-BiBJAAoErBKv_gYgSt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDc84nmvav9LDiC1YJJVit22u2LU7T9bJrUSFUeYCEx4aDdGNwgiBJg3VkcIIgS4V3YWt1MgM"}'
2026-02-04 12:01:34.420 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 12:01:34.426 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 12:01:34.427 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-02-04_12-01-33__9f280b9d-91d0-4c61-99e7-fbd1e782ef55__wakuorg_nwaku:latest.log
2026-02-04 12:01:34.427 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 12:01:34.427 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 12:01:34.428 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 12:01:34.428 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.177.113
2026-02-04 12:01:34.428 DEBUG [src.node.docker_mananger] Generated ports ['59522', '59523', '59524', '59525', '59526']
2026-02-04 12:01:34.429 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 12:01:34.429 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 12:01:34.429 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 12:01:34.429 DEBUG [src.node.docker_mananger] docker run -i -t -p 59522:59522 -p 59523:59523 -p 59524:59524 -p 59525:59525 -p 59526:59526 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59524 --rest-port=59522 --tcp-port=59523 --discv5-udp-port=59525 --rest-address=0.0.0.0 --nat=extip:172.18.177.113 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=40b1ec7ecb90015154bd7eedfae499028843cbde44161afbe9ffd7bfa15b7eaa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59526 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QNB-9eh5XgCEIFUSw9ARQ1R39i0AoHpPb90uTQx24_6vcNR2R8k90ZpXXCRouoFMuJfv68bw7m-eTGsmSJJygEICgmlkgnY0gmlwhKwSr_6KbXVsdGlhZGRyc5YACASsEq_-BiBJAAoErBKv_gYgSt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDc84nmvav9LDiC1YJJVit22u2LU7T9bJrUSFUeYCEx4aDdGNwgiBJg3VkcIIgS4V3YWt1MgM --storenode=/ip4/172.18.175.254/tcp/8265/p2p/16Uiu2HAmLT3ZSZdikZykEi3K3pfZEkZHdDCi5wsDpfH8K8fNqVdX --store=true --relay=true
2026-02-04 12:01:34.584 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.177.113 waku d0fcc736de906bd4d555bf0462cd46d5af1e94ad946993563bbbf77449a276db
2026-02-04 12:01:34.608 DEBUG [src.node.docker_mananger] Container started with ID d0fcc736de90. Setting up logs at ./log/docker/store_node1_2026-02-04_12-01-33__9f280b9d-91d0-4c61-99e7-fbd1e782ef55__wakuorg_nwaku:latest.log
2026-02-04 12:01:34.609 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 59522
2026-02-04 12:01:34.609 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 12:01:35.610 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59522/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:01:35.613 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 12:01:35.614 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 12:01:35.614 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59522/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:01:35.616 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.177.113/tcp/59523/p2p/16Uiu2HAkuakEkeLAnyuXxzkHEfMuK7BPTwy65WC8rbLVgvJy7CaE","/ip4/172.18.177.113/tcp/59524/ws/p2p/16Uiu2HAkuakEkeLAnyuXxzkHEfMuK7BPTwy65WC8rbLVgvJy7CaE"],"enrUri":"enr:-L24QH5ucT_ukJmB4vtNAfYGtprK25_HeFd04dr_bhSiE9TUdKWxzIv31PwiyRJoso3OwIzH13oW3rVFDlAmq3Z__v8CgmlkgnY0gmlwhKwSsXGKbXVsdGlhZGRyc5YACASsErFxBuiDAAoErBKxcQbohN0DgnJzhQADAQAAiXNlY3AyNTZrMaECAlMKrymwAj33cnZXeDzJG8p6CYUZgrV4afbCCm4DbuODdGNwguiDg3VkcILohYV3YWt1MgM"}'
2026-02-04 12:01:35.616 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 12:01:35.617 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59522/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.175.254/tcp/8265/p2p/16Uiu2HAmLT3ZSZdikZykEi3K3pfZEkZHdDCi5wsDpfH8K8fNqVdX"]'
2026-02-04 12:01:35.619 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 12:01:35.619 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8264/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 12:01:35.622 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 12:01:35.622 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59522/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 12:01:35.624 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 12:01:35.625 DEBUG [src.steps.store] Relaying message
2026-02-04 12:01:35.625 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8264/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
2026-02-04 12:01:35.629 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 12:01:35.630 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 12:01:35.831 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-04 12:01:35.831 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8264/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:01:35.834 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xcbe1ae3d9aeb50a3b184a2502701b454fed56d73e742baae4f5e855f073bd165"}]}'
2026-02-04 12:01:35.835 DEBUG [src.steps.store] messages length is 1
2026-02-04 12:01:35.835 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-04 12:01:35.835 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59522/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:01:35.838 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xcbe1ae3d9aeb50a3b184a2502701b454fed56d73e742baae4f5e855f073bd165"}]}'
2026-02-04 12:01:35.838 DEBUG [src.steps.store] messages length is 1
2026-02-04 12:01:35.840 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 12:01:35.841 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 12:01:35.841 DEBUG [src.node.waku_node] Stopping container with id 09ec0791a92b
2026-02-04 12:01:36.302 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 12:01:36.303 DEBUG [src.node.waku_node] Stopping container with id d0fcc736de90
2026-02-04 12:01:36.775 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 12:01:36.777 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 12:01:36.782 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 12:01:36.788 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
