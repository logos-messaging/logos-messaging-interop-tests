2026-02-04 11:56:14.380 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 11:56:14.381 DEBUG [tests.conftest] Running test: test_main_node_relay_and_store__peer_relay_and_store with id: 2026-02-04_11-56-14__144db8a4-9689-4e84-a58f-61d39f8cef08
2026-02-04 11:56:14.381 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 11:56:14.381 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-02-04 11:56:14.388 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 11:56:14.388 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-02-04_11-56-14__144db8a4-9689-4e84-a58f-61d39f8cef08__wakuorg_nwaku:latest.log
2026-02-04 11:56:14.388 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 11:56:14.388 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 11:56:14.390 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 11:56:14.390 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.237.188
2026-02-04 11:56:14.390 DEBUG [src.node.docker_mananger] Generated ports ['53905', '53906', '53907', '53908', '53909']
2026-02-04 11:56:14.390 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 11:56:14.390 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 11:56:14.390 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 11:56:14.391 DEBUG [src.node.docker_mananger] docker run -i -t -p 53905:53905 -p 53906:53906 -p 53907:53907 -p 53908:53908 -p 53909:53909 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=53907 --rest-port=53905 --tcp-port=53906 --discv5-udp-port=53908 --rest-address=0.0.0.0 --nat=extip:172.18.237.188 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=60abf73f0efd4a1aef1f6cd1931a6eb281b5f174d1dedafd70fe27a9abfa1346 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=53909 --metrics-logging=true --store=true --relay=true
2026-02-04 11:56:14.576 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.237.188 waku ea5d456b3700883e0e316b9ebf458e68cceedc56a736eb1675137cb0d02cfc30
2026-02-04 11:56:14.609 DEBUG [src.node.docker_mananger] Container started with ID ea5d456b3700. Setting up logs at ./log/docker/publishing_node1_2026-02-04_11-56-14__144db8a4-9689-4e84-a58f-61d39f8cef08__wakuorg_nwaku:latest.log
2026-02-04 11:56:14.610 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 53905
2026-02-04 11:56:14.611 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 11:56:14.654 ERROR [src.node.docker_mananger] Max retries reached for container 410bfad3c08f. Exiting log stream.
2026-02-04 11:56:15.188 ERROR [src.node.docker_mananger] Max retries reached for container e9378b8c785e. Exiting log stream.
2026-02-04 11:56:15.611 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53905/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:56:15.614 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 11:56:15.614 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 11:56:15.615 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53905/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:56:15.617 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.237.188/tcp/53906/p2p/16Uiu2HAmJehNsUt8zWT4XbRJMgYvLRcJq6Dx631RY49aq2CrQZGg","/ip4/172.18.237.188/tcp/53907/ws/p2p/16Uiu2HAmJehNsUt8zWT4XbRJMgYvLRcJq6Dx631RY49aq2CrQZGg"],"enrUri":"enr:-L24QAhzUF0mBnPjUIJNDQaU7yvWKv0-ZMG2zLMIHT-fUpynHKfqXHmBZVdLqyHpUY3danNaoMMlwPs4kGPcNPSwpS8CgmlkgnY0gmlwhKwS7byKbXVsdGlhZGRyc5YACASsEu28BtKSAAoErBLtvAbSk90DgnJzhQADAQAAiXNlY3AyNTZrMaEDWRLuMEVaDdwjR0VN7hgQHYtMtLvsQK7vJhd9hIYFgtWDdGNwgtKSg3VkcILSlIV3YWt1MgM"}'
2026-02-04 11:56:15.617 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 11:56:15.624 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 11:56:15.624 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-02-04_11-56-14__144db8a4-9689-4e84-a58f-61d39f8cef08__wakuorg_nwaku:latest.log
2026-02-04 11:56:15.624 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 11:56:15.625 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 11:56:15.626 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 11:56:15.626 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.175.227
2026-02-04 11:56:15.626 DEBUG [src.node.docker_mananger] Generated ports ['27612', '27613', '27614', '27615', '27616']
2026-02-04 11:56:15.626 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 11:56:15.626 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 11:56:15.627 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 11:56:15.627 DEBUG [src.node.docker_mananger] docker run -i -t -p 27612:27612 -p 27613:27613 -p 27614:27614 -p 27615:27615 -p 27616:27616 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=27614 --rest-port=27612 --tcp-port=27613 --discv5-udp-port=27615 --rest-address=0.0.0.0 --nat=extip:172.18.175.227 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ac7b1f31beddcc0fb3caececceb0a1141dedf8fbf58becb301ddcc651ed481e7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=27616 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QAhzUF0mBnPjUIJNDQaU7yvWKv0-ZMG2zLMIHT-fUpynHKfqXHmBZVdLqyHpUY3danNaoMMlwPs4kGPcNPSwpS8CgmlkgnY0gmlwhKwS7byKbXVsdGlhZGRyc5YACASsEu28BtKSAAoErBLtvAbSk90DgnJzhQADAQAAiXNlY3AyNTZrMaEDWRLuMEVaDdwjR0VN7hgQHYtMtLvsQK7vJhd9hIYFgtWDdGNwgtKSg3VkcILSlIV3YWt1MgM --storenode=/ip4/172.18.237.188/tcp/53906/p2p/16Uiu2HAmJehNsUt8zWT4XbRJMgYvLRcJq6Dx631RY49aq2CrQZGg --store=true --relay=true
2026-02-04 11:56:15.819 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.175.227 waku f1941db9b9a943037218fcfcd6732405a104bd7775b44cb9e31b34d07765d197
2026-02-04 11:56:15.853 DEBUG [src.node.docker_mananger] Container started with ID f1941db9b9a9. Setting up logs at ./log/docker/store_node1_2026-02-04_11-56-14__144db8a4-9689-4e84-a58f-61d39f8cef08__wakuorg_nwaku:latest.log
2026-02-04 11:56:15.853 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 27612
2026-02-04 11:56:15.854 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 11:56:16.855 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27612/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:56:16.859 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"READY"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 11:56:16.859 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 11:56:16.860 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27612/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:56:16.862 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.175.227/tcp/27613/p2p/16Uiu2HAmJ2k8YjWJZQn6JtM1dDPbZAmB961BRrjrojZLPhELgYrE","/ip4/172.18.175.227/tcp/27614/ws/p2p/16Uiu2HAmJ2k8YjWJZQn6JtM1dDPbZAmB961BRrjrojZLPhELgYrE"],"enrUri":"enr:-L24QEwOMgLNDp8HweWz7hkgrrDchs288KyyjQI1-YXUNXbLS_WCyGnlh_08AyVhkRf5TC04046Xhsl9MWobXxRDUloCgmlkgnY0gmlwhKwSr-OKbXVsdGlhZGRyc5YACASsEq_jBmvdAAoErBKv4wZr3t0DgnJzhQADAQAAiXNlY3AyNTZrMaEDT90iWYCncpxOj1hEth5XNz1Z8OCiVp82T-8CLmgKy-uDdGNwgmvdg3VkcIJr34V3YWt1MgM"}'
2026-02-04 11:56:16.862 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 11:56:16.862 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:27612/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.237.188/tcp/53906/p2p/16Uiu2HAmJehNsUt8zWT4XbRJMgYvLRcJq6Dx631RY49aq2CrQZGg"]'
2026-02-04 11:56:16.865 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:16.865 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53905/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 11:56:16.868 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:16.868 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:27612/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-04 11:56:16.870 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:16.870 DEBUG [src.steps.store] Relaying message
2026-02-04 11:56:16.871 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53905/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 11:56:16.876 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 11:56:16.876 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-04 11:56:17.077 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-04 11:56:17.077 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53905/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:56:17.080 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x6c091e8dfb9de0ae4ffeae8b54b48b17289c0b55a9da4c942befacb21311100f"}]}'
2026-02-04 11:56:17.080 DEBUG [src.steps.store] messages length is 1
2026-02-04 11:56:17.081 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-04 11:56:17.081 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27612/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-04 11:56:17.083 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x6c091e8dfb9de0ae4ffeae8b54b48b17289c0b55a9da4c942befacb21311100f"}]}'
2026-02-04 11:56:17.084 DEBUG [src.steps.store] messages length is 1
2026-02-04 11:56:17.085 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 11:56:17.086 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 11:56:17.086 DEBUG [src.node.waku_node] Stopping container with id ea5d456b3700
2026-02-04 11:56:17.636 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 11:56:17.638 DEBUG [src.node.waku_node] Stopping container with id f1941db9b9a9
2026-02-04 11:56:18.122 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 11:56:18.124 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 11:56:18.129 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 11:56:18.135 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
