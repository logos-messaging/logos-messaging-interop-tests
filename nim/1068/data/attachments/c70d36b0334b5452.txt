2026-02-04 12:01:59.549 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-04 12:01:59.551 DEBUG [tests.conftest] Running test: test_publish_with_extra_field with id: 2026-02-04_12-01-59__73b10e73-846d-4a4b-acae-e0d25fa0be73
2026-02-04 12:01:59.552 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-04 12:01:59.553 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2026-02-04 12:01:59.554 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2026-02-04 12:01:59.561 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 12:01:59.562 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2026-02-04_12-01-59__73b10e73-846d-4a4b-acae-e0d25fa0be73__wakuorg_nwaku:latest.log
2026-02-04 12:01:59.562 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 12:01:59.562 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 12:01:59.564 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 12:01:59.565 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.69.192
2026-02-04 12:01:59.566 DEBUG [src.node.docker_mananger] Generated ports ['5253', '5254', '5255', '5256', '5257']
2026-02-04 12:01:59.566 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 12:01:59.566 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 12:01:59.567 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 12:01:59.568 DEBUG [src.node.docker_mananger] docker run -i -t -p 5253:5253 -p 5254:5254 -p 5255:5255 -p 5256:5256 -p 5257:5257 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=5255 --rest-port=5253 --tcp-port=5254 --discv5-udp-port=5256 --rest-address=0.0.0.0 --nat=extip:172.18.69.192 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b2ff159f674e5cceea8cacff018fb5f35acfcbdea12c938db23dd7d9cd17cdd2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=5257 --metrics-logging=true --relay=true
2026-02-04 12:01:59.753 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.69.192 waku 8de2062e3718619120cba100c447f34c042174830f2eb74667f6b344b5339b13
2026-02-04 12:01:59.787 DEBUG [src.node.docker_mananger] Container started with ID 8de2062e3718. Setting up logs at ./log/docker/node1_2026-02-04_12-01-59__73b10e73-846d-4a4b-acae-e0d25fa0be73__wakuorg_nwaku:latest.log
2026-02-04 12:01:59.789 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 5253
2026-02-04 12:01:59.789 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 12:01:59.795 ERROR [src.node.docker_mananger] Max retries reached for container fb83cda41b90. Exiting log stream.
2026-02-04 12:02:00.384 ERROR [src.node.docker_mananger] Max retries reached for container bf33ac9fe0a3. Exiting log stream.
2026-02-04 12:02:00.789 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5253/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:02:00.792 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 12:02:00.793 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 12:02:00.793 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5253/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:02:00.795 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.69.192/tcp/5254/p2p/16Uiu2HAmQVtds3EpGejB5MDU3Dnyph4aXzCJKSABBrB4v1qfWBhA","/ip4/172.18.69.192/tcp/5255/ws/p2p/16Uiu2HAmQVtds3EpGejB5MDU3Dnyph4aXzCJKSABBrB4v1qfWBhA"],"enrUri":"enr:-L24QHRRuLIz-Vc9gabSumqkiGMgdhNz49i7eyL5ThxlEde-VYxUkddmqz-ezFzWp1W7_RgwaxGer94BfbaMZx45ryYCgmlkgnY0gmlwhKwSRcCKbXVsdGlhZGRyc5YACASsEkXABhSGAAoErBJFwAYUh90DgnJzhQADAQAAiXNlY3AyNTZrMaEDr_eOActwec4kOHyvtFqOx4OXwfI01Ny3KtsS7CBOCOmDdGNwghSGg3VkcIIUiIV3YWt1MgE"}'
2026-02-04 12:02:00.795 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 12:02:00.801 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-04 12:02:00.802 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2026-02-04_12-01-59__73b10e73-846d-4a4b-acae-e0d25fa0be73__wakuorg_nwaku:latest.log
2026-02-04 12:02:00.802 DEBUG [src.node.waku_node] Starting Node...
2026-02-04 12:02:00.802 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-04 12:02:00.803 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-04 12:02:00.803 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.156.53
2026-02-04 12:02:00.804 DEBUG [src.node.docker_mananger] Generated ports ['21364', '21365', '21366', '21367', '21368']
2026-02-04 12:02:00.804 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-04 12:02:00.804 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-04 12:02:00.804 DEBUG [src.node.waku_node] Using volumes []
2026-02-04 12:02:00.804 DEBUG [src.node.docker_mananger] docker run -i -t -p 21364:21364 -p 21365:21365 -p 21366:21366 -p 21367:21367 -p 21368:21368 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=21366 --rest-port=21364 --tcp-port=21365 --discv5-udp-port=21367 --rest-address=0.0.0.0 --nat=extip:172.18.156.53 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=61db13c42ace9cdba5e75e5d310b3eeeb7c10b27253a2ea997af5c7adb64fd5f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=21368 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QHRRuLIz-Vc9gabSumqkiGMgdhNz49i7eyL5ThxlEde-VYxUkddmqz-ezFzWp1W7_RgwaxGer94BfbaMZx45ryYCgmlkgnY0gmlwhKwSRcCKbXVsdGlhZGRyc5YACASsEkXABhSGAAoErBJFwAYUh90DgnJzhQADAQAAiXNlY3AyNTZrMaEDr_eOActwec4kOHyvtFqOx4OXwfI01Ny3KtsS7CBOCOmDdGNwghSGg3VkcIIUiIV3YWt1MgE
2026-02-04 12:02:00.986 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.156.53 waku 37d6697632f6fff6ac5225ecdde27e4ff8e29ed10ae33db212784c5d2420b114
2026-02-04 12:02:01.018 DEBUG [src.node.docker_mananger] Container started with ID 37d6697632f6. Setting up logs at ./log/docker/node2_2026-02-04_12-01-59__73b10e73-846d-4a4b-acae-e0d25fa0be73__wakuorg_nwaku:latest.log
2026-02-04 12:02:01.019 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 21364
2026-02-04 12:02:01.019 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-04 12:02:02.020 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21364/health" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:02:02.034 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"NOT_READY","desc":"No Store service peer available yet, neither Store service set up for the node"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-04 12:02:02.035 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-04 12:02:02.036 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21364/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:02:02.041 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.156.53/tcp/21365/p2p/16Uiu2HAkyHnqWPnYJ4GxEb8yJp3oANuxJGB9mTTuiAXHtBPCNf3V","/ip4/172.18.156.53/tcp/21366/ws/p2p/16Uiu2HAkyHnqWPnYJ4GxEb8yJp3oANuxJGB9mTTuiAXHtBPCNf3V"],"enrUri":"enr:-L24QCezqHNMD8dr_9SZ3iQe40NWEY9tK0rR1JU13BSYnwzlb4pWmC-WiYnkbJHOeH2Ow5jQpLF6tqgeiac24r7cvkgCgmlkgnY0gmlwhKwSnDWKbXVsdGlhZGRyc5YACASsEpw1BlN1AAoErBKcNQZTdt0DgnJzhQADAQAAiXNlY3AyNTZrMaECOWnayLDkxSXgeUkm3VftcuIHLano7tg-ByCisZeCgqCDdGNwglN1g3VkcIJTd4V3YWt1MgE"}'
2026-02-04 12:02:02.041 INFO [src.node.waku_node] REST service is ready !!
2026-02-04 12:02:02.041 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:21364/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.69.192/tcp/5254/p2p/16Uiu2HAmQVtds3EpGejB5MDU3Dnyph4aXzCJKSABBrB4v1qfWBhA"]'
2026-02-04 12:02:02.044 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 12:02:02.045 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2026-02-04 12:02:02.045 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:5253/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-04 12:02:02.048 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 12:02:02.048 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:21364/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2026-02-04 12:02:02.052 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 12:02:02.054 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:5253/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2026-02-04 12:02:02.059 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-04 12:02:02.060 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2026-02-04 12:02:02.160 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2026-02-04 12:02:02.160 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5253/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:02:02.163 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770206522054474240,"ephemeral":false,"proof":""}]'
2026-02-04 12:02:02.165 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2026-02-04 12:02:02.165 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21364/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2026-02-04 12:02:02.167 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1770206522054474240,"ephemeral":false,"proof":""}]'
2026-02-04 12:02:02.169 INFO [src.steps.relay] WARM UP successful!!
2026-02-04 12:02:02.170 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:5253/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "extraField": "extraValue"}'
2026-02-04 12:02:02.172 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:5253/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode: Unable to deserialize data: '
2026-02-04 12:02:02.175 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-04 12:02:02.176 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-04 12:02:02.176 DEBUG [src.node.waku_node] Stopping container with id 8de2062e3718
2026-02-04 12:02:02.735 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 12:02:02.735 DEBUG [src.node.waku_node] Stopping container with id 37d6697632f6
2026-02-04 12:02:03.302 DEBUG [src.node.waku_node] Container stopped.
2026-02-04 12:02:03.304 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-04 12:02:03.309 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-04 12:02:03.314 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
