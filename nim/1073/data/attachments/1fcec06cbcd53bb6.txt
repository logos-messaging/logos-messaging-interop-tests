2026-02-08 04:48:58.576 DEBUG [tests.conftest] Running fixture setup: test_id
2026-02-08 04:48:58.577 DEBUG [tests.conftest] Running test: test_message_relayed_while_store_node_is_stopped_without_removing with id: 2026-02-08_04-48-58__29c97166-b1b1-475a-b3e4-f2d570a88239
2026-02-08 04:48:58.577 DEBUG [src.steps.common] Running fixture setup: common_setup
2026-02-08 04:48:58.577 DEBUG [src.steps.store] Running fixture setup: store_setup
2026-02-08 04:48:58.585 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-08 04:48:58.585 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2026-02-08_04-48-58__29c97166-b1b1-475a-b3e4-f2d570a88239__wakuorg_nwaku:latest.log
2026-02-08 04:48:58.585 DEBUG [src.node.waku_node] Starting Node...
2026-02-08 04:48:58.586 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-08 04:48:58.587 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-08 04:48:58.587 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.200.108
2026-02-08 04:48:58.587 DEBUG [src.node.docker_mananger] Generated ports ['37841', '37842', '37843', '37844', '37845']
2026-02-08 04:48:58.588 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-08 04:48:58.588 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-08 04:48:58.588 DEBUG [src.node.waku_node] Using volumes []
2026-02-08 04:48:58.588 DEBUG [src.node.docker_mananger] docker run -i -t -p 37841:37841 -p 37842:37842 -p 37843:37843 -p 37844:37844 -p 37845:37845 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37843 --rest-port=37841 --tcp-port=37842 --discv5-udp-port=37844 --rest-address=0.0.0.0 --nat=extip:172.18.200.108 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e57180ab6eec11e3e4665f12f1b572d485cc3c9bf1c55e39fbbe703bdc6cc0d7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37845 --metrics-logging=true --store=true --relay=true
2026-02-08 04:48:58.769 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.200.108 waku 3352229360f13ae30ea4eb4bcbd138183b71702eb36f88007b6e9b3de79e3f7d
2026-02-08 04:48:58.803 DEBUG [src.node.docker_mananger] Container started with ID 3352229360f1. Setting up logs at ./log/docker/publishing_node1_2026-02-08_04-48-58__29c97166-b1b1-475a-b3e4-f2d570a88239__wakuorg_nwaku:latest.log
2026-02-08 04:48:58.803 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 37841
2026-02-08 04:48:58.805 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-08 04:48:58.811 ERROR [src.node.docker_mananger] Max retries reached for container 9ce211b9cca7. Exiting log stream.
2026-02-08 04:48:59.385 ERROR [src.node.docker_mananger] Max retries reached for container e7ebcf05a3c4. Exiting log stream.
2026-02-08 04:48:59.805 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37841/health" -H "Content-Type: application/json" -d 'None'
2026-02-08 04:48:59.808 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_READY","desc":"No connected peers"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"READY"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"NOT_READY","desc":"No Legacy Store service peers are available yet, neither Store service set up for the node"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-08 04:48:59.808 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-08 04:48:59.809 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37841/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-08 04:48:59.811 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.200.108/tcp/37842/p2p/16Uiu2HAmFAgKGnvEbEND5JAi62ntZ32BZiaZdiGuJy3ktnPmmKBN","/ip4/172.18.200.108/tcp/37843/ws/p2p/16Uiu2HAmFAgKGnvEbEND5JAi62ntZ32BZiaZdiGuJy3ktnPmmKBN"],"enrUri":"enr:-L24QEOfsdL47V4R6svAbl-EkHUprLF_KaSA3qTvhVHW6GM3bYjHy4oEJs7WPhqKoF5DC35O6OWFDRX3tEfzAGtuiGMCgmlkgnY0gmlwhKwSyGyKbXVsdGlhZGRyc5YACASsEshsBpPSAAoErBLIbAaT090DgnJzhQADAQAAiXNlY3AyNTZrMaEDJVJn-PyitCSxZrrzw2qhXWsIQv7z8PQ2pDJI4KeeYAGDdGNwgpPSg3VkcIKT1IV3YWt1MgM"}'
2026-02-08 04:48:59.811 INFO [src.node.waku_node] REST service is ready !!
2026-02-08 04:48:59.818 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2026-02-08 04:48:59.819 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2026-02-08_04-48-58__29c97166-b1b1-475a-b3e4-f2d570a88239__wakuorg_nwaku:latest.log
2026-02-08 04:48:59.819 DEBUG [src.node.waku_node] Starting Node...
2026-02-08 04:48:59.819 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2026-02-08 04:48:59.820 DEBUG [src.node.docker_mananger] Network waku already exists
2026-02-08 04:48:59.820 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.94.157
2026-02-08 04:48:59.821 DEBUG [src.node.docker_mananger] Generated ports ['55199', '55200', '55201', '55202', '55203']
2026-02-08 04:48:59.821 DEBUG [src.node.waku_node] RLN credentials were not set
2026-02-08 04:48:59.821 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2026-02-08 04:48:59.821 DEBUG [src.node.waku_node] Using volumes []
2026-02-08 04:48:59.821 DEBUG [src.node.docker_mananger] docker run -i -t -p 55199:55199 -p 55200:55200 -p 55201:55201 -p 55202:55202 -p 55203:55203 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55201 --rest-port=55199 --tcp-port=55200 --discv5-udp-port=55202 --rest-address=0.0.0.0 --nat=extip:172.18.94.157 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=398d25ba0d879e79cc85a17d9b1efdee30c3e3d2e4eb89a7c7b7f5fd86fd031b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55203 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QEOfsdL47V4R6svAbl-EkHUprLF_KaSA3qTvhVHW6GM3bYjHy4oEJs7WPhqKoF5DC35O6OWFDRX3tEfzAGtuiGMCgmlkgnY0gmlwhKwSyGyKbXVsdGlhZGRyc5YACASsEshsBpPSAAoErBLIbAaT090DgnJzhQADAQAAiXNlY3AyNTZrMaEDJVJn-PyitCSxZrrzw2qhXWsIQv7z8PQ2pDJI4KeeYAGDdGNwgpPSg3VkcIKT1IV3YWt1MgM --storenode=/ip4/172.18.200.108/tcp/37842/p2p/16Uiu2HAmFAgKGnvEbEND5JAi62ntZ32BZiaZdiGuJy3ktnPmmKBN --store=false --relay=false
2026-02-08 04:49:00.018 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.94.157 waku 3bbcc754b9234afce072ecb129d08aeb5b8d4532dc9138e2f727bed49bc2632b
2026-02-08 04:49:00.049 DEBUG [src.node.docker_mananger] Container started with ID 3bbcc754b923. Setting up logs at ./log/docker/store_node1_2026-02-08_04-48-58__29c97166-b1b1-475a-b3e4-f2d570a88239__wakuorg_nwaku:latest.log
2026-02-08 04:49:00.049 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 55199
2026-02-08 04:49:00.050 DEBUG [src.libs.common] Sleeping for 1 seconds
2026-02-08 04:49:01.050 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55199/health" -H "Content-Type: application/json" -d 'None'
2026-02-08 04:49:01.054 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-08 04:49:01.054 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-08 04:49:01.054 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55199/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-08 04:49:01.057 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.94.157/tcp/55200/p2p/16Uiu2HAmTXGMQWj479ggyAaET6neWLXqka5XAp3hb1LE3mh3UkXD","/ip4/172.18.94.157/tcp/55201/ws/p2p/16Uiu2HAmTXGMQWj479ggyAaET6neWLXqka5XAp3hb1LE3mh3UkXD"],"enrUri":"enr:-L24QGuK7yNQmA1-tprvRoC5h5my6iOVVT-v7bvV3lBymqJXPekyILo9Yt8zdE6DhBOHRHjbmIHXMqX0pLQ3dTGbI1ICgmlkgnY0gmlwhKwSXp2KbXVsdGlhZGRyc5YACASsEl6dBtegAAoErBJenQbXod0DgnJzhQADAQAAiXNlY3AyNTZrMaED3OTAPiOhouP6LL1Ej9bEj968-Sy21V3rf6_ucE5yzDyDdGNwgtegg3VkcILXooV3YWt1MgA"}'
2026-02-08 04:49:01.057 INFO [src.node.waku_node] REST service is ready !!
2026-02-08 04:49:01.057 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55199/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.200.108/tcp/37842/p2p/16Uiu2HAmFAgKGnvEbEND5JAi62ntZ32BZiaZdiGuJy3ktnPmmKBN"]'
2026-02-08 04:49:01.088 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-08 04:49:01.089 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37841/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2026-02-08 04:49:01.100 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-08 04:49:01.102 DEBUG [src.steps.store] Relaying message
2026-02-08 04:49:01.102 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37841/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-08 04:49:01.109 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-08 04:49:01.109 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-08 04:49:01.310 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-08 04:49:01.310 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37841/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2026-02-08 04:49:01.313 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xee7dfb72de8994e2a5f2bf3ced46c6cdf01e25f973973ebdbe6b387f1ab8d128"}]}'
2026-02-08 04:49:01.314 DEBUG [src.steps.store] messages length is 1
2026-02-08 04:49:01.314 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2026-02-08 04:49:01.314 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55199/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2026-02-08 04:49:01.323 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"72ce16a77ccbce8986e1","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xee7dfb72de8994e2a5f2bf3ced46c6cdf01e25f973973ebdbe6b387f1ab8d128"}]}'
2026-02-08 04:49:01.323 DEBUG [src.steps.store] messages length is 1
2026-02-08 04:49:01.847 DEBUG [src.steps.store] Relaying message
2026-02-08 04:49:01.848 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37841/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2026-02-08 04:49:01.854 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2026-02-08 04:49:01.854 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2026-02-08 04:49:02.268 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55199/health" -H "Content-Type: application/json" -d 'None'
2026-02-08 04:49:02.370 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55199/health" -H "Content-Type: application/json" -d 'None'
2026-02-08 04:49:02.375 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"READY","protocolsHealth":[{"Relay":"NOT_MOUNTED"},{"Rln Relay":"NOT_MOUNTED"},{"Lightpush":"NOT_MOUNTED"},{"Legacy Lightpush":"NOT_MOUNTED"},{"Filter":"NOT_MOUNTED"},{"Store":"NOT_MOUNTED"},{"Legacy Store":"NOT_MOUNTED"},{"Peer Exchange":"READY"},{"Rendezvous":"NOT_READY","desc":"No Rendezvous peers are available yet"},{"Mix":"NOT_MOUNTED"},{"Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Legacy Lightpush Client":"NOT_READY","desc":"No Lightpush service peer available yet"},{"Store Client":"READY"},{"Legacy Store Client":"READY"},{"Filter Client":"NOT_READY","desc":"No Filter service peer available yet"}]}'
2026-02-08 04:49:02.375 INFO [src.node.waku_node] Node protocols are initialized !!
2026-02-08 04:49:02.375 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55199/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2026-02-08 04:49:02.377 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.94.157/tcp/55200/p2p/16Uiu2HAmTXGMQWj479ggyAaET6neWLXqka5XAp3hb1LE3mh3UkXD","/ip4/172.18.94.157/tcp/55201/ws/p2p/16Uiu2HAmTXGMQWj479ggyAaET6neWLXqka5XAp3hb1LE3mh3UkXD"],"enrUri":"enr:-L24QGuK7yNQmA1-tprvRoC5h5my6iOVVT-v7bvV3lBymqJXPekyILo9Yt8zdE6DhBOHRHjbmIHXMqX0pLQ3dTGbI1ICgmlkgnY0gmlwhKwSXp2KbXVsdGlhZGRyc5YACASsEl6dBtegAAoErBJenQbXod0DgnJzhQADAQAAiXNlY3AyNTZrMaED3OTAPiOhouP6LL1Ej9bEj968-Sy21V3rf6_ucE5yzDyDdGNwgtegg3VkcILXooV3YWt1MgA"}'
2026-02-08 04:49:02.378 INFO [src.node.waku_node] REST service is ready !!
2026-02-08 04:49:02.378 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37841/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-08 04:49:02.381 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xee7dfb72de8994e2a5f2bf3ced46c6cdf01e25f973973ebdbe6b387f1ab8d128"},{"messageHash":"0xc0cf48a222a566860c2e68b0cb15d507ef9cc819d45696a24d2d1008abc0d422"}]}'
2026-02-08 04:49:02.382 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55199/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2026-02-08 04:49:02.420 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"f710255892c4a764ed49","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xee7dfb72de8994e2a5f2bf3ced46c6cdf01e25f973973ebdbe6b387f1ab8d128"},{"messageHash":"0xc0cf48a222a566860c2e68b0cb15d507ef9cc819d45696a24d2d1008abc0d422"}]}'
2026-02-08 04:49:02.426 DEBUG [tests.conftest] Running fixture teardown: test_setup
2026-02-08 04:49:02.428 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2026-02-08 04:49:02.428 DEBUG [src.node.waku_node] Stopping container with id 3352229360f1
2026-02-08 04:49:02.964 DEBUG [src.node.waku_node] Container stopped.
2026-02-08 04:49:02.964 DEBUG [src.node.waku_node] Stopping container with id 3bbcc754b923
2026-02-08 04:49:03.530 DEBUG [src.node.waku_node] Container stopped.
2026-02-08 04:49:03.531 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2026-02-08 04:49:03.541 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2026-02-08 04:49:03.616 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
